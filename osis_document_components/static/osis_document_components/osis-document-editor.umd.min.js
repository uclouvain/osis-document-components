(function(B,o){typeof exports=="object"&&typeof module<"u"?o(require("@vue/runtime-dom"),require("vue-i18n"),require("vue")):typeof define=="function"&&define.amd?define(["@vue/runtime-dom","vue-i18n","vue"],o):(B=typeof globalThis<"u"?globalThis:B||self,o(B.Vue,B.VueI18n,B.Vue))})(this,(function(runtimeDom,vueI18n,vue){"use strict";const resource$1={uploader:{specific_nb_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici un fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici "},{t:4,k:"count"},{t:3,v:" fichiers"}]}]}},min_max_drag_n_drop_label:{t:0,b:{t:2,i:[{t:3,v:"Glissez-déposez ici entre "},{t:4,k:"min"},{t:3,v:" et "},{t:4,k:"max"},{t:3,v:" fichiers"}]}},min_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici au-moins un fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici au-moins "},{t:4,k:"count"},{t:3,v:" fichiers"}]}]}},max_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici votre fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici vos fichiers (maximum "},{t:4,k:"count"},{t:3,v:")"}]}]}},drag_n_drop_label:{t:0,b:{t:2,i:[{t:3}],s:"Glissez-déposez ici vos fichiers"}},add_file_label:{t:0,b:{t:2,i:[{t:3}],s:"ou cliquez-ici"}},max_size_label:{t:0,b:{t:2,i:[{t:3,v:"(taille maximum "},{t:4,k:"size"},{t:3,v:")"}]}},trigger_upload:{t:0,b:{t:2,i:[{t:3}],s:"Transférer"}}},upload_entry:{completion:{t:0,b:{t:2,i:[{t:4,k:"progress"},{t:3,v:"% transférés"}]}},too_large:{t:0,b:{t:2,i:[{t:3}],s:"Le fichier est trop lourd"}},wrong_type:{t:0,b:{t:1,c:[{t:2,i:[{t:3,v:'Le fichier doit être du type "'},{t:4,k:"types"},{t:3,v:'"'}]},{t:2,i:[{t:3,v:`Le fichier doit être d'un des types suivants : "`},{t:4,k:"types"},{t:3,v:'"'}]}]}},crop_header:{t:0,b:{t:2,i:[{t:3}],s:"Veuillez choisir la partie à garder."}},crop:{t:0,b:{t:2,i:[{t:3}],s:"Recadrer"}},cancel:{t:0,b:{t:2,i:[{t:3}],s:"Annuler"}}},view_entry:{rotate_left:{t:0,b:{t:2,i:[{t:3}],s:"Faire pivoter l'image à gauche"}},rotate_right:{t:0,b:{t:2,i:[{t:3}],s:"Faire pivoter l'image à droite"}},loading:{t:0,b:{t:2,i:[{t:3}],s:"Chargement..."}},close:{t:0,b:{t:2,i:[{t:3}],s:"Fermer"}},save:{t:0,b:{t:2,i:[{t:3}],s:"Enregistrer"}},file_infected:{t:0,b:{t:2,i:[{t:3}],s:"Le fichier référencé semble infecté par un virus"}}},editor:{pagination:{t:0,b:{t:2,i:[{t:4,k:"currentPage"},{t:3,v:" de "},{t:4,k:"pages"}]}},zoom:{auto:{t:0,b:{t:2,i:[{t:3}],s:"Zoom automatique"}},"page-width":{t:0,b:{t:2,i:[{t:3}],s:"Pleine largeur"}},"page-fit":{t:0,b:{t:2,i:[{t:3}],s:"Page entière"}},"page-actual":{t:0,b:{t:2,i:[{t:3}],s:"Taille réelle"}}},colors:{warning:{t:0,b:{t:2,i:[{t:3}],s:"Jaune"}},danger:{t:0,b:{t:2,i:[{t:3}],s:"Rouge"}},info:{t:0,b:{t:2,i:[{t:3}],s:"Bleu"}},success:{t:0,b:{t:2,i:[{t:3}],s:"Vert"}},muted:{t:0,b:{t:2,i:[{t:3}],s:"Blanc"}}}},error:{t:0,b:{t:2,i:[{t:3,v:"Erreur : "},{t:4,k:"error"}]}},request_error:{t:0,b:{t:2,i:[{t:3,v:"Erreur lors de la requête : "},{t:4,k:"error"}]}},units:[{t:0,b:{t:2,i:[{t:3}],s:"o"}},{t:0,b:{t:2,i:[{t:3}],s:"Ko"}},{t:0,b:{t:2,i:[{t:3}],s:"Mo"}},{t:0,b:{t:2,i:[{t:3}],s:"Go"}},{t:0,b:{t:2,i:[{t:3}],s:"To"}}]},resource={uploader:{specific_nb_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop one file here"},{t:2,i:[{t:3,v:"Drag and drop "},{t:4,k:"count"},{t:3,v:" files here"}]}]}},min_max_drag_n_drop_label:{t:0,b:{t:2,i:[{t:3,v:"Drag and drop between "},{t:4,k:"min"},{t:3,v:" and "},{t:4,k:"max"},{t:3,v:" files here"}]}},min_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop at least one file here"},{t:2,i:[{t:3,v:"Drag and drop at least "},{t:4,k:"count"},{t:3,v:" files here"}]}]}},max_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop your file here"},{t:2,i:[{t:3,v:"Drag and drop your files here (maximum "},{t:4,k:"count"},{t:3,v:")"}]}]}},drag_n_drop_label:{t:0,b:{t:2,i:[{t:3}],s:"Drag and drop your files here"}},add_file_label:{t:0,b:{t:2,i:[{t:3}],s:"or click here"}},max_size_label:{t:0,b:{t:2,i:[{t:3,v:"(max size "},{t:4,k:"size"},{t:3,v:")"}]}},trigger_upload:{t:0,b:{t:2,i:[{t:3}],s:"Upload"}}},upload_entry:{completion:{t:0,b:{t:2,i:[{t:4,k:"progress"},{t:3,v:"% uploaded"}]}},too_large:{t:0,b:{t:2,i:[{t:3}],s:"File is too large"}},wrong_type:{t:0,b:{t:1,c:[{t:2,i:[{t:3,v:'The file must have the following type: "'},{t:4,k:"types"},{t:3,v:'"'}]},{t:2,i:[{t:3,v:'The file must have one of the following types: "'},{t:4,k:"types"},{t:3,v:'"'}]}]}},crop_header:{t:0,b:{t:2,i:[{t:3}],s:"Please choose the part you want to keep."}},crop:{t:0,b:{t:2,i:[{t:3}],s:"Crop"}},cancel:{t:0,b:{t:2,i:[{t:3}],s:"Cancel"}}},view_entry:{rotate_left:{t:0,b:{t:2,i:[{t:3}],s:"Rotate image left"}},rotate_right:{t:0,b:{t:2,i:[{t:3}],s:"Rotate image right"}},loading:{t:0,b:{t:2,i:[{t:3}],s:"Loading..."}},close:{t:0,b:{t:2,i:[{t:3}],s:"Close"}},save:{t:0,b:{t:2,i:[{t:3}],s:"Save"}},file_infected:{t:0,b:{t:2,i:[{t:3}],s:"The referenced file appears to be infected with a virus"}}},editor:{pagination:{t:0,b:{t:2,i:[{t:4,k:"currentPage"},{t:3,v:" of "},{t:4,k:"pages"}]}},zoom:{auto:{t:0,b:{t:2,i:[{t:3}],s:"Automatic Zoom"}},"page-width":{t:0,b:{t:2,i:[{t:3}],s:"Page Width"}},"page-fit":{t:0,b:{t:2,i:[{t:3}],s:"Page Fit"}},"page-actual":{t:0,b:{t:2,i:[{t:3}],s:"Actual Size"}}},colors:{warning:{t:0,b:{t:2,i:[{t:3}],s:"Yellow"}},danger:{t:0,b:{t:2,i:[{t:3}],s:"Red"}},info:{t:0,b:{t:2,i:[{t:3}],s:"Blue"}},success:{t:0,b:{t:2,i:[{t:3}],s:"Green"}},muted:{t:0,b:{t:2,i:[{t:3}],s:"White"}}}},error:{t:0,b:{t:2,i:[{t:3,v:"Error: "},{t:4,k:"error"}]}},request_error:{t:0,b:{t:2,i:[{t:3,v:"Request error: "},{t:4,k:"error"}]}},units:[{t:0,b:{t:2,i:[{t:3}],s:"B"}},{t:0,b:{t:2,i:[{t:3}],s:"KB"}},{t:0,b:{t:2,i:[{t:3}],s:"MB"}},{t:0,b:{t:2,i:[{t:3}],s:"GB"}},{t:0,b:{t:2,i:[{t:3}],s:"TB"}}]},i18n=vueI18n.createI18n({legacy:!1,locale:document.documentElement.lang||"en",allowComposition:!0,globalInjection:!0,messages:{en:resource,fr:resource$1}}),_hoisted_1$4={class:"btn-group dropup annotation-dropdown"},_hoisted_2$3={class:"dropdown-menu"},_hoisted_3$2=["onClick"],_sfc_main$4=vue.defineComponent({__name:"ToolbarAnnotation",props:{isActivated:{type:Boolean},color:{},classPrefix:{},icon:{},colors:{}},emits:["onChange"],setup(B){return(o,F)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$4,[vue.createElementVNode("button",{class:vue.normalizeClass(["btn",o.isActivated?"btn-primary":"btn-default"]),type:"button",onClick:F[0]||(F[0]=m=>o.$emit("onChange",o.isActivated?"":o.color||Object.values(o.colors)[0]))},[vue.createElementVNode("span",{class:vue.normalizeClass(["fas",o.icon])},null,2)],2),F[1]||(F[1]=vue.createElementVNode("button",{type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","data-bs-toggle":"dropdown"},[vue.createElementVNode("span",{class:"caret"})],-1)),vue.createElementVNode("ul",_hoisted_2$3,[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(o.colors,(m,R)=>(vue.openBlock(),vue.createElementBlock("li",{key:R,class:vue.normalizeClass(`${o.classPrefix}-${R}`)},[vue.createElementVNode("a",{href:"#",class:vue.normalizeClass(`${o.classPrefix}-${R}`),onClick:vue.withModifiers(H=>o.$emit("onChange",m),["prevent"])},vue.toDisplayString(o.t(`editor.colors.${R}`)),11,_hoisted_3$2)],2))),128))])]))}}),_hoisted_1$3={class:"btn-group"},_hoisted_2$2={class:"btn-group dropup",role:"group"},_hoisted_3$1={type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},_hoisted_4$1={class:"dropdown-menu"},_hoisted_5$1=["value"],_hoisted_6$1=["onClick"],_sfc_main$3=vue.defineComponent({__name:"ToolbarZoom",props:{currentZoom:{}},emits:["onZoomIn","onZoomOut","onSetScale"],setup(B){const o=["auto","page-actual","page-fit","page-width","0.5","0.75","1","1.25","1.5","2","3","4"];function F(m){return isNaN(parseFloat(m))?t(`editor.zoom.${m}`):`${Math.ceil(parseFloat(m)*100)}%`}return(m,R)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$3,[vue.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:R[0]||(R[0]=H=>m.$emit("onZoomOut"))},[...R[2]||(R[2]=[vue.createElementVNode("span",{class:"fas fa-magnifying-glass-minus"},null,-1)])]),vue.createElementVNode("div",_hoisted_2$2,[vue.createElementVNode("button",_hoisted_3$1,[vue.createTextVNode(vue.toDisplayString(F(m.currentZoom))+" ",1),R[3]||(R[3]=vue.createElementVNode("span",{class:"caret"},null,-1))]),vue.createElementVNode("ul",_hoisted_4$1,[(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(o,H=>vue.createElementVNode("li",{key:H,value:H,class:vue.normalizeClass(m.currentZoom==H?"active":"")},[vue.createElementVNode("a",{href:"#",onClick:vue.withModifiers(D=>m.$emit("onSetScale",H),["prevent"])},vue.toDisplayString(F(H)),9,_hoisted_6$1)],10,_hoisted_5$1)),64))])]),vue.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:R[1]||(R[1]=H=>m.$emit("onZoomIn"))},[...R[4]||(R[4]=[vue.createElementVNode("span",{class:"fas fa-magnifying-glass-plus"},null,-1)])])]))}}),_hoisted_1$2={class:"btn-group"},_sfc_main$2=vue.defineComponent({__name:"ToolbarRotation",props:{currentRotation:{}},emits:["onRotate"],setup(B){return(o,F)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$2,[vue.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:F[0]||(F[0]=m=>o.$emit("onRotate",((o.currentRotation-90)%360+360)%360))},[...F[2]||(F[2]=[vue.createElementVNode("span",{class:"fas fa-rotate-left"},null,-1)])]),vue.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:F[1]||(F[1]=m=>o.$emit("onRotate",((o.currentRotation+90)%360+360)%360))},[...F[3]||(F[3]=[vue.createElementVNode("span",{class:"fas fa-rotate-right"},null,-1)])])]))}}),_hoisted_1$1={class:"btn-group"},_hoisted_2$1={class:"btn btn-default disabled",role:"button"},_sfc_main$1=vue.defineComponent({__name:"ToolbarPagination",props:{currentPage:{},pages:{}},emits:["onChangeCurrentPage"],setup(B){return(o,F)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$1,[vue.createElementVNode("button",{class:vue.normalizeClass(["btn btn-default",{disabled:o.currentPage==1}]),type:"button",onClick:F[0]||(F[0]=m=>o.currentPage!=1&&o.$emit("onChangeCurrentPage",o.currentPage-1))},[...F[2]||(F[2]=[vue.createElementVNode("span",{class:"fas fa-angle-up"},null,-1)])],2),vue.createElementVNode("a",_hoisted_2$1,vue.toDisplayString(o.t("editor.pagination",{currentPage:o.currentPage,pages:o.pages})),1),vue.createElementVNode("button",{class:vue.normalizeClass(["btn btn-default",{disabled:o.currentPage==o.pages}]),type:"button",onClick:F[1]||(F[1]=m=>o.currentPage!=o.pages&&o.$emit("onChangeCurrentPage",o.currentPage+1))},[...F[3]||(F[3]=[vue.createElementVNode("span",{class:"fas fa-angle-down"},null,-1)])],2)]))}});async function doRequest(B,o){const F=await fetch(B,{headers:{"Content-Type":"application/json"},...o});if(F.status>=200&&F.status<300)return F.json();throw new Error(F.statusText)}function getAugmentedNamespace(B){if(Object.prototype.hasOwnProperty.call(B,"__esModule"))return B;var o=B.default;if(typeof o=="function"){var F=function m(){var R=!1;try{R=this instanceof m}catch{}return R?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};F.prototype=o.prototype}else F={};return Object.defineProperty(F,"__esModule",{value:!0}),Object.keys(B).forEach(function(m){var R=Object.getOwnPropertyDescriptor(B,m);Object.defineProperty(F,m,R.get?R:{enumerable:!0,get:function(){return B[m]}})}),F}function commonjsRequire(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(o,F){module.exports=F()})(globalThis,()=>(()=>{var __webpack_modules__=[,((B,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.VerbosityLevel=o.Util=o.UnknownErrorException=o.UnexpectedResponseException=o.TextRenderingMode=o.RenderingIntentFlag=o.PromiseCapability=o.PermissionFlag=o.PasswordResponses=o.PasswordException=o.PageActionEventType=o.OPS=o.MissingPDFException=o.MAX_IMAGE_SIZE_TO_CACHE=o.LINE_FACTOR=o.LINE_DESCENT_FACTOR=o.InvalidPDFException=o.ImageKind=o.IDENTITY_MATRIX=o.FormatError=o.FeatureTest=o.FONT_IDENTITY_MATRIX=o.DocumentActionEventType=o.CMapCompressionType=o.BaseException=o.BASELINE_FACTOR=o.AnnotationType=o.AnnotationStateModelType=o.AnnotationReviewState=o.AnnotationReplyType=o.AnnotationMode=o.AnnotationMarkedState=o.AnnotationFlag=o.AnnotationFieldFlag=o.AnnotationEditorType=o.AnnotationEditorPrefix=o.AnnotationEditorParamsType=o.AnnotationBorderStyleType=o.AnnotationActionEventType=o.AbortException=void 0,o.assert=r,o.bytesToString=$,o.createValidAbsoluteUrl=L,o.getModificationDate=xe,o.getVerbosityLevel=M,o.info=C,o.isArrayBuffer=Se,o.isArrayEqual=ye,o.normalizeUnicode=Oe,o.objectFromMap=ee,o.objectSize=G,o.setVerbosityLevel=W,o.shadow=s,o.string32=re,o.stringToBytes=te,o.stringToPDFString=fe,o.stringToUTF8String=pe,o.unreachable=h,o.utf8StringToString=ue,o.warn=A;const F=[1,0,0,1,0,0];o.IDENTITY_MATRIX=F;const m=[.001,0,0,.001,0,0];o.FONT_IDENTITY_MATRIX=m;const R=1e7;o.MAX_IMAGE_SIZE_TO_CACHE=R;const H=1.35;o.LINE_FACTOR=H;const D=.35;o.LINE_DESCENT_FACTOR=D;const E=D/H;o.BASELINE_FACTOR=E;const S={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};o.RenderingIntentFlag=S;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};o.AnnotationMode=d;const i="pdfjs_internal_editor_";o.AnnotationEditorPrefix=i;const _={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};o.AnnotationEditorType=_;const p={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};o.AnnotationEditorParamsType=p;const n={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};o.PermissionFlag=n;const l={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};o.TextRenderingMode=l;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};o.ImageKind=g;const c={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};o.AnnotationType=c;const u={MARKED:"Marked",REVIEW:"Review"};o.AnnotationStateModelType=u;const P={MARKED:"Marked",UNMARKED:"Unmarked"};o.AnnotationMarkedState=P;const w={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};o.AnnotationReviewState=w;const y={GROUP:"Group",REPLY:"R"};o.AnnotationReplyType=y;const e={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};o.AnnotationFlag=e;const a={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};o.AnnotationFieldFlag=a;const T={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};o.AnnotationBorderStyleType=T;const O={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};o.AnnotationActionEventType=O;const x={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};o.DocumentActionEventType=x;const I={O:"PageOpen",C:"PageClose"};o.PageActionEventType=I;const U={ERRORS:0,WARNINGS:1,INFOS:5};o.VerbosityLevel=U;const z={NONE:0,BINARY:1};o.CMapCompressionType=z;const ie={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};o.OPS=ie;const J={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};o.PasswordResponses=J;let q=U.WARNINGS;function W(se){Number.isInteger(se)&&(q=se)}function M(){return q}function C(se){q>=U.INFOS&&console.log(`Info: ${se}`)}function A(se){q>=U.WARNINGS&&console.log(`Warning: ${se}`)}function h(se){throw new Error(se)}function r(se,Y){se||h(Y)}function v(se){switch(se?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function L(se,Y=null,K=null){if(!se)return null;try{if(K&&typeof se=="string"&&(K.addDefaultProtocol&&se.startsWith("www.")&&se.match(/\./g)?.length>=2&&(se=`http://${se}`),K.tryConvertEncoding))try{se=pe(se)}catch{}const le=Y?new URL(se,Y):new URL(se);if(v(le))return le}catch{}return null}function s(se,Y,K,le=!1){return Object.defineProperty(se,Y,{value:K,enumerable:!le,configurable:!0,writable:!1}),K}const f=(function(){function Y(K,le){this.constructor===Y&&h("Cannot initialize BaseException."),this.message=K,this.name=le}return Y.prototype=new Error,Y.constructor=Y,Y})();o.BaseException=f;class b extends f{constructor(Y,K){super(Y,"PasswordException"),this.code=K}}o.PasswordException=b;class k extends f{constructor(Y,K){super(Y,"UnknownErrorException"),this.details=K}}o.UnknownErrorException=k;class N extends f{constructor(Y){super(Y,"InvalidPDFException")}}o.InvalidPDFException=N;class j extends f{constructor(Y){super(Y,"MissingPDFException")}}o.MissingPDFException=j;class V extends f{constructor(Y,K){super(Y,"UnexpectedResponseException"),this.status=K}}o.UnexpectedResponseException=V;class X extends f{constructor(Y){super(Y,"FormatError")}}o.FormatError=X;class Q extends f{constructor(Y){super(Y,"AbortException")}}o.AbortException=Q;function $(se){(typeof se!="object"||se?.length===void 0)&&h("Invalid argument for bytesToString");const Y=se.length,K=8192;if(Y<K)return String.fromCharCode.apply(null,se);const le=[];for(let de=0;de<Y;de+=K){const ge=Math.min(de+K,Y),me=se.subarray(de,ge);le.push(String.fromCharCode.apply(null,me))}return le.join("")}function te(se){typeof se!="string"&&h("Invalid argument for stringToBytes");const Y=se.length,K=new Uint8Array(Y);for(let le=0;le<Y;++le)K[le]=se.charCodeAt(le)&255;return K}function re(se){return String.fromCharCode(se>>24&255,se>>16&255,se>>8&255,se&255)}function G(se){return Object.keys(se).length}function ee(se){const Y=Object.create(null);for(const[K,le]of se)Y[K]=le;return Y}function ne(){const se=new Uint8Array(4);return se[0]=1,new Uint32Array(se.buffer,0,1)[0]===1}function Z(){try{return new Function(""),!0}catch{return!1}}class ae{static get isLittleEndian(){return s(this,"isLittleEndian",ne())}static get isEvalSupported(){return s(this,"isEvalSupported",Z())}static get isOffscreenCanvasSupported(){return s(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?s(this,"platform",{isWin:!1,isMac:!1}):s(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}o.FeatureTest=ae;const oe=[...Array(256).keys()].map(se=>se.toString(16).padStart(2,"0"));class ce{static makeHexColor(Y,K,le){return`#${oe[Y]}${oe[K]}${oe[le]}`}static scaleMinMax(Y,K){let le;Y[0]?(Y[0]<0&&(le=K[0],K[0]=K[1],K[1]=le),K[0]*=Y[0],K[1]*=Y[0],Y[3]<0&&(le=K[2],K[2]=K[3],K[3]=le),K[2]*=Y[3],K[3]*=Y[3]):(le=K[0],K[0]=K[2],K[2]=le,le=K[1],K[1]=K[3],K[3]=le,Y[1]<0&&(le=K[2],K[2]=K[3],K[3]=le),K[2]*=Y[1],K[3]*=Y[1],Y[2]<0&&(le=K[0],K[0]=K[1],K[1]=le),K[0]*=Y[2],K[1]*=Y[2]),K[0]+=Y[4],K[1]+=Y[4],K[2]+=Y[5],K[3]+=Y[5]}static transform(Y,K){return[Y[0]*K[0]+Y[2]*K[1],Y[1]*K[0]+Y[3]*K[1],Y[0]*K[2]+Y[2]*K[3],Y[1]*K[2]+Y[3]*K[3],Y[0]*K[4]+Y[2]*K[5]+Y[4],Y[1]*K[4]+Y[3]*K[5]+Y[5]]}static applyTransform(Y,K){const le=Y[0]*K[0]+Y[1]*K[2]+K[4],de=Y[0]*K[1]+Y[1]*K[3]+K[5];return[le,de]}static applyInverseTransform(Y,K){const le=K[0]*K[3]-K[1]*K[2],de=(Y[0]*K[3]-Y[1]*K[2]+K[2]*K[5]-K[4]*K[3])/le,ge=(-Y[0]*K[1]+Y[1]*K[0]+K[4]*K[1]-K[5]*K[0])/le;return[de,ge]}static getAxialAlignedBoundingBox(Y,K){const le=ce.applyTransform(Y,K),de=ce.applyTransform(Y.slice(2,4),K),ge=ce.applyTransform([Y[0],Y[3]],K),me=ce.applyTransform([Y[2],Y[1]],K);return[Math.min(le[0],de[0],ge[0],me[0]),Math.min(le[1],de[1],ge[1],me[1]),Math.max(le[0],de[0],ge[0],me[0]),Math.max(le[1],de[1],ge[1],me[1])]}static inverseTransform(Y){const K=Y[0]*Y[3]-Y[1]*Y[2];return[Y[3]/K,-Y[1]/K,-Y[2]/K,Y[0]/K,(Y[2]*Y[5]-Y[4]*Y[3])/K,(Y[4]*Y[1]-Y[5]*Y[0])/K]}static singularValueDecompose2dScale(Y){const K=[Y[0],Y[2],Y[1],Y[3]],le=Y[0]*K[0]+Y[1]*K[2],de=Y[0]*K[1]+Y[1]*K[3],ge=Y[2]*K[0]+Y[3]*K[2],me=Y[2]*K[1]+Y[3]*K[3],we=(le+me)/2,Pe=Math.sqrt((le+me)**2-4*(le*me-ge*de))/2,Te=we+Pe||1,ve=we-Pe||1;return[Math.sqrt(Te),Math.sqrt(ve)]}static normalizeRect(Y){const K=Y.slice(0);return Y[0]>Y[2]&&(K[0]=Y[2],K[2]=Y[0]),Y[1]>Y[3]&&(K[1]=Y[3],K[3]=Y[1]),K}static intersect(Y,K){const le=Math.max(Math.min(Y[0],Y[2]),Math.min(K[0],K[2])),de=Math.min(Math.max(Y[0],Y[2]),Math.max(K[0],K[2]));if(le>de)return null;const ge=Math.max(Math.min(Y[1],Y[3]),Math.min(K[1],K[3])),me=Math.min(Math.max(Y[1],Y[3]),Math.max(K[1],K[3]));return ge>me?null:[le,ge,de,me]}static bezierBoundingBox(Y,K,le,de,ge,me,we,Pe){const Te=[],ve=[[],[]];let Me,Ce,ke,be,Ie,De,Ne,Be;for(let Ve=0;Ve<2;++Ve){if(Ve===0?(Ce=6*Y-12*le+6*ge,Me=-3*Y+9*le-9*ge+3*we,ke=3*le-3*Y):(Ce=6*K-12*de+6*me,Me=-3*K+9*de-9*me+3*Pe,ke=3*de-3*K),Math.abs(Me)<1e-12){if(Math.abs(Ce)<1e-12)continue;be=-ke/Ce,0<be&&be<1&&Te.push(be);continue}Ne=Ce*Ce-4*ke*Me,Be=Math.sqrt(Ne),!(Ne<0)&&(Ie=(-Ce+Be)/(2*Me),0<Ie&&Ie<1&&Te.push(Ie),De=(-Ce-Be)/(2*Me),0<De&&De<1&&Te.push(De))}let Le=Te.length,Ee;const Fe=Le;for(;Le--;)be=Te[Le],Ee=1-be,ve[0][Le]=Ee*Ee*Ee*Y+3*Ee*Ee*be*le+3*Ee*be*be*ge+be*be*be*we,ve[1][Le]=Ee*Ee*Ee*K+3*Ee*Ee*be*de+3*Ee*be*be*me+be*be*be*Pe;return ve[0][Fe]=Y,ve[1][Fe]=K,ve[0][Fe+1]=we,ve[1][Fe+1]=Pe,ve[0].length=ve[1].length=Fe+2,[Math.min(...ve[0]),Math.min(...ve[1]),Math.max(...ve[0]),Math.max(...ve[1])]}}o.Util=ce;const he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function fe(se){if(se[0]>="ï"){let K;if(se[0]==="þ"&&se[1]==="ÿ"?K="utf-16be":se[0]==="ÿ"&&se[1]==="þ"?K="utf-16le":se[0]==="ï"&&se[1]==="»"&&se[2]==="¿"&&(K="utf-8"),K)try{const le=new TextDecoder(K,{fatal:!0}),de=te(se);return le.decode(de)}catch(le){A(`stringToPDFString: "${le}".`)}}const Y=[];for(let K=0,le=se.length;K<le;K++){const de=he[se.charCodeAt(K)];Y.push(de?String.fromCharCode(de):se.charAt(K))}return Y.join("")}function pe(se){return decodeURIComponent(escape(se))}function ue(se){return unescape(encodeURIComponent(se))}function Se(se){return typeof se=="object"&&se?.byteLength!==void 0}function ye(se,Y){if(se.length!==Y.length)return!1;for(let K=0,le=se.length;K<le;K++)if(se[K]!==Y[K])return!1;return!0}function xe(se=new Date){return[se.getUTCFullYear().toString(),(se.getUTCMonth()+1).toString().padStart(2,"0"),se.getUTCDate().toString().padStart(2,"0"),se.getUTCHours().toString().padStart(2,"0"),se.getUTCMinutes().toString().padStart(2,"0"),se.getUTCSeconds().toString().padStart(2,"0")].join("")}class _e{#e=!1;constructor(){this.promise=new Promise((Y,K)=>{this.resolve=le=>{this.#e=!0,Y(le)},this.reject=le=>{this.#e=!0,K(le)}})}get settled(){return this.#e}}o.PromiseCapability=_e;let Ae=null,Re=null;function Oe(se){return Ae||(Ae=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Re=new Map([["ﬅ","ſt"]])),se.replaceAll(Ae,(Y,K,le)=>K?K.normalize("NFKC"):Re.get(le))}}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:B,NodeCMapReaderFactory:o,NodeFilterFactory:F,NodeStandardFontDataFactory:m}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=B,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=o,exports.DefaultFilterFactory=DefaultFilterFactory=F,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=m}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:B}=__w_pdfjs_require__(21);createPDFNetworkStream=o=>new B(o)}else{const{PDFNetworkStream:B}=__w_pdfjs_require__(24),{PDFFetchStream:o}=__w_pdfjs_require__(25);createPDFNetworkStream=F=>(0,_display_utils.isValidFetchUrl)(F.url)?new o(F):new B(F)}function getDocument(B){if(typeof B=="string"||B instanceof URL?B={url:B}:(0,_util.isArrayBuffer)(B)&&(B={data:B}),typeof B!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!B.url&&!B.data&&!B.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const o=new PDFDocumentLoadingTask,{docId:F}=o,m=B.url?getUrlProp(B.url):null,R=B.data?getDataProp(B.data):null,H=B.httpHeaders||null,D=B.withCredentials===!0,E=B.password??null,S=B.range instanceof PDFDataRangeTransport?B.range:null,d=Number.isInteger(B.rangeChunkSize)&&B.rangeChunkSize>0?B.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let i=B.worker instanceof PDFWorker?B.worker:null;const _=B.verbosity,p=typeof B.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(B.docBaseUrl)?B.docBaseUrl:null,n=typeof B.cMapUrl=="string"?B.cMapUrl:null,l=B.cMapPacked!==!1,g=B.CMapReaderFactory||DefaultCMapReaderFactory,c=typeof B.standardFontDataUrl=="string"?B.standardFontDataUrl:null,u=B.StandardFontDataFactory||DefaultStandardFontDataFactory,P=B.stopAtErrors!==!0,w=Number.isInteger(B.maxImageSize)&&B.maxImageSize>-1?B.maxImageSize:-1,y=B.isEvalSupported!==!1,e=typeof B.isOffscreenCanvasSupported=="boolean"?B.isOffscreenCanvasSupported:!_is_node.isNodeJS,a=Number.isInteger(B.canvasMaxAreaInBytes)?B.canvasMaxAreaInBytes:-1,T=typeof B.disableFontFace=="boolean"?B.disableFontFace:_is_node.isNodeJS,O=B.fontExtraProperties===!0,x=B.enableXfa===!0,I=B.ownerDocument||globalThis.document,U=B.disableRange===!0,z=B.disableStream===!0,ie=B.disableAutoFetch===!0,J=B.pdfBug===!0,q=S?S.length:B.length??NaN,W=typeof B.useSystemFonts=="boolean"?B.useSystemFonts:!_is_node.isNodeJS&&!T,M=typeof B.useWorkerFetch=="boolean"?B.useWorkerFetch:g===_display_utils.DOMCMapReaderFactory&&u===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(c,document.baseURI),C=B.canvasFactory||new DefaultCanvasFactory({ownerDocument:I}),A=B.filterFactory||new DefaultFilterFactory({docId:F,ownerDocument:I}),h=null;(0,_util.setVerbosityLevel)(_);const r={canvasFactory:C,filterFactory:A};if(M||(r.cMapReaderFactory=new g({baseUrl:n,isCompressed:l}),r.standardFontDataFactory=new u({baseUrl:c})),!i){const s={verbosity:_,port:_worker_options.GlobalWorkerOptions.workerPort};i=s.port?PDFWorker.fromPort(s):new PDFWorker(s),o._worker=i}const v={docId:F,apiVersion:"3.6.172",data:R,password:E,disableAutoFetch:ie,rangeChunkSize:d,length:q,docBaseUrl:p,enableXfa:x,evaluatorOptions:{maxImageSize:w,disableFontFace:T,ignoreErrors:P,isEvalSupported:y,isOffscreenCanvasSupported:e,canvasMaxAreaInBytes:a,fontExtraProperties:O,useSystemFonts:W,cMapUrl:M?n:null,standardFontDataUrl:M?c:null}},L={ignoreErrors:P,isEvalSupported:y,disableFontFace:T,fontExtraProperties:O,enableXfa:x,ownerDocument:I,disableAutoFetch:ie,pdfBug:J,styleElement:h};return i.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const s=_fetchDocument(i,v),f=new Promise(function(b){let k;S?k=new _transport_stream.PDFDataTransportStream({length:q,initialData:S.initialData,progressiveDone:S.progressiveDone,contentDispositionFilename:S.contentDispositionFilename,disableRange:U,disableStream:z},S):R||(k=createPDFNetworkStream({url:m,length:q,httpHeaders:H,withCredentials:D,rangeChunkSize:d,disableRange:U,disableStream:z})),b(k)});return Promise.all([s,f]).then(function([b,k]){if(o.destroyed)throw new Error("Loading aborted");const N=new _message_handler.MessageHandler(F,b,i.port),j=new WorkerTransport(N,o,k,L,r);o._transport=j,N.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(B,o){if(B.destroyed)throw new Error("Worker was destroyed");const F=await B.messageHandler.sendWithPromise("GetDocRequest",o,o.data?[o.data.buffer]:null);if(B.destroyed)throw new Error("Worker was destroyed");return F}function getUrlProp(B){if(B instanceof URL)return B.href;try{return new URL(B,window.location).href}catch{if(_is_node.isNodeJS&&typeof B=="string")return B}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(B){if(_is_node.isNodeJS&&typeof Buffer<"u"&&B instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(B);if(B instanceof Uint8Array&&B.byteLength===B.buffer.byteLength)return B;if(typeof B=="string")return(0,_util.stringToBytes)(B);if(typeof B=="object"&&!isNaN(B?.length)||(0,_util.isArrayBuffer)(B))return new Uint8Array(B);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,F,m=!1,R=null){this.length=o,this.initialData=F,this.progressiveDone=m,this.contentDispositionFilename=R,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,F){for(const m of this._rangeListeners)m(o,F)}onDataProgress(o,F){this._readyCapability.promise.then(()=>{for(const m of this._progressListeners)m(o,F)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const F of this._progressiveReadListeners)F(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,F){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,F){this._pdfInfo=o,this._transport=F}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(o,F,m,R=!1){this._pageIndex=o,this._pageInfo=F,this._transport=m,this._stats=R?new _display_utils.StatTimer:null,this._pdfBug=R,this.commonObjs=m.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:F=this.rotate,offsetX:m=0,offsetY:R=0,dontFlip:H=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:F,offsetX:m,offsetY:R,dontFlip:H})}getAnnotations({intent:o="display"}={}){const F=this._transport.getRenderingIntent(o);return this._transport.getAnnotations(this._pageIndex,F.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:o,viewport:F,intent:m="display",annotationMode:R=_util.AnnotationMode.ENABLE,transform:H=null,background:D=null,optionalContentConfigPromise:E=null,annotationCanvasMap:S=null,pageColors:d=null,printAnnotationStorage:i=null}){if(arguments[0]?.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");const _=this._transport.getRenderingIntent(m,R,i);this.#t=!1,this.#n(),E||(E=this._transport.getOptionalContentConfig());let p=this._intentStates.get(_.cacheKey);p||(p=Object.create(null),this._intentStates.set(_.cacheKey,p)),p.streamReaderCancelTimeout&&(clearTimeout(p.streamReaderCancelTimeout),p.streamReaderCancelTimeout=null);const n=!!(_.renderingIntent&_util.RenderingIntentFlag.PRINT);p.displayReadyCapability||(p.displayReadyCapability=new _util.PromiseCapability,p.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const l=u=>{p.renderTasks.delete(g),(this._maybeCleanupAfterRender||n)&&(this.#t=!0),this.#i(!n),u?(g.capability.reject(u),this._abortOperatorList({intentState:p,reason:u instanceof Error?u:new Error(u)})):g.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},g=new InternalRenderTask({callback:l,params:{canvasContext:o,viewport:F,transform:H,background:D},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:S,operatorList:p.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!n,pdfBug:this._pdfBug,pageColors:d});(p.renderTasks||=new Set).add(g);const c=g.task;return Promise.all([p.displayReadyCapability.promise,E]).then(([u,P])=>{if(this.#t){l();return}this._stats?.time("Rendering"),g.initializeGraphics({transparency:u,optionalContentConfig:P}),g.operatorListChanged()}).catch(l),c}getOperatorList({intent:o="display",annotationMode:F=_util.AnnotationMode.ENABLE,printAnnotationStorage:m=null}={}){function R(){D.operatorList.lastChunk&&(D.opListReadCapability.resolve(D.operatorList),D.renderTasks.delete(E))}const H=this._transport.getRenderingIntent(o,F,m,!0);let D=this._intentStates.get(H.cacheKey);D||(D=Object.create(null),this._intentStates.set(H.cacheKey,D));let E;return D.opListReadCapability||(E=Object.create(null),E.operatorListChanged=R,D.opListReadCapability=new _util.PromiseCapability,(D.renderTasks||=new Set).add(E),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(H)),D.opListReadCapability.promise}streamTextContent({includeMarkedContent:o=!1,disableNormalization:F=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:o===!0,disableNormalization:F===!0},{highWaterMark:100,size(R){return R.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(m=>_xfa_text.XfaText.textContent(m));const F=this.streamTextContent(o);return new Promise(function(m,R){function H(){D.read().then(function({value:S,done:d}){if(d){m(E);return}Object.assign(E.styles,S.styles),E.items.push(...S.items),H()},R)}const D=F.getReader(),E={items:[],styles:Object.create(null)};H()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const o=[];for(const F of this._intentStates.values())if(this._abortOperatorList({intentState:F,reason:new Error("Page was destroyed."),force:!0}),!F.opListReadCapability)for(const m of F.renderTasks)o.push(m.completed),m.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(o)}cleanup(o=!1){this.#t=!0;const F=this.#i(!1);return o&&F&&(this._stats&&=new _display_utils.StatTimer),F}#i(o=!1){if(this.#n(),!this.#t)return!1;if(o)return this.#e=setTimeout(()=>{this.#e=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:F,operatorList:m}of this._intentStates.values())if(F.size>0||!m.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(o,F){const m=this._intentStates.get(F);m&&(this._stats?.timeEnd("Page Request"),m.displayReadyCapability?.resolve(o))}_renderPageChunk(o,F){for(let m=0,R=o.length;m<R;m++)F.operatorList.fnArray.push(o.fnArray[m]),F.operatorList.argsArray.push(o.argsArray[m]);F.operatorList.lastChunk=o.lastChunk,F.operatorList.separateAnnots=o.separateAnnots;for(const m of F.renderTasks)m.operatorListChanged();o.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:o,cacheKey:F,annotationStorageMap:m}){const H=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:F,annotationStorage:m}).getReader(),D=this._intentStates.get(F);D.streamReader=H;const E=()=>{H.read().then(({value:S,done:d})=>{if(d){D.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(S,D),E())},S=>{if(D.streamReader=null,!this._transport.destroyed){if(D.operatorList){D.operatorList.lastChunk=!0;for(const d of D.renderTasks)d.operatorListChanged();this.#i(!0)}if(D.displayReadyCapability)D.displayReadyCapability.reject(S);else if(D.opListReadCapability)D.opListReadCapability.reject(S);else throw S}})};E()}_abortOperatorList({intentState:o,reason:F,force:m=!1}){if(o.streamReader){if(o.streamReaderCancelTimeout&&(clearTimeout(o.streamReaderCancelTimeout),o.streamReaderCancelTimeout=null),!m){if(o.renderTasks.size>0)return;if(F instanceof _display_utils.RenderingCancelledException){let R=RENDERING_CANCELLED_TIMEOUT;F.extraDelay>0&&F.extraDelay<1e3&&(R+=F.extraDelay),o.streamReaderCancelTimeout=setTimeout(()=>{o.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:o,reason:F,force:!0})},R);return}}if(o.streamReader.cancel(new _util.AbortException(F.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[R,H]of this._intentStates)if(H===o){this._intentStates.delete(R);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(o,F){const m={data:structuredClone(o,F?{transfer:F}:null)};this.#t.then(()=>{for(const R of this.#e)R.call(this,m)})}addEventListener(o,F){this.#e.add(F)}removeEventListener(o,F){this.#e.delete(F)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const B=document?.currentScript?.src;B&&(PDFWorkerUtil.fallbackWorkerSrc=B.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(B,o){let F;try{if(F=new URL(B),!F.origin||F.origin==="null")return!1}catch{return!1}const m=new URL(o,F);return F.origin===m.origin},PDFWorkerUtil.createCDNWrapper=function(B){const o=`importScripts("${B}");`;return URL.createObjectURL(new Blob([o]))}}class PDFWorker{static#workerPorts=new WeakMap;constructor({name:B=null,port:o=null,verbosity:F=(0,_util.getVerbosityLevel)()}={}){if(o&&PDFWorker.#workerPorts.has(o))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=B,this.destroyed=!1,this.verbosity=F,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,o){PDFWorker.#workerPorts.set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(B){this._port=B,this._messageHandler=new _message_handler.MessageHandler("main","worker",B),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:B}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,B)||(B=PDFWorkerUtil.createCDNWrapper(new URL(B,window.location).href));const o=new Worker(B),F=new _message_handler.MessageHandler("main","worker",o),m=()=>{o.removeEventListener("error",R),F.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},R=()=>{this._webWorker||m()};o.addEventListener("error",R),F.on("test",D=>{if(o.removeEventListener("error",R),this.destroyed){m();return}D?(this._messageHandler=F,this._port=o,this._webWorker=o,this._readyCapability.resolve(),F.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),F.destroy(),o.terminate())}),F.on("ready",D=>{if(o.removeEventListener("error",R),this.destroyed){m();return}try{H()}catch{this._setupFakeWorker()}});const H=()=>{const D=new Uint8Array;F.send("test",D,[D.buffer])};H();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(B=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const F=`fake${PDFWorkerUtil.fakeWorkerId++}`,m=new _message_handler.MessageHandler(F+"_worker",F,o);B.setup(m,o);const R=new _message_handler.MessageHandler(F,F+"_worker",o);this._messageHandler=R,this._readyCapability.resolve(),R.send("configure",{verbosity:this.verbosity})}).catch(B=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${B.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(B){if(!B?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(B.port)?this.#workerPorts.get(B.port):new PDFWorker(B)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#i=new Map;constructor(o,F,m,R,H){this.messageHandler=o,this.loadingTask=F,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:R.ownerDocument,styleElement:R.styleElement}),this._params=R,this.canvasFactory=H.canvasFactory,this.filterFactory=H.filterFactory,this.cMapReaderFactory=H.cMapReaderFactory,this.standardFontDataFactory=H.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=m,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#n(o,F=null){const m=this.#e.get(o);if(m)return m;const R=this.messageHandler.sendWithPromise(o,F);return this.#e.set(o,R),R}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,F=_util.AnnotationMode.ENABLE,m=null,R=!1){let H=_util.RenderingIntentFlag.DISPLAY,D=null;switch(o){case"any":H=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":H=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(F){case _util.AnnotationMode.DISABLE:H+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:H+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:H+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,D=(H&_util.RenderingIntentFlag.PRINT&&m instanceof _annotation_storage.PrintAnnotationStorage?m:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${F}`)}return R&&(H+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:H,cacheKey:`${H}_${_annotation_storage.AnnotationStorage.getHash(D)}`,annotationStorageMap:D}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const m of this.#t.values())o.push(m._destroy());this.#t.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const F=this.messageHandler.sendWithPromise("Terminate",null);return o.push(F),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:F}=this;o.on("GetReader",(m,R)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=H=>{this._lastProgress={loaded:H.loaded,total:H.total}},R.onPull=()=>{this._fullReader.read().then(function({value:H,done:D}){if(D){R.close();return}(0,_util.assert)(H instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(H),1,[H])}).catch(H=>{R.error(H)})},R.onCancel=H=>{this._fullReader.cancel(H),R.ready.catch(D=>{if(!this.destroyed)throw D})}}),o.on("ReaderHeadersReady",m=>{const R=new _util.PromiseCapability,H=this._fullReader;return H.headersReady.then(()=>{(!H.isStreamingSupported||!H.isRangeSupported)&&(this._lastProgress&&F.onProgress?.(this._lastProgress),H.onProgress=D=>{F.onProgress?.({loaded:D.loaded,total:D.total})}),R.resolve({isStreamingSupported:H.isStreamingSupported,isRangeSupported:H.isRangeSupported,contentLength:H.contentLength})},R.reject),R.promise}),o.on("GetRangeReader",(m,R)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const H=this._networkStream.getRangeReader(m.begin,m.end);if(!H){R.close();return}R.onPull=()=>{H.read().then(function({value:D,done:E}){if(E){R.close();return}(0,_util.assert)(D instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),R.enqueue(new Uint8Array(D),1,[D])}).catch(D=>{R.error(D)})},R.onCancel=D=>{H.cancel(D),R.ready.catch(E=>{if(!this.destroyed)throw E})}}),o.on("GetDoc",({pdfInfo:m})=>{this._numPages=m.numPages,this._htmlForXfa=m.htmlForXfa,delete m.htmlForXfa,F._capability.resolve(new PDFDocumentProxy(m,this))}),o.on("DocException",function(m){let R;switch(m.name){case"PasswordException":R=new _util.PasswordException(m.message,m.code);break;case"InvalidPDFException":R=new _util.InvalidPDFException(m.message);break;case"MissingPDFException":R=new _util.MissingPDFException(m.message);break;case"UnexpectedResponseException":R=new _util.UnexpectedResponseException(m.message,m.status);break;case"UnknownErrorException":R=new _util.UnknownErrorException(m.message,m.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}F._capability.reject(R)}),o.on("PasswordRequest",m=>{if(this._passwordCapability=new _util.PromiseCapability,F.onPassword){const R=H=>{H instanceof Error?this._passwordCapability.reject(H):this._passwordCapability.resolve({password:H})};try{F.onPassword(R,m.code)}catch(H){this._passwordCapability.reject(H)}}else this._passwordCapability.reject(new _util.PasswordException(m.message,m.code));return this._passwordCapability.promise}),o.on("DataLoaded",m=>{F.onProgress?.({loaded:m.length,total:m.length}),this.downloadInfoCapability.resolve(m)}),o.on("StartRenderPage",m=>{if(this.destroyed)return;this.#t.get(m.pageIndex)._startRenderPage(m.transparency,m.cacheKey)}),o.on("commonobj",([m,R,H])=>{if(!this.destroyed&&!this.commonObjs.has(m))switch(R){case"Font":const D=this._params;if("error"in H){const d=H.error;(0,_util.warn)(`Error during font loading: ${d}`),this.commonObjs.resolve(m,d);break}const E=D.pdfBug&&globalThis.FontInspector?.enabled?(d,i)=>globalThis.FontInspector.fontAdded(d,i):null,S=new _font_loader.FontFaceObject(H,{isEvalSupported:D.isEvalSupported,disableFontFace:D.disableFontFace,ignoreErrors:D.ignoreErrors,inspectFont:E});this.fontLoader.bind(S).catch(d=>o.sendWithPromise("FontFallback",{id:m})).finally(()=>{!D.fontExtraProperties&&S.data&&(S.data=null),this.commonObjs.resolve(m,S)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(m,H);break;default:throw new Error(`Got unknown common object type ${R}`)}}),o.on("obj",([m,R,H,D])=>{if(this.destroyed)return;const E=this.#t.get(R);if(!E.objs.has(m))switch(H){case"Image":if(E.objs.resolve(m,D),D){let S;if(D.bitmap){const{width:d,height:i}=D;S=d*i*4}else S=D.data?.length||0;S>_util.MAX_IMAGE_SIZE_TO_CACHE&&(E._maybeCleanupAfterRender=!0)}break;case"Pattern":E.objs.resolve(m,D);break;default:throw new Error(`Got unknown object type ${H}`)}}),o.on("DocProgress",m=>{this.destroyed||F.onProgress?.({loaded:m.loaded,total:m.total})}),o.on("FetchBuiltInCMap",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(m):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",m=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(m):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request."));const F=o-1,m=this.#i.get(F);if(m)return m;const R=this.messageHandler.sendWithPromise("GetPage",{pageIndex:F}).then(H=>{if(this.destroyed)throw new Error("Transport destroyed");const D=new PDFPageProxy(F,H,this,this._params.pdfBug);return this.#t.set(F,D),D});return this.#i.set(F,R),R}getPageIndex(o){return typeof o!="object"||o===null||!Number.isInteger(o.num)||o.num<0||!Number.isInteger(o.gen)||o.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:o.num,gen:o.gen})}getAnnotations(o,F){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:F})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const o="GetMetadata",F=this.#e.get(o);if(F)return F;const m=this.messageHandler.sendWithPromise(o,null).then(R=>({info:R[0],metadata:R[1]?new _metadata.Metadata(R[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(o,m),m}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(o=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const F of this.#t.values())if(!F.cleanup())throw new Error(`startCleanup: Page ${F.pageNumber} is currently rendering.`);this.commonObjs.clear(),o||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:o,enableXfa:F}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o,enableXfa:F})}}class PDFObjects{#e=Object.create(null);#t(o){const F=this.#e[o];return F||(this.#e[o]={capability:new _util.PromiseCapability,data:null})}get(o,F=null){if(F){const R=this.#t(o);return R.capability.promise.then(()=>F(R.data)),null}const m=this.#e[o];if(!m?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${o}.`);return m.data}has(o){return this.#e[o]?.capability.settled||!1}resolve(o,F=null){const m=this.#t(o);m.data=F,m.capability.resolve()}clear(){for(const o in this.#e){const{data:F}=this.#e[o];F?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(o){this.#e=o,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(o=0){this.#e.cancel(null,o)}get separateAnnots(){const{separateAnnots:o}=this.#e.operatorList;if(!o)return!1;const{annotationCanvasMap:F}=this.#e;return o.form||o.canvas&&F?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:o,params:F,objs:m,commonObjs:R,annotationCanvasMap:H,operatorList:D,pageIndex:E,canvasFactory:S,filterFactory:d,useRequestAnimationFrame:i=!1,pdfBug:_=!1,pageColors:p=null}){this.callback=o,this.params=F,this.objs=m,this.commonObjs=R,this.annotationCanvasMap=H,this.operatorListIdx=null,this.operatorList=D,this._pageIndex=E,this.canvasFactory=S,this.filterFactory=d,this._pdfBug=_,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=i===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=F.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:F}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:m,viewport:R,transform:H,background:D}=this.params;this.gfx=new _canvas.CanvasGraphics(m,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:F},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:H,viewport:R,transparency:o,background:D}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(o=null,F=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",F))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PrintAnnotationStorage=o.AnnotationStorage=void 0;var m=F(1),R=F(4),H=F(8);class D{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(d,i){const _=this.#t.get(d);return _===void 0?i:Object.assign(i,_)}getRawValue(d){return this.#t.get(d)}remove(d){if(this.#t.delete(d),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of this.#t.values())if(i instanceof R.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(d,i){const _=this.#t.get(d);let p=!1;if(_!==void 0)for(const[n,l]of Object.entries(i))_[n]!==l&&(p=!0,_[n]=l);else p=!0,this.#t.set(d,i);p&&this.#i(),i instanceof R.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(d){return this.#t.has(d)}getAll(){return this.#t.size>0?(0,m.objectFromMap)(this.#t):null}setAll(d){for(const[i,_]of Object.entries(d))this.setValue(i,_)}get size(){return this.#t.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new E(this)}get serializable(){if(this.#t.size===0)return null;const d=new Map;for(const[i,_]of this.#t){const p=_ instanceof R.AnnotationEditor?_.serialize():_;p&&d.set(i,p)}return d}static getHash(d){if(!d)return"";const i=new H.MurmurHash3_64;for(const[_,p]of d)i.update(`${_}:${JSON.stringify(p)}`);return i.hexdigest()}}o.AnnotationStorage=D;class E extends D{#e=null;constructor(d){super(),this.#e=structuredClone(d.serializable)}get print(){(0,m.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}o.PrintAnnotationStorage=E}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditor=void 0;var m=F(5),R=F(1);class H{#e=this.focusin.bind(this);#t=this.focusout.bind(this);#i=!1;#n=!1;#s=!1;_uiManager=null;#l=H._zIndex++;static _colorManager=new m.ColorManager;static _zIndex=1;constructor(E){this.constructor===H&&(0,R.unreachable)("Cannot initialize AnnotationEditor."),this.parent=E.parent,this.id=E.id,this.width=this.height=null,this.pageIndex=E.parent.pageIndex,this.name=E.name,this.div=null,this._uiManager=E.uiManager;const{rotation:S,rawDims:{pageWidth:d,pageHeight:i,pageX:_,pageY:p}}=this.parent.viewport;this.rotation=S,this.pageRotation=(360+S-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[d,i],this.pageTranslation=[_,p];const[n,l]=this.parentDimensions;this.x=E.x/n,this.y=E.y/l,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,R.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(E){this._uiManager.addCommands(E)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#l}setParent(E){E!==null&&(this.pageIndex=E.pageIndex,this.pageDimensions=E.pageDimensions),this.parent=E}focusin(E){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(E){!this.isAttachedToDOM||E.relatedTarget?.closest(`#${this.id}`)||(E.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(E){const S=this.parent.div.getBoundingClientRect();this.startX=E.clientX-S.x,this.startY=E.clientY-S.y,E.dataTransfer.setData("text/plain",this.id),E.dataTransfer.effectAllowed="move"}setAt(E,S,d,i){const[_,p]=this.parentDimensions;[d,i]=this.screenToPageTranslation(d,i),this.x=(E+d)/_,this.y=(S+i)/p,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(E,S){const[d,i]=this.parentDimensions;[E,S]=this.screenToPageTranslation(E,S),this.x+=E/d,this.y+=S/i,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(E,S){switch(this.parentRotation){case 90:return[S,-E];case 180:return[-E,-S];case 270:return[-S,E];default:return[E,S]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:E}=this._uiManager.viewParameters,[S,d]=this.pageDimensions;return[S*E,d*E]}setDims(E,S){const[d,i]=this.parentDimensions;this.div.style.width=`${100*E/d}%`,this.div.style.height=`${100*S/i}%`}fixDims(){const{style:E}=this.div,{height:S,width:d}=E,i=d.endsWith("%"),_=S.endsWith("%");if(i&&_)return;const[p,n]=this.parentDimensions;i||(E.width=`${100*parseFloat(d)/p}%`),_||(E.height=`${100*parseFloat(S)/n}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#e),this.div.addEventListener("focusout",this.#t);const[E,S]=this.getInitialTranslation();return this.translate(E,S),(0,m.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(E){const{isMac:S}=R.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&S){E.preventDefault();return}E.ctrlKey&&!S||E.shiftKey||E.metaKey&&S?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0}getRect(E,S){const d=this.parentScale,[i,_]=this.pageDimensions,[p,n]=this.pageTranslation,l=E/d,g=S/d,c=this.x*i,u=this.y*_,P=this.width*i,w=this.height*_;switch(this.rotation){case 0:return[c+l+p,_-u-g-w+n,c+l+P+p,_-u-g+n];case 90:return[c+g+p,_-u+l+n,c+g+w+p,_-u+l+P+n];case 180:return[c-l-P+p,_-u+g+n,c-l+p,_-u+g+w+n];case 270:return[c-g-w+p,_-u-l-P+n,c-g+p,_-u-l+n];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(E,S){const[d,i,_,p]=E,n=_-d,l=p-i;switch(this.rotation){case 0:return[d,S-p,n,l];case 90:return[d,S-i,l,n];case 180:return[_,S-i,n,l];case 270:return[_,S-p,l,n];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#s=!0}disableEditMode(){this.#s=!1}isInEditMode(){return this.#s}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#e)}serialize(){(0,R.unreachable)("An editor must be serializable")}static deserialize(E,S,d){const i=new this.prototype.constructor({parent:S,id:S.getNextId(),uiManager:d});i.rotation=E.rotation;const[_,p]=i.pageDimensions,[n,l,g,c]=i.getRectInCurrentCoords(E.rect,p);return i.x=n/_,i.y=l/p,i.width=g/_,i.height=c/p,i}remove(){this.div.removeEventListener("focusin",this.#e),this.div.removeEventListener("focusout",this.#t),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(E,S){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#n}set isEditing(E){this.#n=E,E?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}o.AnnotationEditor=H}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.KeyboardManager=o.CommandManager=o.ColorManager=o.AnnotationEditorUIManager=void 0,o.bindEvents=H,o.opacityToHex=D;var m=F(1),R=F(6);function H(p,n,l){for(const g of l)n.addEventListener(g,p[g].bind(p))}function D(p){return Math.round(Math.min(255,Math.max(1,255*p))).toString(16).padStart(2,"0")}class E{#e=0;getId(){return`${m.AnnotationEditorPrefix}${this.#e++}`}}class S{#e=[];#t=!1;#i;#n=-1;constructor(n=128){this.#i=n}add({cmd:n,undo:l,mustExec:g,type:c=NaN,overwriteIfSameType:u=!1,keepUndo:P=!1}){if(g&&n(),this.#t)return;const w={cmd:n,undo:l,type:c};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(w);return}if(u&&this.#e[this.#n].type===c){P&&(w.undo=this.#e[this.#n].undo),this.#e[this.#n]=w;return}const y=this.#n+1;y===this.#i?this.#e.splice(0,1):(this.#n=y,y<this.#e.length&&this.#e.splice(y)),this.#e.push(w)}undo(){this.#n!==-1&&(this.#t=!0,this.#e[this.#n].undo(),this.#t=!1,this.#n-=1)}redo(){this.#n<this.#e.length-1&&(this.#n+=1,this.#t=!0,this.#e[this.#n].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}destroy(){this.#e=null}}o.CommandManager=S;class d{constructor(n){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:l}=m.FeatureTest.platform;for(const[g,c]of n)for(const u of g){const P=u.startsWith("mac+");l&&P?(this.callbacks.set(u.slice(4),c),this.allKeys.add(u.split("+").at(-1))):!l&&!P&&(this.callbacks.set(u,c),this.allKeys.add(u.split("+").at(-1)))}}#e(n){n.altKey&&this.buffer.push("alt"),n.ctrlKey&&this.buffer.push("ctrl"),n.metaKey&&this.buffer.push("meta"),n.shiftKey&&this.buffer.push("shift"),this.buffer.push(n.key);const l=this.buffer.join("+");return this.buffer.length=0,l}exec(n,l){if(!this.allKeys.has(l.key))return;const g=this.callbacks.get(this.#e(l));g&&(g.bind(n)(),l.stopPropagation(),l.preventDefault())}}o.KeyboardManager=d;class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const n=new Map([["CanvasText",null],["Canvas",null]]);return(0,R.getColorValues)(n),(0,m.shadow)(this,"_colors",n)}convert(n){const l=(0,R.getRGB)(n);if(!window.matchMedia("(forced-colors: active)").matches)return l;for(const[g,c]of this._colors)if(c.every((u,P)=>u===l[P]))return i._colorsMapping.get(g);return l}getHexCode(n){const l=this._colors.get(n);return l?m.Util.makeHexColor(...l):n}}o.ColorManager=i;class _{#e=null;#t=new Map;#i=new Map;#n=null;#s=new S;#l=0;#h=null;#r=new Set;#a=null;#d=new E;#c=!1;#f=m.AnnotationEditorType.NONE;#o=new Set;#u=this.copy.bind(this);#g=this.cut.bind(this);#b=this.paste.bind(this);#v=this.keydown.bind(this);#C=this.onEditingAction.bind(this);#A=this.onPageChanging.bind(this);#w=this.onScaleChanging.bind(this);#y=this.onRotationChanging.bind(this);#S={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#p=null;static _keyboardManager=new d([[["ctrl+a","mac+meta+a"],_.prototype.selectAll],[["ctrl+z","mac+meta+z"],_.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],_.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],_.prototype.delete],[["Escape","mac+Escape"],_.prototype.unselectAll]]);constructor(n,l,g){this.#p=n,this.#a=l,this.#a._on("editingaction",this.#C),this.#a._on("pagechanging",this.#A),this.#a._on("scalechanging",this.#w),this.#a._on("rotationchanging",this.#y),this.#n=g,this.viewParameters={realScale:R.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#T(),this.#a._off("editingaction",this.#C),this.#a._off("pagechanging",this.#A),this.#a._off("scalechanging",this.#w),this.#a._off("rotationchanging",this.#y);for(const n of this.#i.values())n.destroy();this.#i.clear(),this.#t.clear(),this.#r.clear(),this.#e=null,this.#o.clear(),this.#s.destroy()}onPageChanging({pageNumber:n}){this.#l=n-1}focusMainContainer(){this.#p.focus()}addShouldRescale(n){this.#r.add(n)}removeShouldRescale(n){this.#r.delete(n)}onScaleChanging({scale:n}){this.commitOrRemove(),this.viewParameters.realScale=n*R.PixelsPerInch.PDF_TO_CSS_UNITS;for(const l of this.#r)l.onScaleChanging()}onRotationChanging({pagesRotation:n}){this.commitOrRemove(),this.viewParameters.rotation=n}addToAnnotationStorage(n){!n.isEmpty()&&this.#n&&!this.#n.has(n.id)&&this.#n.setValue(n.id,n)}#x(){this.#p.addEventListener("keydown",this.#v)}#T(){this.#p.removeEventListener("keydown",this.#v)}#_(){document.addEventListener("copy",this.#u),document.addEventListener("cut",this.#g),document.addEventListener("paste",this.#b)}#E(){document.removeEventListener("copy",this.#u),document.removeEventListener("cut",this.#g),document.removeEventListener("paste",this.#b)}copy(n){if(n.preventDefault(),this.#e&&this.#e.commitOrRemove(),!this.hasSelection)return;const l=[];for(const g of this.#o)g.isEmpty()||l.push(g.serialize());l.length!==0&&n.clipboardData.setData("application/pdfjs",JSON.stringify(l))}cut(n){this.copy(n),this.delete()}paste(n){n.preventDefault();let l=n.clipboardData.getData("application/pdfjs");if(!l)return;try{l=JSON.parse(l)}catch(c){(0,m.warn)(`paste: "${c.message}".`);return}if(!Array.isArray(l))return;this.unselectAll();const g=this.#i.get(this.#l);try{const c=[];for(const w of l){const y=g.deserialize(w);if(!y)return;c.push(y)}const u=()=>{for(const w of c)this.#I(w);this.#L(c)},P=()=>{for(const w of c)w.remove()};this.addCommands({cmd:u,undo:P,mustExec:!0})}catch(c){(0,m.warn)(`paste: "${c.message}".`)}}keydown(n){this.getActive()?.shouldGetKeyboardEvents()||_._keyboardManager.exec(this,n)}onEditingAction(n){["undo","redo","delete","selectAll"].includes(n.name)&&this[n.name]()}#m(n){Object.entries(n).some(([g,c])=>this.#S[g]!==c)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#S,n)})}#P(n){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:n})}setEditingState(n){n?(this.#x(),this.#_(),this.#m({isEditing:this.#f!==m.AnnotationEditorType.NONE,isEmpty:this.#R(),hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:this.#s.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#T(),this.#E(),this.#m({isEditing:!1}))}registerEditorTypes(n){if(!this.#h){this.#h=n;for(const l of this.#h)this.#P(l.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#i.get(this.#l)}get currentPageIndex(){return this.#l}addLayer(n){this.#i.set(n.pageIndex,n),this.#c?n.enable():n.disable()}removeLayer(n){this.#i.delete(n.pageIndex)}updateMode(n){if(this.#f=n,n===m.AnnotationEditorType.NONE)this.setEditingState(!1),this.#k();else{this.setEditingState(!0),this.#M();for(const l of this.#i.values())l.updateMode(n)}}updateToolbar(n){n!==this.#f&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:n})}updateParams(n,l){if(this.#h){for(const g of this.#o)g.updateParams(n,l);for(const g of this.#h)g.updateDefaultParams(n,l)}}#M(){if(!this.#c){this.#c=!0;for(const n of this.#i.values())n.enable()}}#k(){if(this.unselectAll(),this.#c){this.#c=!1;for(const n of this.#i.values())n.disable()}}getEditors(n){const l=[];for(const g of this.#t.values())g.pageIndex===n&&l.push(g);return l}getEditor(n){return this.#t.get(n)}addEditor(n){this.#t.set(n.id,n)}removeEditor(n){this.#t.delete(n.id),this.unselect(n),this.#n?.remove(n.id)}#I(n){const l=this.#i.get(n.pageIndex);l?l.addOrRebuild(n):this.addEditor(n)}setActiveEditor(n){this.#e!==n&&(this.#e=n,n&&this.#P(n.propertiesToUpdate))}toggleSelected(n){if(this.#o.has(n)){this.#o.delete(n),n.unselect(),this.#m({hasSelectedEditor:this.hasSelection});return}this.#o.add(n),n.select(),this.#P(n.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}setSelected(n){for(const l of this.#o)l!==n&&l.unselect();this.#o.clear(),this.#o.add(n),n.select(),this.#P(n.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}isSelected(n){return this.#o.has(n)}unselect(n){n.unselect(),this.#o.delete(n),this.#m({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#s.undo(),this.#m({hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#R()})}redo(){this.#s.redo(),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:this.#s.hasSomethingToRedo(),isEmpty:this.#R()})}addCommands(n){this.#s.add(n),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#R()})}#R(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const n of this.#t.values())return n.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const n=[...this.#o],l=()=>{for(const c of n)c.remove()},g=()=>{for(const c of n)this.#I(c)};this.addCommands({cmd:l,undo:g,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}#L(n){this.#o.clear();for(const l of n)l.isEmpty()||(this.#o.add(l),l.select());this.#m({hasSelectedEditor:!0})}selectAll(){for(const n of this.#o)n.commit();this.#L(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.#o.size!==0){for(const n of this.#o)n.unselect();this.#o.clear(),this.#m({hasSelectedEditor:!1})}}isActive(n){return this.#e===n}getActive(){return this.#e}getMode(){return this.#f}}o.AnnotationEditorUIManager=_}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.StatTimer=o.RenderingCancelledException=o.PixelsPerInch=o.PageViewport=o.PDFDateString=o.DOMStandardFontDataFactory=o.DOMSVGFactory=o.DOMFilterFactory=o.DOMCanvasFactory=o.DOMCMapReaderFactory=o.AnnotationPrefix=void 0,o.deprecated=T,o.getColorValues=z,o.getCurrentTransform=ie,o.getCurrentTransformInverse=J,o.getFilenameFromUrl=P,o.getPdfFilenameFromUrl=w,o.getRGB=U,o.getXfaPageViewport=I,o.isDataScheme=c,o.isPdfFile=u,o.isValidFetchUrl=e,o.loadScript=a,o.setLayerDimensions=q;var m=F(7),R=F(1);const H="http://www.w3.org/2000/svg",D="pdfjs_internal_id_";o.AnnotationPrefix=D;class E{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}o.PixelsPerInch=E;class S extends m.BaseFilterFactory{#e;#t;#i;#n;#s;#l;#h;#r=0;constructor({docId:M,ownerDocument:C=globalThis.document}={}){super(),this.#i=M,this.#n=C}get#a(){return this.#e||=new Map}get#d(){if(!this.#t){const M=this.#n.createElement("div"),{style:C}=M;C.visibility="hidden",C.contain="strict",C.width=C.height=0,C.position="absolute",C.top=C.left=0,C.zIndex=-1;const A=this.#n.createElementNS(H,"svg");A.setAttribute("width",0),A.setAttribute("height",0),this.#t=this.#n.createElementNS(H,"defs"),M.append(A),A.append(this.#t),this.#n.body.append(M)}return this.#t}#c(M,C,A){const h=this.#n.createElementNS(H,C);h.setAttribute("type","discrete"),h.setAttribute("tableValues",A),M.append(h)}addFilter(M){if(!M)return"none";let C=this.#a.get(M);if(C)return C;let A,h,r,v;if(M.length===1){const k=M[0],N=new Array(256);for(let j=0;j<256;j++)N[j]=k[j]/255;v=A=h=r=N.join(",")}else{const[k,N,j]=M,V=new Array(256),X=new Array(256),Q=new Array(256);for(let $=0;$<256;$++)V[$]=k[$]/255,X[$]=N[$]/255,Q[$]=j[$]/255;A=V.join(","),h=X.join(","),r=Q.join(","),v=`${A}${h}${r}`}if(C=this.#a.get(v),C)return this.#a.set(M,C),C;const L=`g_${this.#i}_transfer_map_${this.#r++}`,s=`url(#${L})`;this.#a.set(M,s),this.#a.set(v,s);const f=this.#n.createElementNS(H,"filter",H);f.setAttribute("id",L),f.setAttribute("color-interpolation-filters","sRGB");const b=this.#n.createElementNS(H,"feComponentTransfer");return f.append(b),this.#c(b,"feFuncR",A),this.#c(b,"feFuncG",h),this.#c(b,"feFuncB",r),this.#d.append(f),s}addHCMFilter(M,C){const A=`${M}-${C}`;if(this.#l===A)return this.#h;if(this.#l=A,this.#h="none",this.#s?.remove(),!M||!C)return this.#h;this.#d.style.color=M,M=getComputedStyle(this.#d).getPropertyValue("color");const h=U(M);M=R.Util.makeHexColor(...h),this.#d.style.color=C,C=getComputedStyle(this.#d).getPropertyValue("color");const r=U(C);if(C=R.Util.makeHexColor(...r),this.#d.style.color="",M==="#000000"&&C==="#ffffff"||M===C)return this.#h;const v=new Array(256);for(let j=0;j<=255;j++){const V=j/255;v[j]=V<=.03928?V/12.92:((V+.055)/1.055)**2.4}const L=v.join(","),s=`g_${this.#i}_hcm_filter`,f=this.#s=this.#n.createElementNS(H,"filter",H);f.setAttribute("id",s),f.setAttribute("color-interpolation-filters","sRGB");let b=this.#n.createElementNS(H,"feComponentTransfer");f.append(b),this.#c(b,"feFuncR",L),this.#c(b,"feFuncG",L),this.#c(b,"feFuncB",L);const k=this.#n.createElementNS(H,"feColorMatrix");k.setAttribute("type","matrix"),k.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),f.append(k),b=this.#n.createElementNS(H,"feComponentTransfer"),f.append(b);const N=(j,V)=>{const X=h[j]/255,Q=r[j]/255,$=new Array(V+1);for(let te=0;te<=V;te++)$[te]=X+te/V*(Q-X);return $.join(",")};return this.#c(b,"feFuncR",N(0,5)),this.#c(b,"feFuncG",N(1,5)),this.#c(b,"feFuncB",N(2,5)),this.#d.append(f),this.#h=`url(#${s})`,this.#h}destroy(M=!1){M&&this.#h||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#r=0)}}o.DOMFilterFactory=S;class d extends m.BaseCanvasFactory{constructor({ownerDocument:M=globalThis.document}={}){super(),this._document=M}_createCanvas(M,C){const A=this._document.createElement("canvas");return A.width=M,A.height=C,A}}o.DOMCanvasFactory=d;async function i(W,M=!1){if(e(W,document.baseURI)){const C=await fetch(W);if(!C.ok)throw new Error(C.statusText);return M?new Uint8Array(await C.arrayBuffer()):(0,R.stringToBytes)(await C.text())}return new Promise((C,A)=>{const h=new XMLHttpRequest;h.open("GET",W,!0),M&&(h.responseType="arraybuffer"),h.onreadystatechange=()=>{if(h.readyState===XMLHttpRequest.DONE){if(h.status===200||h.status===0){let r;if(M&&h.response?r=new Uint8Array(h.response):!M&&h.responseText&&(r=(0,R.stringToBytes)(h.responseText)),r){C(r);return}}A(new Error(h.statusText))}},h.send(null)})}class _ extends m.BaseCMapReaderFactory{_fetchData(M,C){return i(M,this.isCompressed).then(A=>({cMapData:A,compressionType:C}))}}o.DOMCMapReaderFactory=_;class p extends m.BaseStandardFontDataFactory{_fetchData(M){return i(M,!0)}}o.DOMStandardFontDataFactory=p;class n extends m.BaseSVGFactory{_createSVG(M){return document.createElementNS(H,M)}}o.DOMSVGFactory=n;class l{constructor({viewBox:M,scale:C,rotation:A,offsetX:h=0,offsetY:r=0,dontFlip:v=!1}){this.viewBox=M,this.scale=C,this.rotation=A,this.offsetX=h,this.offsetY=r;const L=(M[2]+M[0])/2,s=(M[3]+M[1])/2;let f,b,k,N;switch(A%=360,A<0&&(A+=360),A){case 180:f=-1,b=0,k=0,N=1;break;case 90:f=0,b=1,k=1,N=0;break;case 270:f=0,b=-1,k=-1,N=0;break;case 0:f=1,b=0,k=0,N=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}v&&(k=-k,N=-N);let j,V,X,Q;f===0?(j=Math.abs(s-M[1])*C+h,V=Math.abs(L-M[0])*C+r,X=(M[3]-M[1])*C,Q=(M[2]-M[0])*C):(j=Math.abs(L-M[0])*C+h,V=Math.abs(s-M[1])*C+r,X=(M[2]-M[0])*C,Q=(M[3]-M[1])*C),this.transform=[f*C,b*C,k*C,N*C,j-f*C*L-k*C*s,V-b*C*L-N*C*s],this.width=X,this.height=Q}get rawDims(){const{viewBox:M}=this;return(0,R.shadow)(this,"rawDims",{pageWidth:M[2]-M[0],pageHeight:M[3]-M[1],pageX:M[0],pageY:M[1]})}clone({scale:M=this.scale,rotation:C=this.rotation,offsetX:A=this.offsetX,offsetY:h=this.offsetY,dontFlip:r=!1}={}){return new l({viewBox:this.viewBox.slice(),scale:M,rotation:C,offsetX:A,offsetY:h,dontFlip:r})}convertToViewportPoint(M,C){return R.Util.applyTransform([M,C],this.transform)}convertToViewportRectangle(M){const C=R.Util.applyTransform([M[0],M[1]],this.transform),A=R.Util.applyTransform([M[2],M[3]],this.transform);return[C[0],C[1],A[0],A[1]]}convertToPdfPoint(M,C){return R.Util.applyInverseTransform([M,C],this.transform)}}o.PageViewport=l;class g extends R.BaseException{constructor(M,C,A=0){super(M,"RenderingCancelledException"),this.type=C,this.extraDelay=A}}o.RenderingCancelledException=g;function c(W){const M=W.length;let C=0;for(;C<M&&W[C].trim()==="";)C++;return W.substring(C,C+5).toLowerCase()==="data:"}function u(W){return typeof W=="string"&&/\.pdf$/i.test(W)}function P(W,M=!1){return M||([W]=W.split(/[#?]/,1)),W.substring(W.lastIndexOf("/")+1)}function w(W,M="document.pdf"){if(typeof W!="string")return M;if(c(W))return(0,R.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),M;const C=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,A=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,h=C.exec(W);let r=A.exec(h[1])||A.exec(h[2])||A.exec(h[3]);if(r&&(r=r[0],r.includes("%")))try{r=A.exec(decodeURIComponent(r))[0]}catch{}return r||M}class y{started=Object.create(null);times=[];time(M){M in this.started&&(0,R.warn)(`Timer is already running for ${M}`),this.started[M]=Date.now()}timeEnd(M){M in this.started||(0,R.warn)(`Timer has not been started for ${M}`),this.times.push({name:M,start:this.started[M],end:Date.now()}),delete this.started[M]}toString(){const M=[];let C=0;for(const{name:A}of this.times)C=Math.max(A.length,C);for(const{name:A,start:h,end:r}of this.times)M.push(`${A.padEnd(C)} ${r-h}ms
`);return M.join("")}}o.StatTimer=y;function e(W,M){try{const{protocol:C}=M?new URL(W,M):new URL(W);return C==="http:"||C==="https:"}catch{return!1}}function a(W,M=!1){return new Promise((C,A)=>{const h=document.createElement("script");h.src=W,h.onload=function(r){M&&h.remove(),C(r)},h.onerror=function(){A(new Error(`Cannot load script at: ${h.src}`))},(document.head||document.documentElement).append(h)})}function T(W){console.log("Deprecated API usage: "+W)}let O;class x{static toDateObject(M){if(!M||typeof M!="string")return null;O||(O=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const C=O.exec(M);if(!C)return null;const A=parseInt(C[1],10);let h=parseInt(C[2],10);h=h>=1&&h<=12?h-1:0;let r=parseInt(C[3],10);r=r>=1&&r<=31?r:1;let v=parseInt(C[4],10);v=v>=0&&v<=23?v:0;let L=parseInt(C[5],10);L=L>=0&&L<=59?L:0;let s=parseInt(C[6],10);s=s>=0&&s<=59?s:0;const f=C[7]||"Z";let b=parseInt(C[8],10);b=b>=0&&b<=23?b:0;let k=parseInt(C[9],10)||0;return k=k>=0&&k<=59?k:0,f==="-"?(v+=b,L+=k):f==="+"&&(v-=b,L-=k),new Date(Date.UTC(A,h,r,v,L,s))}}o.PDFDateString=x;function I(W,{scale:M=1,rotation:C=0}){const{width:A,height:h}=W.attributes.style,r=[0,0,parseInt(A),parseInt(h)];return new l({viewBox:r,scale:M,rotation:C})}function U(W){if(W.startsWith("#")){const M=parseInt(W.slice(1),16);return[(M&16711680)>>16,(M&65280)>>8,M&255]}return W.startsWith("rgb(")?W.slice(4,-1).split(",").map(M=>parseInt(M)):W.startsWith("rgba(")?W.slice(5,-1).split(",").map(M=>parseInt(M)).slice(0,3):((0,R.warn)(`Not a valid color format: "${W}"`),[0,0,0])}function z(W){const M=document.createElement("span");M.style.visibility="hidden",document.body.append(M);for(const C of W.keys()){M.style.color=C;const A=window.getComputedStyle(M).color;W.set(C,U(A))}M.remove()}function ie(W){const{a:M,b:C,c:A,d:h,e:r,f:v}=W.getTransform();return[M,C,A,h,r,v]}function J(W){const{a:M,b:C,c:A,d:h,e:r,f:v}=W.getTransform().invertSelf();return[M,C,A,h,r,v]}function q(W,M,C=!1,A=!0){if(M instanceof l){const{pageWidth:h,pageHeight:r}=M.rawDims,{style:v}=W,L=`calc(var(--scale-factor) * ${h}px)`,s=`calc(var(--scale-factor) * ${r}px)`;!C||M.rotation%180===0?(v.width=L,v.height=s):(v.width=s,v.height=L)}A&&W.setAttribute("data-main-rotation",M.rotation)}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BaseStandardFontDataFactory=o.BaseSVGFactory=o.BaseFilterFactory=o.BaseCanvasFactory=o.BaseCMapReaderFactory=void 0;var m=F(1);class R{constructor(){this.constructor===R&&(0,m.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(i){return"none"}addHCMFilter(i,_){return"none"}destroy(i=!1){}}o.BaseFilterFactory=R;class H{constructor(){this.constructor===H&&(0,m.unreachable)("Cannot initialize BaseCanvasFactory.")}create(i,_){if(i<=0||_<=0)throw new Error("Invalid canvas size");const p=this._createCanvas(i,_);return{canvas:p,context:p.getContext("2d")}}reset(i,_,p){if(!i.canvas)throw new Error("Canvas is not specified");if(_<=0||p<=0)throw new Error("Invalid canvas size");i.canvas.width=_,i.canvas.height=p}destroy(i){if(!i.canvas)throw new Error("Canvas is not specified");i.canvas.width=0,i.canvas.height=0,i.canvas=null,i.context=null}_createCanvas(i,_){(0,m.unreachable)("Abstract method `_createCanvas` called.")}}o.BaseCanvasFactory=H;class D{constructor({baseUrl:i=null,isCompressed:_=!0}){this.constructor===D&&(0,m.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=i,this.isCompressed=_}async fetch({name:i}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!i)throw new Error("CMap name must be specified.");const _=this.baseUrl+i+(this.isCompressed?".bcmap":""),p=this.isCompressed?m.CMapCompressionType.BINARY:m.CMapCompressionType.NONE;return this._fetchData(_,p).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${_}`)})}_fetchData(i,_){(0,m.unreachable)("Abstract method `_fetchData` called.")}}o.BaseCMapReaderFactory=D;class E{constructor({baseUrl:i=null}){this.constructor===E&&(0,m.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=i}async fetch({filename:i}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!i)throw new Error("Font filename must be specified.");const _=`${this.baseUrl}${i}`;return this._fetchData(_).catch(p=>{throw new Error(`Unable to load font data at: ${_}`)})}_fetchData(i){(0,m.unreachable)("Abstract method `_fetchData` called.")}}o.BaseStandardFontDataFactory=E;class S{constructor(){this.constructor===S&&(0,m.unreachable)("Cannot initialize BaseSVGFactory.")}create(i,_,p=!1){if(i<=0||_<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),p||(n.setAttribute("width",`${i}px`),n.setAttribute("height",`${_}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${i} ${_}`),n}createElement(i){if(typeof i!="string")throw new Error("Invalid SVG element type");return this._createSVG(i)}_createSVG(i){(0,m.unreachable)("Abstract method `_createSVG` called.")}}o.BaseSVGFactory=S}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.MurmurHash3_64=void 0;var m=F(1);const R=3285377520,H=4294901760,D=65535;class E{constructor(d){this.h1=d?d&4294967295:R,this.h2=d?d&4294967295:R}update(d){let i,_;if(typeof d=="string"){i=new Uint8Array(d.length*2),_=0;for(let T=0,O=d.length;T<O;T++){const x=d.charCodeAt(T);x<=255?i[_++]=x:(i[_++]=x>>>8,i[_++]=x&255)}}else if((0,m.isArrayBuffer)(d))i=d.slice(),_=i.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const p=_>>2,n=_-p*4,l=new Uint32Array(i.buffer,0,p);let g=0,c=0,u=this.h1,P=this.h2;const w=3432918353,y=461845907,e=w&D,a=y&D;for(let T=0;T<p;T++)T&1?(g=l[T],g=g*w&H|g*e&D,g=g<<15|g>>>17,g=g*y&H|g*a&D,u^=g,u=u<<13|u>>>19,u=u*5+3864292196):(c=l[T],c=c*w&H|c*e&D,c=c<<15|c>>>17,c=c*y&H|c*a&D,P^=c,P=P<<13|P>>>19,P=P*5+3864292196);switch(g=0,n){case 3:g^=i[p*4+2]<<16;case 2:g^=i[p*4+1]<<8;case 1:g^=i[p*4],g=g*w&H|g*e&D,g=g<<15|g>>>17,g=g*y&H|g*a&D,p&1?u^=g:P^=g}this.h1=u,this.h2=P}hexdigest(){let d=this.h1,i=this.h2;return d^=i>>>1,d=d*3981806797&H|d*36045&D,i=i*4283543511&H|((i<<16|d>>>16)*2950163797&H)>>>16,d^=i>>>1,d=d*444984403&H|d*60499&D,i=i*3301882366&H|((i<<16|d>>>16)*3120437893&H)>>>16,d^=i>>>1,(d>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}o.MurmurHash3_64=E}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FontLoader=o.FontFaceObject=void 0;var m=F(1),R=F(10);class H{constructor({ownerDocument:S=globalThis.document,styleElement:d=null}){this._document=S,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(S){this.nativeFontFaces.push(S),this._document.fonts.add(S)}insertRule(S){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const d=this.styleElement.sheet;d.insertRule(S,d.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(S){if(S.attached||S.missingFile)return;if(S.attached=!0,this.isFontLoadingAPISupported){const i=S.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(_){throw(0,m.warn)(`Failed to load font '${i.family}': '${_}'.`),S.disableFontFace=!0,_}}return}const d=S.createFontFaceRule();if(d){if(this.insertRule(d),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const _=this._queueLoadingCallback(i);this._prepareFontLoadEvent(S,_)})}}get isFontLoadingAPISupported(){const S=!!this._document?.fonts;return(0,m.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){let S=!1;return(R.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(S=!0),(0,m.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function d(){for((0,m.assert)(!_.done,"completeRequest() cannot be called twice."),_.done=!0;i.length>0&&i[0].done;){const p=i.shift();setTimeout(p.callback,0)}}const{loadingRequests:i}=this,_={done:!1,complete:d,callback:S};return i.push(_),_}get _loadTestFont(){const S=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,m.shadow)(this,"_loadTestFont",S)}_prepareFontLoadEvent(S,d){function i(U,z){return U.charCodeAt(z)<<24|U.charCodeAt(z+1)<<16|U.charCodeAt(z+2)<<8|U.charCodeAt(z+3)&255}function _(U,z,ie,J){const q=U.substring(0,z),W=U.substring(z+ie);return q+J+W}let p,n;const l=this._document.createElement("canvas");l.width=1,l.height=1;const g=l.getContext("2d");let c=0;function u(U,z){if(++c>30){(0,m.warn)("Load test font never loaded."),z();return}if(g.font="30px "+U,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(u.bind(null,U,z))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=_(w,976,P.length,P);const e=16,a=1482184792;let T=i(w,e);for(p=0,n=P.length-3;p<n;p+=4)T=T-a+i(P,p)|0;p<P.length&&(T=T-a+i(P+"XXX",p)|0),w=_(w,e,4,(0,m.string32)(T));const O=`url(data:font/opentype;base64,${btoa(w)});`,x=`@font-face {font-family:"${P}";src:${O}}`;this.insertRule(x);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const U of[S.loadedName,P]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=U,I.append(z)}this._document.body.append(I),u(P,()=>{I.remove(),d.complete()})}}o.FontLoader=H;class D{constructor(S,{isEvalSupported:d=!0,disableFontFace:i=!1,ignoreErrors:_=!1,inspectFont:p=null}){this.compiledGlyphs=Object.create(null);for(const n in S)this[n]=S[n];this.isEvalSupported=d!==!1,this.disableFontFace=i===!0,this.ignoreErrors=_===!0,this._inspectFont=p}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const d={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(d.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,d)}return this._inspectFont?.(this),S}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const S=(0,m.bytesToString)(this.data),d=`url(data:${this.mimetype};base64,${btoa(S)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${d}}`;else{let _=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_}src:${d}}`}return this._inspectFont?.(this,d),i}getPathGenerator(S,d){if(this.compiledGlyphs[d]!==void 0)return this.compiledGlyphs[d];let i;try{i=S.get(this.loadedName+"_path_"+d)}catch(_){if(!this.ignoreErrors)throw _;return(0,m.warn)(`getPathGenerator - ignoring character: "${_}".`),this.compiledGlyphs[d]=function(p,n){}}if(this.isEvalSupported&&m.FeatureTest.isEvalSupported){const _=[];for(const p of i){const n=p.args!==void 0?p.args.join(","):"";_.push("c.",p.cmd,"(",n,`);
`)}return this.compiledGlyphs[d]=new Function("c","size",_.join(""))}return this.compiledGlyphs[d]=function(_,p){for(const n of i)n.cmd==="scale"&&(n.args=[p,-p]),_[n.cmd].apply(_,n.args)}}}o.FontFaceObject=D}),((B,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isNodeJS=void 0;const F=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");o.isNodeJS=F}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CanvasGraphics=void 0;var m=F(1),R=F(6),H=F(12),D=F(13),E=F(10);const S=16,d=100,i=4096,_=15,p=10,n=1e3,l=16;function g(A,h){if(A._removeMirroring)throw new Error("Context is already forwarding operations.");A.__originalSave=A.save,A.__originalRestore=A.restore,A.__originalRotate=A.rotate,A.__originalScale=A.scale,A.__originalTranslate=A.translate,A.__originalTransform=A.transform,A.__originalSetTransform=A.setTransform,A.__originalResetTransform=A.resetTransform,A.__originalClip=A.clip,A.__originalMoveTo=A.moveTo,A.__originalLineTo=A.lineTo,A.__originalBezierCurveTo=A.bezierCurveTo,A.__originalRect=A.rect,A.__originalClosePath=A.closePath,A.__originalBeginPath=A.beginPath,A._removeMirroring=()=>{A.save=A.__originalSave,A.restore=A.__originalRestore,A.rotate=A.__originalRotate,A.scale=A.__originalScale,A.translate=A.__originalTranslate,A.transform=A.__originalTransform,A.setTransform=A.__originalSetTransform,A.resetTransform=A.__originalResetTransform,A.clip=A.__originalClip,A.moveTo=A.__originalMoveTo,A.lineTo=A.__originalLineTo,A.bezierCurveTo=A.__originalBezierCurveTo,A.rect=A.__originalRect,A.closePath=A.__originalClosePath,A.beginPath=A.__originalBeginPath,delete A._removeMirroring},A.save=function(){h.save(),this.__originalSave()},A.restore=function(){h.restore(),this.__originalRestore()},A.translate=function(v,L){h.translate(v,L),this.__originalTranslate(v,L)},A.scale=function(v,L){h.scale(v,L),this.__originalScale(v,L)},A.transform=function(v,L,s,f,b,k){h.transform(v,L,s,f,b,k),this.__originalTransform(v,L,s,f,b,k)},A.setTransform=function(v,L,s,f,b,k){h.setTransform(v,L,s,f,b,k),this.__originalSetTransform(v,L,s,f,b,k)},A.resetTransform=function(){h.resetTransform(),this.__originalResetTransform()},A.rotate=function(v){h.rotate(v),this.__originalRotate(v)},A.clip=function(v){h.clip(v),this.__originalClip(v)},A.moveTo=function(r,v){h.moveTo(r,v),this.__originalMoveTo(r,v)},A.lineTo=function(r,v){h.lineTo(r,v),this.__originalLineTo(r,v)},A.bezierCurveTo=function(r,v,L,s,f,b){h.bezierCurveTo(r,v,L,s,f,b),this.__originalBezierCurveTo(r,v,L,s,f,b)},A.rect=function(r,v,L,s){h.rect(r,v,L,s),this.__originalRect(r,v,L,s)},A.closePath=function(){h.closePath(),this.__originalClosePath()},A.beginPath=function(){h.beginPath(),this.__originalBeginPath()}}class c{constructor(h){this.canvasFactory=h,this.cache=Object.create(null)}getCanvas(h,r,v){let L;return this.cache[h]!==void 0?(L=this.cache[h],this.canvasFactory.reset(L,r,v)):(L=this.canvasFactory.create(r,v),this.cache[h]=L),L}delete(h){delete this.cache[h]}clear(){for(const h in this.cache){const r=this.cache[h];this.canvasFactory.destroy(r),delete this.cache[h]}}}function u(A,h,r,v,L,s,f,b,k,N){const[j,V,X,Q,$,te]=(0,R.getCurrentTransform)(A);if(V===0&&X===0){const ee=f*j+$,ne=Math.round(ee),Z=b*Q+te,ae=Math.round(Z),oe=(f+k)*j+$,ce=Math.abs(Math.round(oe)-ne)||1,he=(b+N)*Q+te,fe=Math.abs(Math.round(he)-ae)||1;return A.setTransform(Math.sign(j),0,0,Math.sign(Q),ne,ae),A.drawImage(h,r,v,L,s,0,0,ce,fe),A.setTransform(j,V,X,Q,$,te),[ce,fe]}if(j===0&&Q===0){const ee=b*X+$,ne=Math.round(ee),Z=f*V+te,ae=Math.round(Z),oe=(b+N)*X+$,ce=Math.abs(Math.round(oe)-ne)||1,he=(f+k)*V+te,fe=Math.abs(Math.round(he)-ae)||1;return A.setTransform(0,Math.sign(V),Math.sign(X),0,ne,ae),A.drawImage(h,r,v,L,s,0,0,fe,ce),A.setTransform(j,V,X,Q,$,te),[fe,ce]}A.drawImage(h,r,v,L,s,f,b,k,N);const re=Math.hypot(j,V),G=Math.hypot(X,Q);return[re*k,G*N]}function P(A){const{width:h,height:r}=A;if(h>n||r>n)return null;const v=1e3,L=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=h+1;let f=new Uint8Array(s*(r+1)),b,k,N;const j=h+7&-8;let V=new Uint8Array(j*r),X=0;for(const G of A.data){let ee=128;for(;ee>0;)V[X++]=G&ee?0:255,ee>>=1}let Q=0;for(X=0,V[X]!==0&&(f[0]=1,++Q),k=1;k<h;k++)V[X]!==V[X+1]&&(f[k]=V[X]?2:1,++Q),X++;for(V[X]!==0&&(f[k]=2,++Q),b=1;b<r;b++){X=b*j,N=b*s,V[X-j]!==V[X]&&(f[N]=V[X]?1:8,++Q);let G=(V[X]?4:0)+(V[X-j]?8:0);for(k=1;k<h;k++)G=(G>>2)+(V[X+1]?4:0)+(V[X-j+1]?8:0),L[G]&&(f[N+k]=L[G],++Q),X++;if(V[X-j]!==V[X]&&(f[N+k]=V[X]?2:4,++Q),Q>v)return null}for(X=j*(r-1),N=b*s,V[X]!==0&&(f[N]=8,++Q),k=1;k<h;k++)V[X]!==V[X+1]&&(f[N+k]=V[X]?4:8,++Q),X++;if(V[X]!==0&&(f[N+k]=4,++Q),Q>v)return null;const $=new Int32Array([0,s,-1,0,-s,0,0,0,1]),te=new Path2D;for(b=0;Q&&b<=r;b++){let G=b*s;const ee=G+h;for(;G<ee&&!f[G];)G++;if(G===ee)continue;te.moveTo(G%s,b);const ne=G;let Z=f[G];do{const ae=$[Z];do G+=ae;while(!f[G]);const oe=f[G];oe!==5&&oe!==10?(Z=oe,f[G]=0):(Z=oe&51*Z>>4,f[G]&=Z>>2|Z<<2),te.lineTo(G%s,G/s|0),f[G]||--Q}while(ne!==G);--b}return V=null,f=null,function(G){G.save(),G.scale(1/h,-1/r),G.translate(0,-r),G.fill(te),G.beginPath(),G.restore()}}class w{constructor(h,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=m.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=m.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=m.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,h,r])}clone(){const h=Object.create(this);return h.clipBox=this.clipBox.slice(),h}setCurrentPoint(h,r){this.x=h,this.y=r}updatePathMinMax(h,r,v){[r,v]=m.Util.applyTransform([r,v],h),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,v),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,v)}updateRectMinMax(h,r){const v=m.Util.applyTransform(r,h),L=m.Util.applyTransform(r.slice(2),h);this.minX=Math.min(this.minX,v[0],L[0]),this.minY=Math.min(this.minY,v[1],L[1]),this.maxX=Math.max(this.maxX,v[0],L[0]),this.maxY=Math.max(this.maxY,v[1],L[1])}updateScalingPathMinMax(h,r){m.Util.scaleMinMax(h,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(h,r,v,L,s,f,b,k,N,j){const V=m.Util.bezierBoundingBox(r,v,L,s,f,b,k,N);if(j){j[0]=Math.min(j[0],V[0],V[2]),j[1]=Math.max(j[1],V[0],V[2]),j[2]=Math.min(j[2],V[1],V[3]),j[3]=Math.max(j[3],V[1],V[3]);return}this.updateRectMinMax(h,V)}getPathBoundingBox(h=H.PathType.FILL,r=null){const v=[this.minX,this.minY,this.maxX,this.maxY];if(h===H.PathType.STROKE){r||(0,m.unreachable)("Stroke bounding box must include transform.");const L=m.Util.singularValueDecompose2dScale(r),s=L[0]*this.lineWidth/2,f=L[1]*this.lineWidth/2;v[0]-=s,v[1]-=f,v[2]+=s,v[3]+=f}return v}updateClipFromPath(){const h=m.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(h||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(h){this.clipBox=h,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(h=H.PathType.FILL,r=null){return m.Util.intersect(this.clipBox,this.getPathBoundingBox(h,r))}}function y(A,h){if(typeof ImageData<"u"&&h instanceof ImageData){A.putImageData(h,0,0);return}const r=h.height,v=h.width,L=r%l,s=(r-L)/l,f=L===0?s:s+1,b=A.createImageData(v,l);let k=0,N;const j=h.data,V=b.data;let X,Q,$,te;if(h.kind===m.ImageKind.GRAYSCALE_1BPP){const re=j.byteLength,G=new Uint32Array(V.buffer,0,V.byteLength>>2),ee=G.length,ne=v+7>>3,Z=4294967295,ae=m.FeatureTest.isLittleEndian?4278190080:255;for(X=0;X<f;X++){for($=X<s?l:L,N=0,Q=0;Q<$;Q++){const oe=re-k;let ce=0;const he=oe>ne?v:oe*8-7,fe=he&-8;let pe=0,ue=0;for(;ce<fe;ce+=8)ue=j[k++],G[N++]=ue&128?Z:ae,G[N++]=ue&64?Z:ae,G[N++]=ue&32?Z:ae,G[N++]=ue&16?Z:ae,G[N++]=ue&8?Z:ae,G[N++]=ue&4?Z:ae,G[N++]=ue&2?Z:ae,G[N++]=ue&1?Z:ae;for(;ce<he;ce++)pe===0&&(ue=j[k++],pe=128),G[N++]=ue&pe?Z:ae,pe>>=1}for(;N<ee;)G[N++]=0;A.putImageData(b,0,X*l)}}else if(h.kind===m.ImageKind.RGBA_32BPP){for(Q=0,te=v*l*4,X=0;X<s;X++)V.set(j.subarray(k,k+te)),k+=te,A.putImageData(b,0,Q),Q+=l;X<f&&(te=v*L*4,V.set(j.subarray(k,k+te)),A.putImageData(b,0,Q))}else if(h.kind===m.ImageKind.RGB_24BPP)for($=l,te=v*$,X=0;X<f;X++){for(X>=s&&($=L,te=v*$),N=0,Q=te;Q--;)V[N++]=j[k++],V[N++]=j[k++],V[N++]=j[k++],V[N++]=255;A.putImageData(b,0,X*l)}else throw new Error(`bad image kind: ${h.kind}`)}function e(A,h){if(h.bitmap){A.drawImage(h.bitmap,0,0);return}const r=h.height,v=h.width,L=r%l,s=(r-L)/l,f=L===0?s:s+1,b=A.createImageData(v,l);let k=0;const N=h.data,j=b.data;for(let V=0;V<f;V++){const X=V<s?l:L;({srcPos:k}=(0,D.convertBlackAndWhiteToRGBA)({src:N,srcPos:k,dest:j,width:v,height:X,nonBlackColor:0})),A.putImageData(b,0,V*l)}}function a(A,h){const r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const v of r)A[v]!==void 0&&(h[v]=A[v]);A.setLineDash!==void 0&&(h.setLineDash(A.getLineDash()),h.lineDashOffset=A.lineDashOffset)}function T(A){A.strokeStyle=A.fillStyle="#000000",A.fillRule="nonzero",A.globalAlpha=1,A.lineWidth=1,A.lineCap="butt",A.lineJoin="miter",A.miterLimit=10,A.globalCompositeOperation="source-over",A.font="10px sans-serif",A.setLineDash!==void 0&&(A.setLineDash([]),A.lineDashOffset=0),E.isNodeJS||(A.filter="none")}function O(A,h,r,v){const L=A.length;for(let s=3;s<L;s+=4){const f=A[s];if(f===0)A[s-3]=h,A[s-2]=r,A[s-1]=v;else if(f<255){const b=255-f;A[s-3]=A[s-3]*f+h*b>>8,A[s-2]=A[s-2]*f+r*b>>8,A[s-1]=A[s-1]*f+v*b>>8}}}function x(A,h,r){const v=A.length,L=1/255;for(let s=3;s<v;s+=4){const f=r?r[A[s]]:A[s];h[s]=h[s]*f*L|0}}function I(A,h,r){const v=A.length;for(let L=3;L<v;L+=4){const s=A[L-3]*77+A[L-2]*152+A[L-1]*28;h[L]=r?h[L]*r[s>>8]>>8:h[L]*s>>16}}function U(A,h,r,v,L,s,f,b,k,N,j){const V=!!s,X=V?s[0]:0,Q=V?s[1]:0,$=V?s[2]:0;let te;L==="Luminosity"?te=I:te=x;const G=Math.min(v,Math.ceil(1048576/r));for(let ee=0;ee<v;ee+=G){const ne=Math.min(G,v-ee),Z=A.getImageData(b-N,ee+(k-j),r,ne),ae=h.getImageData(b,ee+k,r,ne);V&&O(Z.data,X,Q,$),te(Z.data,ae.data,f),h.putImageData(ae,b,ee+k)}}function z(A,h,r,v){const L=v[0],s=v[1],f=v[2]-L,b=v[3]-s;f===0||b===0||(U(h.context,r,f,b,h.subtype,h.backdrop,h.transferMap,L,s,h.offsetX,h.offsetY),A.save(),A.globalAlpha=1,A.globalCompositeOperation="source-over",A.setTransform(1,0,0,1,0,0),A.drawImage(r.canvas,0,0),A.restore())}function ie(A,h){const r=m.Util.singularValueDecompose2dScale(A);r[0]=Math.fround(r[0]),r[1]=Math.fround(r[1]);const v=Math.fround((globalThis.devicePixelRatio||1)*R.PixelsPerInch.PDF_TO_CSS_UNITS);return h!==void 0?h:r[0]<=v||r[1]<=v}const J=["butt","round","square"],q=["miter","round","bevel"],W={},M={};class C{constructor(h,r,v,L,s,{optionalContentConfig:f,markedContentStack:b=null},k,N){this.ctx=h,this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=v,this.canvasFactory=L,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=b||[],this.optionalContentConfig=f,this.cachedCanvases=new c(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=k,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=N,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(h,r=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):r}beginDrawing({transform:h,viewport:r,transparency:v=!1,background:L=null}){const s=this.ctx.canvas.width,f=this.ctx.canvas.height,b=this.ctx.fillStyle;if(this.ctx.fillStyle=L||"#ffffff",this.ctx.fillRect(0,0,s,f),this.ctx.fillStyle=b,v){const k=this.cachedCanvases.getCanvas("transparent",s,f);this.compositeCtx=this.ctx,this.transparentCanvas=k.canvas,this.ctx=k.context,this.ctx.save(),this.ctx.transform(...(0,R.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),T(this.ctx),h&&(this.ctx.transform(...h),this.outputScaleX=h[0],this.outputScaleY=h[0]),this.ctx.transform(...r.transform),this.viewportScale=r.scale,this.baseTransform=(0,R.getCurrentTransform)(this.ctx)}executeOperatorList(h,r,v,L){const s=h.argsArray,f=h.fnArray;let b=r||0;const k=s.length;if(k===b)return b;const N=k-b>p&&typeof v=="function",j=N?Date.now()+_:0;let V=0;const X=this.commonObjs,Q=this.objs;let $;for(;;){if(L!==void 0&&b===L.nextBreakPoint)return L.breakIt(b,v),b;if($=f[b],$!==m.OPS.dependency)this[$].apply(this,s[b]);else for(const te of s[b]){const re=te.startsWith("g_")?X:Q;if(!re.has(te))return re.get(te,v),b}if(b++,b===k)return b;if(N&&++V>p){if(Date.now()>j)return v(),b;V=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const h of this._cachedBitmapsMap.values()){for(const r of h.values())typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);h.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const h=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(h!=="none"){const r=this.ctx.filter;this.ctx.filter=h,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=r}}}_scaleImage(h,r){const v=h.width,L=h.height;let s=Math.max(Math.hypot(r[0],r[1]),1),f=Math.max(Math.hypot(r[2],r[3]),1),b=v,k=L,N="prescale1",j,V;for(;s>2&&b>1||f>2&&k>1;){let X=b,Q=k;s>2&&b>1&&(X=b>=16384?Math.floor(b/2)-1||1:Math.ceil(b/2),s/=b/X),f>2&&k>1&&(Q=k>=16384?Math.floor(k/2)-1||1:Math.ceil(k)/2,f/=k/Q),j=this.cachedCanvases.getCanvas(N,X,Q),V=j.context,V.clearRect(0,0,X,Q),V.drawImage(h,0,0,b,k,0,0,X,Q),h=j.canvas,b=X,k=Q,N=N==="prescale1"?"prescale2":"prescale1"}return{img:h,paintWidth:b,paintHeight:k}}_createMaskCanvas(h){const r=this.ctx,{width:v,height:L}=h,s=this.current.fillColor,f=this.current.patternFill,b=(0,R.getCurrentTransform)(r);let k,N,j,V;if((h.bitmap||h.data)&&h.count>1){const ce=h.bitmap||h.data.buffer;N=JSON.stringify(f?b:[b.slice(0,4),s]),k=this._cachedBitmapsMap.get(ce),k||(k=new Map,this._cachedBitmapsMap.set(ce,k));const he=k.get(N);if(he&&!f){const fe=Math.round(Math.min(b[0],b[2])+b[4]),pe=Math.round(Math.min(b[1],b[3])+b[5]);return{canvas:he,offsetX:fe,offsetY:pe}}j=he}j||(V=this.cachedCanvases.getCanvas("maskCanvas",v,L),e(V.context,h));let X=m.Util.transform(b,[1/v,0,0,-1/L,0,0]);X=m.Util.transform(X,[1,0,0,1,0,-L]);const Q=m.Util.applyTransform([0,0],X),$=m.Util.applyTransform([v,L],X),te=m.Util.normalizeRect([Q[0],Q[1],$[0],$[1]]),re=Math.round(te[2]-te[0])||1,G=Math.round(te[3]-te[1])||1,ee=this.cachedCanvases.getCanvas("fillCanvas",re,G),ne=ee.context,Z=Math.min(Q[0],$[0]),ae=Math.min(Q[1],$[1]);ne.translate(-Z,-ae),ne.transform(...X),j||(j=this._scaleImage(V.canvas,(0,R.getCurrentTransformInverse)(ne)),j=j.img,k&&f&&k.set(N,j)),ne.imageSmoothingEnabled=ie((0,R.getCurrentTransform)(ne),h.interpolate),u(ne,j,0,0,j.width,j.height,0,0,v,L),ne.globalCompositeOperation="source-in";const oe=m.Util.transform((0,R.getCurrentTransformInverse)(ne),[1,0,0,1,-Z,-ae]);return ne.fillStyle=f?s.getPattern(r,this,oe,H.PathType.FILL):s,ne.fillRect(0,0,v,L),k&&!f&&(this.cachedCanvases.delete("fillCanvas"),k.set(N,ee.canvas)),{canvas:ee.canvas,offsetX:Math.round(Z),offsetY:Math.round(ae)}}setLineWidth(h){h!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=h,this.ctx.lineWidth=h}setLineCap(h){this.ctx.lineCap=J[h]}setLineJoin(h){this.ctx.lineJoin=q[h]}setMiterLimit(h){this.ctx.miterLimit=h}setDash(h,r){const v=this.ctx;v.setLineDash!==void 0&&(v.setLineDash(h),v.lineDashOffset=r)}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(const[r,v]of h)switch(r){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v[0],v[1]);break;case"CA":this.current.strokeAlpha=v;break;case"ca":this.current.fillAlpha=v,this.ctx.globalAlpha=v;break;case"BM":this.ctx.globalCompositeOperation=v;break;case"SMask":this.current.activeSMask=v?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(v);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const h=this.inSMaskMode;this.current.activeSMask&&!h?this.beginSMaskMode():!this.current.activeSMask&&h&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const h=this.ctx.canvas.width,r=this.ctx.canvas.height,v="smaskGroupAt"+this.groupLevel,L=this.cachedCanvases.getCanvas(v,h,r);this.suspendedCtx=this.ctx,this.ctx=L.context;const s=this.ctx;s.setTransform(...(0,R.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,s),g(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(h){if(!this.current.activeSMask)return;h?(h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3])):h=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask,v=this.suspendedCtx;z(v,r,this.ctx,h),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const h=this.current;this.stateStack.push(h),this.current=h.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(h,r,v,L,s,f){this.ctx.transform(h,r,v,L,s,f),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(h,r,v){const L=this.ctx,s=this.current;let f=s.x,b=s.y,k,N;const j=(0,R.getCurrentTransform)(L),V=j[0]===0&&j[3]===0||j[1]===0&&j[2]===0,X=V?v.slice(0):null;for(let Q=0,$=0,te=h.length;Q<te;Q++)switch(h[Q]|0){case m.OPS.rectangle:f=r[$++],b=r[$++];const re=r[$++],G=r[$++],ee=f+re,ne=b+G;L.moveTo(f,b),re===0||G===0?L.lineTo(ee,ne):(L.lineTo(ee,b),L.lineTo(ee,ne),L.lineTo(f,ne)),V||s.updateRectMinMax(j,[f,b,ee,ne]),L.closePath();break;case m.OPS.moveTo:f=r[$++],b=r[$++],L.moveTo(f,b),V||s.updatePathMinMax(j,f,b);break;case m.OPS.lineTo:f=r[$++],b=r[$++],L.lineTo(f,b),V||s.updatePathMinMax(j,f,b);break;case m.OPS.curveTo:k=f,N=b,f=r[$+4],b=r[$+5],L.bezierCurveTo(r[$],r[$+1],r[$+2],r[$+3],f,b),s.updateCurvePathMinMax(j,k,N,r[$],r[$+1],r[$+2],r[$+3],f,b,X),$+=6;break;case m.OPS.curveTo2:k=f,N=b,L.bezierCurveTo(f,b,r[$],r[$+1],r[$+2],r[$+3]),s.updateCurvePathMinMax(j,k,N,f,b,r[$],r[$+1],r[$+2],r[$+3],X),f=r[$+2],b=r[$+3],$+=4;break;case m.OPS.curveTo3:k=f,N=b,f=r[$+2],b=r[$+3],L.bezierCurveTo(r[$],r[$+1],f,b,f,b),s.updateCurvePathMinMax(j,k,N,r[$],r[$+1],f,b,f,b,X),$+=4;break;case m.OPS.closePath:L.closePath();break}V&&s.updateScalingPathMinMax(j,X),s.setCurrentPoint(f,b)}closePath(){this.ctx.closePath()}stroke(h=!0){const r=this.ctx,v=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof v=="object"&&v?.getPattern?(r.save(),r.strokeStyle=v.getPattern(r,this,(0,R.getCurrentTransformInverse)(r),H.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),h&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(h=!0){const r=this.ctx,v=this.current.fillColor,L=this.current.patternFill;let s=!1;L&&(r.save(),r.fillStyle=v.getPattern(r,this,(0,R.getCurrentTransformInverse)(r),H.PathType.FILL),s=!0);const f=this.current.getClippedPathBoundingBox();this.contentVisible&&f!==null&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),s&&r.restore(),h&&this.consumePath(f)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=W}eoClip(){this.pendingClip=M}beginText(){this.current.textMatrix=m.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const h=this.pendingTextPaths,r=this.ctx;if(h===void 0){r.beginPath();return}r.save(),r.beginPath();for(const v of h)r.setTransform(...v.transform),r.translate(v.x,v.y),v.addToPath(r,v.fontSize);r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}setCharSpacing(h){this.current.charSpacing=h}setWordSpacing(h){this.current.wordSpacing=h}setHScale(h){this.current.textHScale=h/100}setLeading(h){this.current.leading=-h}setFont(h,r){const v=this.commonObjs.get(h),L=this.current;if(!v)throw new Error(`Can't find font for ${h}`);if(L.fontMatrix=v.fontMatrix||m.FONT_IDENTITY_MATRIX,(L.fontMatrix[0]===0||L.fontMatrix[3]===0)&&(0,m.warn)("Invalid font matrix for font "+h),r<0?(r=-r,L.fontDirection=-1):L.fontDirection=1,this.current.font=v,this.current.fontSize=r,v.isType3Font)return;const s=v.loadedName||"sans-serif";let f="normal";v.black?f="900":v.bold&&(f="bold");const b=v.italic?"italic":"normal",k=`"${s}", ${v.fallbackName}`;let N=r;r<S?N=S:r>d&&(N=d),this.current.fontSizeScale=r/N,this.ctx.font=`${b} ${f} ${N}px ${k}`}setTextRenderingMode(h){this.current.textRenderingMode=h}setTextRise(h){this.current.textRise=h}moveText(h,r){this.current.x=this.current.lineX+=h,this.current.y=this.current.lineY+=r}setLeadingMoveText(h,r){this.setLeading(-r),this.moveText(h,r)}setTextMatrix(h,r,v,L,s,f){this.current.textMatrix=[h,r,v,L,s,f],this.current.textMatrixScale=Math.hypot(h,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(h,r,v,L){const s=this.ctx,f=this.current,b=f.font,k=f.textRenderingMode,N=f.fontSize/f.fontSizeScale,j=k&m.TextRenderingMode.FILL_STROKE_MASK,V=!!(k&m.TextRenderingMode.ADD_TO_PATH_FLAG),X=f.patternFill&&!b.missingFile;let Q;(b.disableFontFace||V||X)&&(Q=b.getPathGenerator(this.commonObjs,h)),b.disableFontFace||X?(s.save(),s.translate(r,v),s.beginPath(),Q(s,N),L&&s.setTransform(...L),(j===m.TextRenderingMode.FILL||j===m.TextRenderingMode.FILL_STROKE)&&s.fill(),(j===m.TextRenderingMode.STROKE||j===m.TextRenderingMode.FILL_STROKE)&&s.stroke(),s.restore()):((j===m.TextRenderingMode.FILL||j===m.TextRenderingMode.FILL_STROKE)&&s.fillText(h,r,v),(j===m.TextRenderingMode.STROKE||j===m.TextRenderingMode.FILL_STROKE)&&s.strokeText(h,r,v)),V&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,R.getCurrentTransform)(s),x:r,y:v,fontSize:N,addToPath:Q})}get isFontSubpixelAAEnabled(){const{context:h}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);h.scale(1.5,1),h.fillText("I",0,10);const r=h.getImageData(0,0,10,10).data;let v=!1;for(let L=3;L<r.length;L+=4)if(r[L]>0&&r[L]<255){v=!0;break}return(0,m.shadow)(this,"isFontSubpixelAAEnabled",v)}showText(h){const r=this.current,v=r.font;if(v.isType3Font)return this.showType3Text(h);const L=r.fontSize;if(L===0)return;const s=this.ctx,f=r.fontSizeScale,b=r.charSpacing,k=r.wordSpacing,N=r.fontDirection,j=r.textHScale*N,V=h.length,X=v.vertical,Q=X?1:-1,$=v.defaultVMetrics,te=L*r.fontMatrix[0],re=r.textRenderingMode===m.TextRenderingMode.FILL&&!v.disableFontFace&&!r.patternFill;s.save(),s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),N>0?s.scale(j,-1):s.scale(j,1);let G;if(r.patternFill){s.save();const oe=r.fillColor.getPattern(s,this,(0,R.getCurrentTransformInverse)(s),H.PathType.FILL);G=(0,R.getCurrentTransform)(s),s.restore(),s.fillStyle=oe}let ee=r.lineWidth;const ne=r.textMatrixScale;if(ne===0||ee===0){const oe=r.textRenderingMode&m.TextRenderingMode.FILL_STROKE_MASK;(oe===m.TextRenderingMode.STROKE||oe===m.TextRenderingMode.FILL_STROKE)&&(ee=this.getSinglePixelWidth())}else ee/=ne;if(f!==1&&(s.scale(f,f),ee/=f),s.lineWidth=ee,v.isInvalidPDFjsFont){const oe=[];let ce=0;for(const he of h)oe.push(he.unicode),ce+=he.width;s.fillText(oe.join(""),0,0),r.x+=ce*te*j,s.restore(),this.compose();return}let Z=0,ae;for(ae=0;ae<V;++ae){const oe=h[ae];if(typeof oe=="number"){Z+=Q*oe*L/1e3;continue}let ce=!1;const he=(oe.isSpace?k:0)+b,fe=oe.fontChar,pe=oe.accent;let ue,Se,ye=oe.width;if(X){const _e=oe.vmetric||$,Ae=-(oe.vmetric?_e[1]:ye*.5)*te,Re=_e[2]*te;ye=_e?-_e[0]:ye,ue=Ae/f,Se=(Z+Re)/f}else ue=Z/f,Se=0;if(v.remeasure&&ye>0){const _e=s.measureText(fe).width*1e3/L*f;if(ye<_e&&this.isFontSubpixelAAEnabled){const Ae=ye/_e;ce=!0,s.save(),s.scale(Ae,1),ue/=Ae}else ye!==_e&&(ue+=(ye-_e)/2e3*L/f)}if(this.contentVisible&&(oe.isInFont||v.missingFile)){if(re&&!pe)s.fillText(fe,ue,Se);else if(this.paintChar(fe,ue,Se,G),pe){const _e=ue+L*pe.offset.x/f,Ae=Se-L*pe.offset.y/f;this.paintChar(pe.fontChar,_e,Ae,G)}}let xe;X?xe=ye*te-he*N:xe=ye*te+he*N,Z+=xe,ce&&s.restore()}X?r.y-=Z:r.x+=Z*j,s.restore(),this.compose()}showType3Text(h){const r=this.ctx,v=this.current,L=v.font,s=v.fontSize,f=v.fontDirection,b=L.vertical?1:-1,k=v.charSpacing,N=v.wordSpacing,j=v.textHScale*f,V=v.fontMatrix||m.FONT_IDENTITY_MATRIX,X=h.length,Q=v.textRenderingMode===m.TextRenderingMode.INVISIBLE;let $,te,re,G;if(!(Q||s===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,r.save(),r.transform(...v.textMatrix),r.translate(v.x,v.y),r.scale(j,f),$=0;$<X;++$){if(te=h[$],typeof te=="number"){G=b*te*s/1e3,this.ctx.translate(G,0),v.x+=G*j;continue}const ee=(te.isSpace?N:0)+k,ne=L.charProcOperatorList[te.operatorListId];if(!ne){(0,m.warn)(`Type3 character "${te.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=te,this.save(),r.scale(s,s),r.transform(...V),this.executeOperatorList(ne),this.restore()),re=m.Util.applyTransform([te.width,0],V)[0]*s+ee,r.translate(re,0),v.x+=re*j}r.restore(),this.processingType3=null}}setCharWidth(h,r){}setCharWidthAndBounds(h,r,v,L,s,f){this.ctx.rect(v,L,s-v,f-L),this.ctx.clip(),this.endPath()}getColorN_Pattern(h){let r;if(h[0]==="TilingPattern"){const v=h[1],L=this.baseTransform||(0,R.getCurrentTransform)(this.ctx),s={createCanvasGraphics:f=>new C(f,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};r=new H.TilingPattern(h,v,this.ctx,s,L)}else r=this._getPattern(h[1],h[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(h,r,v){const L=m.Util.makeHexColor(h,r,v);this.ctx.strokeStyle=L,this.current.strokeColor=L}setFillRGBColor(h,r,v){const L=m.Util.makeHexColor(h,r,v);this.ctx.fillStyle=L,this.current.fillColor=L,this.current.patternFill=!1}_getPattern(h,r=null){let v;return this.cachedPatterns.has(h)?v=this.cachedPatterns.get(h):(v=(0,H.getShadingPattern)(this.getObject(h)),this.cachedPatterns.set(h,v)),r&&(v.matrix=r),v}shadingFill(h){if(!this.contentVisible)return;const r=this.ctx;this.save();const v=this._getPattern(h);r.fillStyle=v.getPattern(r,this,(0,R.getCurrentTransformInverse)(r),H.PathType.SHADING);const L=(0,R.getCurrentTransformInverse)(r);if(L){const s=r.canvas,f=s.width,b=s.height,k=m.Util.applyTransform([0,0],L),N=m.Util.applyTransform([0,b],L),j=m.Util.applyTransform([f,0],L),V=m.Util.applyTransform([f,b],L),X=Math.min(k[0],N[0],j[0],V[0]),Q=Math.min(k[1],N[1],j[1],V[1]),$=Math.max(k[0],N[0],j[0],V[0]),te=Math.max(k[1],N[1],j[1],V[1]);this.ctx.fillRect(X,Q,$-X,te-Q)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,m.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,m.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(h,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(h)&&h.length===6&&this.transform(...h),this.baseTransform=(0,R.getCurrentTransform)(this.ctx),r)){const v=r[2]-r[0],L=r[3]-r[1];this.ctx.rect(r[0],r[1],v,L),this.current.updateRectMinMax((0,R.getCurrentTransform)(this.ctx),r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(h){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;h.isolated||(0,m.info)("TODO: Support non-isolated groups."),h.knockout&&(0,m.warn)("Knockout groups not supported.");const v=(0,R.getCurrentTransform)(r);if(h.matrix&&r.transform(...h.matrix),!h.bbox)throw new Error("Bounding box is required.");let L=m.Util.getAxialAlignedBoundingBox(h.bbox,(0,R.getCurrentTransform)(r));const s=[0,0,r.canvas.width,r.canvas.height];L=m.Util.intersect(L,s)||[0,0,0,0];const f=Math.floor(L[0]),b=Math.floor(L[1]);let k=Math.max(Math.ceil(L[2])-f,1),N=Math.max(Math.ceil(L[3])-b,1),j=1,V=1;k>i&&(j=k/i,k=i),N>i&&(V=N/i,N=i),this.current.startNewPathAndClipBox([0,0,k,N]);let X="groupAt"+this.groupLevel;h.smask&&(X+="_smask_"+this.smaskCounter++%2);const Q=this.cachedCanvases.getCanvas(X,k,N),$=Q.context;$.scale(1/j,1/V),$.translate(-f,-b),$.transform(...v),h.smask?this.smaskStack.push({canvas:Q.canvas,context:$,offsetX:f,offsetY:b,scaleX:j,scaleY:V,subtype:h.smask.subtype,backdrop:h.smask.backdrop,transferMap:h.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(f,b),r.scale(j,V),r.save()),a(r,$),this.ctx=$,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(h){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,v=this.groupStack.pop();if(this.ctx=v,this.ctx.imageSmoothingEnabled=!1,h.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const L=(0,R.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...L);const s=m.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],L);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(h,r,v,L,s){if(this.#e(),T(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(r)&&r.length===4){const f=r[2]-r[0],b=r[3]-r[1];if(s&&this.annotationCanvasMap){v=v.slice(),v[4]-=r[0],v[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=f,r[3]=b;const[k,N]=m.Util.singularValueDecompose2dScale((0,R.getCurrentTransform)(this.ctx)),{viewportScale:j}=this,V=Math.ceil(f*this.outputScaleX*j),X=Math.ceil(b*this.outputScaleY*j);this.annotationCanvas=this.canvasFactory.create(V,X);const{canvas:Q,context:$}=this.annotationCanvas;this.annotationCanvasMap.set(h,Q),this.annotationCanvas.savedCtx=this.ctx,this.ctx=$,this.ctx.save(),this.ctx.setTransform(k,0,0,-N,0,b*N),T(this.ctx)}else T(this.ctx),this.ctx.rect(r[0],r[1],f,b),this.ctx.clip(),this.endPath()}this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...v),this.transform(...L)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(h){if(!this.contentVisible)return;const r=h.count;h=this.getObject(h.data,h),h.count=r;const v=this.ctx,L=this.processingType3;if(L&&(L.compiled===void 0&&(L.compiled=P(h)),L.compiled)){L.compiled(v);return}const s=this._createMaskCanvas(h),f=s.canvas;v.save(),v.setTransform(1,0,0,1,0,0),v.drawImage(f,s.offsetX,s.offsetY),v.restore(),this.compose()}paintImageMaskXObjectRepeat(h,r,v=0,L=0,s,f){if(!this.contentVisible)return;h=this.getObject(h.data,h);const b=this.ctx;b.save();const k=(0,R.getCurrentTransform)(b);b.transform(r,v,L,s,0,0);const N=this._createMaskCanvas(h);b.setTransform(1,0,0,1,N.offsetX-k[4],N.offsetY-k[5]);for(let j=0,V=f.length;j<V;j+=2){const X=m.Util.transform(k,[r,v,L,s,f[j],f[j+1]]),[Q,$]=m.Util.applyTransform([0,0],X);b.drawImage(N.canvas,Q,$)}b.restore(),this.compose()}paintImageMaskXObjectGroup(h){if(!this.contentVisible)return;const r=this.ctx,v=this.current.fillColor,L=this.current.patternFill;for(const s of h){const{data:f,width:b,height:k,transform:N}=s,j=this.cachedCanvases.getCanvas("maskCanvas",b,k),V=j.context;V.save();const X=this.getObject(f,s);e(V,X),V.globalCompositeOperation="source-in",V.fillStyle=L?v.getPattern(V,this,(0,R.getCurrentTransformInverse)(r),H.PathType.FILL):v,V.fillRect(0,0,b,k),V.restore(),r.save(),r.transform(...N),r.scale(1,-1),u(r,j.canvas,0,0,b,k,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(h){if(!this.contentVisible)return;const r=this.getObject(h);if(!r){(0,m.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(r)}paintImageXObjectRepeat(h,r,v,L){if(!this.contentVisible)return;const s=this.getObject(h);if(!s){(0,m.warn)("Dependent image isn't ready yet");return}const f=s.width,b=s.height,k=[];for(let N=0,j=L.length;N<j;N+=2)k.push({transform:[r,0,0,v,L[N],L[N+1]],x:0,y:0,w:f,h:b});this.paintInlineImageXObjectGroup(s,k)}applyTransferMapsToCanvas(h){return this.current.transferMaps!=="none"&&(h.filter=this.current.transferMaps,h.drawImage(h.canvas,0,0),h.filter="none"),h.canvas}applyTransferMapsToBitmap(h){if(this.current.transferMaps==="none")return h.bitmap;const{bitmap:r,width:v,height:L}=h,s=this.cachedCanvases.getCanvas("inlineImage",v,L),f=s.context;return f.filter=this.current.transferMaps,f.drawImage(r,0,0),f.filter="none",s.canvas}paintInlineImageXObject(h){if(!this.contentVisible)return;const r=h.width,v=h.height,L=this.ctx;this.save(),E.isNodeJS||(L.filter="none"),L.scale(1/r,-1/v);let s;if(h.bitmap)s=this.applyTransferMapsToBitmap(h);else if(typeof HTMLElement=="function"&&h instanceof HTMLElement||!h.data)s=h;else{const k=this.cachedCanvases.getCanvas("inlineImage",r,v).context;y(k,h),s=this.applyTransferMapsToCanvas(k)}const f=this._scaleImage(s,(0,R.getCurrentTransformInverse)(L));L.imageSmoothingEnabled=ie((0,R.getCurrentTransform)(L),h.interpolate),u(L,f.img,0,0,f.paintWidth,f.paintHeight,0,-v,r,v),this.compose(),this.restore()}paintInlineImageXObjectGroup(h,r){if(!this.contentVisible)return;const v=this.ctx;let L;if(h.bitmap)L=h.bitmap;else{const s=h.width,f=h.height,k=this.cachedCanvases.getCanvas("inlineImage",s,f).context;y(k,h),L=this.applyTransferMapsToCanvas(k)}for(const s of r)v.save(),v.transform(...s.transform),v.scale(1,-1),u(v,L,s.x,s.y,s.w,s.h,0,-1,1,1),v.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(h){}markPointProps(h,r){}beginMarkedContent(h){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(h,r){h==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(h){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(h);const v=this.ctx;this.pendingClip&&(r||(this.pendingClip===M?v.clip("evenodd"):v.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),v.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const h=(0,R.getCurrentTransform)(this.ctx);if(h[1]===0&&h[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(h[0]),Math.abs(h[3]));else{const r=Math.abs(h[0]*h[3]-h[2]*h[1]),v=Math.hypot(h[0],h[2]),L=Math.hypot(h[1],h[3]);this._cachedGetSinglePixelWidth=Math.max(v,L)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:h}=this.current,r=(0,R.getCurrentTransform)(this.ctx);let v,L;if(r[1]===0&&r[2]===0){const s=Math.abs(r[0]),f=Math.abs(r[3]);if(h===0)v=1/s,L=1/f;else{const b=s*h,k=f*h;v=b<1?1/b:1,L=k<1?1/k:1}}else{const s=Math.abs(r[0]*r[3]-r[2]*r[1]),f=Math.hypot(r[0],r[1]),b=Math.hypot(r[2],r[3]);if(h===0)v=b/s,L=f/s;else{const k=h*s;v=b>k?b/k:1,L=f>k?f/k:1}}this._cachedScaleForStroking=[v,L]}return this._cachedScaleForStroking}rescaleAndStroke(h){const{ctx:r}=this,{lineWidth:v}=this.current,[L,s]=this.getScaleForStroking();if(r.lineWidth=v||1,L===1&&s===1){r.stroke();return}let f,b,k;h&&(f=(0,R.getCurrentTransform)(r),b=r.getLineDash().slice(),k=r.lineDashOffset),r.scale(L,s);const N=Math.max(L,s);r.setLineDash(r.getLineDash().map(j=>j/N)),r.lineDashOffset/=N,r.stroke(),h&&(r.setTransform(...f),r.setLineDash(b),r.lineDashOffset=k)}isContentVisible(){for(let h=this.markedContentStack.length-1;h>=0;h--)if(!this.markedContentStack[h].visible)return!1;return!0}}o.CanvasGraphics=C;for(const A in m.OPS)C.prototype[A]!==void 0&&(C.prototype[m.OPS[A]]=C.prototype[A])}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TilingPattern=o.PathType=void 0,o.getShadingPattern=n;var m=F(1),R=F(6);const H={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};o.PathType=H;function D(c,u){if(!u)return;const P=u[2]-u[0],w=u[3]-u[1],y=new Path2D;y.rect(u[0],u[1],P,w),c.clip(y)}class E{constructor(){this.constructor===E&&(0,m.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,m.unreachable)("Abstract method `getPattern` called.")}}class S extends E{constructor(u){super(),this._type=u[1],this._bbox=u[2],this._colorStops=u[3],this._p0=u[4],this._p1=u[5],this._r0=u[6],this._r1=u[7],this.matrix=null}_createGradient(u){let P;this._type==="axial"?P=u.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(P=u.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const w of this._colorStops)P.addColorStop(w[0],w[1]);return P}getPattern(u,P,w,y){let e;if(y===H.STROKE||y===H.FILL){const a=P.current.getClippedPathBoundingBox(y,(0,R.getCurrentTransform)(u))||[0,0,0,0],T=Math.ceil(a[2]-a[0])||1,O=Math.ceil(a[3]-a[1])||1,x=P.cachedCanvases.getCanvas("pattern",T,O,!0),I=x.context;I.clearRect(0,0,I.canvas.width,I.canvas.height),I.beginPath(),I.rect(0,0,I.canvas.width,I.canvas.height),I.translate(-a[0],-a[1]),w=m.Util.transform(w,[1,0,0,1,a[0],a[1]]),I.transform(...P.baseTransform),this.matrix&&I.transform(...this.matrix),D(I,this._bbox),I.fillStyle=this._createGradient(I),I.fill(),e=u.createPattern(x.canvas,"no-repeat");const U=new DOMMatrix(w);e.setTransform(U)}else D(u,this._bbox),e=this._createGradient(u);return e}}function d(c,u,P,w,y,e,a,T){const O=u.coords,x=u.colors,I=c.data,U=c.width*4;let z;O[P+1]>O[w+1]&&(z=P,P=w,w=z,z=e,e=a,a=z),O[w+1]>O[y+1]&&(z=w,w=y,y=z,z=a,a=T,T=z),O[P+1]>O[w+1]&&(z=P,P=w,w=z,z=e,e=a,a=z);const ie=(O[P]+u.offsetX)*u.scaleX,J=(O[P+1]+u.offsetY)*u.scaleY,q=(O[w]+u.offsetX)*u.scaleX,W=(O[w+1]+u.offsetY)*u.scaleY,M=(O[y]+u.offsetX)*u.scaleX,C=(O[y+1]+u.offsetY)*u.scaleY;if(J>=C)return;const A=x[e],h=x[e+1],r=x[e+2],v=x[a],L=x[a+1],s=x[a+2],f=x[T],b=x[T+1],k=x[T+2],N=Math.round(J),j=Math.round(C);let V,X,Q,$,te,re,G,ee;for(let ne=N;ne<=j;ne++){if(ne<W){let he;ne<J?he=0:he=(J-ne)/(J-W),V=ie-(ie-q)*he,X=A-(A-v)*he,Q=h-(h-L)*he,$=r-(r-s)*he}else{let he;ne>C?he=1:W===C?he=0:he=(W-ne)/(W-C),V=q-(q-M)*he,X=v-(v-f)*he,Q=L-(L-b)*he,$=s-(s-k)*he}let Z;ne<J?Z=0:ne>C?Z=1:Z=(J-ne)/(J-C),te=ie-(ie-M)*Z,re=A-(A-f)*Z,G=h-(h-b)*Z,ee=r-(r-k)*Z;const ae=Math.round(Math.min(V,te)),oe=Math.round(Math.max(V,te));let ce=U*ne+ae*4;for(let he=ae;he<=oe;he++)Z=(V-he)/(V-te),Z<0?Z=0:Z>1&&(Z=1),I[ce++]=X-(X-re)*Z|0,I[ce++]=Q-(Q-G)*Z|0,I[ce++]=$-($-ee)*Z|0,I[ce++]=255}}function i(c,u,P){const w=u.coords,y=u.colors;let e,a;switch(u.type){case"lattice":const T=u.verticesPerRow,O=Math.floor(w.length/T)-1,x=T-1;for(e=0;e<O;e++){let I=e*T;for(let U=0;U<x;U++,I++)d(c,P,w[I],w[I+1],w[I+T],y[I],y[I+1],y[I+T]),d(c,P,w[I+T+1],w[I+1],w[I+T],y[I+T+1],y[I+1],y[I+T])}break;case"triangles":for(e=0,a=w.length;e<a;e+=3)d(c,P,w[e],w[e+1],w[e+2],y[e],y[e+1],y[e+2]);break;default:throw new Error("illegal figure")}}class _ extends E{constructor(u){super(),this._coords=u[2],this._colors=u[3],this._figures=u[4],this._bounds=u[5],this._bbox=u[7],this._background=u[8],this.matrix=null}_createMeshCanvas(u,P,w){const T=Math.floor(this._bounds[0]),O=Math.floor(this._bounds[1]),x=Math.ceil(this._bounds[2])-T,I=Math.ceil(this._bounds[3])-O,U=Math.min(Math.ceil(Math.abs(x*u[0]*1.1)),3e3),z=Math.min(Math.ceil(Math.abs(I*u[1]*1.1)),3e3),ie=x/U,J=I/z,q={coords:this._coords,colors:this._colors,offsetX:-T,offsetY:-O,scaleX:1/ie,scaleY:1/J},W=U+4,M=z+4,C=w.getCanvas("mesh",W,M,!1),A=C.context,h=A.createImageData(U,z);if(P){const v=h.data;for(let L=0,s=v.length;L<s;L+=4)v[L]=P[0],v[L+1]=P[1],v[L+2]=P[2],v[L+3]=255}for(const v of this._figures)i(h,v,q);return A.putImageData(h,2,2),{canvas:C.canvas,offsetX:T-2*ie,offsetY:O-2*J,scaleX:ie,scaleY:J}}getPattern(u,P,w,y){D(u,this._bbox);let e;if(y===H.SHADING)e=m.Util.singularValueDecompose2dScale((0,R.getCurrentTransform)(u));else if(e=m.Util.singularValueDecompose2dScale(P.baseTransform),this.matrix){const T=m.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*T[0],e[1]*T[1]]}const a=this._createMeshCanvas(e,y===H.SHADING?null:this._background,P.cachedCanvases);return y!==H.SHADING&&(u.setTransform(...P.baseTransform),this.matrix&&u.transform(...this.matrix)),u.translate(a.offsetX,a.offsetY),u.scale(a.scaleX,a.scaleY),u.createPattern(a.canvas,"no-repeat")}}class p extends E{getPattern(){return"hotpink"}}function n(c){switch(c[0]){case"RadialAxial":return new S(c);case"Mesh":return new _(c);case"Dummy":return new p}throw new Error(`Unknown IR type: ${c[0]}`)}const l={COLORED:1,UNCOLORED:2};class g{static MAX_PATTERN_SIZE=3e3;constructor(u,P,w,y,e){this.operatorList=u[2],this.matrix=u[3]||[1,0,0,1,0,0],this.bbox=u[4],this.xstep=u[5],this.ystep=u[6],this.paintType=u[7],this.tilingType=u[8],this.color=P,this.ctx=w,this.canvasGraphicsFactory=y,this.baseTransform=e}createPatternCanvas(u){const P=this.operatorList,w=this.bbox,y=this.xstep,e=this.ystep,a=this.paintType,T=this.tilingType,O=this.color,x=this.canvasGraphicsFactory;(0,m.info)("TilingType: "+T);const I=w[0],U=w[1],z=w[2],ie=w[3],J=m.Util.singularValueDecompose2dScale(this.matrix),q=m.Util.singularValueDecompose2dScale(this.baseTransform),W=[J[0]*q[0],J[1]*q[1]],M=this.getSizeAndScale(y,this.ctx.canvas.width,W[0]),C=this.getSizeAndScale(e,this.ctx.canvas.height,W[1]),A=u.cachedCanvases.getCanvas("pattern",M.size,C.size,!0),h=A.context,r=x.createCanvasGraphics(h);r.groupLevel=u.groupLevel,this.setFillAndStrokeStyleToContext(r,a,O);let v=I,L=U,s=z,f=ie;return I<0&&(v=0,s+=Math.abs(I)),U<0&&(L=0,f+=Math.abs(U)),h.translate(-(M.scale*v),-(C.scale*L)),r.transform(M.scale,0,0,C.scale,0,0),h.save(),this.clipBbox(r,v,L,s,f),r.baseTransform=(0,R.getCurrentTransform)(r.ctx),r.executeOperatorList(P),r.endDrawing(),{canvas:A.canvas,scaleX:M.scale,scaleY:C.scale,offsetX:v,offsetY:L}}getSizeAndScale(u,P,w){u=Math.abs(u);const y=Math.max(g.MAX_PATTERN_SIZE,P);let e=Math.ceil(u*w);return e>=y?e=y:w=e/u,{scale:w,size:e}}clipBbox(u,P,w,y,e){const a=y-P,T=e-w;u.ctx.rect(P,w,a,T),u.current.updateRectMinMax((0,R.getCurrentTransform)(u.ctx),[P,w,y,e]),u.clip(),u.endPath()}setFillAndStrokeStyleToContext(u,P,w){const y=u.ctx,e=u.current;switch(P){case l.COLORED:const a=this.ctx;y.fillStyle=a.fillStyle,y.strokeStyle=a.strokeStyle,e.fillColor=a.fillStyle,e.strokeColor=a.strokeStyle;break;case l.UNCOLORED:const T=m.Util.makeHexColor(w[0],w[1],w[2]);y.fillStyle=T,y.strokeStyle=T,e.fillColor=T,e.strokeColor=T;break;default:throw new m.FormatError(`Unsupported paint type: ${P}`)}}getPattern(u,P,w,y){let e=w;y!==H.SHADING&&(e=m.Util.transform(e,P.baseTransform),this.matrix&&(e=m.Util.transform(e,this.matrix)));const a=this.createPatternCanvas(P);let T=new DOMMatrix(e);T=T.translate(a.offsetX,a.offsetY),T=T.scale(1/a.scaleX,1/a.scaleY);const O=u.createPattern(a.canvas,"repeat");return O.setTransform(T),O}}o.TilingPattern=g}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.convertBlackAndWhiteToRGBA=H,o.convertToRGBA=R,o.grayToRGBA=E;var m=F(1);function R(S){switch(S.kind){case m.ImageKind.GRAYSCALE_1BPP:return H(S);case m.ImageKind.RGB_24BPP:return D(S)}return null}function H({src:S,srcPos:d=0,dest:i,width:_,height:p,nonBlackColor:n=4294967295,inverseDecode:l=!1}){const g=m.FeatureTest.isLittleEndian?4278190080:255,[c,u]=l?[n,g]:[g,n],P=_>>3,w=_&7,y=S.length;i=new Uint32Array(i.buffer);let e=0;for(let a=0;a<p;a++){for(const O=d+P;d<O;d++){const x=d<y?S[d]:255;i[e++]=x&128?u:c,i[e++]=x&64?u:c,i[e++]=x&32?u:c,i[e++]=x&16?u:c,i[e++]=x&8?u:c,i[e++]=x&4?u:c,i[e++]=x&2?u:c,i[e++]=x&1?u:c}if(w===0)continue;const T=d<y?S[d++]:255;for(let O=0;O<w;O++)i[e++]=T&1<<7-O?u:c}return{srcPos:d,destPos:e}}function D({src:S,srcPos:d=0,dest:i,destPos:_=0,width:p,height:n}){let l=0;const g=S.length>>2,c=new Uint32Array(S.buffer,d,g);if(m.FeatureTest.isLittleEndian){for(;l<g-2;l+=3,_+=4){const u=c[l],P=c[l+1],w=c[l+2];i[_]=u|4278190080,i[_+1]=u>>>24|P<<8|4278190080,i[_+2]=P>>>16|w<<16|4278190080,i[_+3]=w>>>8|4278190080}for(let u=l*4,P=S.length;u<P;u+=3)i[_++]=S[u]|S[u+1]<<8|S[u+2]<<16|4278190080}else{for(;l<g-2;l+=3,_+=4){const u=c[l],P=c[l+1],w=c[l+2];i[_]=u|255,i[_+1]=u<<24|P>>>8|255,i[_+2]=P<<16|w>>>16|255,i[_+3]=w<<8|255}for(let u=l*4,P=S.length;u<P;u+=3)i[_++]=S[u]<<24|S[u+1]<<16|S[u+2]<<8|255}return{srcPos:d,destPos:_}}function E(S,d){if(m.FeatureTest.isLittleEndian)for(let i=0,_=S.length;i<_;i++)d[i]=S[i]*65793|4278190080;else for(let i=0,_=S.length;i<_;i++)d[i]=S[i]*16843008|255}}),((B,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.GlobalWorkerOptions=void 0;const F=Object.create(null);o.GlobalWorkerOptions=F,F.workerPort=null,F.workerSrc=""}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.MessageHandler=void 0;var m=F(1);const R={DATA:1,ERROR:2},H={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function D(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,m.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new m.AbortException(S.message);case"MissingPDFException":return new m.MissingPDFException(S.message);case"PasswordException":return new m.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new m.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new m.UnknownErrorException(S.message,S.details);default:return new m.UnknownErrorException(S.message,S.toString())}}class E{constructor(d,i,_){this.sourceName=d,this.targetName=i,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=p=>{const n=p.data;if(n.targetName!==this.sourceName)return;if(n.stream){this.#t(n);return}if(n.callback){const g=n.callbackId,c=this.callbackCapabilities[g];if(!c)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],n.callback===R.DATA)c.resolve(n.data);else if(n.callback===R.ERROR)c.reject(D(n.reason));else throw new Error("Unexpected callback case");return}const l=this.actionHandler[n.action];if(!l)throw new Error(`Unknown action from worker: ${n.action}`);if(n.callbackId){const g=this.sourceName,c=n.sourceName;new Promise(function(u){u(l(n.data))}).then(function(u){_.postMessage({sourceName:g,targetName:c,callback:R.DATA,callbackId:n.callbackId,data:u})},function(u){_.postMessage({sourceName:g,targetName:c,callback:R.ERROR,callbackId:n.callbackId,reason:D(u)})});return}if(n.streamId){this.#e(n);return}l(n.data)},_.addEventListener("message",this._onComObjOnMessage)}on(d,i){const _=this.actionHandler;if(_[d])throw new Error(`There is already an actionName called "${d}"`);_[d]=i}send(d,i,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,data:i},_)}sendWithPromise(d,i,_){const p=this.callbackId++,n=new m.PromiseCapability;this.callbackCapabilities[p]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,callbackId:p,data:i},_)}catch(l){n.reject(l)}return n.promise}sendWithStream(d,i,_,p){const n=this.streamId++,l=this.sourceName,g=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const P=new m.PromiseCapability;return this.streamControllers[n]={controller:u,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:l,targetName:g,action:d,streamId:n,data:i,desiredSize:u.desiredSize},p),P.promise},pull:u=>{const P=new m.PromiseCapability;return this.streamControllers[n].pullCall=P,c.postMessage({sourceName:l,targetName:g,stream:H.PULL,streamId:n,desiredSize:u.desiredSize}),P.promise},cancel:u=>{(0,m.assert)(u instanceof Error,"cancel must have a valid reason");const P=new m.PromiseCapability;return this.streamControllers[n].cancelCall=P,this.streamControllers[n].isClosed=!0,c.postMessage({sourceName:l,targetName:g,stream:H.CANCEL,streamId:n,reason:D(u)}),P.promise}},_)}#e(d){const i=d.streamId,_=this.sourceName,p=d.sourceName,n=this.comObj,l=this,g=this.actionHandler[d.action],c={enqueue(u,P=1,w){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=P,y>0&&this.desiredSize<=0&&(this.sinkCapability=new m.PromiseCapability,this.ready=this.sinkCapability.promise),n.postMessage({sourceName:_,targetName:p,stream:H.ENQUEUE,streamId:i,chunk:u},w)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:_,targetName:p,stream:H.CLOSE,streamId:i}),delete l.streamSinks[i])},error(u){(0,m.assert)(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:_,targetName:p,stream:H.ERROR,streamId:i,reason:D(u)}))},sinkCapability:new m.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:d.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[i]=c,new Promise(function(u){u(g(d.data,c))}).then(function(){n.postMessage({sourceName:_,targetName:p,stream:H.START_COMPLETE,streamId:i,success:!0})},function(u){n.postMessage({sourceName:_,targetName:p,stream:H.START_COMPLETE,streamId:i,reason:D(u)})})}#t(d){const i=d.streamId,_=this.sourceName,p=d.sourceName,n=this.comObj,l=this.streamControllers[i],g=this.streamSinks[i];switch(d.stream){case H.START_COMPLETE:d.success?l.startCall.resolve():l.startCall.reject(D(d.reason));break;case H.PULL_COMPLETE:d.success?l.pullCall.resolve():l.pullCall.reject(D(d.reason));break;case H.PULL:if(!g){n.postMessage({sourceName:_,targetName:p,stream:H.PULL_COMPLETE,streamId:i,success:!0});break}g.desiredSize<=0&&d.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=d.desiredSize,new Promise(function(c){c(g.onPull?.())}).then(function(){n.postMessage({sourceName:_,targetName:p,stream:H.PULL_COMPLETE,streamId:i,success:!0})},function(c){n.postMessage({sourceName:_,targetName:p,stream:H.PULL_COMPLETE,streamId:i,reason:D(c)})});break;case H.ENQUEUE:if((0,m.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(d.chunk);break;case H.CLOSE:if((0,m.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#i(l,i);break;case H.ERROR:(0,m.assert)(l,"error should have stream controller"),l.controller.error(D(d.reason)),this.#i(l,i);break;case H.CANCEL_COMPLETE:d.success?l.cancelCall.resolve():l.cancelCall.reject(D(d.reason)),this.#i(l,i);break;case H.CANCEL:if(!g)break;new Promise(function(c){c(g.onCancel?.(D(d.reason)))}).then(function(){n.postMessage({sourceName:_,targetName:p,stream:H.CANCEL_COMPLETE,streamId:i,success:!0})},function(c){n.postMessage({sourceName:_,targetName:p,stream:H.CANCEL_COMPLETE,streamId:i,reason:D(c)})}),g.sinkCapability.reject(D(d.reason)),g.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#i(d,i){await Promise.allSettled([d.startCall?.promise,d.pullCall?.promise,d.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}o.MessageHandler=E}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Metadata=void 0;var m=F(1);class R{#e;#t;constructor({parsedData:D,rawData:E}){this.#e=D,this.#t=E}getRaw(){return this.#t}get(D){return this.#e.get(D)??null}getAll(){return(0,m.objectFromMap)(this.#e)}has(D){return this.#e.has(D)}}o.Metadata=R}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionalContentConfig=void 0;var m=F(1),R=F(8);const H=Symbol("INTERNAL");class D{#e=!0;constructor(d,i){this.name=d,this.intent=i}get visible(){return this.#e}_setVisible(d,i){d!==H&&(0,m.unreachable)("Internal method `_setVisible` called."),this.#e=i}}class E{#e=null;#t=new Map;#i=null;#n=null;constructor(d){if(this.name=null,this.creator=null,d!==null){this.name=d.name,this.creator=d.creator,this.#n=d.order;for(const i of d.groups)this.#t.set(i.id,new D(i.name,i.intent));if(d.baseState==="OFF")for(const i of this.#t.values())i._setVisible(H,!1);for(const i of d.on)this.#t.get(i)._setVisible(H,!0);for(const i of d.off)this.#t.get(i)._setVisible(H,!1);this.#i=this.getHash()}}#s(d){const i=d.length;if(i<2)return!0;const _=d[0];for(let p=1;p<i;p++){const n=d[p];let l;if(Array.isArray(n))l=this.#s(n);else if(this.#t.has(n))l=this.#t.get(n).visible;else return(0,m.warn)(`Optional content group not found: ${n}`),!0;switch(_){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return _==="And"}isVisible(d){if(this.#t.size===0)return!0;if(!d)return(0,m.warn)("Optional content group not defined."),!0;if(d.type==="OCG")return this.#t.has(d.id)?this.#t.get(d.id).visible:((0,m.warn)(`Optional content group not found: ${d.id}`),!0);if(d.type==="OCMD"){if(d.expression)return this.#s(d.expression);if(!d.policy||d.policy==="AnyOn"){for(const i of d.ids){if(!this.#t.has(i))return(0,m.warn)(`Optional content group not found: ${i}`),!0;if(this.#t.get(i).visible)return!0}return!1}else if(d.policy==="AllOn"){for(const i of d.ids){if(!this.#t.has(i))return(0,m.warn)(`Optional content group not found: ${i}`),!0;if(!this.#t.get(i).visible)return!1}return!0}else if(d.policy==="AnyOff"){for(const i of d.ids){if(!this.#t.has(i))return(0,m.warn)(`Optional content group not found: ${i}`),!0;if(!this.#t.get(i).visible)return!0}return!1}else if(d.policy==="AllOff"){for(const i of d.ids){if(!this.#t.has(i))return(0,m.warn)(`Optional content group not found: ${i}`),!0;if(this.#t.get(i).visible)return!1}return!0}return(0,m.warn)(`Unknown optional content policy ${d.policy}.`),!0}return(0,m.warn)(`Unknown group type ${d.type}.`),!0}setVisibility(d,i=!0){if(!this.#t.has(d)){(0,m.warn)(`Optional content group not found: ${d}`);return}this.#t.get(d)._setVisible(H,!!i),this.#e=null}get hasInitialVisibility(){return this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,m.objectFromMap)(this.#t):null}getGroup(d){return this.#t.get(d)||null}getHash(){if(this.#e!==null)return this.#e;const d=new R.MurmurHash3_64;for(const[i,_]of this.#t)d.update(`${i}:${_.visible}`);return this.#e=d.hexdigest()}}o.OptionalContentConfig=E}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFDataTransportStream=void 0;var m=F(1),R=F(6);class H{constructor({length:d,initialData:i,progressiveDone:_=!1,contentDispositionFilename:p=null,disableRange:n=!1,disableStream:l=!1},g){if((0,m.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=_,this._contentDispositionFilename=p,i?.length>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!l,this._isRangeSupported=!n,this._contentLength=d,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:d,chunk:i}){const _=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(d===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(_):this._queuedChunks.push(_);else{const p=this._rangeReaders.some(function(n){return n._begin!==d?!1:(n._enqueue(_),!0)});(0,m.assert)(p,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(d){d.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:d.loaded}):this._fullRequestReader?.onProgress?.({loaded:d.loaded,total:d.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(d){const i=this._rangeReaders.indexOf(d);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){(0,m.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const d=this._queuedChunks;return this._queuedChunks=null,new D(this,d,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(d,i){if(i<=this._progressiveDataLength)return null;const _=new E(this,d,i);return this._pdfDataRangeTransport.requestDataRange(d,i),this._rangeReaders.push(_),_}cancelAllRequests(d){this._fullRequestReader?.cancel(d);for(const i of this._rangeReaders.slice(0))i.cancel(d);this._pdfDataRangeTransport.abort()}}o.PDFDataTransportStream=H;class D{constructor(d,i,_=!1,p=null){this._stream=d,this._done=_||!1,this._filename=(0,R.isPdfFile)(p)?p:null,this._queuedChunks=i||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),d._fullRequestReader=this,this.onProgress=null}_enqueue(d){this._done||(this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunks.push(d),this._loaded+=d.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const d=new m.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class E{constructor(d,i,_){this._stream=d,this._begin=i,this._end=_,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(d){if(!this._done){if(this._requests.length===0)this._queuedChunk=d;else{this._requests.shift().resolve({value:d,done:!1});for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const d=new m.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((B,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaText=void 0;class F{static textContent(R){const H=[],D={items:H,styles:Object.create(null)};function E(S){if(!S)return;let d=null;const i=S.name;if(i==="#text")d=S.value;else if(F.shouldBuildText(i))S?.attributes?.textContent?d=S.attributes.textContent:S.value&&(d=S.value);else return;if(d!==null&&H.push({str:d}),!!S.children)for(const _ of S.children)E(_)}return E(R),D}static shouldBuildText(R){return!(R==="textarea"||R==="input"||R==="option"||R==="select")}}o.XfaText=F}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.NodeStandardFontDataFactory=o.NodeFilterFactory=o.NodeCanvasFactory=o.NodeCMapReaderFactory=void 0;var m=F(7);const R=function(d){return new Promise((i,_)=>{require$$5.readFile(d,(n,l)=>{if(n||!l){_(new Error(n));return}i(new Uint8Array(l))})})};class H extends m.BaseFilterFactory{}o.NodeFilterFactory=H;class D extends m.BaseCanvasFactory{_createCanvas(i,_){return require$$5.createCanvas(i,_)}}o.NodeCanvasFactory=D;class E extends m.BaseCMapReaderFactory{_fetchData(i,_){return R(i).then(p=>({cMapData:p,compressionType:_}))}}o.NodeCMapReaderFactory=E;class S extends m.BaseStandardFontDataFactory{_fetchData(i){return R(i)}}o.NodeStandardFontDataFactory=S}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNodeStream=void 0;var m=F(1),R=F(22);const H=require$$5,D=require$$5,E=require$$5,S=require$$5,d=/^file:\/\/\/[a-zA-Z]:\//;function i(w){const y=S.parse(w);return y.protocol==="file:"||y.host?y:/^[a-z]:[/\\]/i.test(w)?S.parse(`file:///${w}`):(y.host||(y.protocol="file:"),y)}class _{constructor(y){this.source=y,this.url=i(y.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&y.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new u(this):new g(this),this._fullRequestReader}getRangeReader(y,e){if(e<=this._progressiveDataLength)return null;const a=this.isFsUrl?new P(this,y,e):new c(this,y,e);return this._rangeRequestReaders.push(a),a}cancelAllRequests(y){this._fullRequestReader?.cancel(y);for(const e of this._rangeRequestReaders.slice(0))e.cancel(y)}}o.PDFNodeStream=_;class p{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=y.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=new m.PromiseCapability,this._headersCapability=new m.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=new m.PromiseCapability,this.read()):(this._loaded+=y.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new m.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class n{constructor(y){this._url=y.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new m.PromiseCapability;const e=y.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const y=this._readableStream.read();return y===null?(this._readCapability=new m.PromiseCapability,this.read()):(this._loaded+=y.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(y).buffer,done:!1})}cancel(y){if(!this._readableStream){this._error(y);return}this._readableStream.destroy(y)}_error(y){this._storedError=y,this._readCapability.resolve()}_setReadableStream(y){this._readableStream=y,y.on("readable",()=>{this._readCapability.resolve()}),y.on("end",()=>{y.destroy(),this._done=!0,this._readCapability.resolve()}),y.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(w,y){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:y}}class g extends p{constructor(y){super(y);const e=a=>{if(a.statusCode===404){const I=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=I,this._headersCapability.reject(I);return}this._headersCapability.resolve(),this._setReadableStream(a);const T=I=>this._readableStream.headers[I.toLowerCase()],{allowRangeRequests:O,suggestedLength:x}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:y.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=O,this._contentLength=x||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(T)};this._request=null,this._url.protocol==="http:"?this._request=D.request(l(this._url,y.httpHeaders),e):this._request=E.request(l(this._url,y.httpHeaders),e),this._request.on("error",a=>{this._storedError=a,this._headersCapability.reject(a)}),this._request.end()}}class c extends n{constructor(y,e,a){super(y),this._httpHeaders={};for(const O in y.httpHeaders){const x=y.httpHeaders[O];x!==void 0&&(this._httpHeaders[O]=x)}this._httpHeaders.Range=`bytes=${e}-${a-1}`;const T=O=>{if(O.statusCode===404){const x=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=x;return}this._setReadableStream(O)};this._request=null,this._url.protocol==="http:"?this._request=D.request(l(this._url,this._httpHeaders),T):this._request=E.request(l(this._url,this._httpHeaders),T),this._request.on("error",O=>{this._storedError=O}),this._request.end()}}class u extends p{constructor(y){super(y);let e=decodeURIComponent(this._url.path);d.test(this._url.href)&&(e=e.replace(/^\//,"")),H.lstat(e,(a,T)=>{if(a){a.code==="ENOENT"&&(a=new m.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=a,this._headersCapability.reject(a);return}this._contentLength=T.size,this._setReadableStream(H.createReadStream(e)),this._headersCapability.resolve()})}}class P extends n{constructor(y,e,a){super(y);let T=decodeURIComponent(this._url.path);d.test(this._url.href)&&(T=T.replace(/^\//,"")),this._setReadableStream(H.createReadStream(T,{start:e,end:a-1}))}}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createResponseStatusError=S,o.extractFilenameFromHeader=E,o.validateRangeRequestCapabilities=D,o.validateResponseStatus=d;var m=F(1),R=F(23),H=F(6);function D({getResponseHeader:i,isHttp:_,rangeChunkSize:p,disableRange:n}){const l={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(i("Content-Length"),10);return!Number.isInteger(g)||(l.suggestedLength=g,g<=2*p)||n||!_||i("Accept-Ranges")!=="bytes"||(i("Content-Encoding")||"identity")!=="identity"||(l.allowRangeRequests=!0),l}function E(i){const _=i("Content-Disposition");if(_){let p=(0,R.getFilenameFromContentDispositionHeader)(_);if(p.includes("%"))try{p=decodeURIComponent(p)}catch{}if((0,H.isPdfFile)(p))return p}return null}function S(i,_){return i===404||i===0&&_.startsWith("file:")?new m.MissingPDFException('Missing PDF "'+_+'".'):new m.UnexpectedResponseException(`Unexpected server response (${i}) while retrieving PDF "${_}".`,i)}function d(i){return i===200||i===206}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getFilenameFromContentDispositionHeader=R;var m=F(1);function R(H){let D=!0,E=S("filename\\*","i").exec(H);if(E){E=E[1];let g=p(E);return g=unescape(g),g=n(g),g=l(g),i(g)}if(E=_(H),E){const g=l(E);return i(g)}if(E=S("filename","i").exec(H),E){E=E[1];let g=p(E);return g=l(g),i(g)}function S(g,c){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',c)}function d(g,c){if(g){if(!/^[\x00-\xFF]+$/.test(c))return c;try{const u=new TextDecoder(g,{fatal:!0}),P=(0,m.stringToBytes)(c);c=u.decode(P),D=!1}catch{}}return c}function i(g){return D&&/[\x80-\xff]/.test(g)&&(g=d("utf-8",g),D&&(g=d("iso-8859-1",g))),g}function _(g){const c=[];let u;const P=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=P.exec(g))!==null;){let[,y,e,a]=u;if(y=parseInt(y,10),y in c){if(y===0)break;continue}c[y]=[e,a]}const w=[];for(let y=0;y<c.length&&y in c;++y){let[e,a]=c[y];a=p(a),e&&(a=unescape(a),y===0&&(a=n(a))),w.push(a)}return w.join("")}function p(g){if(g.startsWith('"')){const c=g.slice(1).split('\\"');for(let u=0;u<c.length;++u){const P=c[u].indexOf('"');P!==-1&&(c[u]=c[u].slice(0,P),c.length=u+1),c[u]=c[u].replaceAll(/\\(.)/g,"$1")}g=c.join('"')}return g}function n(g){const c=g.indexOf("'");if(c===-1)return g;const u=g.slice(0,c),w=g.slice(c+1).replace(/^[^']*'/,"");return d(u,w)}function l(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(c,u,P,w){if(P==="q"||P==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,e){return String.fromCharCode(parseInt(e,16))}),d(u,w);try{w=atob(w)}catch{}return d(u,w)})}return""}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFNetworkStream=void 0;var m=F(1),R=F(22);const H=200,D=206;function E(p){const n=p.response;return typeof n!="string"?n:(0,m.stringToBytes)(n).buffer}class S{constructor(n,l={}){this.url=n,this.isHttp=/^https?:/i.test(n),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(n,l,g){const c={begin:n,end:l};for(const u in g)c[u]=g[u];return this.request(c)}requestFull(n){return this.request(n)}request(n){const l=new XMLHttpRequest,g=this.currXhrId++,c=this.pendingRequests[g]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const P=this.httpHeaders[u];P!==void 0&&l.setRequestHeader(u,P)}return this.isHttp&&"begin"in n&&"end"in n?(l.setRequestHeader("Range",`bytes=${n.begin}-${n.end-1}`),c.expectedStatus=D):c.expectedStatus=H,l.responseType="arraybuffer",n.onError&&(l.onerror=function(u){n.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,g),l.onprogress=this.onProgress.bind(this,g),c.onHeadersReceived=n.onHeadersReceived,c.onDone=n.onDone,c.onError=n.onError,c.onProgress=n.onProgress,l.send(null),g}onProgress(n,l){const g=this.pendingRequests[n];g&&g.onProgress?.(l)}onStateChange(n,l){const g=this.pendingRequests[n];if(!g)return;const c=g.xhr;if(c.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),c.readyState!==4||!(n in this.pendingRequests))return;if(delete this.pendingRequests[n],c.status===0&&this.isHttp){g.onError?.(c.status);return}const u=c.status||H;if(!(u===H&&g.expectedStatus===D)&&u!==g.expectedStatus){g.onError?.(c.status);return}const w=E(c);if(u===D){const y=c.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(y);g.onDone({begin:parseInt(e[1],10),chunk:w})}else w?g.onDone({begin:0,chunk:w}):g.onError?.(c.status)}getRequestXhr(n){return this.pendingRequests[n].xhr}isPendingRequest(n){return n in this.pendingRequests}abortRequest(n){const l=this.pendingRequests[n].xhr;delete this.pendingRequests[n],l.abort()}}class d{constructor(n){this._source=n,this._manager=new S(n.url,{httpHeaders:n.httpHeaders,withCredentials:n.withCredentials}),this._rangeChunkSize=n.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(n){const l=this._rangeRequestReaders.indexOf(n);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new i(this._manager,this._source),this._fullRequestReader}getRangeReader(n,l){const g=new _(this._manager,n,l);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(n){this._fullRequestReader?.cancel(n);for(const l of this._rangeRequestReaders.slice(0))l.cancel(n)}}o.PDFNetworkStream=d;class i{constructor(n,l){this._manager=n;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=n.requestFull(g),this._headersReceivedCapability=new m.PromiseCapability,this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const n=this._fullRequestId,l=this._manager.getRequestXhr(n),g=P=>l.getResponseHeader(P),{allowRangeRequests:c,suggestedLength:u}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});c&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(n),this._headersReceivedCapability.resolve()}_onDone(n){if(n&&(this._requests.length>0?this._requests.shift().resolve({value:n.chunk,done:!1}):this._cachedChunks.push(n.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(n){this._storedError=(0,R.createResponseStatusError)(n,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(n){this.onProgress?.({loaded:n.loaded,total:n.lengthComputable?n.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const n=new m.PromiseCapability;return this._requests.push(n),n.promise}cancel(n){this._done=!0,this._headersReceivedCapability.reject(n);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _{constructor(n,l,g){this._manager=n;const c={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=n.url,this._requestId=n.requestRange(l,g,c),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(n){const l=n.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(n){this._storedError=(0,R.createResponseStatusError)(n,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(n){this.isStreamingSupported||this.onProgress?.({loaded:n.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const l=this._queuedChunk;return this._queuedChunk=null,{value:l,done:!1}}if(this._done)return{value:void 0,done:!0};const n=new m.PromiseCapability;return this._requests.push(n),n.promise}cancel(n){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PDFFetchStream=void 0;var m=F(1),R=F(22);function H(_,p,n){return{method:"GET",headers:_,signal:n.signal,mode:"cors",credentials:p?"include":"same-origin",redirect:"follow"}}function D(_){const p=new Headers;for(const n in _){const l=_[n];l!==void 0&&p.append(n,l)}return p}function E(_){return _ instanceof Uint8Array?_.buffer:_ instanceof ArrayBuffer?_:((0,m.warn)(`getArrayBuffer - unexpected data format: ${_}`),new Uint8Array(_).buffer)}class S{constructor(p){this.source=p,this.isHttp=/^https?:/i.test(p.url),this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d(this),this._fullRequestReader}getRangeReader(p,n){if(n<=this._progressiveDataLength)return null;const l=new i(this,p,n);return this._rangeRequestReaders.push(l),l}cancelAllRequests(p){this._fullRequestReader?.cancel(p);for(const n of this._rangeRequestReaders.slice(0))n.cancel(p)}}o.PDFFetchStream=S;class d{constructor(p){this._stream=p,this._reader=null,this._loaded=0,this._filename=null;const n=p.source;this._withCredentials=n.withCredentials||!1,this._contentLength=n.length,this._headersCapability=new m.PromiseCapability,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._headers=D(this._stream.httpHeaders);const l=n.url;fetch(l,H(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,R.validateResponseStatus)(g.status))throw(0,R.createResponseStatusError)(g.status,l);this._reader=g.body.getReader(),this._headersCapability.resolve();const c=w=>g.headers.get(w),{allowRangeRequests:u,suggestedLength:P}=(0,R.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=P||this._contentLength,this._filename=(0,R.extractFilenameFromHeader)(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new m.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:p,done:n}=await this._reader.read();return n?{value:p,done:n}:(this._loaded+=p.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:E(p),done:!1})}cancel(p){this._reader?.cancel(p),this._abortController.abort()}}class i{constructor(p,n,l){this._stream=p,this._reader=null,this._loaded=0;const g=p.source;this._withCredentials=g.withCredentials||!1,this._readCapability=new m.PromiseCapability,this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=D(this._stream.httpHeaders),this._headers.append("Range",`bytes=${n}-${l-1}`);const c=g.url;fetch(c,H(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,R.validateResponseStatus)(u.status))throw(0,R.createResponseStatusError)(u.status,c);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:p,done:n}=await this._reader.read();return n?{value:p,done:n}:(this._loaded+=p.byteLength,this.onProgress?.({loaded:this._loaded}),{value:E(p),done:!1})}cancel(p){this._reader?.cancel(p),this._abortController.abort()}}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TextLayerRenderTask=void 0,o.renderTextLayer=g,o.updateTextLayer=c;var m=F(1),R=F(6);const H=1e5,D=30,E=.8,S=new Map;function d(u,P){let w;if(P&&m.FeatureTest.isOffscreenCanvasSupported)w=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const y=document.createElement("canvas");y.width=y.height=u,w=y.getContext("2d",{alpha:!1})}return w}function i(u,P){const w=S.get(u);if(w)return w;const y=d(D,P);y.font=`${D}px ${u}`;const e=y.measureText("");let a=e.fontBoundingBoxAscent,T=Math.abs(e.fontBoundingBoxDescent);if(a){const x=a/(a+T);return S.set(u,x),y.canvas.width=y.canvas.height=0,x}y.strokeStyle="red",y.clearRect(0,0,D,D),y.strokeText("g",0,0);let O=y.getImageData(0,0,D,D).data;T=0;for(let x=O.length-1-3;x>=0;x-=4)if(O[x]>0){T=Math.ceil(x/4/D);break}y.clearRect(0,0,D,D),y.strokeText("A",0,D),O=y.getImageData(0,0,D,D).data,a=0;for(let x=0,I=O.length;x<I;x+=4)if(O[x]>0){a=D-Math.floor(x/4/D);break}if(y.canvas.width=y.canvas.height=0,a){const x=a/(a+T);return S.set(u,x),x}return S.set(u,E),E}function _(u,P,w){const y=document.createElement("span"),e={angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,fontSize:0};u._textDivs.push(y);const a=m.Util.transform(u._transform,P.transform);let T=Math.atan2(a[1],a[0]);const O=w[P.fontName];O.vertical&&(T+=Math.PI/2);const x=Math.hypot(a[2],a[3]),I=x*i(O.fontFamily,u._isOffscreenCanvasSupported);let U,z;T===0?(U=a[4],z=a[5]-I):(U=a[4]+I*Math.sin(T),z=a[5]-I*Math.cos(T));const ie="calc(var(--scale-factor)*",J=y.style;u._container===u._rootContainer?(J.left=`${(100*U/u._pageWidth).toFixed(2)}%`,J.top=`${(100*z/u._pageHeight).toFixed(2)}%`):(J.left=`${ie}${U.toFixed(2)}px)`,J.top=`${ie}${z.toFixed(2)}px)`),J.fontSize=`${ie}${x.toFixed(2)}px)`,J.fontFamily=O.fontFamily,e.fontSize=x,y.setAttribute("role","presentation"),y.textContent=P.str,y.dir=P.dir,u._fontInspectorEnabled&&(y.dataset.fontName=P.fontName),T!==0&&(e.angle=T*(180/Math.PI));let q=!1;if(P.str.length>1)q=!0;else if(P.str!==" "&&P.transform[0]!==P.transform[3]){const W=Math.abs(P.transform[0]),M=Math.abs(P.transform[3]);W!==M&&Math.max(W,M)/Math.min(W,M)>1.5&&(q=!0)}q&&(e.canvasWidth=O.vertical?P.height:P.width),u._textDivProperties.set(y,e),u._isReadableStream&&u._layoutText(y)}function p(u){const{div:P,scale:w,properties:y,ctx:e,prevFontSize:a,prevFontFamily:T}=u,{style:O}=P;let x="";if(y.canvasWidth!==0&&y.hasText){const{fontFamily:I}=O,{canvasWidth:U,fontSize:z}=y;(a!==z||T!==I)&&(e.font=`${z*w}px ${I}`,u.prevFontSize=z,u.prevFontFamily=I);const{width:ie}=e.measureText(P.textContent);ie>0&&(x=`scaleX(${U*w/ie})`)}y.angle!==0&&(x=`rotate(${y.angle}deg) ${x}`),x.length>0&&(O.transform=x)}function n(u){if(u._canceled)return;const P=u._textDivs,w=u._capability;if(P.length>H){w.resolve();return}if(!u._isReadableStream)for(const e of P)u._layoutText(e);w.resolve()}class l{constructor({textContentSource:P,container:w,viewport:y,textDivs:e,textDivProperties:a,textContentItemsStr:T,isOffscreenCanvasSupported:O}){this._textContentSource=P,this._isReadableStream=P instanceof ReadableStream,this._container=this._rootContainer=w,this._textDivs=e||[],this._textContentItemsStr=T||[],this._isOffscreenCanvasSupported=O,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=a||new WeakMap,this._canceled=!1,this._capability=new m.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:d(0,O)};const{pageWidth:x,pageHeight:I,pageX:U,pageY:z}=y.rawDims;this._transform=[1,0,0,-1,-U,z+I],this._pageWidth=x,this._pageHeight=I,(0,R.setLayerDimensions)(w,y),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new m.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new m.AbortException("TextLayer task cancelled."))}_processItems(P,w){for(const y of P){if(y.str===void 0){if(y.type==="beginMarkedContentProps"||y.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),y.id!==null&&this._container.setAttribute("id",`${y.id}`),e.append(this._container)}else y.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(y.str),_(this,y,w)}}_layoutText(P){const w=this._layoutTextParams.properties=this._textDivProperties.get(P);if(this._layoutTextParams.div=P,p(this._layoutTextParams),w.hasText&&this._container.append(P),w.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(){const P=new m.PromiseCapability;let w=Object.create(null);if(this._isReadableStream){const y=()=>{this._reader.read().then(({value:e,done:a})=>{if(a){P.resolve();return}Object.assign(w,e.styles),this._processItems(e.items,w),y()},P.reject)};this._reader=this._textContentSource.getReader(),y()}else if(this._textContentSource){const{items:y,styles:e}=this._textContentSource;this._processItems(y,e),P.resolve()}else throw new Error('No "textContentSource" parameter specified.');P.promise.then(()=>{w=null,n(this)},this._capability.reject)}}o.TextLayerRenderTask=l;function g(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,R.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:P,viewport:w}=u,y=getComputedStyle(P),e=y.getPropertyValue("visibility"),a=parseFloat(y.getPropertyValue("--scale-factor"));e==="visible"&&(!a||Math.abs(a-w.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const T=new l(u);return T._render(),T}function c({container:u,viewport:P,textDivs:w,textDivProperties:y,isOffscreenCanvasSupported:e,mustRotate:a=!0,mustRescale:T=!0}){if(a&&(0,R.setLayerDimensions)(u,{rotation:P.rotation}),T){const O=d(0,e),I={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:O};for(const U of w)I.properties=y.get(U),I.div=U,p(I)}}}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationEditorLayer=void 0;var m=F(1),R=F(5),H=F(28),D=F(29),E=F(6);class S{#e;#t=!1;#i=this.pointerup.bind(this);#n=this.pointerdown.bind(this);#s=new Map;#l=!1;#h=!1;#r;static _initialized=!1;constructor(i){S._initialized||(S._initialized=!0,H.FreeTextEditor.initialize(i.l10n),D.InkEditor.initialize(i.l10n)),i.uiManager.registerEditorTypes([H.FreeTextEditor,D.InkEditor]),this.#r=i.uiManager,this.pageIndex=i.pageIndex,this.div=i.div,this.#e=i.accessibilityManager,this.#r.addLayer(this)}get isEmpty(){return this.#s.size===0}updateToolbar(i){this.#r.updateToolbar(i)}updateMode(i=this.#r.getMode()){this.#f(),i===m.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#r.unselectAll(),i!==m.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===m.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===m.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&this.#r.getMode()!==m.AnnotationEditorType.INK)return;if(!i){for(const p of this.#s.values())if(p.isEmpty()){p.setInBackground();return}}this.#c({offsetX:0,offsetY:0}).setInBackground()}setEditingState(i){this.#r.setEditingState(i)}addCommands(i){this.#r.addCommands(i)}enable(){this.div.style.pointerEvents="auto";for(const i of this.#s.values())i.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const i of this.#s.values())i.disableEditing();this.#f(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(i){this.#r.getActive()!==i&&this.#r.setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",this.#n),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#n),this.div.removeEventListener("pointerup",this.#i)}attach(i){this.#s.set(i.id,i)}detach(i){this.#s.delete(i.id),this.#e?.removePointerInTextLayer(i.contentDiv)}remove(i){this.#r.removeEditor(i),this.detach(i),i.div.style.display="none",setTimeout(()=>{i.div.style.display="",i.div.remove(),i.isAttachedToDOM=!1,document.activeElement===document.body&&this.#r.focusMainContainer()},0),this.#h||this.addInkEditorIfNeeded(!1)}#a(i){i.parent!==this&&(this.attach(i),i.parent?.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.#a(i),this.#r.addEditor(i),this.attach(i),!i.isAttachedToDOM){const _=i.render();this.div.append(_),i.isAttachedToDOM=!0}this.moveEditorInDOM(i),i.onceAdded(),this.#r.addToAnnotationStorage(i)}moveEditorInDOM(i){this.#e?.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addANewEditor(i){const _=()=>{this.addOrRebuild(i)},p=()=>{i.remove()};this.addCommands({cmd:_,undo:p,mustExec:!0})}addUndoableEditor(i){const _=()=>{this.addOrRebuild(i)},p=()=>{i.remove()};this.addCommands({cmd:_,undo:p,mustExec:!1})}getNextId(){return this.#r.getId()}#d(i){switch(this.#r.getMode()){case m.AnnotationEditorType.FREETEXT:return new H.FreeTextEditor(i);case m.AnnotationEditorType.INK:return new D.InkEditor(i)}return null}deserialize(i){switch(i.annotationType){case m.AnnotationEditorType.FREETEXT:return H.FreeTextEditor.deserialize(i,this,this.#r);case m.AnnotationEditorType.INK:return D.InkEditor.deserialize(i,this,this.#r)}return null}#c(i){const _=this.getNextId(),p=this.#d({parent:this,id:_,x:i.offsetX,y:i.offsetY,uiManager:this.#r});return p&&this.add(p),p}setSelected(i){this.#r.setSelected(i)}toggleSelected(i){this.#r.toggleSelected(i)}isSelected(i){return this.#r.isSelected(i)}unselect(i){this.#r.unselect(i)}pointerup(i){const{isMac:_}=m.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&_)&&i.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}this.#c(i)}}pointerdown(i){const{isMac:_}=m.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&_||i.target!==this.div)return;this.#l=!0;const p=this.#r.getActive();this.#t=!p||p.isEmpty()}drop(i){const _=i.dataTransfer.getData("text/plain"),p=this.#r.getEditor(_);if(!p)return;i.preventDefault(),i.dataTransfer.dropEffect="move",this.#a(p);const n=this.div.getBoundingClientRect(),l=i.clientX-n.x,g=i.clientY-n.y;p.translate(l-p.startX,g-p.startY),this.moveEditorInDOM(p),p.div.focus()}dragover(i){i.preventDefault()}destroy(){this.#r.getActive()?.parent===this&&this.#r.setActiveEditor(null);for(const i of this.#s.values())this.#e?.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,this.#s.clear(),this.#r.removeLayer(this)}#f(){this.#h=!0;for(const i of this.#s.values())i.isEmpty()&&i.remove();this.#h=!1}render({viewport:i}){this.viewport=i,(0,E.setLayerDimensions)(this.div,i),(0,R.bindEvents)(this,this.div,["dragover","drop"]);for(const _ of this.#r.getEditors(this.pageIndex))this.add(_);this.updateMode()}update({viewport:i}){this.#r.commitOrRemove(),this.viewport=i,(0,E.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:_}=this.viewport.rawDims;return[i,_]}}o.AnnotationEditorLayer=S}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FreeTextEditor=void 0;var m=F(1),R=F(5),H=F(4);class D extends H.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#n=this.editorDivKeydown.bind(this);#s;#l="";#h=`${this.id}-editor`;#r=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new R.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],D.prototype.commitOrRemove]]);static _type="freetext";constructor(S){super({...S,name:"freeTextEditor"}),this.#s=S.color||D._defaultColor||H.AnnotationEditor._defaultLineColor,this.#a=S.fontSize||D._defaultFontSize}static initialize(S){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(i=>[i,S.get(i)]));const d=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(d.getPropertyValue("--freetext-padding"))}static updateDefaultParams(S,d){switch(S){case m.AnnotationEditorParamsType.FREETEXT_SIZE:D._defaultFontSize=d;break;case m.AnnotationEditorParamsType.FREETEXT_COLOR:D._defaultColor=d;break}}updateParams(S,d){switch(S){case m.AnnotationEditorParamsType.FREETEXT_SIZE:this.#d(d);break;case m.AnnotationEditorParamsType.FREETEXT_COLOR:this.#c(d);break}}static get defaultPropertiesToUpdate(){return[[m.AnnotationEditorParamsType.FREETEXT_SIZE,D._defaultFontSize],[m.AnnotationEditorParamsType.FREETEXT_COLOR,D._defaultColor||H.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[m.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[m.AnnotationEditorParamsType.FREETEXT_COLOR,this.#s]]}#d(S){const d=_=>{this.editorDiv.style.fontSize=`calc(${_}px * var(--scale-factor))`,this.translate(0,-(_-this.#a)*this.parentScale),this.#a=_,this.#o()},i=this.#a;this.addCommands({cmd:()=>{d(S)},undo:()=>{d(i)},mustExec:!0,type:m.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(S){const d=this.#s;this.addCommands({cmd:()=>{this.#s=this.editorDiv.style.color=S},undo:()=>{this.#s=this.editorDiv.style.color=d},mustExec:!0,type:m.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const S=this.parentScale;return[-D._internalPadding*S,-(D._internalPadding+this.#a)*S]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(m.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#n),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#h),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#n),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(S){super.focusin(S),S.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#f(){const S=this.editorDiv.getElementsByTagName("div");if(S.length===0)return this.editorDiv.innerText;const d=[];for(const i of S)d.push(i.innerText.replace(/\r\n?|\n/,""));return d.join(`
`)}#o(){const[S,d]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:_,div:p}=this,n=p.style.display;p.style.display="hidden",_.div.append(this.div),i=p.getBoundingClientRect(),p.remove(),p.style.display=n}this.width=i.width/S,this.height=i.height/d}commit(){this.isInEditMode()&&(super.commit(),this.#r||(this.#r=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#l=this.#f().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(S){this.enableEditMode(),this.editorDiv.focus()}keydown(S){S.target===this.div&&S.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(S){D._keyboardManager.exec(this,S)}editorDivFocus(S){this.isEditing=!0}editorDivBlur(S){this.isEditing=!1}editorDivInput(S){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let S,d;this.width&&(S=this.x,d=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#h),this.enableEditing(),D._l10nPromise.get("editor_free_text2_aria_label").then(_=>this.editorDiv?.setAttribute("aria-label",_)),D._l10nPromise.get("free_text2_default_content").then(_=>this.editorDiv?.setAttribute("default-content",_)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#a}px * var(--scale-factor))`,i.color=this.#s,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,R.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[_,p]=this.parentDimensions;this.setAt(S*_,d*p,this.width*_,this.height*p);for(const n of this.#l.split(`
`)){const l=document.createElement("div");l.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(l)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(S,d,i){const _=super.deserialize(S,d,i);return _.#a=S.fontSize,_.#s=m.Util.makeHexColor(...S.color),_.#l=S.value,_}serialize(){if(this.isEmpty())return null;const S=D._internalPadding*this.parentScale,d=this.getRect(S,S),i=H.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#s);return{annotationType:m.AnnotationEditorType.FREETEXT,color:i,fontSize:this.#a,value:this.#l,pageIndex:this.pageIndex,rect:d,rotation:this.rotation}}}o.FreeTextEditor=D}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InkEditor=void 0,Object.defineProperty(o,"fitCurve",{enumerable:!0,get:function(){return H.fitCurve}});var m=F(1),R=F(4),H=F(30),D=F(5);const E=16;class S extends R.AnnotationEditor{#e=0;#t=0;#i=0;#n=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#l=this.canvasPointerup.bind(this);#h=this.canvasPointerdown.bind(this);#r=!1;#a=!1;#d=null;#c=null;#f=0;#o=0;#u=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(i){super({...i,name:"inkEditor"}),this.color=i.color||null,this.thickness=i.thickness||null,this.opacity=i.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(i){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(_=>[_,i.get(_)]))}static updateDefaultParams(i,_){switch(i){case m.AnnotationEditorParamsType.INK_THICKNESS:S._defaultThickness=_;break;case m.AnnotationEditorParamsType.INK_COLOR:S._defaultColor=_;break;case m.AnnotationEditorParamsType.INK_OPACITY:S._defaultOpacity=_/100;break}}updateParams(i,_){switch(i){case m.AnnotationEditorParamsType.INK_THICKNESS:this.#g(_);break;case m.AnnotationEditorParamsType.INK_COLOR:this.#b(_);break;case m.AnnotationEditorParamsType.INK_OPACITY:this.#v(_);break}}static get defaultPropertiesToUpdate(){return[[m.AnnotationEditorParamsType.INK_THICKNESS,S._defaultThickness],[m.AnnotationEditorParamsType.INK_COLOR,S._defaultColor||R.AnnotationEditor._defaultLineColor],[m.AnnotationEditorParamsType.INK_OPACITY,Math.round(S._defaultOpacity*100)]]}get propertiesToUpdate(){return[[m.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||S._defaultThickness],[m.AnnotationEditorParamsType.INK_COLOR,this.color||S._defaultColor||R.AnnotationEditor._defaultLineColor],[m.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??S._defaultOpacity))]]}#g(i){const _=this.thickness;this.addCommands({cmd:()=>{this.thickness=i,this.#F()},undo:()=>{this.thickness=_,this.#F()},mustExec:!0,type:m.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#b(i){const _=this.color;this.addCommands({cmd:()=>{this.color=i,this.#p()},undo:()=>{this.color=_,this.#p()},mustExec:!0,type:m.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#v(i){i/=100;const _=this.opacity;this.addCommands({cmd:()=>{this.opacity=i,this.#p()},undo:()=>{this.opacity=_,this.#p()},mustExec:!0,type:m.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#T(),this.#_()),this.isAttachedToDOM||(this.parent.add(this),this.#E()),this.#F())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}setParent(i){!this.parent&&i?this._uiManager.removeShouldRescale(this):this.parent&&i===null&&this._uiManager.addShouldRescale(this),super.setParent(i)}onScaleChanging(){const[i,_]=this.parentDimensions,p=this.width*i,n=this.height*_;this.setDimensions(p,n)}enableEditMode(){this.#r||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#h),this.canvas.addEventListener("pointerup",this.#l))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#h),this.canvas.removeEventListener("pointerup",this.#l))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#C(){const{parentRotation:i,parentDimensions:[_,p]}=this;switch(i){case 90:return[0,p,p,_];case 180:return[_,p,_,p];case 270:return[_,0,p,_];default:return[0,0,_,p]}}#A(){const{ctx:i,color:_,opacity:p,thickness:n,parentScale:l,scaleFactor:g}=this;i.lineWidth=n*l/g,i.lineCap="round",i.lineJoin="round",i.miterLimit=10,i.strokeStyle=`${_}${(0,D.opacityToHex)(p)}`}#w(i,_){this.isEditing=!0,this.#a||(this.#a=!0,this.#E(),this.thickness||=S._defaultThickness,this.color||=S._defaultColor||R.AnnotationEditor._defaultLineColor,this.opacity??=S._defaultOpacity),this.currentPath.push([i,_]),this.#d=null,this.#A(),this.ctx.beginPath(),this.ctx.moveTo(i,_),this.#u=()=>{this.#u&&(this.#d&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#p(),this.ctx.lineTo(...this.#d),this.#d=null,this.ctx.stroke()),window.requestAnimationFrame(this.#u))},window.requestAnimationFrame(this.#u)}#y(i,_){const[p,n]=this.currentPath.at(-1);i===p&&_===n||(this.currentPath.push([i,_]),this.#d=[i,_])}#S(i,_){this.ctx.closePath(),this.#u=null,i=Math.min(Math.max(i,0),this.canvas.width),_=Math.min(Math.max(_,0),this.canvas.height);const[p,n]=this.currentPath.at(-1);(i!==p||_!==n)&&this.currentPath.push([i,_]);let l;if(this.currentPath.length!==1)l=(0,H.fitCurve)(this.currentPath,30,null);else{const P=[i,_];l=[[P,P.slice(),P.slice(),P]]}const g=S.#M(l);this.currentPath.length=0;const c=()=>{this.paths.push(l),this.bezierPath2D.push(g),this.rebuild()},u=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#T(),this.#_()),this.#F())};this.addCommands({cmd:c,undo:u,mustExec:!0})}#p(){if(this.isEmpty()){this.#P();return}this.#A();const{canvas:i,ctx:_}=this;_.setTransform(1,0,0,1,0,0),_.clearRect(0,0,i.width,i.height),this.#P();for(const p of this.bezierPath2D)_.stroke(p)}commit(){this.#r||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#r=!0,this.div.classList.add("disabled"),this.#F(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(i){super.focusin(i),this.enableEditMode()}canvasPointerdown(i){i.button!==0||!this.isInEditMode()||this.#r||(this.setInForeground(),i.type!=="mouse"&&this.div.focus(),i.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#n),this.#w(i.offsetX,i.offsetY))}canvasPointermove(i){i.stopPropagation(),this.#y(i.offsetX,i.offsetY)}canvasPointerup(i){i.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(i.stopPropagation(),this.#x(i),this.setInBackground())}canvasPointerleave(i){this.#x(i),this.setInBackground()}#x(i){this.#S(i.offsetX,i.offsetY),this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#n),this.addToAnnotationStorage()}#T(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",S._l10nPromise.get("editor_ink_canvas_aria_label").then(i=>this.canvas?.setAttribute("aria-label",i)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#_(){this.#c=new ResizeObserver(i=>{const _=i[0].contentRect;_.width&&_.height&&this.setDimensions(_.width,_.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let i,_;this.width&&(i=this.x,_=this.y),super.render(),S._l10nPromise.get("editor_ink2_aria_label").then(c=>this.div?.setAttribute("aria-label",c));const[p,n,l,g]=this.#C();if(this.setAt(p,n,0,0),this.setDims(l,g),this.#T(),this.width){const[c,u]=this.parentDimensions;this.setAt(i*c,_*u,this.width*c,this.height*u),this.#a=!0,this.#E(),this.setDims(this.width*c,this.height*u),this.#p(),this.#O(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#_(),this.div}#E(){if(!this.#a)return;const[i,_]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*i),this.canvas.height=Math.ceil(this.height*_),this.#P()}setDimensions(i,_){const p=Math.round(i),n=Math.round(_);if(this.#f===p&&this.#o===n)return;this.#f=p,this.#o=n,this.canvas.style.visibility="hidden",this.#e&&Math.abs(this.#e-i/_)>.01&&(_=Math.ceil(i/this.#e),this.setDims(i,_));const[l,g]=this.parentDimensions;this.width=i/l,this.height=_/g,this.#r&&this.#m(i,_),this.#E(),this.#p(),this.canvas.style.visibility="visible",this.fixDims()}#m(i,_){const p=this.#D(),n=(i-p)/this.#i,l=(_-p)/this.#t;this.scaleFactor=Math.min(n,l)}#P(){const i=this.#D()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+i,this.translationY*this.scaleFactor+i)}static#M(i){const _=new Path2D;for(let p=0,n=i.length;p<n;p++){const[l,g,c,u]=i[p];p===0&&_.moveTo(...l),_.bezierCurveTo(g[0],g[1],c[0],c[1],u[0],u[1])}return _}#k(i,_,p,n){const g=[],c=this.thickness/2;let u,P;for(const w of this.paths){u=[],P=[];for(let y=0,e=w.length;y<e;y++){const[a,T,O,x]=w[y],I=i*(a[0]+_)+c,U=n-i*(a[1]+p)-c,z=i*(T[0]+_)+c,ie=n-i*(T[1]+p)-c,J=i*(O[0]+_)+c,q=n-i*(O[1]+p)-c,W=i*(x[0]+_)+c,M=n-i*(x[1]+p)-c;y===0&&(u.push(I,U),P.push(I,U)),u.push(z,ie,J,q,W,M),this.#I(I,U,z,ie,J,q,W,M,4,P)}g.push({bezier:u,points:P})}return g}#I(i,_,p,n,l,g,c,u,P,w){if(this.#R(i,_,p,n,l,g,c,u)){w.push(c,u);return}for(let y=1;y<P-1;y++){const e=y/P,a=1-e;let T=e*i+a*p,O=e*_+a*n,x=e*p+a*l,I=e*n+a*g;const U=e*l+a*c,z=e*g+a*u;T=e*T+a*x,O=e*O+a*I,x=e*x+a*U,I=e*I+a*z,T=e*T+a*x,O=e*O+a*I,w.push(T,O)}w.push(c,u)}#R(i,_,p,n,l,g,c,u){const w=(3*p-2*i-c)**2,y=(3*n-2*_-u)**2,e=(3*l-i-2*c)**2,a=(3*g-_-2*u)**2;return Math.max(w,e)+Math.max(y,a)<=10}#L(){let i=1/0,_=-1/0,p=1/0,n=-1/0;for(const l of this.paths)for(const[g,c,u,P]of l){const w=m.Util.bezierBoundingBox(...g,...c,...u,...P);i=Math.min(i,w[0]),p=Math.min(p,w[1]),_=Math.max(_,w[2]),n=Math.max(n,w[3])}return[i,p,_,n]}#D(){return this.#r?Math.ceil(this.thickness*this.parentScale):0}#F(i=!1){if(this.isEmpty())return;if(!this.#r){this.#p();return}const _=this.#L(),p=this.#D();this.#i=Math.max(E,_[2]-_[0]),this.#t=Math.max(E,_[3]-_[1]);const n=Math.ceil(p+this.#i*this.scaleFactor),l=Math.ceil(p+this.#t*this.scaleFactor),[g,c]=this.parentDimensions;this.width=n/g,this.height=l/c,this.#e=n/l,this.#O();const u=this.translationX,P=this.translationY;this.translationX=-_[0],this.translationY=-_[1],this.#E(),this.#p(),this.#f=n,this.#o=l,this.setDims(n,l);const w=i?p/this.scaleFactor/2:0;this.translate(u-this.translationX-w,P-this.translationY-w)}#O(){const{style:i}=this.div;this.#e>=1?(i.minHeight=`${E}px`,i.minWidth=`${Math.round(this.#e*E)}px`):(i.minWidth=`${E}px`,i.minHeight=`${Math.round(E/this.#e)}px`)}static deserialize(i,_,p){const n=super.deserialize(i,_,p);n.thickness=i.thickness,n.color=m.Util.makeHexColor(...i.color),n.opacity=i.opacity;const[l,g]=n.pageDimensions,c=n.width*l,u=n.height*g,P=n.parentScale,w=i.thickness/2;n.#e=c/u,n.#r=!0,n.#f=Math.round(c),n.#o=Math.round(u);for(const{bezier:e}of i.paths){const a=[];n.paths.push(a);let T=P*(e[0]-w),O=P*(u-e[1]-w);for(let I=2,U=e.length;I<U;I+=6){const z=P*(e[I]-w),ie=P*(u-e[I+1]-w),J=P*(e[I+2]-w),q=P*(u-e[I+3]-w),W=P*(e[I+4]-w),M=P*(u-e[I+5]-w);a.push([[T,O],[z,ie],[J,q],[W,M]]),T=W,O=M}const x=this.#M(a);n.bezierPath2D.push(x)}const y=n.#L();return n.#i=Math.max(E,y[2]-y[0]),n.#t=Math.max(E,y[3]-y[1]),n.#m(c,u),n}serialize(){if(this.isEmpty())return null;const i=this.getRect(0,0),_=this.rotation%180===0?i[3]-i[1]:i[2]-i[0],p=R.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:m.AnnotationEditorType.INK,color:p,thickness:this.thickness,opacity:this.opacity,paths:this.#k(this.scaleFactor/this.parentScale,this.translationX,this.translationY,_),pageIndex:this.pageIndex,rect:i,rotation:this.rotation}}}o.InkEditor=S}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.fitCurve=void 0;const m=F(31);o.fitCurve=m}),(B=>{function o(l,g,c){if(!Array.isArray(l))throw new TypeError("First argument should be an array");if(l.forEach(y=>{if(!Array.isArray(y)||y.some(e=>typeof e!="number")||y.length!==l[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),l=l.filter((y,e)=>e===0||!y.every((a,T)=>a===l[e-1][T])),l.length<2)return[];const u=l.length,P=_(l[1],l[0]),w=_(l[u-2],l[u-1]);return F(l,P,w,g,c)}function F(l,g,c,u,P){var y,e,a,T,O,x,I,U,z,ie,J,q,W;if(l.length===2)return q=p.vectorLen(p.subtract(l[0],l[1]))/3,y=[l[0],p.addArrays(l[0],p.mulItems(g,q)),p.addArrays(l[1],p.mulItems(c,q)),l[1]],[y];if(e=E(l),[y,T,x]=m(l,e,e,g,c,P),T===0||T<u)return[y];if(T<u*u)for(a=e,O=T,I=x,W=0;W<20;W++){if(a=H(y,l,a),[y,T,x]=m(l,e,a,g,c,P),T<u)return[y];if(x===I){let M=T/O;if(M>.9999&&M<1.0001)break}O=T,I=x}return J=[],U=p.subtract(l[x-1],l[x+1]),U.every(M=>M===0)&&(U=p.subtract(l[x-1],l[x]),[U[0],U[1]]=[-U[1],U[0]]),z=p.normalize(U),ie=p.mulItems(z,-1),J=J.concat(F(l.slice(0,x+1),g,z,u,P)),J=J.concat(F(l.slice(x),ie,c,u,P)),J}function m(l,g,c,u,P,w){var y,e,a;return y=R(l,c,u,P),[e,a]=S(l,y,g),w&&w({bez:y,points:l,params:g,maxErr:e,maxPoint:a}),[y,e,a]}function R(l,g,c,u){var P,w,y,e,a,T,O,x,I,U,z,ie,J,q,W,M,C,A=l[0],h=l[l.length-1];for(P=[A,null,null,h],w=p.zeros_Xx2x2(g.length),J=0,q=g.length;J<q;J++)M=g[J],C=1-M,y=w[J],y[0]=p.mulItems(c,3*M*(C*C)),y[1]=p.mulItems(u,3*C*(M*M));for(e=[[0,0],[0,0]],a=[0,0],J=0,q=l.length;J<q;J++)M=g[J],y=w[J],e[0][0]+=p.dot(y[0],y[0]),e[0][1]+=p.dot(y[0],y[1]),e[1][0]+=p.dot(y[0],y[1]),e[1][1]+=p.dot(y[1],y[1]),W=p.subtract(l[J],n.q([A,A,h,h],M)),a[0]+=p.dot(y[0],W),a[1]+=p.dot(y[1],W);return T=e[0][0]*e[1][1]-e[1][0]*e[0][1],O=e[0][0]*a[1]-e[1][0]*a[0],x=a[0]*e[1][1]-a[1]*e[0][1],I=T===0?0:x/T,U=T===0?0:O/T,ie=p.vectorLen(p.subtract(A,h)),z=1e-6*ie,I<z||U<z?(P[1]=p.addArrays(A,p.mulItems(c,ie/3)),P[2]=p.addArrays(h,p.mulItems(u,ie/3))):(P[1]=p.addArrays(A,p.mulItems(c,I)),P[2]=p.addArrays(h,p.mulItems(u,U))),P}function H(l,g,c){return c.map((u,P)=>D(l,g[P],u))}function D(l,g,c){var u=p.subtract(n.q(l,c),g),P=n.qprime(l,c),w=p.mulMatrix(u,P),y=p.sum(p.squareItems(P))+2*p.mulMatrix(u,n.qprimeprime(l,c));return y===0?c:c-w/y}function E(l){var g=[],c,u,P;return l.forEach((w,y)=>{c=y?u+p.vectorLen(p.subtract(w,P)):0,g.push(c),u=c,P=w}),g=g.map(w=>w/u),g}function S(l,g,c){var u,P,w,y,e,a,T,O;P=0,w=Math.floor(l.length/2);const x=d(g,10);for(e=0,a=l.length;e<a;e++)T=l[e],O=i(g,c[e],x,10),y=p.subtract(n.q(g,O),T),u=y[0]*y[0]+y[1]*y[1],u>P&&(P=u,w=e);return[P,w]}var d=function(l,g){for(var c,u=[0],P=l[0],w=0,y=1;y<=g;y++)c=n.q(l,y/g),w+=p.vectorLen(p.subtract(c,P)),u.push(w),P=c;return u=u.map(e=>e/w),u};function i(l,g,c,u){if(g<0)return 0;if(g>1)return 1;for(var P,w,y,e,a,T=1;T<=u;T++)if(g<=c[T]){e=(T-1)/u,y=T/u,w=c[T-1],P=c[T],a=(g-w)/(P-w)*(y-e)+e;break}return a}function _(l,g){return p.normalize(p.subtract(l,g))}class p{static zeros_Xx2x2(g){for(var c=[];g--;)c.push([0,0]);return c}static mulItems(g,c){return g.map(u=>u*c)}static mulMatrix(g,c){return g.reduce((u,P,w)=>u+P*c[w],0)}static subtract(g,c){return g.map((u,P)=>u-c[P])}static addArrays(g,c){return g.map((u,P)=>u+c[P])}static addItems(g,c){return g.map(u=>u+c)}static sum(g){return g.reduce((c,u)=>c+u)}static dot(g,c){return p.mulMatrix(g,c)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,c){return g.map(u=>u/c)}static squareItems(g){return g.map(c=>c*c)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class n{static q(g,c){var u=1-c,P=p.mulItems(g[0],u*u*u),w=p.mulItems(g[1],3*u*u*c),y=p.mulItems(g[2],3*u*c*c),e=p.mulItems(g[3],c*c*c);return p.addArrays(p.addArrays(P,w),p.addArrays(y,e))}static qprime(g,c){var u=1-c,P=p.mulItems(p.subtract(g[1],g[0]),3*u*u),w=p.mulItems(p.subtract(g[2],g[1]),6*u*c),y=p.mulItems(p.subtract(g[3],g[2]),3*c*c);return p.addArrays(p.addArrays(P,w),y)}static qprimeprime(g,c){return p.addArrays(p.mulItems(p.addArrays(p.subtract(g[2],p.mulItems(g[1],2)),g[0]),6*(1-c)),p.mulItems(p.addArrays(p.subtract(g[3],p.mulItems(g[2],2)),g[1]),6*c))}}B.exports=o,B.exports.fitCubic=F,B.exports.createTangent=_}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationLayer=void 0;var m=F(1),R=F(6),H=F(3),D=F(33),E=F(34);const S=1e3,d=9,i=new WeakSet;function _(L){return{width:L[2]-L[0],height:L[3]-L[1]}}class p{static create(s){switch(s.data.annotationType){case m.AnnotationType.LINK:return new l(s);case m.AnnotationType.TEXT:return new g(s);case m.AnnotationType.WIDGET:switch(s.data.fieldType){case"Tx":return new u(s);case"Btn":return s.data.radioButton?new w(s):s.data.checkBox?new P(s):new y(s);case"Ch":return new e(s)}return new c(s);case m.AnnotationType.POPUP:return new a(s);case m.AnnotationType.FREETEXT:return new O(s);case m.AnnotationType.LINE:return new x(s);case m.AnnotationType.SQUARE:return new I(s);case m.AnnotationType.CIRCLE:return new U(s);case m.AnnotationType.POLYLINE:return new z(s);case m.AnnotationType.CARET:return new J(s);case m.AnnotationType.INK:return new q(s);case m.AnnotationType.POLYGON:return new ie(s);case m.AnnotationType.HIGHLIGHT:return new W(s);case m.AnnotationType.UNDERLINE:return new M(s);case m.AnnotationType.SQUIGGLY:return new C(s);case m.AnnotationType.STRIKEOUT:return new A(s);case m.AnnotationType.STAMP:return new h(s);case m.AnnotationType.FILEATTACHMENT:return new r(s);default:return new n(s)}}}class n{constructor(s,{isRenderable:f=!1,ignoreBorder:b=!1,createQuadrilaterals:k=!1}={}){this.isRenderable=f,this.data=s.data,this.layer=s.layer,this.page=s.page,this.viewport=s.viewport,this.linkService=s.linkService,this.downloadManager=s.downloadManager,this.imageResourcesPath=s.imageResourcesPath,this.renderForms=s.renderForms,this.svgFactory=s.svgFactory,this.annotationStorage=s.annotationStorage,this.enableScripting=s.enableScripting,this.hasJSActions=s.hasJSActions,this._fieldObjects=s.fieldObjects,f&&(this.container=this._createContainer(b)),k&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(s=!1){const{data:f,page:b,viewport:k}=this,N=document.createElement("section");N.setAttribute("data-annotation-id",f.id),f.noRotate&&N.classList.add("norotate");const{pageWidth:j,pageHeight:V,pageX:X,pageY:Q}=k.rawDims,{width:$,height:te}=_(f.rect),re=m.Util.normalizeRect([f.rect[0],b.view[3]-f.rect[1]+b.view[1],f.rect[2],b.view[3]-f.rect[3]+b.view[1]]);if(!s&&f.borderStyle.width>0){N.style.borderWidth=`${f.borderStyle.width}px`;const ee=f.borderStyle.horizontalCornerRadius,ne=f.borderStyle.verticalCornerRadius;if(ee>0||ne>0){const ae=`calc(${ee}px * var(--scale-factor)) / calc(${ne}px * var(--scale-factor))`;N.style.borderRadius=ae}else if(this instanceof w){const ae=`calc(${$}px * var(--scale-factor)) / calc(${te}px * var(--scale-factor))`;N.style.borderRadius=ae}switch(f.borderStyle.style){case m.AnnotationBorderStyleType.SOLID:N.style.borderStyle="solid";break;case m.AnnotationBorderStyleType.DASHED:N.style.borderStyle="dashed";break;case m.AnnotationBorderStyleType.BEVELED:(0,m.warn)("Unimplemented border style: beveled");break;case m.AnnotationBorderStyleType.INSET:(0,m.warn)("Unimplemented border style: inset");break;case m.AnnotationBorderStyleType.UNDERLINE:N.style.borderBottomStyle="solid";break}const Z=f.borderColor||null;Z?N.style.borderColor=m.Util.makeHexColor(Z[0]|0,Z[1]|0,Z[2]|0):N.style.borderWidth=0}N.style.left=`${100*(re[0]-X)/j}%`,N.style.top=`${100*(re[1]-Q)/V}%`;const{rotation:G}=f;return f.hasOwnCanvas||G===0?(N.style.width=`${100*$/j}%`,N.style.height=`${100*te/V}%`):this.setRotation(G,N),N}setRotation(s,f=this.container){const{pageWidth:b,pageHeight:k}=this.viewport.rawDims,{width:N,height:j}=_(this.data.rect);let V,X;s%180===0?(V=100*N/b,X=100*j/k):(V=100*j/b,X=100*N/k),f.style.width=`${V}%`,f.style.height=`${X}%`,f.setAttribute("data-main-rotation",(360-s)%360)}get _commonActions(){const s=(f,b,k)=>{const N=k.detail[f];k.target.style[b]=D.ColorConverters[`${N[0]}_HTML`](N.slice(1))};return(0,m.shadow)(this,"_commonActions",{display:f=>{const b=f.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:f.detail.display===0||f.detail.display===3})},print:f=>{this.annotationStorage.setValue(this.data.id,{print:f.detail.print})},hidden:f=>{this.container.style.visibility=f.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:f.detail.hidden})},focus:f=>{setTimeout(()=>f.target.focus({preventScroll:!1}),0)},userName:f=>{f.target.title=f.detail.userName},readonly:f=>{f.detail.readonly?f.target.setAttribute("readonly",""):f.target.removeAttribute("readonly")},required:f=>{this._setRequired(f.target,f.detail.required)},bgColor:f=>{s("bgColor","backgroundColor",f)},fillColor:f=>{s("fillColor","backgroundColor",f)},fgColor:f=>{s("fgColor","color",f)},textColor:f=>{s("textColor","color",f)},borderColor:f=>{s("borderColor","borderColor",f)},strokeColor:f=>{s("strokeColor","borderColor",f)},rotation:f=>{const b=f.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(s,f){const b=this._commonActions;for(const k of Object.keys(f.detail))(s[k]||b[k])?.(f)}_setDefaultPropertiesFromJS(s){if(!this.enableScripting)return;const f=this.annotationStorage.getRawValue(this.data.id);if(!f)return;const b=this._commonActions;for(const[k,N]of Object.entries(f)){const j=b[k];if(j){const V={detail:{[k]:N},target:s};j(V),delete f[k]}}}_createQuadrilaterals(s=!1){if(!this.data.quadPoints)return null;const f=[],b=this.data.rect;for(const k of this.data.quadPoints)this.data.rect=[k[2].x,k[2].y,k[1].x,k[1].y],f.push(this._createContainer(s));return this.data.rect=b,f}_createPopup(s,f){let b=this.container;this.quadrilaterals&&(s||=this.quadrilaterals,b=this.quadrilaterals[0]),s||(s=document.createElement("div"),s.classList.add("popupTriggerArea"),b.append(s));const N=new T({container:b,trigger:s,color:f.color,titleObj:f.titleObj,modificationDate:f.modificationDate,contentsObj:f.contentsObj,richText:f.richText,hideWrapper:!0}).render();N.style.left="100%",b.append(N)}_renderQuadrilaterals(s){for(const f of this.quadrilaterals)f.classList.add(s);return this.quadrilaterals}render(){(0,m.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(s,f=null){const b=[];if(this._fieldObjects){const k=this._fieldObjects[s];if(k)for(const{page:N,id:j,exportValues:V}of k){if(N===-1||j===f)continue;const X=typeof V=="string"?V:null,Q=document.querySelector(`[data-element-id="${j}"]`);if(Q&&!i.has(Q)){(0,m.warn)(`_getElementsByName - element not allowed: ${j}`);continue}b.push({id:j,exportValue:X,domElement:Q})}return b}for(const k of document.getElementsByName(s)){const{exportValue:N}=k,j=k.getAttribute("data-element-id");j!==f&&i.has(k)&&b.push({id:j,exportValue:N,domElement:k})}return b}}class l extends n{constructor(s,f=null){super(s,{isRenderable:!0,ignoreBorder:!!f?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:f}=this,b=document.createElement("a");b.setAttribute("data-element-id",s.id);let k=!1;return s.url?(f.addLinkAttributes(b,s.url,s.newWindow),k=!0):s.action?(this._bindNamedAction(b,s.action),k=!0):s.attachment?(this._bindAttachment(b,s.attachment),k=!0):s.setOCGState?(this.#t(b,s.setOCGState),k=!0):s.dest?(this._bindLink(b,s.dest),k=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(b,s),k=!0),s.resetForm?(this._bindResetFormAction(b,s.resetForm),k=!0):this.isTooltipOnly&&!k&&(this._bindLink(b,""),k=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((N,j)=>{const V=j===0?b:b.cloneNode();return N.append(V),N}):(this.container.classList.add("linkAnnotation"),k&&this.container.append(b),this.container)}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(s,f){s.href=this.linkService.getDestinationHash(f),s.onclick=()=>(f&&this.linkService.goToDestination(f),!1),(f||f==="")&&this.#e()}_bindNamedAction(s,f){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(f),!1),this.#e()}_bindAttachment(s,f){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,f.content,f.filename),!1),this.#e()}#t(s,f){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(f),!1),this.#e()}_bindJSAction(s,f){s.href=this.linkService.getAnchorUrl("");const b=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const k of Object.keys(f.actions)){const N=b.get(k);N&&(s[N]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f.id,name:k}}),!1))}s.onclick||(s.onclick=()=>!1),this.#e()}_bindResetFormAction(s,f){const b=s.onclick;if(b||(s.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,m.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),b||(s.onclick=()=>!1);return}s.onclick=()=>{b?.();const{fields:k,refs:N,include:j}=f,V=[];if(k.length!==0||N.length!==0){const $=new Set(N);for(const te of k){const re=this._fieldObjects[te]||[];for(const{id:G}of re)$.add(G)}for(const te of Object.values(this._fieldObjects))for(const re of te)$.has(re.id)===j&&V.push(re)}else for(const $ of Object.values(this._fieldObjects))V.push(...$);const X=this.annotationStorage,Q=[];for(const $ of V){const{id:te}=$;switch(Q.push(te),$.type){case"text":{const G=$.defaultValue||"";X.setValue(te,{value:G});break}case"checkbox":case"radiobutton":{const G=$.defaultValue===$.exportValues;X.setValue(te,{value:G});break}case"combobox":case"listbox":{const G=$.defaultValue||"";X.setValue(te,{value:G});break}default:continue}const re=document.querySelector(`[data-element-id="${te}"]`);if(re){if(!i.has(re)){(0,m.warn)(`_bindResetFormAction - element not allowed: ${te}`);continue}}else continue;re.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Q,name:"ResetForm"}}),!1}}}class g extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f})}render(){this.container.classList.add("textAnnotation");const s=document.createElement("img");return s.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",s.alt="[{{type}} Annotation]",s.dataset.l10nId="text_annotation_type",s.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(s,this.data),this.container.append(s),this.container}}class c extends n{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(s){this.data.hasOwnCanvas&&(s.previousSibling?.nodeName==="CANVAS"&&(s.previousSibling.hidden=!0),s.hidden=!1)}_getKeyModifier(s){const{isWin:f,isMac:b}=m.FeatureTest.platform;return f&&s.ctrlKey||b&&s.metaKey}_setEventListener(s,f,b,k){f.includes("mouse")?s.addEventListener(f,N=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:k(N),shift:N.shiftKey,modifier:this._getKeyModifier(N)}})}):s.addEventListener(f,N=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:k(N)}})})}_setEventListeners(s,f,b){for(const[k,N]of f)(N==="Action"||this.data.actions?.[N])&&this._setEventListener(s,k,N,b)}_setBackgroundColor(s){const f=this.data.backgroundColor||null;s.style.backgroundColor=f===null?"transparent":m.Util.makeHexColor(f[0],f[1],f[2])}_setTextStyle(s){const f=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,k=this.data.defaultAppearanceData.fontSize||d,N=s.style;let j;const V=2,X=Q=>Math.round(10*Q)/10;if(this.data.multiLine){const Q=Math.abs(this.data.rect[3]-this.data.rect[1]-V),$=Math.round(Q/(m.LINE_FACTOR*k))||1,te=Q/$;j=Math.min(k,X(te/m.LINE_FACTOR))}else{const Q=Math.abs(this.data.rect[3]-this.data.rect[1]-V);j=Math.min(k,X(Q/m.LINE_FACTOR))}N.fontSize=`calc(${j}px * var(--scale-factor))`,N.color=m.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(N.textAlign=f[this.data.textAlignment])}_setRequired(s,f){f?s.setAttribute("required",!0):s.removeAttribute("required"),s.setAttribute("aria-required",f)}}class u extends c{constructor(s){const f=s.renderForms||!s.data.hasAppearance&&!!s.data.fieldValue;super(s,{isRenderable:f})}setPropertyOnSiblings(s,f,b,k){const N=this.annotationStorage;for(const j of this._getElementsByName(s.name,s.id))j.domElement&&(j.domElement[f]=b),N.setValue(j.id,{[k]:b})}render(){const s=this.annotationStorage,f=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const k=s.getValue(f,{value:this.data.fieldValue});let N=k.formattedValue||k.value||"";const j=s.getValue(f,{charLimit:this.data.maxLen}).charLimit;j&&N.length>j&&(N=N.slice(0,j));const V={userValue:N,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=N,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",N),this.data.doNotScroll&&(b.style.overflowX="hidden")),this.data.hasOwnCanvas&&(b.hidden=!0),i.add(b),b.setAttribute("data-element-id",f),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=S,this._setRequired(b,this.data.required),j&&(b.maxLength=j),b.addEventListener("input",Q=>{s.setValue(f,{value:Q.target.value}),this.setPropertyOnSiblings(b,"value",Q.target.value,"value")}),b.addEventListener("resetform",Q=>{const $=this.data.defaultFieldValue??"";b.value=V.userValue=$,V.formattedValue=null});let X=Q=>{const{formattedValue:$}=V;$!=null&&(Q.target.value=$),Q.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",$=>{const{target:te}=$;V.userValue&&(te.value=V.userValue),V.lastCommittedValue=te.value,V.commitKey=1}),b.addEventListener("updatefromsandbox",$=>{this.showElementAndHideCanvas($.target);const te={value(re){V.userValue=re.detail.value??"",s.setValue(f,{value:V.userValue.toString()}),re.target.value=V.userValue},formattedValue(re){const{formattedValue:G}=re.detail;V.formattedValue=G,G!=null&&re.target!==document.activeElement&&(re.target.value=G),s.setValue(f,{formattedValue:G})},selRange(re){re.target.setSelectionRange(...re.detail.selRange)},charLimit:re=>{const{charLimit:G}=re.detail,{target:ee}=re;if(G===0){ee.removeAttribute("maxLength");return}ee.setAttribute("maxLength",G);let ne=V.userValue;!ne||ne.length<=G||(ne=ne.slice(0,G),ee.value=V.userValue=ne,s.setValue(f,{value:ne}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:ne,willCommit:!0,commitKey:1,selStart:ee.selectionStart,selEnd:ee.selectionEnd}}))}};this._dispatchEventFromSandbox(te,$)}),b.addEventListener("keydown",$=>{V.commitKey=1;let te=-1;if($.key==="Escape"?te=0:$.key==="Enter"&&!this.data.multiLine?te=2:$.key==="Tab"&&(V.commitKey=3),te===-1)return;const{value:re}=$.target;V.lastCommittedValue!==re&&(V.lastCommittedValue=re,V.userValue=re,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:re,willCommit:!0,commitKey:te,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}))});const Q=X;X=null,b.addEventListener("blur",$=>{if(!$.relatedTarget)return;const{value:te}=$.target;V.userValue=te,V.lastCommittedValue!==te&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:te,willCommit:!0,commitKey:V.commitKey,selStart:$.target.selectionStart,selEnd:$.target.selectionEnd}}),Q($)}),this.data.actions?.Keystroke&&b.addEventListener("beforeinput",$=>{V.lastCommittedValue=null;const{data:te,target:re}=$,{value:G,selectionStart:ee,selectionEnd:ne}=re;let Z=ee,ae=ne;switch($.inputType){case"deleteWordBackward":{const oe=G.substring(0,ee).match(/\w*[^\w]*$/);oe&&(Z-=oe[0].length);break}case"deleteWordForward":{const oe=G.substring(ee).match(/^[^\w]*\w*/);oe&&(ae+=oe[0].length);break}case"deleteContentBackward":ee===ne&&(Z-=1);break;case"deleteContentForward":ee===ne&&(ae+=1);break}$.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:G,change:te||"",willCommit:!1,selStart:Z,selEnd:ae}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],$=>$.target.value)}if(X&&b.addEventListener("blur",X),this.data.comb){const $=(this.data.rect[2]-this.data.rect[0])/j;b.classList.add("comb"),b.style.letterSpacing=`calc(${$}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class P extends c{constructor(s){super(s,{isRenderable:s.renderForms})}render(){const s=this.annotationStorage,f=this.data,b=f.id;let k=s.getValue(b,{value:f.exportValue===f.fieldValue}).value;typeof k=="string"&&(k=k!=="Off",s.setValue(b,{value:k})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const N=document.createElement("input");return i.add(N),N.setAttribute("data-element-id",b),N.disabled=f.readOnly,this._setRequired(N,this.data.required),N.type="checkbox",N.name=f.fieldName,k&&N.setAttribute("checked",!0),N.setAttribute("exportValue",f.exportValue),N.tabIndex=S,N.addEventListener("change",j=>{const{name:V,checked:X}=j.target;for(const Q of this._getElementsByName(V,b)){const $=X&&Q.exportValue===f.exportValue;Q.domElement&&(Q.domElement.checked=$),s.setValue(Q.id,{value:$})}s.setValue(b,{value:X})}),N.addEventListener("resetform",j=>{const V=f.defaultFieldValue||"Off";j.target.checked=V===f.exportValue}),this.enableScripting&&this.hasJSActions&&(N.addEventListener("updatefromsandbox",j=>{const V={value(X){X.target.checked=X.detail.value!=="Off",s.setValue(b,{value:X.target.checked})}};this._dispatchEventFromSandbox(V,j)}),this._setEventListeners(N,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(N),this._setDefaultPropertiesFromJS(N),this.container.append(N),this.container}}class w extends c{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const s=this.annotationStorage,f=this.data,b=f.id;let k=s.getValue(b,{value:f.fieldValue===f.buttonValue}).value;typeof k=="string"&&(k=k!==f.buttonValue,s.setValue(b,{value:k}));const N=document.createElement("input");if(i.add(N),N.setAttribute("data-element-id",b),N.disabled=f.readOnly,this._setRequired(N,this.data.required),N.type="radio",N.name=f.fieldName,k&&N.setAttribute("checked",!0),N.tabIndex=S,N.addEventListener("change",j=>{const{name:V,checked:X}=j.target;for(const Q of this._getElementsByName(V,b))s.setValue(Q.id,{value:!1});s.setValue(b,{value:X})}),N.addEventListener("resetform",j=>{const V=f.defaultFieldValue;j.target.checked=V!=null&&V===f.buttonValue}),this.enableScripting&&this.hasJSActions){const j=f.buttonValue;N.addEventListener("updatefromsandbox",V=>{const X={value:Q=>{const $=j===Q.detail.value;for(const te of this._getElementsByName(Q.target.name)){const re=$&&te.id===b;te.domElement&&(te.domElement.checked=re),s.setValue(te.id,{value:re})}}};this._dispatchEventFromSandbox(X,V)}),this._setEventListeners(N,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.checked)}return this._setBackgroundColor(N),this._setDefaultPropertiesFromJS(N),this.container.append(N),this.container}}class y extends l{constructor(s){super(s,{ignoreBorder:s.data.hasAppearance})}render(){const s=super.render();s.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(s.title=this.data.alternativeText);const f=s.lastChild;return this.enableScripting&&this.hasJSActions&&f&&(this._setDefaultPropertiesFromJS(f),f.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),s}}class e extends c{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const s=this.annotationStorage,f=this.data.id,b=s.getValue(f,{value:this.data.fieldValue}),k=document.createElement("select");i.add(k),k.setAttribute("data-element-id",f),k.disabled=this.data.readOnly,this._setRequired(k,this.data.required),k.name=this.data.fieldName,k.tabIndex=S;let N=this.data.combo&&this.data.options.length>0;this.data.combo||(k.size=this.data.options.length,this.data.multiSelect&&(k.multiple=!0)),k.addEventListener("resetform",$=>{const te=this.data.defaultFieldValue;for(const re of k.options)re.selected=re.value===te});for(const $ of this.data.options){const te=document.createElement("option");te.textContent=$.displayValue,te.value=$.exportValue,b.value.includes($.exportValue)&&(te.setAttribute("selected",!0),N=!1),k.append(te)}let j=null;if(N){const $=document.createElement("option");$.value=" ",$.setAttribute("hidden",!0),$.setAttribute("selected",!0),k.prepend($),j=()=>{$.remove(),k.removeEventListener("input",j),j=null},k.addEventListener("input",j)}const V=$=>{const te=$?"value":"textContent",{options:re,multiple:G}=k;return G?Array.prototype.filter.call(re,ee=>ee.selected).map(ee=>ee[te]):re.selectedIndex===-1?null:re[re.selectedIndex][te]};let X=V(!1);const Q=$=>{const te=$.target.options;return Array.prototype.map.call(te,re=>({displayValue:re.textContent,exportValue:re.value}))};return this.enableScripting&&this.hasJSActions?(k.addEventListener("updatefromsandbox",$=>{const te={value(re){j?.();const G=re.detail.value,ee=new Set(Array.isArray(G)?G:[G]);for(const ne of k.options)ne.selected=ee.has(ne.value);s.setValue(f,{value:V(!0)}),X=V(!1)},multipleSelection(re){k.multiple=!0},remove(re){const G=k.options,ee=re.detail.remove;G[ee].selected=!1,k.remove(ee),G.length>0&&Array.prototype.findIndex.call(G,Z=>Z.selected)===-1&&(G[0].selected=!0),s.setValue(f,{value:V(!0),items:Q(re)}),X=V(!1)},clear(re){for(;k.length!==0;)k.remove(0);s.setValue(f,{value:null,items:[]}),X=V(!1)},insert(re){const{index:G,displayValue:ee,exportValue:ne}=re.detail.insert,Z=k.children[G],ae=document.createElement("option");ae.textContent=ee,ae.value=ne,Z?Z.before(ae):k.append(ae),s.setValue(f,{value:V(!0),items:Q(re)}),X=V(!1)},items(re){const{items:G}=re.detail;for(;k.length!==0;)k.remove(0);for(const ee of G){const{displayValue:ne,exportValue:Z}=ee,ae=document.createElement("option");ae.textContent=ne,ae.value=Z,k.append(ae)}k.options.length>0&&(k.options[0].selected=!0),s.setValue(f,{value:V(!0),items:Q(re)}),X=V(!1)},indices(re){const G=new Set(re.detail.indices);for(const ee of re.target.options)ee.selected=G.has(ee.index);s.setValue(f,{value:V(!0)}),X=V(!1)},editable(re){re.target.disabled=!re.detail.editable}};this._dispatchEventFromSandbox(te,$)}),k.addEventListener("input",$=>{const te=V(!0);s.setValue(f,{value:te}),$.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:X,changeEx:te,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(k,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],$=>$.target.value)):k.addEventListener("input",function($){s.setValue(f,{value:V(!0)})}),this.data.combo&&this._setTextStyle(k),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class a extends n{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(s){const{data:f}=s,b=!a.IGNORE_TYPES.has(f.parentType)&&!!(f.titleObj?.str||f.contentsObj?.str||f.richText?.str);super(s,{isRenderable:b})}render(){this.container.classList.add("popupAnnotation");const s=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(s.length===0)return this.container;const f=new T({container:this.container,trigger:Array.from(s),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,k=m.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),N=k[0]+this.data.parentRect[2]-this.data.parentRect[0],j=k[1],{pageWidth:V,pageHeight:X,pageX:Q,pageY:$}=this.viewport.rawDims;return this.container.style.left=`${100*(N-Q)/V}%`,this.container.style.top=`${100*(j-$)/X}%`,this.container.append(f.render()),this.container}}class T{constructor(s){this.container=s.container,this.trigger=s.trigger,this.color=s.color,this.titleObj=s.titleObj,this.modificationDate=s.modificationDate,this.contentsObj=s.contentsObj,this.richText=s.richText,this.hideWrapper=s.hideWrapper||!1,this.pinned=!1}render(){const f=document.createElement("div");f.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?f:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.classList.add("popup");const k=this.color;if(k){const V=.7*(255-k[0])+k[0],X=.7*(255-k[1])+k[1],Q=.7*(255-k[2])+k[2];b.style.backgroundColor=m.Util.makeHexColor(V|0,X|0,Q|0)}const N=document.createElement("h1");N.dir=this.titleObj.dir,N.textContent=this.titleObj.str,b.append(N);const j=R.PDFDateString.toDateObject(this.modificationDate);if(j){const V=document.createElement("span");V.classList.add("popupDate"),V.textContent="{{date}}, {{time}}",V.dataset.l10nId="annotation_date_string",V.dataset.l10nArgs=JSON.stringify({date:j.toLocaleDateString(),time:j.toLocaleTimeString()}),b.append(V)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))E.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.classList.add("richText","popupContent");else{const V=this._formatContents(this.contentsObj);b.append(V)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const V of this.trigger)V.addEventListener("click",this._toggle.bind(this)),V.addEventListener("mouseover",this._show.bind(this,!1)),V.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),f.append(b),f}_formatContents({str:s,dir:f}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=f;const k=s.split(/(?:\r\n?|\n)/);for(let N=0,j=k.length;N<j;++N){const V=k[N];b.append(document.createTextNode(V)),N<j-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(s=!1){s&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(s=!0){s&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class O extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0}),this.textContent=s.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const s=document.createElement("div");s.classList.add("annotationTextContent"),s.setAttribute("role","comment");for(const f of this.textContent){const b=document.createElement("span");b.textContent=f,s.append(b)}this.container.append(s)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class x extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:f,height:b}=_(s.rect),k=this.svgFactory.create(f,b,!0),N=this.svgFactory.createElement("svg:line");return N.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),N.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),N.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),N.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),N.setAttribute("stroke-width",s.borderStyle.width||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),k.append(N),this.container.append(k),this._createPopup(N,s),this.container}}class I extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:f,height:b}=_(s.rect),k=this.svgFactory.create(f,b,!0),N=s.borderStyle.width,j=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",N/2),j.setAttribute("y",N/2),j.setAttribute("width",f-N),j.setAttribute("height",b-N),j.setAttribute("stroke-width",N||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.append(j),this.container.append(k),this._createPopup(j,s),this.container}}class U extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:f,height:b}=_(s.rect),k=this.svgFactory.create(f,b,!0),N=s.borderStyle.width,j=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",f/2),j.setAttribute("cy",b/2),j.setAttribute("rx",f/2-N/2),j.setAttribute("ry",b/2-N/2),j.setAttribute("stroke-width",N||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.append(j),this.container.append(k),this._createPopup(j,s),this.container}}class z extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:f,height:b}=_(s.rect),k=this.svgFactory.create(f,b,!0);let N=[];for(const V of s.vertices){const X=V.x-s.rect[0],Q=s.rect[3]-V.y;N.push(X+","+Q)}N=N.join(" ");const j=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",N),j.setAttribute("stroke-width",s.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.append(j),this.container.append(k),this._createPopup(j,s),this.container}}class ie extends z{constructor(s){super(s),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class J extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class q extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:f,height:b}=_(s.rect),k=this.svgFactory.create(f,b,!0);for(const N of s.inkLists){let j=[];for(const X of N){const Q=X.x-s.rect[0],$=s.rect[3]-X.y;j.push(`${Q},${$}`)}j=j.join(" ");const V=this.svgFactory.createElement(this.svgElementName);V.setAttribute("points",j),V.setAttribute("stroke-width",s.borderStyle.width||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),this._createPopup(V,s),k.append(V)}return this.container.append(k),this.container}}class W extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class M extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class C extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class A extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class h extends n{constructor(s){const f=!!(s.data.hasPopup||s.data.titleObj?.str||s.data.contentsObj?.str||s.data.richText?.str);super(s,{isRenderable:f,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class r extends n{constructor(s){super(s,{isRenderable:!0});const{filename:f,content:b}=this.data.file;this.filename=(0,R.getFilenameFromUrl)(f,!0),this.content=b,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:f,content:b})}render(){this.container.classList.add("fileAttachmentAnnotation");let s;return this.data.hasAppearance?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),s.classList.add("popupTriggerArea"),s.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(s,this.data),this.container.append(s),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class v{static#e(s,f,b,k){const N=s.firstChild||s;N.id=`${R.AnnotationPrefix}${f}`,b.append(s),k?.moveElementInDOM(b,s,N,!1)}static render(s){const{annotations:f,div:b,viewport:k,accessibilityManager:N}=s;(0,R.setLayerDimensions)(b,k);const j={data:null,layer:b,page:s.page,viewport:k,linkService:s.linkService,downloadManager:s.downloadManager,imageResourcesPath:s.imageResourcesPath||"",renderForms:s.renderForms!==!1,svgFactory:new R.DOMSVGFactory,annotationStorage:s.annotationStorage||new H.AnnotationStorage,enableScripting:s.enableScripting===!0,hasJSActions:s.hasJSActions,fieldObjects:s.fieldObjects};let V=0;for(const X of f){if(X.noHTML)continue;if(X.annotationType!==m.AnnotationType.POPUP){const{width:te,height:re}=_(X.rect);if(te<=0||re<=0)continue}j.data=X;const Q=p.create(j);if(!Q.isRenderable)continue;const $=Q.render();if(X.hidden&&($.style.visibility="hidden"),Array.isArray($))for(const te of $)te.style.zIndex=V++,v.#e(te,X.id,b,N);else $.style.zIndex=V++,Q instanceof a?b.prepend($):v.#e($,X.id,b,N)}this.#t(b,s.annotationCanvasMap)}static update(s){const{annotationCanvasMap:f,div:b,viewport:k}=s;(0,R.setLayerDimensions)(b,{rotation:k.rotation}),this.#t(b,f),b.hidden=!1}static#t(s,f){if(f){for(const[b,k]of f){const N=s.querySelector(`[data-annotation-id="${b}"]`);if(!N)continue;const{firstChild:j}=N;j?j.nodeName==="CANVAS"?j.replaceWith(k):j.before(k):N.append(k)}f.clear()}}}o.AnnotationLayer=v}),((B,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorConverters=void 0;function F(R){return Math.floor(Math.max(0,Math.min(1,R))*255).toString(16).padStart(2,"0")}class m{static CMYK_G([H,D,E,S]){return["G",1-Math.min(1,.3*H+.59*E+.11*D+S)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_HTML([H]){const D=F(H);return`#${D}${D}${D}`}static RGB_G([H,D,E]){return["G",.3*H+.59*D+.11*E]}static RGB_HTML([H,D,E]){const S=F(H),d=F(D),i=F(E);return`#${S}${d}${i}`}static T_HTML(){return"#00000000"}static CMYK_RGB([H,D,E,S]){return["RGB",1-Math.min(1,H+S),1-Math.min(1,E+S),1-Math.min(1,D+S)]}static CMYK_HTML(H){const D=this.CMYK_RGB(H).slice(1);return this.RGB_HTML(D)}static RGB_CMYK([H,D,E]){const S=1-H,d=1-D,i=1-E,_=Math.min(S,d,i);return["CMYK",S,d,i,_]}}o.ColorConverters=m}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.XfaLayer=void 0;var m=F(19);class R{static setupStorage(D,E,S,d,i){const _=d.getValue(E,{value:null});switch(S.name){case"textarea":if(_.value!==null&&(D.textContent=_.value),i==="print")break;D.addEventListener("input",p=>{d.setValue(E,{value:p.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(_.value===S.attributes.xfaOn?D.setAttribute("checked",!0):_.value===S.attributes.xfaOff&&D.removeAttribute("checked"),i==="print")break;D.addEventListener("change",p=>{d.setValue(E,{value:p.target.checked?p.target.getAttribute("xfaOn"):p.target.getAttribute("xfaOff")})})}else{if(_.value!==null&&D.setAttribute("value",_.value),i==="print")break;D.addEventListener("input",p=>{d.setValue(E,{value:p.target.value})})}break;case"select":if(_.value!==null)for(const p of S.children)p.attributes.value===_.value&&(p.attributes.selected=!0);D.addEventListener("input",p=>{const n=p.target.options,l=n.selectedIndex===-1?"":n[n.selectedIndex].value;d.setValue(E,{value:l})});break}}static setAttributes({html:D,element:E,storage:S=null,intent:d,linkService:i}){const{attributes:_}=E,p=D instanceof HTMLAnchorElement;_.type==="radio"&&(_.name=`${_.name}-${d}`);for(const[n,l]of Object.entries(_))if(l!=null)switch(n){case"class":l.length&&D.setAttribute(n,l.join(" "));break;case"dataId":break;case"id":D.setAttribute("data-element-id",l);break;case"style":Object.assign(D.style,l);break;case"textContent":D.textContent=l;break;default:(!p||n!=="href"&&n!=="newWindow")&&D.setAttribute(n,l)}p&&i.addLinkAttributes(D,_.href,_.newWindow),S&&_.dataId&&this.setupStorage(D,_.dataId,E,S)}static render(D){const E=D.annotationStorage,S=D.linkService,d=D.xfaHtml,i=D.intent||"display",_=document.createElement(d.name);d.attributes&&this.setAttributes({html:_,element:d,intent:i,linkService:S});const p=[[d,-1,_]],n=D.div;if(n.append(_),D.viewport){const g=`matrix(${D.viewport.transform.join(",")})`;n.style.transform=g}i!=="richText"&&n.setAttribute("class","xfaLayer xfaFont");const l=[];for(;p.length>0;){const[g,c,u]=p.at(-1);if(c+1===g.children.length){p.pop();continue}const P=g.children[++p.at(-1)[1]];if(P===null)continue;const{name:w}=P;if(w==="#text"){const e=document.createTextNode(P.value);l.push(e),u.append(e);continue}let y;if(P?.attributes?.xmlns?y=document.createElementNS(P.attributes.xmlns,w):y=document.createElement(w),u.append(y),P.attributes&&this.setAttributes({html:y,element:P,storage:E,intent:i,linkService:S}),P.children&&P.children.length>0)p.push([P,-1,y]);else if(P.value){const e=document.createTextNode(P.value);m.XfaText.shouldBuildText(w)&&l.push(e),y.append(e)}}for(const g of n.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:l}}static update(D){const E=`matrix(${D.viewport.transform.join(",")})`;D.div.style.transform=E,D.div.hidden=!1}}o.XfaLayer=R}),((B,o,F)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SVGGraphics=void 0;var m=F(6),R=F(1),H=F(10);let D=class{constructor(){(0,R.unreachable)("Not implemented: SVGGraphics")}};o.SVGGraphics=D;{let g=function(e){let a=[];const T=[];for(const O of e){if(O.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),T.push(a),a=a.at(-1).items;continue}O.fn==="restore"?a=T.pop():a.push(O)}return a},c=function(e){if(Number.isInteger(e))return e.toString();const a=e.toFixed(10);let T=a.length-1;if(a[T]!=="0")return a;do T--;while(a[T]==="0");return a.substring(0,a[T]==="."?T:T+1)},u=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${c(e[0])} ${c(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const a=Math.acos(e[0])*180/Math.PI;return`rotate(${c(a)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${c(e[4])} ${c(e[5])})`;return`matrix(${c(e[0])} ${c(e[1])} ${c(e[2])} ${c(e[3])} ${c(e[4])} ${c(e[5])})`};const E={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},S="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/1999/xlink",i=["butt","round","square"],_=["miter","round","bevel"],p=function(e,a="",T=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!T)return URL.createObjectURL(new Blob([e],{type:a}));const O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let x=`data:${a};base64,`;for(let I=0,U=e.length;I<U;I+=3){const z=e[I]&255,ie=e[I+1]&255,J=e[I+2]&255,q=z>>2,W=(z&3)<<4|ie>>4,M=I+1<U?(ie&15)<<2|J>>6:64,C=I+2<U?J&63:64;x+=O[q]+O[W]+O[M]+O[C]}return x},n=(function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,T=new Int32Array(256);for(let J=0;J<256;J++){let q=J;for(let W=0;W<8;W++)q&1?q=3988292384^q>>1&2147483647:q=q>>1&2147483647;T[J]=q}function O(J,q,W){let M=-1;for(let C=q;C<W;C++){const A=(M^J[C])&255,h=T[A];M=M>>>8^h}return M^-1}function x(J,q,W,M){let C=M;const A=q.length;W[C]=A>>24&255,W[C+1]=A>>16&255,W[C+2]=A>>8&255,W[C+3]=A&255,C+=4,W[C]=J.charCodeAt(0)&255,W[C+1]=J.charCodeAt(1)&255,W[C+2]=J.charCodeAt(2)&255,W[C+3]=J.charCodeAt(3)&255,C+=4,W.set(q,C),C+=q.length;const h=O(W,M+4,C);W[C]=h>>24&255,W[C+1]=h>>16&255,W[C+2]=h>>8&255,W[C+3]=h&255}function I(J,q,W){let M=1,C=0;for(let A=q;A<W;++A)M=(M+(J[A]&255))%65521,C=(C+M)%65521;return C<<16|M}function U(J){if(!H.isNodeJS)return z(J);try{let q;parseInt(process.versions.node)>=8?q=J:q=Buffer.from(J);const W=require$$5.deflateSync(q,{level:9});return W instanceof Uint8Array?W:new Uint8Array(W)}catch(q){(0,R.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+q)}return z(J)}function z(J){let q=J.length;const W=65535,M=Math.ceil(q/W),C=new Uint8Array(2+q+M*5+4);let A=0;C[A++]=120,C[A++]=156;let h=0;for(;q>W;)C[A++]=0,C[A++]=255,C[A++]=255,C[A++]=0,C[A++]=0,C.set(J.subarray(h,h+W),A),A+=W,h+=W,q-=W;C[A++]=1,C[A++]=q&255,C[A++]=q>>8&255,C[A++]=~q&65535&255,C[A++]=(~q&65535)>>8&255,C.set(J.subarray(h),A),A+=J.length-h;const r=I(J,0,J.length);return C[A++]=r>>24&255,C[A++]=r>>16&255,C[A++]=r>>8&255,C[A++]=r&255,C}function ie(J,q,W,M){const C=J.width,A=J.height;let h,r,v;const L=J.data;switch(q){case R.ImageKind.GRAYSCALE_1BPP:r=0,h=1,v=C+7>>3;break;case R.ImageKind.RGB_24BPP:r=2,h=8,v=C*3;break;case R.ImageKind.RGBA_32BPP:r=6,h=8,v=C*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+v)*A);let f=0,b=0;for(let Q=0;Q<A;++Q)s[f++]=0,s.set(L.subarray(b,b+v),f),b+=v,f+=v;if(q===R.ImageKind.GRAYSCALE_1BPP&&M){f=0;for(let Q=0;Q<A;Q++){f++;for(let $=0;$<v;$++)s[f++]^=255}}const k=new Uint8Array([C>>24&255,C>>16&255,C>>8&255,C&255,A>>24&255,A>>16&255,A>>8&255,A&255,h,r,0,0,0]),N=U(s),j=e.length+a*3+k.length+N.length,V=new Uint8Array(j);let X=0;return V.set(e,X),X+=e.length,x("IHDR",k,V,X),X+=a+k.length,x("IDATA",N,V,X),X+=a+N.length,x("IEND",new Uint8Array(0),V,X),p(V,"image/png",W)}return function(q,W,M){const C=q.kind===void 0?R.ImageKind.GRAYSCALE_1BPP:q.kind;return ie(q,C,W,M)}})();class l{constructor(){this.fontSizeScale=1,this.fontWeight=E.fontWeight,this.fontSize=0,this.textMatrix=R.IDENTITY_MATRIX,this.fontMatrix=R.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=R.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=E.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,T){this.x=a,this.y=T}}let P=0,w=0,y=0;o.SVGGraphics=D=class{constructor(e,a,T=!1){(0,m.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new m.DOMSVGFactory,this.current=new l,this.transformMatrix=R.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!T,this._operatorIdMapping=[];for(const O in R.OPS)this._operatorIdMapping[R.OPS[O]]=O}getObject(e,a=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):a}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const a=e.fnArray,T=e.argsArray;for(let O=0,x=a.length;O<x;O++)if(a[O]===R.OPS.dependency)for(const I of T[O]){const U=I.startsWith("g_")?this.commonObjs:this.objs,z=new Promise(ie=>{U.get(I,ie)});this.current.dependencies.push(z)}return Promise.all(this.current.dependencies)}transform(e,a,T,O,x,I){const U=[e,a,T,O,x,I];this.transformMatrix=R.Util.transform(this.transformMatrix,U),this.tgrp=null}getSVG(e,a){this.viewport=a;const T=this._initialize(a);return this.loadDependencies(e).then(()=>(this.transformMatrix=R.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),T))}convertOpList(e){const a=this._operatorIdMapping,T=e.argsArray,O=e.fnArray,x=[];for(let I=0,U=O.length;I<U;I++){const z=O[I];x.push({fnId:z,fn:a[z],args:T[I]})}return g(x)}executeOpTree(e){for(const a of e){const T=a.fn,O=a.fnId,x=a.args;switch(O|0){case R.OPS.beginText:this.beginText();break;case R.OPS.dependency:break;case R.OPS.setLeading:this.setLeading(x);break;case R.OPS.setLeadingMoveText:this.setLeadingMoveText(x[0],x[1]);break;case R.OPS.setFont:this.setFont(x);break;case R.OPS.showText:this.showText(x[0]);break;case R.OPS.showSpacedText:this.showText(x[0]);break;case R.OPS.endText:this.endText();break;case R.OPS.moveText:this.moveText(x[0],x[1]);break;case R.OPS.setCharSpacing:this.setCharSpacing(x[0]);break;case R.OPS.setWordSpacing:this.setWordSpacing(x[0]);break;case R.OPS.setHScale:this.setHScale(x[0]);break;case R.OPS.setTextMatrix:this.setTextMatrix(x[0],x[1],x[2],x[3],x[4],x[5]);break;case R.OPS.setTextRise:this.setTextRise(x[0]);break;case R.OPS.setTextRenderingMode:this.setTextRenderingMode(x[0]);break;case R.OPS.setLineWidth:this.setLineWidth(x[0]);break;case R.OPS.setLineJoin:this.setLineJoin(x[0]);break;case R.OPS.setLineCap:this.setLineCap(x[0]);break;case R.OPS.setMiterLimit:this.setMiterLimit(x[0]);break;case R.OPS.setFillRGBColor:this.setFillRGBColor(x[0],x[1],x[2]);break;case R.OPS.setStrokeRGBColor:this.setStrokeRGBColor(x[0],x[1],x[2]);break;case R.OPS.setStrokeColorN:this.setStrokeColorN(x);break;case R.OPS.setFillColorN:this.setFillColorN(x);break;case R.OPS.shadingFill:this.shadingFill(x[0]);break;case R.OPS.setDash:this.setDash(x[0],x[1]);break;case R.OPS.setRenderingIntent:this.setRenderingIntent(x[0]);break;case R.OPS.setFlatness:this.setFlatness(x[0]);break;case R.OPS.setGState:this.setGState(x[0]);break;case R.OPS.fill:this.fill();break;case R.OPS.eoFill:this.eoFill();break;case R.OPS.stroke:this.stroke();break;case R.OPS.fillStroke:this.fillStroke();break;case R.OPS.eoFillStroke:this.eoFillStroke();break;case R.OPS.clip:this.clip("nonzero");break;case R.OPS.eoClip:this.clip("evenodd");break;case R.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case R.OPS.paintImageXObject:this.paintImageXObject(x[0]);break;case R.OPS.paintInlineImageXObject:this.paintInlineImageXObject(x[0]);break;case R.OPS.paintImageMaskXObject:this.paintImageMaskXObject(x[0]);break;case R.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(x[0],x[1]);break;case R.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case R.OPS.closePath:this.closePath();break;case R.OPS.closeStroke:this.closeStroke();break;case R.OPS.closeFillStroke:this.closeFillStroke();break;case R.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case R.OPS.nextLine:this.nextLine();break;case R.OPS.transform:this.transform(x[0],x[1],x[2],x[3],x[4],x[5]);break;case R.OPS.constructPath:this.constructPath(x[0],x[1]);break;case R.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,R.warn)(`Unimplemented operator ${T}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,a,T,O,x,I){const U=this.current;U.textMatrix=U.lineMatrix=[e,a,T,O,x,I],U.textMatrixScale=Math.hypot(e,a),U.x=U.lineX=0,U.y=U.lineY=0,U.xcoords=[],U.ycoords=[],U.tspan=this.svgFactory.createElement("svg:tspan"),U.tspan.setAttributeNS(null,"font-family",U.fontFamily),U.tspan.setAttributeNS(null,"font-size",`${c(U.fontSize)}px`),U.tspan.setAttributeNS(null,"y",c(-U.y)),U.txtElement=this.svgFactory.createElement("svg:text"),U.txtElement.append(U.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=R.IDENTITY_MATRIX,e.lineMatrix=R.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,a){const T=this.current;T.x=T.lineX+=e,T.y=T.lineY+=a,T.xcoords=[],T.ycoords=[],T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size",`${c(T.fontSize)}px`),T.tspan.setAttributeNS(null,"y",c(-T.y))}showText(e){const a=this.current,T=a.font,O=a.fontSize;if(O===0)return;const x=a.fontSizeScale,I=a.charSpacing,U=a.wordSpacing,z=a.fontDirection,ie=a.textHScale*z,J=T.vertical,q=J?1:-1,W=T.defaultVMetrics,M=O*a.fontMatrix[0];let C=0;for(const r of e){if(r===null){C+=z*U;continue}else if(typeof r=="number"){C+=q*r*O/1e3;continue}const v=(r.isSpace?U:0)+I,L=r.fontChar;let s,f,b=r.width;if(J){let N;const j=r.vmetric||W;N=r.vmetric?j[1]:b*.5,N=-N*M;const V=j[2]*M;b=j?-j[0]:b,s=N/x,f=(C+V)/x}else s=C/x,f=0;(r.isInFont||T.missingFile)&&(a.xcoords.push(a.x+s),J&&a.ycoords.push(-a.y+f),a.tspan.textContent+=L);let k;J?k=b*M-v*z:k=b*M+v*z,C+=k}a.tspan.setAttributeNS(null,"x",a.xcoords.map(c).join(" ")),J?a.tspan.setAttributeNS(null,"y",a.ycoords.map(c).join(" ")):a.tspan.setAttributeNS(null,"y",c(-a.y)),J?a.y-=C:a.x+=C*ie,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${c(a.fontSize)}px`),a.fontStyle!==E.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==E.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const A=a.textRenderingMode&R.TextRenderingMode.FILL_STROKE_MASK;if(A===R.TextRenderingMode.FILL||A===R.TextRenderingMode.FILL_STROKE?(a.fillColor!==E.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===R.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),A===R.TextRenderingMode.STROKE||A===R.TextRenderingMode.FILL_STROKE){const r=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,r)}let h=a.textMatrix;a.textRise!==0&&(h=h.slice(),h[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${u(h)} scale(${c(ie)}, -1)`),a.txtElement.setAttributeNS(S,"xml:space","preserve"),a.txtElement.append(a.tspan),a.txtgrp.append(a.txtElement),this._ensureTransformGroup().append(a.txtElement)}setLeadingMoveText(e,a){this.setLeading(-a),this.moveText(e,a)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const a=p(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${a}); }
`}setFont(e){const a=this.current,T=this.commonObjs.get(e[0]);let O=e[1];a.font=T,this.embedFonts&&!T.missingFile&&!this.embeddedFonts[T.loadedName]&&(this.addFontStyle(T),this.embeddedFonts[T.loadedName]=T),a.fontMatrix=T.fontMatrix||R.FONT_IDENTITY_MATRIX;let x="normal";T.black?x="900":T.bold&&(x="bold");const I=T.italic?"italic":"normal";O<0?(O=-O,a.fontDirection=-1):a.fontDirection=1,a.fontSize=O,a.fontFamily=T.loadedName,a.fontWeight=x,a.fontStyle=I,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",c(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&R.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement?.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=i[e]}setLineJoin(e){this.current.lineJoin=_[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,a,T){this.current.strokeColor=R.Util.makeHexColor(e,a,T)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,a,T){this.current.fillColor=R.Util.makeHexColor(e,a,T),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const a=this.viewport.width,T=this.viewport.height,O=R.Util.inverseTransform(this.transformMatrix),x=R.Util.applyTransform([0,0],O),I=R.Util.applyTransform([0,T],O),U=R.Util.applyTransform([a,0],O),z=R.Util.applyTransform([a,T],O),ie=Math.min(x[0],I[0],U[0],z[0]),J=Math.min(x[1],I[1],U[1],z[1]),q=Math.max(x[0],I[0],U[0],z[0]),W=Math.max(x[1],I[1],U[1],z[1]),M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x",ie),M.setAttributeNS(null,"y",J),M.setAttributeNS(null,"width",q-ie),M.setAttributeNS(null,"height",W-J),M.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&M.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(M)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const a=e[1],T=e[2],O=e[3]||R.IDENTITY_MATRIX,[x,I,U,z]=e[4],ie=e[5],J=e[6],q=e[7],W=`shading${y++}`,[M,C,A,h]=R.Util.normalizeRect([...R.Util.applyTransform([x,I],O),...R.Util.applyTransform([U,z],O)]),[r,v]=R.Util.singularValueDecompose2dScale(O),L=ie*r,s=J*v,f=this.svgFactory.createElement("svg:pattern");f.setAttributeNS(null,"id",W),f.setAttributeNS(null,"patternUnits","userSpaceOnUse"),f.setAttributeNS(null,"width",L),f.setAttributeNS(null,"height",s),f.setAttributeNS(null,"x",`${M}`),f.setAttributeNS(null,"y",`${C}`);const b=this.svg,k=this.transformMatrix,N=this.current.fillColor,j=this.current.strokeColor,V=this.svgFactory.create(A-M,h-C);if(this.svg=V,this.transformMatrix=O,q===2){const X=R.Util.makeHexColor(...a);this.current.fillColor=X,this.current.strokeColor=X}return this.executeOpTree(this.convertOpList(T)),this.svg=b,this.transformMatrix=k,this.current.fillColor=N,this.current.strokeColor=j,f.append(V.childNodes[0]),this.defs.append(f),`url(#${W})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const a=`shading${y++}`,T=e[3];let O;switch(e[1]){case"axial":const x=e[4],I=e[5];O=this.svgFactory.createElement("svg:linearGradient"),O.setAttributeNS(null,"id",a),O.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),O.setAttributeNS(null,"x1",x[0]),O.setAttributeNS(null,"y1",x[1]),O.setAttributeNS(null,"x2",I[0]),O.setAttributeNS(null,"y2",I[1]);break;case"radial":const U=e[4],z=e[5],ie=e[6],J=e[7];O=this.svgFactory.createElement("svg:radialGradient"),O.setAttributeNS(null,"id",a),O.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),O.setAttributeNS(null,"cx",z[0]),O.setAttributeNS(null,"cy",z[1]),O.setAttributeNS(null,"r",J),O.setAttributeNS(null,"fx",U[0]),O.setAttributeNS(null,"fy",U[1]),O.setAttributeNS(null,"fr",ie);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const x of T){const I=this.svgFactory.createElement("svg:stop");I.setAttributeNS(null,"offset",x[0]),I.setAttributeNS(null,"stop-color",x[1]),O.append(I)}return this.defs.append(O),`url(#${a})`;case"Mesh":return(0,R.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,a){this.current.dashArray=e,this.current.dashPhase=a}constructPath(e,a){const T=this.current;let O=T.x,x=T.y,I=[],U=0;for(const z of e)switch(z|0){case R.OPS.rectangle:O=a[U++],x=a[U++];const ie=a[U++],J=a[U++],q=O+ie,W=x+J;I.push("M",c(O),c(x),"L",c(q),c(x),"L",c(q),c(W),"L",c(O),c(W),"Z");break;case R.OPS.moveTo:O=a[U++],x=a[U++],I.push("M",c(O),c(x));break;case R.OPS.lineTo:O=a[U++],x=a[U++],I.push("L",c(O),c(x));break;case R.OPS.curveTo:O=a[U+4],x=a[U+5],I.push("C",c(a[U]),c(a[U+1]),c(a[U+2]),c(a[U+3]),c(O),c(x)),U+=6;break;case R.OPS.curveTo2:I.push("C",c(O),c(x),c(a[U]),c(a[U+1]),c(a[U+2]),c(a[U+3])),O=a[U+2],x=a[U+3],U+=4;break;case R.OPS.curveTo3:O=a[U+2],x=a[U+3],I.push("C",c(a[U]),c(a[U+1]),c(O),c(x),c(O),c(x)),U+=4;break;case R.OPS.closePath:I.push("Z");break}I=I.join(" "),T.path&&e.length>0&&e[0]!==R.OPS.rectangle&&e[0]!==R.OPS.moveTo?I=T.path.getAttributeNS(null,"d")+I:(T.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(T.path)),T.path.setAttributeNS(null,"d",I),T.path.setAttributeNS(null,"fill","none"),T.element=T.path,T.setCurrentPoint(O,x)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const a=`clippath${P++}`,T=this.svgFactory.createElement("svg:clipPath");T.setAttributeNS(null,"id",a),T.setAttributeNS(null,"transform",u(this.transformMatrix));const O=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?O.setAttributeNS(null,"clip-rule","evenodd"):O.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,T.append(O),this.defs.append(T),e.activeClipUrl){e.clipGroup=null;for(const x of this.extraStack)x.clipGroup=null;T.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const a=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",a)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[a,T]of e)switch(a){case"LW":this.setLineWidth(T);break;case"LC":this.setLineCap(T);break;case"LJ":this.setLineJoin(T);break;case"ML":this.setMiterLimit(T);break;case"D":this.setDash(T[0],T[1]);break;case"RI":this.setRenderingIntent(T);break;case"FL":this.setFlatness(T);break;case"Font":this.setFont(T);break;case"CA":this.setStrokeAlpha(T);break;case"ca":this.setFillAlpha(T);break;default:(0,R.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,a=1){const T=this.current;let O=T.dashArray;a!==1&&O.length>0&&(O=O.map(function(x){return a*x})),e.setAttributeNS(null,"stroke",T.strokeColor),e.setAttributeNS(null,"stroke-opacity",T.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",c(T.miterLimit)),e.setAttributeNS(null,"stroke-linecap",T.lineCap),e.setAttributeNS(null,"stroke-linejoin",T.lineJoin),e.setAttributeNS(null,"stroke-width",c(a*T.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",O.map(c).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",c(a*T.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const a=this.getObject(e);if(!a){(0,R.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(e,a){const T=e.width,O=e.height,x=n(e,this.forceDataSchema,!!a),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",c(T)),I.setAttributeNS(null,"height",c(O)),this.current.element=I,this.clip("nonzero");const U=this.svgFactory.createElement("svg:image");U.setAttributeNS(d,"xlink:href",x),U.setAttributeNS(null,"x","0"),U.setAttributeNS(null,"y",c(-O)),U.setAttributeNS(null,"width",c(T)+"px"),U.setAttributeNS(null,"height",c(O)+"px"),U.setAttributeNS(null,"transform",`scale(${c(1/T)} ${c(-1/O)})`),a?a.append(U):this._ensureTransformGroup().append(U)}paintImageMaskXObject(e){const a=this.getObject(e.data,e);if(a.bitmap){(0,R.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const T=this.current,O=a.width,x=a.height,I=T.fillColor;T.maskId=`mask${w++}`;const U=this.svgFactory.createElement("svg:mask");U.setAttributeNS(null,"id",T.maskId);const z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",c(O)),z.setAttributeNS(null,"height",c(x)),z.setAttributeNS(null,"fill",I),z.setAttributeNS(null,"mask",`url(#${T.maskId})`),this.defs.append(U),this._ensureTransformGroup().append(z),this.paintInlineImageXObject(a,U)}paintFormXObjectBegin(e,a){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),a){const T=a[2]-a[0],O=a[3]-a[1],x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",a[0]),x.setAttributeNS(null,"y",a[1]),x.setAttributeNS(null,"width",c(T)),x.setAttributeNS(null,"height",c(O)),this.current.element=x,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const a=this.svgFactory.create(e.width,e.height),T=this.svgFactory.createElement("svg:defs");a.append(T),this.defs=T;const O=this.svgFactory.createElement("svg:g");return O.setAttributeNS(null,"transform",u(e.transform)),a.append(O),this.svg=O,a}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",u(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}})],__webpack_module_cache__={};function __w_pdfjs_require__(B){var o=__webpack_module_cache__[B];if(o!==void 0)return o.exports;var F=__webpack_module_cache__[B]={exports:{}};return __webpack_modules__[B](F,F.exports,__w_pdfjs_require__),F.exports}var __webpack_exports__={};return(()=>{var B=__webpack_exports__;Object.defineProperty(B,"__esModule",{value:!0}),Object.defineProperty(B,"AbortException",{enumerable:!0,get:function(){return o.AbortException}}),Object.defineProperty(B,"AnnotationEditorLayer",{enumerable:!0,get:function(){return H.AnnotationEditorLayer}}),Object.defineProperty(B,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return o.AnnotationEditorParamsType}}),Object.defineProperty(B,"AnnotationEditorType",{enumerable:!0,get:function(){return o.AnnotationEditorType}}),Object.defineProperty(B,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return D.AnnotationEditorUIManager}}),Object.defineProperty(B,"AnnotationLayer",{enumerable:!0,get:function(){return E.AnnotationLayer}}),Object.defineProperty(B,"AnnotationMode",{enumerable:!0,get:function(){return o.AnnotationMode}}),Object.defineProperty(B,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(B,"FeatureTest",{enumerable:!0,get:function(){return o.FeatureTest}}),Object.defineProperty(B,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(B,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(B,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(B,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(B,"PDFDataRangeTransport",{enumerable:!0,get:function(){return F.PDFDataRangeTransport}}),Object.defineProperty(B,"PDFDateString",{enumerable:!0,get:function(){return m.PDFDateString}}),Object.defineProperty(B,"PDFWorker",{enumerable:!0,get:function(){return F.PDFWorker}}),Object.defineProperty(B,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(B,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(B,"PixelsPerInch",{enumerable:!0,get:function(){return m.PixelsPerInch}}),Object.defineProperty(B,"PromiseCapability",{enumerable:!0,get:function(){return o.PromiseCapability}}),Object.defineProperty(B,"RenderingCancelledException",{enumerable:!0,get:function(){return m.RenderingCancelledException}}),Object.defineProperty(B,"SVGGraphics",{enumerable:!0,get:function(){return d.SVGGraphics}}),Object.defineProperty(B,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(B,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(B,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(B,"XfaLayer",{enumerable:!0,get:function(){return i.XfaLayer}}),Object.defineProperty(B,"build",{enumerable:!0,get:function(){return F.build}}),Object.defineProperty(B,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(B,"getDocument",{enumerable:!0,get:function(){return F.getDocument}}),Object.defineProperty(B,"getFilenameFromUrl",{enumerable:!0,get:function(){return m.getFilenameFromUrl}}),Object.defineProperty(B,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return m.getPdfFilenameFromUrl}}),Object.defineProperty(B,"getXfaPageViewport",{enumerable:!0,get:function(){return m.getXfaPageViewport}}),Object.defineProperty(B,"isDataScheme",{enumerable:!0,get:function(){return m.isDataScheme}}),Object.defineProperty(B,"isPdfFile",{enumerable:!0,get:function(){return m.isPdfFile}}),Object.defineProperty(B,"loadScript",{enumerable:!0,get:function(){return m.loadScript}}),Object.defineProperty(B,"normalizeUnicode",{enumerable:!0,get:function(){return o.normalizeUnicode}}),Object.defineProperty(B,"renderTextLayer",{enumerable:!0,get:function(){return R.renderTextLayer}}),Object.defineProperty(B,"setLayerDimensions",{enumerable:!0,get:function(){return m.setLayerDimensions}}),Object.defineProperty(B,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(B,"updateTextLayer",{enumerable:!0,get:function(){return R.updateTextLayer}}),Object.defineProperty(B,"version",{enumerable:!0,get:function(){return F.version}});var o=__w_pdfjs_require__(1),F=__w_pdfjs_require__(2),m=__w_pdfjs_require__(6),R=__w_pdfjs_require__(26),H=__w_pdfjs_require__(27),D=__w_pdfjs_require__(5),E=__w_pdfjs_require__(32),S=__w_pdfjs_require__(14),d=__w_pdfjs_require__(35),i=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf)),pdf.exports}var pdfExports=requirePdf(),pdf_viewer={exports:{}},hasRequiredPdf_viewer;function requirePdf_viewer(){return hasRequiredPdf_viewer||(hasRequiredPdf_viewer=1,(function(B,o){(function(m,R){B.exports=R()})(globalThis,()=>(()=>{var F=[,((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.SimpleLinkService=E.PDFLinkService=E.LinkTarget=void 0;var d=S(2);const i="noopener noreferrer nofollow",_={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};E.LinkTarget=_;function p(g,{url:c,target:u,rel:P,enabled:w=!0}={}){if(!c||typeof c!="string")throw new Error('A valid "url" parameter must provided.');const y=(0,d.removeNullCharacters)(c);w?g.href=g.title=y:(g.href="",g.title=`Disabled: ${y}`,g.onclick=()=>!1);let e="";switch(u){case _.NONE:break;case _.SELF:e="_self";break;case _.BLANK:e="_blank";break;case _.PARENT:e="_parent";break;case _.TOP:e="_top";break}g.target=e,g.rel=typeof P=="string"?P:i}class n{#e=new Map;constructor({eventBus:c,externalLinkTarget:u=null,externalLinkRel:P=null,ignoreDestinationZoom:w=!1}={}){this.eventBus=c,this.externalLinkTarget=u,this.externalLinkRel=P,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=w,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(c,u=null){this.baseUrl=u,this.pdfDocument=c,this.#e.clear()}setViewer(c){this.pdfViewer=c}setHistory(c){this.pdfHistory=c}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(c){this.pdfViewer.currentPageNumber=c}get rotation(){return this.pdfViewer.pagesRotation}set rotation(c){this.pdfViewer.pagesRotation=c}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}#t(c,u=null,P){const w=P[0];let y;if(typeof w=="object"&&w!==null){if(y=this._cachedPageNumber(w),!y){this.pdfDocument.getPageIndex(w).then(e=>{this.cachePageRef(e+1,w),this.#t(c,u,P)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${w}" is not a valid page reference, for dest="${c}".`)});return}}else if(Number.isInteger(w))y=w+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${w}" is not a valid destination reference, for dest="${c}".`);return}if(!y||y<1||y>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${y}" is not a valid page number, for dest="${c}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:u,explicitDest:P,pageNumber:y})),this.pdfViewer.scrollPageIntoView({pageNumber:y,destArray:P,ignoreDestinationZoom:this._ignoreDestinationZoom})}async goToDestination(c){if(!this.pdfDocument)return;let u,P;if(typeof c=="string"?(u=c,P=await this.pdfDocument.getDestination(c)):(u=null,P=await c),!Array.isArray(P)){console.error(`PDFLinkService.goToDestination: "${P}" is not a valid destination array, for dest="${c}".`);return}this.#t(c,u,P)}goToPage(c){if(!this.pdfDocument)return;const u=typeof c=="string"&&this.pdfViewer.pageLabelToPageNumber(c)||c|0;if(!(Number.isInteger(u)&&u>0&&u<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${c}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(u)),this.pdfViewer.scrollPageIntoView({pageNumber:u})}addLinkAttributes(c,u,P=!1){p(c,{url:u,target:P?_.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(c){if(typeof c=="string"){if(c.length>0)return this.getAnchorUrl("#"+escape(c))}else if(Array.isArray(c)){const u=JSON.stringify(c);if(u.length>0)return this.getAnchorUrl("#"+escape(u))}return this.getAnchorUrl("")}getAnchorUrl(c){return this.baseUrl?this.baseUrl+c:c}setHash(c){if(!this.pdfDocument)return;let u,P;if(c.includes("=")){const w=(0,d.parseQueryString)(c);if(w.has("search")){const y=w.get("search").replaceAll('"',""),e=w.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:e?y:y.match(/\S+/g)})}if(w.has("page")&&(u=w.get("page")|0||1),w.has("zoom")){const y=w.get("zoom").split(","),e=y[0],a=parseFloat(e);e.includes("Fit")?e==="Fit"||e==="FitB"?P=[null,{name:e}]:e==="FitH"||e==="FitBH"||e==="FitV"||e==="FitBV"?P=[null,{name:e},y.length>1?y[1]|0:null]:e==="FitR"?y.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):P=[null,{name:e},y[1]|0,y[2]|0,y[3]|0,y[4]|0]:console.error(`PDFLinkService.setHash: "${e}" is not a valid zoom value.`):P=[null,{name:"XYZ"},y.length>1?y[1]|0:null,y.length>2?y[2]|0:null,a?a/100:e]}P?this.pdfViewer.scrollPageIntoView({pageNumber:u||this.page,destArray:P,allowNegativeOffset:!0}):u&&(this.page=u),w.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:w.get("pagemode")}),w.has("nameddest")&&this.goToDestination(w.get("nameddest"))}else{P=unescape(c);try{P=JSON.parse(P),Array.isArray(P)||(P=P.toString())}catch{}if(typeof P=="string"||n.#i(P)){this.goToDestination(P);return}console.error(`PDFLinkService.setHash: "${unescape(c)}" is not a valid destination.`)}}executeNamedAction(c){switch(c){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:c})}async executeSetOCGState(c){const u=this.pdfDocument,P=await this.pdfViewer.optionalContentConfigPromise;if(u!==this.pdfDocument)return;let w;for(const y of c.state){switch(y){case"ON":case"OFF":case"Toggle":w=y;continue}switch(w){case"ON":P.setVisibility(y,!0);break;case"OFF":P.setVisibility(y,!1);break;case"Toggle":const e=P.getGroup(y);e&&P.setVisibility(y,!e.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(P)}cachePageRef(c,u){if(!u)return;const P=u.gen===0?`${u.num}R`:`${u.num}R${u.gen}`;this.#e.set(P,c)}_cachedPageNumber(c){if(!c)return null;const u=c.gen===0?`${c.num}R`:`${c.num}R${c.gen}`;return this.#e.get(u)||null}isPageVisible(c){return this.pdfViewer.isPageVisible(c)}isPageCached(c){return this.pdfViewer.isPageCached(c)}static#i(c){if(!Array.isArray(c))return!1;const u=c.length;if(u<2)return!1;const P=c[0];if(!(typeof P=="object"&&Number.isInteger(P.num)&&Number.isInteger(P.gen))&&!(Number.isInteger(P)&&P>=0))return!1;const w=c[1];if(!(typeof w=="object"&&typeof w.name=="string"))return!1;let y=!0;switch(w.name){case"XYZ":if(u!==5)return!1;break;case"Fit":case"FitB":return u===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(u!==3)return!1;break;case"FitR":if(u!==6)return!1;y=!1;break;default:return!1}for(let e=2;e<u;e++){const a=c[e];if(!(typeof a=="number"||y&&a===null))return!1}return!0}}E.PDFLinkService=n;class l{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(c){}get rotation(){return 0}set rotation(c){}get isInPresentationMode(){return!1}async goToDestination(c){}goToPage(c){}addLinkAttributes(c,u,P=!1){p(c,{url:u,enabled:this.externalLinkEnabled})}getDestinationHash(c){return"#"}getAnchorUrl(c){return"#"}setHash(c){}executeNamedAction(c){}executeSetOCGState(c){}cachePageRef(c,u){}isPageVisible(c){return!0}isPageCached(c){return!0}}E.SimpleLinkService=l}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.animationStarted=E.VERTICAL_PADDING=E.UNKNOWN_SCALE=E.TextLayerMode=E.SpreadMode=E.SidebarView=E.ScrollMode=E.SCROLLBAR_PADDING=E.RenderingStates=E.ProgressBar=E.PresentationModeState=E.OutputScale=E.MIN_SCALE=E.MAX_SCALE=E.MAX_AUTO_SCALE=E.DEFAULT_SCALE_VALUE=E.DEFAULT_SCALE_DELTA=E.DEFAULT_SCALE=E.CursorTool=E.AutoPrintRegExp=void 0,E.apiPageLayoutToViewerModes=$,E.apiPageModeToSidebarView=te,E.approximateFraction=W,E.backtrackBeforeAllVisibleElements=A,E.binarySearchFirstItem=q,E.docStyle=void 0,E.getActiveOrFocusedElement=Q,E.getPageSizeInches=C,E.getVisibleElements=h,E.isPortraitOrientation=k,E.isValidRotation=s,E.isValidScrollMode=f,E.isValidSpreadMode=b,E.noContextMenuHandler=r,E.normalizeWheelEventDelta=L,E.normalizeWheelEventDirection=v,E.parseQueryString=z,E.removeNullCharacters=J,E.roundToDivide=M,E.scrollIntoView=I,E.toggleCheckedBtn=re,E.watchScroll=U;const S="auto";E.DEFAULT_SCALE_VALUE=S;const d=1;E.DEFAULT_SCALE=d;const i=1.1;E.DEFAULT_SCALE_DELTA=i;const _=.1;E.MIN_SCALE=_;const p=10;E.MAX_SCALE=p;const n=0;E.UNKNOWN_SCALE=n;const l=1.25;E.MAX_AUTO_SCALE=l;const g=40;E.SCROLLBAR_PADDING=g;const c=5;E.VERTICAL_PADDING=c;const u={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};E.RenderingStates=u;const P={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};E.PresentationModeState=P;const w={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};E.SidebarView=w;const y={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};E.TextLayerMode=y;const e={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};E.ScrollMode=e;const a={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};E.SpreadMode=a;const T={SELECT:0,HAND:1,ZOOM:2};E.CursorTool=T;const O=/\bprint\s*\(/;E.AutoPrintRegExp=O;class x{constructor(){const ee=window.devicePixelRatio||1;this.sx=ee,this.sy=ee}get scaled(){return this.sx!==1||this.sy!==1}}E.OutputScale=x;function I(G,ee,ne=!1){let Z=G.offsetParent;if(!Z){console.error("offsetParent is not set -- cannot scroll");return}let ae=G.offsetTop+G.clientTop,oe=G.offsetLeft+G.clientLeft;for(;Z.clientHeight===Z.scrollHeight&&Z.clientWidth===Z.scrollWidth||ne&&(Z.classList.contains("markedContent")||getComputedStyle(Z).overflow==="hidden");)if(ae+=Z.offsetTop,oe+=Z.offsetLeft,Z=Z.offsetParent,!Z)return;ee&&(ee.top!==void 0&&(ae+=ee.top),ee.left!==void 0&&(oe+=ee.left,Z.scrollLeft=oe)),Z.scrollTop=ae}function U(G,ee){const ne=function(oe){ae||(ae=window.requestAnimationFrame(function(){ae=null;const he=G.scrollLeft,fe=Z.lastX;he!==fe&&(Z.right=he>fe),Z.lastX=he;const pe=G.scrollTop,ue=Z.lastY;pe!==ue&&(Z.down=pe>ue),Z.lastY=pe,ee(Z)}))},Z={right:!0,down:!0,lastX:G.scrollLeft,lastY:G.scrollTop,_eventHandler:ne};let ae=null;return G.addEventListener("scroll",ne,!0),Z}function z(G){const ee=new Map;for(const[ne,Z]of new URLSearchParams(G))ee.set(ne.toLowerCase(),Z);return ee}const ie=/[\x01-\x1F]/g;function J(G,ee=!1){return typeof G!="string"?(console.error("The argument must be a string."),G):(ee&&(G=G.replaceAll(ie," ")),G.replaceAll("\0",""))}function q(G,ee,ne=0){let Z=ne,ae=G.length-1;if(ae<0||!ee(G[ae]))return G.length;if(ee(G[Z]))return Z;for(;Z<ae;){const oe=Z+ae>>1,ce=G[oe];ee(ce)?ae=oe:Z=oe+1}return Z}function W(G){if(Math.floor(G)===G)return[G,1];const ee=1/G,ne=8;if(ee>ne)return[1,ne];if(Math.floor(ee)===ee)return[1,ee];const Z=G>1?ee:G;let ae=0,oe=1,ce=1,he=1;for(;;){const pe=ae+ce,ue=oe+he;if(ue>ne)break;Z<=pe/ue?(ce=pe,he=ue):(ae=pe,oe=ue)}let fe;return Z-ae/oe<ce/he-Z?fe=Z===G?[ae,oe]:[oe,ae]:fe=Z===G?[ce,he]:[he,ce],fe}function M(G,ee){const ne=G%ee;return ne===0?G:Math.round(G-ne+ee)}function C({view:G,userUnit:ee,rotate:ne}){const[Z,ae,oe,ce]=G,he=ne%180!==0,fe=(oe-Z)/72*ee,pe=(ce-ae)/72*ee;return{width:he?pe:fe,height:he?fe:pe}}function A(G,ee,ne){if(G<2)return G;let Z=ee[G].div,ae=Z.offsetTop+Z.clientTop;ae>=ne&&(Z=ee[G-1].div,ae=Z.offsetTop+Z.clientTop);for(let oe=G-2;oe>=0&&(Z=ee[oe].div,!(Z.offsetTop+Z.clientTop+Z.clientHeight<=ae));--oe)G=oe;return G}function h({scrollEl:G,views:ee,sortByVisibility:ne=!1,horizontal:Z=!1,rtl:ae=!1}){const oe=G.scrollTop,ce=oe+G.clientHeight,he=G.scrollLeft,fe=he+G.clientWidth;function pe(se){const Y=se.div;return Y.offsetTop+Y.clientTop+Y.clientHeight>oe}function ue(se){const Y=se.div,K=Y.offsetLeft+Y.clientLeft,le=K+Y.clientWidth;return ae?K<fe:le>he}const Se=[],ye=new Set,xe=ee.length;let _e=q(ee,Z?ue:pe);_e>0&&_e<xe&&!Z&&(_e=A(_e,ee,oe));let Ae=Z?fe:-1;for(let se=_e;se<xe;se++){const Y=ee[se],K=Y.div,le=K.offsetLeft+K.clientLeft,de=K.offsetTop+K.clientTop,ge=K.clientWidth,me=K.clientHeight,we=le+ge,Pe=de+me;if(Ae===-1)Pe>=ce&&(Ae=Pe);else if((Z?le:de)>Ae)break;if(Pe<=oe||de>=ce||we<=he||le>=fe)continue;const Te=Math.max(0,oe-de)+Math.max(0,Pe-ce),ve=Math.max(0,he-le)+Math.max(0,we-fe),Me=(me-Te)/me,Ce=(ge-ve)/ge,ke=Me*Ce*100|0;Se.push({id:Y.id,x:le,y:de,view:Y,percent:ke,widthPercent:Ce*100|0}),ye.add(Y.id)}const Re=Se[0],Oe=Se.at(-1);return ne&&Se.sort(function(se,Y){const K=se.percent-Y.percent;return Math.abs(K)>.001?-K:se.id-Y.id}),{first:Re,last:Oe,views:Se,ids:ye}}function r(G){G.preventDefault()}function v(G){let ee=Math.hypot(G.deltaX,G.deltaY);const ne=Math.atan2(G.deltaY,G.deltaX);return-.25*Math.PI<ne&&ne<.75*Math.PI&&(ee=-ee),ee}function L(G){const ee=G.deltaMode;let ne=v(G);const Z=30,ae=30;return ee===WheelEvent.DOM_DELTA_PIXEL?ne/=Z*ae:ee===WheelEvent.DOM_DELTA_LINE&&(ne/=ae),ne}function s(G){return Number.isInteger(G)&&G%90===0}function f(G){return Number.isInteger(G)&&Object.values(e).includes(G)&&G!==e.UNKNOWN}function b(G){return Number.isInteger(G)&&Object.values(a).includes(G)&&G!==a.UNKNOWN}function k(G){return G.width<=G.height}const N=new Promise(function(G){window.requestAnimationFrame(G)});E.animationStarted=N;const j=document.documentElement.style;E.docStyle=j;function V(G,ee,ne){return Math.min(Math.max(G,ee),ne)}class X{#e=null;#t=null;#i=0;#n=null;#s=!0;constructor(ee){this.#e=ee.classList,this.#n=ee.style}get percent(){return this.#i}set percent(ee){if(this.#i=V(ee,0,100),isNaN(ee)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#i}%`)}setWidth(ee){if(!ee)return;const Z=ee.parentNode.offsetWidth-ee.offsetWidth;Z>0&&this.#n.setProperty("--progressBar-end-offset",`${Z}px`)}setDisableAutoFetch(ee=5e3){isNaN(this.#i)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},ee))}hide(){this.#s&&(this.#s=!1,this.#e.add("hidden"))}show(){this.#s||(this.#s=!0,this.#e.remove("hidden"))}}E.ProgressBar=X;function Q(){let G=document,ee=G.activeElement||G.querySelector(":focus");for(;ee?.shadowRoot;)G=ee.shadowRoot,ee=G.activeElement||G.querySelector(":focus");return ee}function $(G){let ee=e.VERTICAL,ne=a.NONE;switch(G){case"SinglePage":ee=e.PAGE;break;case"OneColumn":break;case"TwoPageLeft":ee=e.PAGE;case"TwoColumnLeft":ne=a.ODD;break;case"TwoPageRight":ee=e.PAGE;case"TwoColumnRight":ne=a.EVEN;break}return{scrollMode:ee,spreadMode:ne}}function te(G){switch(G){case"UseNone":return w.NONE;case"UseThumbs":return w.THUMBS;case"UseOutlines":return w.OUTLINE;case"UseAttachments":return w.ATTACHMENTS;case"UseOC":return w.LAYERS}return w.NONE}function re(G,ee,ne=null){G.classList.toggle("toggled",ee),G.setAttribute("aria-checked",ee),ne?.classList.toggle("hidden",!ee)}}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.AnnotationLayerBuilder=void 0;var d=S(4),i=S(5),_=S(2);class p{#e=0;#t=null;constructor({pageDiv:l,pdfPage:g,linkService:c,downloadManager:u,annotationStorage:P=null,imageResourcesPath:w="",renderForms:y=!0,l10n:e=i.NullL10n,enableScripting:a=!1,hasJSActionsPromise:T=null,fieldObjectsPromise:O=null,annotationCanvasMap:x=null,accessibilityManager:I=null}){this.pageDiv=l,this.pdfPage=g,this.linkService=c,this.downloadManager=u,this.imageResourcesPath=w,this.renderForms=y,this.l10n=e,this.annotationStorage=P,this.enableScripting=a,this._hasJSActionsPromise=T||Promise.resolve(!1),this._fieldObjectsPromise=O||Promise.resolve(null),this._annotationCanvasMap=x,this._accessibilityManager=I,this.div=null,this._cancelled=!1,this._eventBus=c.eventBus}async render(l,g="display"){if(this.div){if(this._cancelled||this.#e===0)return;d.AnnotationLayer.update({viewport:l.clone({dontFlip:!0}),div:this.div,annotationCanvasMap:this._annotationCanvasMap});return}const[c,u,P]=await Promise.all([this.pdfPage.getAnnotations({intent:g}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(!this._cancelled){if(this.#e=c.length,this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div),this.#e===0){this.hide();return}d.AnnotationLayer.render({viewport:l.clone({dontFlip:!0}),div:this.div,annotations:c,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:u,fieldObjects:P,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager}),this.l10n.translate(this.div),this.linkService.isInPresentationMode&&this.#i(_.PresentationModeState.FULLSCREEN),this.#t||(this.#t=w=>{this.#i(w.state)},this._eventBus?._on("presentationmodechanged",this.#t))}}cancel(){this._cancelled=!0,this.#t&&(this._eventBus?._off("presentationmodechanged",this.#t),this.#t=null)}hide(){this.div&&(this.div.hidden=!0)}#i(l){if(!this.div)return;let g=!1;switch(l){case _.PresentationModeState.FULLSCREEN:g=!0;break;case _.PresentationModeState.NORMAL:break;default:return}for(const c of this.div.childNodes)c.hasAttribute("data-internal-link")||(c.inert=g)}}E.AnnotationLayerBuilder=p}),(D=>{let E;typeof window<"u"&&window["pdfjs-dist/build/pdf"]?E=window["pdfjs-dist/build/pdf"]:E=requirePdf(),D.exports=E}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.NullL10n=void 0,E.fixupLangCode=_,E.getL10nFallback=d;const S={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};S.print_progress_percent="{{progress}}%";function d(l,g){switch(l){case"find_match_count":l=`find_match_count[${g.total===1?"one":"other"}]`;break;case"find_match_count_limit":l=`find_match_count_limit[${g.limit===1?"one":"other"}]`;break}return S[l]||""}const i={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function _(l){return i[l?.toLowerCase()]||l}function p(l,g){return g?l.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(c,u)=>u in g?g[u]:"{{"+u+"}}"):l}const n={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(l,g=null,c=d(l,g)){return p(c,g)},async translate(l){}};E.NullL10n=n}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.DownloadManager=void 0;var d=S(4);function i(p,n){const l=document.createElement("a");if(!l.click)throw new Error('DownloadManager: "a.click()" is not supported.');l.href=p,l.target="_parent","download"in l&&(l.download=n),(document.body||document.documentElement).append(l),l.click(),l.remove()}class _{#e=new WeakMap;downloadUrl(n,l,g){if(!(0,d.createValidAbsoluteUrl)(n,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${n}`);return}i(n+"#pdfjs.action=download",l)}downloadData(n,l,g){const c=URL.createObjectURL(new Blob([n],{type:g}));i(c,l)}openOrDownloadData(n,l,g){const u=(0,d.isPdfFile)(g)?"application/pdf":"";return this.downloadData(l,g,u),!1}download(n,l,g,c){const u=URL.createObjectURL(n);i(u,g)}}E.DownloadManager=_}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.WaitOnType=E.EventBus=E.AutomationEventBus=void 0,E.waitOnEventOrTimeout=d;const S={EVENT:"event",TIMEOUT:"timeout"};E.WaitOnType=S;function d({target:p,name:n,delay:l=0}){return new Promise(function(g,c){if(typeof p!="object"||!(n&&typeof n=="string")||!(Number.isInteger(l)&&l>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function u(e){p instanceof i?p._off(n,P):p.removeEventListener(n,P),y&&clearTimeout(y),g(e)}const P=u.bind(null,S.EVENT);p instanceof i?p._on(n,P):p.addEventListener(n,P);const w=u.bind(null,S.TIMEOUT),y=setTimeout(w,l)})}class i{#e=Object.create(null);on(n,l,g=null){this._on(n,l,{external:!0,once:g?.once})}off(n,l,g=null){this._off(n,l,{external:!0,once:g?.once})}dispatch(n,l){const g=this.#e[n];if(!g||g.length===0)return;let c;for(const{listener:u,external:P,once:w}of g.slice(0)){if(w&&this._off(n,u),P){(c||=[]).push(u);continue}u(l)}if(c){for(const u of c)u(l);c=null}}_on(n,l,g=null){(this.#e[n]||=[]).push({listener:l,external:g?.external===!0,once:g?.once===!0})}_off(n,l,g=null){const c=this.#e[n];if(c){for(let u=0,P=c.length;u<P;u++)if(c[u].listener===l){c.splice(u,1);return}}}}E.EventBus=i;class _ extends i{dispatch(n,l){throw new Error("Not implemented: AutomationEventBus.dispatch")}}E.AutomationEventBus=_}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.GenericL10n=void 0,S(9);var d=S(5);const i=document.webL10n;class _{constructor(n){this._lang=n,this._ready=new Promise((l,g)=>{i.setLanguage((0,d.fixupLangCode)(n),()=>{l(i)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(n,l=null,g=(0,d.getL10nFallback)(n,l)){return(await this._ready).get(n,l,g)}async translate(n){return(await this._ready).translate(n)}}E.GenericL10n=_}),(()=>{document.webL10n=(function(D,E,S){var d={},i="",_="textContent",p="",n={},l="loading",g=!0;function c(){return E.querySelectorAll('link[type="application/l10n"]')}function u(){var q=E.querySelector('script[type="application/l10n"]');return q?JSON.parse(q.innerHTML):null}function P(q){return q?q.querySelectorAll("*[data-l10n-id]"):[]}function w(q){if(!q)return{};var W=q.getAttribute("data-l10n-id"),M=q.getAttribute("data-l10n-args"),C={};if(M)try{C=JSON.parse(M)}catch{console.warn("could not parse arguments for #"+W)}return{id:W,args:C}}function y(q,W,M){W=W||function(h){},M=M||function(){};var C=new XMLHttpRequest;C.open("GET",q,g),C.overrideMimeType&&C.overrideMimeType("text/plain; charset=utf-8"),C.onreadystatechange=function(){C.readyState==4&&(C.status==200||C.status===0?W(C.responseText):M())},C.onerror=M,C.ontimeout=M;try{C.send(null)}catch{M()}}function e(q,W,M,C){var A=q.replace(/[^\/]*$/,"")||"./";function h(v){return v.lastIndexOf("\\")<0?v:v.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function r(v,L){var s={},f=/^\s*|\s*$/,b=/^\s*#|^\s*$/,k=/^\s*\[(.*)\]\s*$/,N=/^\s*@import\s+url\((.*)\)\s*$/i,j=/^([^=\s]*)\s*=\s*(.+)$/;function V(Q,$,te){var re=Q.replace(f,"").split(/[\r\n]+/),G="*",ee=W.split("-",1)[0],ne=!1,Z="";function ae(){for(;;){if(!re.length){te();return}var oe=re.shift();if(!b.test(oe)){if($){if(Z=k.exec(oe),Z){G=Z[1].toLowerCase(),ne=G!=="*"&&G!==W&&G!==ee;continue}else if(ne)continue;if(Z=N.exec(oe),Z){X(A+Z[1],ae);return}}var ce=oe.match(j);ce&&ce.length==3&&(s[ce[1]]=h(ce[2]))}}}ae()}function X(Q,$){y(Q,function(te){V(te,!1,$)},function(){console.warn(Q+" not found."),$()})}V(v,!0,function(){L(s)})}y(q,function(v){i+=v,r(v,function(L){for(var s in L){var f,b,k=s.lastIndexOf(".");k>0?(f=s.substring(0,k),b=s.substring(k+1)):(f=s,b=_),d[f]||(d[f]={}),d[f][b]=L[s]}M&&M()})},C)}function a(q,W){q&&(q=q.toLowerCase()),W=W||function(){},T(),p=q;var M=c(),C=M.length;if(C===0){var A=u();if(A&&A.locales&&A.default_locale){if(console.log("using the embedded JSON directory, early way out"),d=A.locales[q],!d){var h=A.default_locale.toLowerCase();for(var r in A.locales)if(r=r.toLowerCase(),r===q){d=A.locales[q];break}else r===h&&(d=A.locales[h])}W()}else console.log("no resource to load, early way out");l="complete";return}var v=null,L=0;v=function(){L++,L>=C&&(W(),l="complete")};function s(k){var N=k.href;this.load=function(j,V){e(N,j,V,function(){console.warn(N+" not found."),console.warn('"'+j+'" resource not found'),p="",V()})}}for(var f=0;f<C;f++){var b=new s(M[f]);b.load(q,v)}}function T(){d={},i="",p=""}function O(q){var W={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function M(r,v){return v.indexOf(r)!==-1}function C(r,v,L){return v<=r&&r<=L}var A={0:function(r){return"other"},1:function(r){return C(r%100,3,10)?"few":r===0?"zero":C(r%100,11,99)?"many":r==2?"two":r==1?"one":"other"},2:function(r){return r!==0&&r%10===0?"many":r==2?"two":r==1?"one":"other"},3:function(r){return r==1?"one":"other"},4:function(r){return C(r,0,1)?"one":"other"},5:function(r){return C(r,0,2)&&r!=2?"one":"other"},6:function(r){return r===0?"zero":r%10==1&&r%100!=11?"one":"other"},7:function(r){return r==2?"two":r==1?"one":"other"},8:function(r){return C(r,3,6)?"few":C(r,7,10)?"many":r==2?"two":r==1?"one":"other"},9:function(r){return r===0||r!=1&&C(r%100,1,19)?"few":r==1?"one":"other"},10:function(r){return C(r%10,2,9)&&!C(r%100,11,19)?"few":r%10==1&&!C(r%100,11,19)?"one":"other"},11:function(r){return C(r%10,2,4)&&!C(r%100,12,14)?"few":r%10===0||C(r%10,5,9)||C(r%100,11,14)?"many":r%10==1&&r%100!=11?"one":"other"},12:function(r){return C(r,2,4)?"few":r==1?"one":"other"},13:function(r){return C(r%10,2,4)&&!C(r%100,12,14)?"few":r!=1&&C(r%10,0,1)||C(r%10,5,9)||C(r%100,12,14)?"many":r==1?"one":"other"},14:function(r){return C(r%100,3,4)?"few":r%100==2?"two":r%100==1?"one":"other"},15:function(r){return r===0||C(r%100,2,10)?"few":C(r%100,11,19)?"many":r==1?"one":"other"},16:function(r){return r%10==1&&r!=11?"one":"other"},17:function(r){return r==3?"few":r===0?"zero":r==6?"many":r==2?"two":r==1?"one":"other"},18:function(r){return r===0?"zero":C(r,0,2)&&r!==0&&r!=2?"one":"other"},19:function(r){return C(r,2,10)?"few":C(r,0,1)?"one":"other"},20:function(r){return(C(r%10,3,4)||r%10==9)&&!(C(r%100,10,19)||C(r%100,70,79)||C(r%100,90,99))?"few":r%1e6===0&&r!==0?"many":r%10==2&&!M(r%100,[12,72,92])?"two":r%10==1&&!M(r%100,[11,71,91])?"one":"other"},21:function(r){return r===0?"zero":r==1?"one":"other"},22:function(r){return C(r,0,1)||C(r,11,99)?"one":"other"},23:function(r){return C(r%10,1,2)||r%20===0?"one":"other"},24:function(r){return C(r,3,10)||C(r,13,19)?"few":M(r,[2,12])?"two":M(r,[1,11])?"one":"other"}},h=W[q.replace(/-.*$/,"")];return h in A?A[h]:(console.warn("plural form unknown for ["+q+"]"),function(){return"other"})}n.plural=function(q,W,M,C){var A=parseFloat(W);if(isNaN(A)||C!=_)return q;n._pluralRules||(n._pluralRules=O(p));var h="["+n._pluralRules(A)+"]";return A===0&&M+"[zero]"in d?q=d[M+"[zero]"][C]:A==1&&M+"[one]"in d?q=d[M+"[one]"][C]:A==2&&M+"[two]"in d?q=d[M+"[two]"][C]:M+h in d?q=d[M+h][C]:M+"[other]"in d&&(q=d[M+"[other]"][C]),q};function x(q,W,M){var C=d[q];if(!C){if(console.warn("#"+q+" is undefined."),!M)return null;C=M}var A={};for(var h in C){var r=C[h];r=I(r,W,q,h),r=U(r,W,q),A[h]=r}return A}function I(q,W,M,C){var A=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,h=A.exec(q);if(!h||!h.length)return q;var r=h[1],v=h[2],L;if(W&&v in W?L=W[v]:v in d&&(L=d[v]),r in n){var s=n[r];q=s(q,L,M,C)}return q}function U(q,W,M){var C=/\{\{\s*(.+?)\s*\}\}/g;return q.replace(C,function(A,h){return W&&h in W?W[h]:h in d?d[h]:(console.log("argument {{"+h+"}} for #"+M+" is undefined."),A)})}function z(q){var W=w(q);if(W.id){var M=x(W.id,W.args);if(!M){console.warn("#"+W.id+" is undefined.");return}if(M[_]){if(ie(q)===0)q[_]=M[_];else{for(var C=q.childNodes,A=!1,h=0,r=C.length;h<r;h++)C[h].nodeType===3&&/\S/.test(C[h].nodeValue)&&(A?C[h].nodeValue="":(C[h].nodeValue=M[_],A=!0));if(!A){var v=E.createTextNode(M[_]);q.prepend(v)}}delete M[_]}for(var L in M)q[L]=M[L]}}function ie(q){if(q.children)return q.children.length;if(typeof q.childElementCount<"u")return q.childElementCount;for(var W=0,M=0;M<q.childNodes.length;M++)W+=q.nodeType===1?1:0;return W}function J(q){q=q||E.documentElement;for(var W=P(q),M=W.length,C=0;C<M;C++)z(W[C]);z(q)}return{get:function(q,W,M){var C=q.lastIndexOf("."),A=_;C>0&&(A=q.substring(C+1),q=q.substring(0,C));var h;M&&(h={},h[A]=M);var r=x(q,W,h);return r&&A in r?r[A]:"{{"+q+"}}"},getData:function(){return d},getText:function(){return i},getLanguage:function(){return p},setLanguage:function(q,W){a(q,function(){W&&W()})},getDirection:function(){var q=["ar","he","fa","ps","ur"],W=p.split("-",1)[0];return q.indexOf(W)>=0?"rtl":"ltr"},translate:J,getReadyState:function(){return l},ready:function(q){if(q)l=="complete"||l=="interactive"?D.setTimeout(function(){q()}):E.addEventListener&&E.addEventListener("localized",function W(){E.removeEventListener("localized",W),q()});else return}}})(window,document)}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFFindController=E.FindState=void 0;var d=S(2),i=S(11),_=S(4);const p={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};E.FindState=p;const n=250,l=-50,g=-400,c={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},u=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let P;const w=new RegExp("\\p{M}+","gu"),y=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),e=new RegExp("([^\\p{M}])\\p{M}*$","u"),a=new RegExp("^\\p{M}*([^\\p{M}])","u"),T=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,O=new Map,x="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",I=new Map;let U=null,z=null;function ie(W){const M=[];let C;for(;(C=T.exec(W))!==null;){let{index:j}=C;for(const V of C[0]){let X=O.get(V);X||(X=V.normalize("NFD").length,O.set(V,X)),M.push([X,j++])}}let A;if(M.length===0&&U)A=U;else if(M.length>0&&z)A=z;else{const j=Object.keys(c).join(""),V=(0,i.getNormalizeWithNFKC)(),$=`([${j}])|([${V}])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;M.length===0?A=U=new RegExp($+"|(\\u0000)","gum"):A=z=new RegExp($+`|(${x})`,"gum")}const h=[];for(;(C=w.exec(W))!==null;)h.push([C[0].length,C.index]);let r=W.normalize("NFD");const v=[[0,0]];let L=0,s=0,f=0,b=0,k=0,N=!1;return r=r.replace(A,(j,V,X,Q,$,te,re,G,ee,ne)=>{if(ne-=b,V){const Z=c[V],ae=Z.length;for(let oe=1;oe<ae;oe++)v.push([ne-f+oe,f-oe]);return f-=ae-1,Z}if(X){let Z=I.get(X);Z||(Z=X.normalize("NFKC"),I.set(X,Z));const ae=Z.length;for(let oe=1;oe<ae;oe++)v.push([ne-f+oe,f-oe]);return f-=ae-1,Z}if(Q)return N=!0,ne+k===h[L]?.[1]?++L:(v.push([ne-1-f+1,f-1]),f-=1,b+=1),v.push([ne-f+1,f]),b+=1,k+=1,Q.charAt(0);if($){const Z=$.endsWith(`
`),ae=Z?$.length-2:$.length;N=!0;let oe=ae;ne+k===h[L]?.[1]&&(oe-=h[L][0],++L);for(let ce=1;ce<=oe;ce++)v.push([ne-1-f+ce,f-ce]);return f-=oe,b+=oe,Z?(ne+=ae-1,v.push([ne-f+1,1+f]),f+=1,b+=1,k+=1,$.slice(0,ae)):$}if(te){const Z=te.length-2;return v.push([ne-f+Z,1+f]),f+=1,b+=1,k+=1,te.slice(0,-2)}if(re){const Z=re.length-1;return v.push([ne-f+Z,f]),b+=1,k+=1,re.slice(0,-1)}if(G)return v.push([ne-f+1,f-1]),f-=1,b+=1,k+=1," ";if(ne+k===M[s]?.[1]){const Z=M[s][0]-1;++s;for(let ae=1;ae<=Z;ae++)v.push([ne-(f-ae),f-ae]);f-=Z,b+=Z}return ee}),v.push([r.length,f]),[r,v,N]}function J(W,M,C){if(!W)return[M,C];const A=M,h=M+C-1;let r=(0,d.binarySearchFirstItem)(W,b=>b[0]>=A);W[r][0]>A&&--r;let v=(0,d.binarySearchFirstItem)(W,b=>b[0]>=h,r);W[v][0]>h&&--v;const L=A+W[r][1],f=h+W[v][1]+1-L;return[L,f]}class q{#e=null;#t=!0;#i=0;constructor({linkService:M,eventBus:C,updateMatchesCountOnProgress:A=!0}){this._linkService=M,this._eventBus=C,this.#t=A,this.#s(),C._on("find",this.#n.bind(this)),C._on("findbarclose",this.#w.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(M){this._pdfDocument&&this.#s(),M&&(this._pdfDocument=M,this._firstPageCapability.resolve())}#n(M){if(!M)return;M.phraseSearch===!1&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),typeof M.query=="string"&&(M.query=M.query.match(/\S+/g)));const C=this._pdfDocument,{type:A}=M;(this.#e===null||this.#h(M))&&(this._dirtyMatch=!0),this.#e=M,A!=="highlightallchange"&&this.#p(p.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||C&&this._pdfDocument!==C)return;this.#f();const h=!this._highlightMatches,r=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),A?this._dirtyMatch?this.#g():A==="again"?(this.#g(),h&&this.#e.highlightAll&&this.#u()):A==="highlightallchange"?(r?this.#g():this._highlightMatches=!0,this.#u()):this.#g():this._findTimeout=setTimeout(()=>{this.#g(),this._findTimeout=null},n)})}scrollMatchIntoView({element:M=null,selectedLeft:C=0,pageIndex:A=-1,matchIndex:h=-1}){if(!this._scrollMatches||!M)return;if(h===-1||h!==this._selected.matchIdx)return;if(A===-1||A!==this._selected.pageIdx)return;this._scrollMatches=!1;const r={top:l,left:C+g};(0,d.scrollIntoView)(M,r,!0)}#s(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#i=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new _.PromiseCapability}get#l(){const{query:M}=this.#e;return typeof M=="string"?(M!==this._rawQuery&&(this._rawQuery=M,[this._normalizedQuery]=ie(M)),this._normalizedQuery):(M||[]).filter(C=>!!C).map(C=>ie(C)[0])}#h(M){const C=M.query,A=this.#e.query,h=typeof C;if(h!==typeof A)return!0;if(h==="string"){if(C!==A)return!0}else if(JSON.stringify(C)!==JSON.stringify(A))return!0;switch(M.type){case"again":const v=this._selected.pageIdx+1,L=this._linkService;return v>=1&&v<=L.pagesCount&&v!==L.page&&!L.isPageVisible(v);case"highlightallchange":return!1}return!0}#r(M,C,A){let h=M.slice(0,C).match(e);if(h){const r=M.charCodeAt(C),v=h[1].charCodeAt(0);if((0,i.getCharacterType)(r)===(0,i.getCharacterType)(v))return!1}if(h=M.slice(C+A).match(a),h){const r=M.charCodeAt(C+A-1),v=h[1].charCodeAt(0);if((0,i.getCharacterType)(r)===(0,i.getCharacterType)(v))return!1}return!0}#a(M,C,A,h){const r=this._pageMatches[A]=[],v=this._pageMatchesLength[A]=[];if(!M)return;const L=this._pageDiffs[A];let s;for(;(s=M.exec(h))!==null;){if(C&&!this.#r(h,s.index,s[0].length))continue;const[f,b]=J(L,s.index,s[0].length);b&&(r.push(f),v.push(b))}}#d(M,C){const{matchDiacritics:A}=this.#e;let h=!1;M=M.replaceAll(y,(v,L,s,f,b,k)=>L?`[ ]*\\${L}[ ]*`:s?`[ ]*${s}[ ]*`:f?"[ ]+":A?b||k:b?u.has(b.charCodeAt(0))?b:"":C?(h=!0,`${k}\\p{M}*`):k);const r="[ ]*";return M.endsWith(r)&&(M=M.slice(0,M.length-r.length)),A&&C&&(P||=String.fromCharCode(...u),h=!0,M=`${M}(?=[${P}]|[^\\p{M}]|$)`),[h,M]}#c(M){let C=this.#l;if(C.length===0)return;const{caseSensitive:A,entireWord:h}=this.#e,r=this._pageContents[M],v=this._hasDiacritics[M];let L=!1;typeof C=="string"?[L,C]=this.#d(C,v):C=C.sort().reverse().map(b=>{const[k,N]=this.#d(b,v);return L||=k,`(${N})`}).join("|");const s=`g${L?"u":""}${A?"":"i"}`;C=C?new RegExp(C,s):null,this.#a(C,h,M,r),this.#e.highlightAll&&this.#o(M),this._resumePageIdx===M&&(this._resumePageIdx=null,this.#v());const f=this._pageMatches[M].length;this._matchesCountTotal+=f,this.#t?f>0&&this.#S():++this.#i===this._linkService.pagesCount&&this.#S()}#f(){if(this._extractTextPromises.length>0)return;let M=Promise.resolve();const C={disableNormalization:!0};for(let A=0,h=this._linkService.pagesCount;A<h;A++){const r=new _.PromiseCapability;this._extractTextPromises[A]=r.promise,M=M.then(()=>this._pdfDocument.getPage(A+1).then(v=>v.getTextContent(C)).then(v=>{const L=[];for(const s of v.items)L.push(s.str),s.hasEOL&&L.push(`
`);[this._pageContents[A],this._pageDiffs[A],this._hasDiacritics[A]]=ie(L.join("")),r.resolve()},v=>{console.error(`Unable to get text content for page ${A+1}`,v),this._pageContents[A]="",this._pageDiffs[A]=null,this._hasDiacritics[A]=!1,r.resolve()}))}}#o(M){this._scrollMatches&&this._selected.pageIdx===M&&(this._linkService.page=M+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:M})}#u(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#g(){const M=this.#e.findPrevious,C=this._linkService.page-1,A=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=C,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#i=0,this._matchesCountTotal=0,this.#u();for(let v=0;v<A;v++)this._pendingFindMatches.has(v)||(this._pendingFindMatches.add(v),this._extractTextPromises[v].then(()=>{this._pendingFindMatches.delete(v),this.#c(v)}))}if(this.#l.length===0){this.#p(p.FOUND);return}if(this._resumePageIdx)return;const r=this._offset;if(this._pagesToSearch=A,r.matchIdx!==null){const v=this._pageMatches[r.pageIdx].length;if(!M&&r.matchIdx+1<v||M&&r.matchIdx>0){r.matchIdx=M?r.matchIdx-1:r.matchIdx+1,this.#A(!0);return}this.#C(M)}this.#v()}#b(M){const C=this._offset,A=M.length,h=this.#e.findPrevious;return A?(C.matchIdx=h?A-1:0,this.#A(!0),!0):(this.#C(h),C.wrapped&&(C.matchIdx=null,this._pagesToSearch<0)?(this.#A(!1),!0):!1)}#v(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let M=null;do{const C=this._offset.pageIdx;if(M=this._pageMatches[C],!M){this._resumePageIdx=C;break}}while(!this.#b(M))}#C(M){const C=this._offset,A=this._linkService.pagesCount;C.pageIdx=M?C.pageIdx-1:C.pageIdx+1,C.matchIdx=null,this._pagesToSearch--,(C.pageIdx>=A||C.pageIdx<0)&&(C.pageIdx=M?A-1:0,C.wrapped=!0)}#A(M=!1){let C=p.NOT_FOUND;const A=this._offset.wrapped;if(this._offset.wrapped=!1,M){const h=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,C=A?p.WRAPPED:p.FOUND,h!==-1&&h!==this._selected.pageIdx&&this.#o(h)}this.#p(C,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#o(this._selected.pageIdx))}#w(M){const C=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||C&&this._pdfDocument!==C||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#p(p.FOUND),this._highlightMatches=!1,this.#u())})}#y(){const{pageIdx:M,matchIdx:C}=this._selected;let A=0,h=this._matchesCountTotal;if(C!==-1){for(let r=0;r<M;r++)A+=this._pageMatches[r]?.length||0;A+=C+1}return(A<1||A>h)&&(A=h=0),{current:A,total:h}}#S(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#y()})}#p(M,C=!1){!this.#t&&(this.#i!==this._linkService.pagesCount||M===p.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:M,previous:C,matchesCount:this.#y(),rawQuery:this.#e?.query??null})}}E.PDFFindController=q}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.CharacterType=void 0,E.getCharacterType=w,E.getNormalizeWithNFKC=e;const S={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};E.CharacterType=S;function d(a){return a<11904}function i(a){return(a&65408)===0}function _(a){return a>=97&&a<=122||a>=65&&a<=90}function p(a){return a>=48&&a<=57}function n(a){return a===32||a===9||a===13||a===10}function l(a){return a>=13312&&a<=40959||a>=63744&&a<=64255}function g(a){return a>=12448&&a<=12543}function c(a){return a>=12352&&a<=12447}function u(a){return a>=65376&&a<=65439}function P(a){return(a&65408)===3584}function w(a){return d(a)?i(a)?n(a)?S.SPACE:_(a)||p(a)||a===95?S.ALPHA_LETTER:S.PUNCT:P(a)?S.THAI_LETTER:a===160?S.SPACE:S.ALPHA_LETTER:l(a)?S.HAN_LETTER:g(a)?S.KATAKANA_LETTER:c(a)?S.HIRAGANA_LETTER:u(a)?S.HALFWIDTH_KATAKANA_LETTER:S.ALPHA_LETTER}let y;function e(){return y||=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦",y}}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFHistory=void 0,E.isDestArraysEqual=u,E.isDestHashesEqual=c;var d=S(2),i=S(7);const _=1e3,p=50,n=1e3;function l(){return document.location.hash}class g{constructor({linkService:w,eventBus:y}){this.linkService=w,this.eventBus=y,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",e=>{this._isPagesLoaded=!!e.pagesCount},{once:!0})})}initialize({fingerprint:w,resetHistory:y=!1,updateUrl:e=!1}){if(!w||typeof w!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const a=this._fingerprint!==""&&this._fingerprint!==w;this._fingerprint=w,this._updateUrl=e===!0,this._initialized=!0,this._bindEvents();const T=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=l(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(T,!0)||y){const{hash:x,page:I,rotation:U}=this._parseCurrentHash(!0);if(!x||a||y){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:x,page:I,rotation:U},!0);return}const O=T.destination;this._updateInternalState(O,T.uid,!0),O.rotation!==void 0&&(this._initialRotation=O.rotation),O.dest?(this._initialBookmark=JSON.stringify(O.dest),this._destination.page=null):O.hash?this._initialBookmark=O.hash:O.page&&(this._initialBookmark=`page=${O.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:w=null,explicitDest:y,pageNumber:e}){if(!this._initialized)return;if(w&&typeof w!="string"){console.error(`PDFHistory.push: "${w}" is not a valid namedDest parameter.`);return}else if(Array.isArray(y)){if(!this._isValidPage(e)&&(e!==null||this._destination)){console.error(`PDFHistory.push: "${e}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${y}" is not a valid explicitDest parameter.`);return}const a=w||JSON.stringify(y);if(!a)return;let T=!1;if(this._destination&&(c(this._destination.hash,a)||u(this._destination.dest,y))){if(this._destination.page)return;T=!0}this._popStateInProgress&&!T||(this._pushOrReplaceState({dest:y,hash:a,page:e,rotation:this.linkService.rotation},T),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(w){if(this._initialized){if(!this._isValidPage(w)){console.error(`PDFHistory.pushPage: "${w}" is not a valid page number.`);return}this._destination?.page!==w&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${w}`,page:w,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const w=window.history.state;this._isValidState(w)&&w.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const w=window.history.state;this._isValidState(w)&&w.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(w,y=!1){const e=y||!this._destination,a={fingerprint:this._fingerprint,uid:e?this._uid:this._uid+1,destination:w};this._updateInternalState(w,a.uid);let T;if(this._updateUrl&&w?.hash){const O=document.location.href.split("#")[0];O.startsWith("file://")||(T=`${O}#${w.hash}`)}e?window.history.replaceState(a,"",T):window.history.pushState(a,"",T)}_tryPushCurrentPosition(w=!1){if(!this._position)return;let y=this._position;if(w&&(y=Object.assign(Object.create(null),this._position),y.temporary=!0),!this._destination){this._pushOrReplaceState(y);return}if(this._destination.temporary){this._pushOrReplaceState(y,!0);return}if(this._destination.hash===y.hash||!this._destination.page&&this._numPositionUpdates<=p)return;let e=!1;if(this._destination.page>=y.first&&this._destination.page<=y.page){if(this._destination.dest!==void 0||!this._destination.first)return;e=!0}this._pushOrReplaceState(y,e)}_isValidPage(w){return Number.isInteger(w)&&w>0&&w<=this.linkService.pagesCount}_isValidState(w,y=!1){if(!w)return!1;if(w.fingerprint!==this._fingerprint)if(y){if(typeof w.fingerprint!="string"||w.fingerprint.length!==this._fingerprint.length)return!1;const[e]=performance.getEntriesByType("navigation");if(e?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(w.uid)||w.uid<0||w.destination===null||typeof w.destination!="object")}_updateInternalState(w,y,e=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),e&&w?.temporary&&delete w.temporary,this._destination=w,this._uid=y,this._maxUid=Math.max(this._maxUid,y),this._numPositionUpdates=0}_parseCurrentHash(w=!1){const y=unescape(l()).substring(1),e=(0,d.parseQueryString)(y),a=e.get("nameddest")||"";let T=e.get("page")|0;return(!this._isValidPage(T)||w&&a.length>0)&&(T=null),{hash:y,page:T,rotation:this.linkService.rotation}}_updateViewarea({location:w}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:w.pdfOpenParams.substring(1),page:this.linkService.page,first:w.pageNumber,rotation:w.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},n))}_popState({state:w}){const y=l(),e=this._currentHash!==y;if(this._currentHash=y,!w){this._uid++;const{hash:T,page:O,rotation:x}=this._parseCurrentHash();this._pushOrReplaceState({hash:T,page:O,rotation:x},!0);return}if(!this._isValidState(w))return;this._popStateInProgress=!0,e&&(this._blockHashChange++,(0,i.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:_}).then(()=>{this._blockHashChange--}));const a=w.destination;this._updateInternalState(a,w.uid,!0),(0,d.isValidRotation)(a.rotation)&&(this.linkService.rotation=a.rotation),a.dest?this.linkService.goToDestination(a.dest):a.hash?this.linkService.setHash(a.hash):a.page&&(this.linkService.page=a.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}E.PDFHistory=g;function c(P,w){return typeof P!="string"||typeof w!="string"?!1:P===w||(0,d.parseQueryString)(P).get("nameddest")===w}function u(P,w){function y(e,a){if(typeof e!=typeof a||Array.isArray(e)||Array.isArray(a))return!1;if(e!==null&&typeof e=="object"&&a!==null){if(Object.keys(e).length!==Object.keys(a).length)return!1;for(const T in e)if(!y(e[T],a[T]))return!1;return!0}return e===a||Number.isNaN(e)&&Number.isNaN(a)}if(!(Array.isArray(P)&&Array.isArray(w))||P.length!==w.length)return!1;for(let e=0,a=P.length;e<a;e++)if(!y(P[e],w[e]))return!1;return!0}}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFPageView=void 0;var d=S(4),i=S(2),_=S(14),p=S(3),n=S(15),l=S(5),g=S(1),c=S(16),u=S(17),P=S(18),w=S(19),y=S(20);const e=n.compatibilityParams.maxCanvasPixels||16777216,a=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new g.SimpleLinkService}});class T{#e=d.AnnotationMode.ENABLE_FORMS;#t=null;#i=null;#n=null;#s=null;#l=i.RenderingStates.INITIAL;#h=i.TextLayerMode.ENABLE;#r={initialOptionalContent:!0,regularAnnotations:!0};#a=new WeakMap;constructor(x){const I=x.container,U=x.defaultViewport;this.id=x.id,this.renderingId="page"+this.id,this.#t=x.layerProperties||a,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=x.scale||i.DEFAULT_SCALE,this.viewport=U,this.pdfPageRotate=U.rotation,this._optionalContentConfigPromise=x.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.#h=x.textLayerMode??i.TextLayerMode.ENABLE,this.#e=x.annotationMode??d.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=x.imageResourcesPath||"",this.useOnlyCssZoom=x.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=x.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=x.maxCanvasPixels||e,this.pageColors=x.pageColors||null,this.eventBus=x.eventBus,this.renderingQueue=x.renderingQueue,this.l10n=x.l10n||l.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const z=document.createElement("div");if(z.className="page",z.setAttribute("data-page-number",this.id),z.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(ie=>{z.setAttribute("aria-label",ie)}),this.div=z,this.#d(),I?.append(z),this._isStandalone){I?.style.setProperty("--scale-factor",this.scale*d.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:ie}=x;ie&&ie.then(J=>{ie===this._optionalContentConfigPromise&&(this.#r.initialOptionalContent=J.hasInitialVisibility)})}}get renderingState(){return this.#l}set renderingState(x){if(x!==this.#l)switch(this.#l=x,this.#i&&(clearTimeout(this.#i),this.#i=null),x){case i.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case i.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),this.#i=setTimeout(()=>{this.div.classList.add("loading"),this.#i=null},0);break;case i.RenderingStates.INITIAL:case i.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#d(){const{viewport:x}=this;if(this.pdfPage){if(this.#n===x.rotation)return;this.#n=x.rotation}(0,d.setLayerDimensions)(this.div,x,!0,!1)}setPdfPage(x){this.pdfPage=x,this.pdfPageRotate=x.rotate;const I=(this.rotation+this.pdfPageRotate)%360;this.viewport=x.getViewport({scale:this.scale*d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:I}),this.#d(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}get _textHighlighter(){return(0,d.shadow)(this,"_textHighlighter",new P.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#t().findController}))}async#c(){let x=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(I){console.error(`#renderAnnotationLayer: "${I}".`),x=I}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:x})}}async#f(){let x=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(I){console.error(`#renderAnnotationEditorLayer: "${I}".`),x=I}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:x})}}async#o(){let x=null;try{const I=await this.xfaLayer.render(this.viewport,"display");I?.textDivs&&this._textHighlighter&&this.#b(I.textDivs)}catch(I){console.error(`#renderXfaLayer: "${I}".`),x=I}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:x})}}async#u(){const{pdfPage:x,textLayer:I,viewport:U}=this;if(!I)return;let z=null;try{if(!I.renderingDone){const ie=x.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});I.setTextContentSource(ie)}await I.render(U)}catch(ie){if(ie instanceof d.AbortException)return;console.error(`#renderTextLayer: "${ie}".`),z=ie}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:I.numTextDivs,error:z}),this.#g()}async#g(){if(!this.textLayer)return;this.structTreeLayer||=new c.StructTreeLayerBuilder;const x=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),I=this.structTreeLayer?.render(x);I&&this.canvas?.append(I),this.structTreeLayer?.show()}async#b(x){const I=await this.pdfPage.getTextContent(),U=[];for(const z of I.items)U.push(z.str);this._textHighlighter.setTextMapping(x,U),this._textHighlighter.enable()}_resetZoomLayer(x=!1){if(!this.zoomLayer)return;const I=this.zoomLayer.firstChild;this.#a.delete(I),I.width=0,I.height=0,x&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:x=!1,keepAnnotationLayer:I=!1,keepAnnotationEditorLayer:U=!1,keepXfaLayer:z=!1,keepTextLayer:ie=!1}={}){this.cancelRendering({keepAnnotationLayer:I,keepAnnotationEditorLayer:U,keepXfaLayer:z,keepTextLayer:ie}),this.renderingState=i.RenderingStates.INITIAL;const J=this.div,q=J.childNodes,W=x&&this.zoomLayer||null,M=I&&this.annotationLayer?.div||null,C=U&&this.annotationEditorLayer?.div||null,A=z&&this.xfaLayer?.div||null,h=ie&&this.textLayer?.div||null;for(let r=q.length-1;r>=0;r--){const v=q[r];switch(v){case W:case M:case C:case A:case h:continue}v.remove()}J.removeAttribute("data-loaded"),M&&this.annotationLayer.hide(),C&&this.annotationEditorLayer.hide(),A&&this.xfaLayer.hide(),h&&this.textLayer.hide(),this.structTreeLayer?.hide(),W||(this.canvas&&(this.#a.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:x=0,rotation:I=null,optionalContentConfigPromise:U=null,drawingDelay:z=-1}){this.scale=x||this.scale,typeof I=="number"&&(this.rotation=I),U instanceof Promise&&(this._optionalContentConfigPromise=U,U.then(M=>{U===this._optionalContentConfigPromise&&(this.#r.initialOptionalContent=M.hasInitialVisibility)}));const ie=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:this.scale*d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:ie}),this.#d(),this._isStandalone&&this.div.parentNode?.style.setProperty("--scale-factor",this.viewport.scale);let J=!1;if(this.canvas&&this.maxCanvasPixels>0){const{width:M,height:C}=this.viewport,{sx:A,sy:h}=this.outputScale;(Math.floor(M)*A|0)*(Math.floor(C)*h|0)>this.maxCanvasPixels&&(J=!0)}const q=this.useOnlyCssZoom||this.hasRestrictedScaling&&J,W=!q&&z>=0&&z<1e3;if(this.canvas){if(W||q){W&&this.renderingState!==i.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:z}),this.renderingState=i.RenderingStates.FINISHED),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!W,hideTextLayer:W}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#s});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:x=!1,keepAnnotationEditorLayer:I=!1,keepXfaLayer:U=!1,keepTextLayer:z=!1,cancelExtraDelay:ie=0}={}){this.renderTask&&(this.renderTask.cancel(ie),this.renderTask=null),this.resume=null,this.textLayer&&(!z||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!x||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!I||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!U||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:x,redrawAnnotationLayer:I=!1,redrawAnnotationEditorLayer:U=!1,redrawXfaLayer:z=!1,redrawTextLayer:ie=!1,hideTextLayer:J=!1}){if(!x.hasAttribute("zooming")){x.setAttribute("zooming",!0);const{style:W}=x;W.width=W.height=""}const q=this.#a.get(x);if(this.viewport!==q){const W=this.viewport.rotation-q.rotation,M=Math.abs(W);let C=1,A=1;if(M===90||M===270){const{width:h,height:r}=this.viewport;C=r/h,A=h/r}x.style.transform=`rotate(${W}deg) scale(${C}, ${A})`}I&&this.annotationLayer&&this.#c(),U&&this.annotationEditorLayer&&this.#f(),z&&this.xfaLayer&&this.#o(),this.textLayer&&(J?(this.textLayer.hide(),this.structTreeLayer?.hide()):ie&&this.#u())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(x,I){return this.viewport.convertToPdfPoint(x,I)}async#v(x,I=null){if(x===this.renderTask&&(this.renderTask=null),I instanceof d.RenderingCancelledException){this.#s=null;return}if(this.#s=I,this.renderingState=i.RenderingStates.FINISHED,this._resetZoomLayer(!0),this.#r.regularAnnotations=!x.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#s}),I)throw I}async draw(){this.renderingState!==i.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:x,l10n:I,pageColors:U,pdfPage:z,viewport:ie}=this;if(!z)throw this.renderingState=i.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=i.RenderingStates.RUNNING;const J=document.createElement("div");if(J.classList.add("canvasWrapper"),x.append(J),!this.textLayer&&this.#h!==i.TextLayerMode.DISABLE&&!z.isPureXfa&&(this._accessibilityManager||=new u.TextAccessibilityManager,this.textLayer=new w.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:this.#h===i.TextLayerMode.ENABLE_PERMISSIONS}),x.append(this.textLayer.div)),!this.annotationLayer&&this.#e!==d.AnnotationMode.DISABLE){const{annotationStorage:V,downloadManager:X,enableScripting:Q,fieldObjectsPromise:$,hasJSActionsPromise:te,linkService:re}=this.#t();this._annotationCanvasMap||=new Map,this.annotationLayer=new p.AnnotationLayerBuilder({pageDiv:x,pdfPage:z,annotationStorage:V,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===d.AnnotationMode.ENABLE_FORMS,linkService:re,downloadManager:X,l10n:I,enableScripting:Q,hasJSActionsPromise:te,fieldObjectsPromise:$,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const q=V=>{if(h?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=i.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=i.RenderingStates.RUNNING,V()};return}V()},{width:W,height:M}=ie,C=document.createElement("canvas");C.setAttribute("role","presentation"),C.hidden=!0;const A=!!(U?.background&&U?.foreground);let h=V=>{(!A||V)&&(C.hidden=!1,h=null)};J.append(C),this.canvas=C;const r=C.getContext("2d",{alpha:!1}),v=this.outputScale=new i.OutputScale;if(this.useOnlyCssZoom){const V=ie.clone({scale:d.PixelsPerInch.PDF_TO_CSS_UNITS});v.sx*=V.width/W,v.sy*=V.height/M}if(this.maxCanvasPixels>0){const V=W*M,X=Math.sqrt(this.maxCanvasPixels/V);v.sx>X||v.sy>X?(v.sx=X,v.sy=X,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const L=(0,i.approximateFraction)(v.sx),s=(0,i.approximateFraction)(v.sy);C.width=(0,i.roundToDivide)(W*v.sx,L[0]),C.height=(0,i.roundToDivide)(M*v.sy,s[0]);const{style:f}=C;f.width=(0,i.roundToDivide)(W,L[1])+"px",f.height=(0,i.roundToDivide)(M,s[1])+"px",this.#a.set(C,ie);const b=v.scaled?[v.sx,0,0,v.sy,0,0]:null,k={canvasContext:r,transform:b,viewport:ie,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:U},N=this.renderTask=this.pdfPage.render(k);N.onContinue=q;const j=N.promise.then(async()=>{if(h?.(!0),await this.#v(N),this.#u(),this.annotationLayer&&await this.#c(),!this.annotationEditorLayer){const{annotationEditorUIManager:V}=this.#t();if(!V)return;this.annotationEditorLayer=new _.AnnotationEditorLayerBuilder({uiManager:V,pageDiv:x,pdfPage:z,l10n:I,accessibilityManager:this._accessibilityManager})}this.#f()},V=>(V instanceof d.RenderingCancelledException||h?.(!0),this.#v(N,V)));if(z.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&x.append(this.xfaLayer.div);else{const{annotationStorage:V,linkService:X}=this.#t();this.xfaLayer=new y.XfaLayerBuilder({pageDiv:x,pdfPage:z,annotationStorage:V,linkService:X})}this.#o()}return x.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),j}setPageLabel(x){this.pageLabel=typeof x=="string"?x:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent:x,regularAnnotations:I}=this.#r;return x&&I?this.canvas:null}}E.PDFPageView=T}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.AnnotationEditorLayerBuilder=void 0;var d=S(4),i=S(5);class _{#e;constructor(n){this.pageDiv=n.pageDiv,this.pdfPage=n.pdfPage,this.accessibilityManager=n.accessibilityManager,this.l10n=n.l10n||i.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#e=n.uiManager}async render(n,l="display"){if(l!=="display"||this._cancelled)return;const g=n.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:g}),this.show();return}const c=this.div=document.createElement("div");c.className="annotationEditorLayer",c.tabIndex=0,c.hidden=!0,this.pageDiv.append(c),this.annotationEditorLayer=new d.AnnotationEditorLayer({uiManager:this.#e,div:c,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:g});const u={viewport:g,div:c,annotations:null,intent:l};this.annotationEditorLayer.render(u),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}E.AnnotationEditorLayerBuilder=_}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.compatibilityParams=E.OptionKind=E.AppOptions=void 0;const S=Object.create(null);E.compatibilityParams=S;{const n=navigator.userAgent||"",l=navigator.platform||"",g=navigator.maxTouchPoints||1,c=/Android/.test(n),u=/\b(iPad|iPhone|iPod)(?=;)/.test(n)||l==="MacIntel"&&g>1;(function(){(u||c)&&(S.maxCanvasPixels=5242880)})()}const d={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};E.OptionKind=d;const i={annotationEditorMode:{value:0,kind:d.VIEWER+d.PREFERENCE},annotationMode:{value:2,kind:d.VIEWER+d.PREFERENCE},cursorToolOnLoad:{value:0,kind:d.VIEWER+d.PREFERENCE},defaultZoomDelay:{value:400,kind:d.VIEWER+d.PREFERENCE},defaultZoomValue:{value:"",kind:d.VIEWER+d.PREFERENCE},disableHistory:{value:!1,kind:d.VIEWER},disablePageLabels:{value:!1,kind:d.VIEWER+d.PREFERENCE},enableFloatingToolbar:{value:!1,kind:d.VIEWER+d.PREFERENCE},enablePermissions:{value:!1,kind:d.VIEWER+d.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:d.VIEWER+d.PREFERENCE},enableScripting:{value:!0,kind:d.VIEWER+d.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:d.VIEWER},externalLinkTarget:{value:0,kind:d.VIEWER+d.PREFERENCE},historyUpdateUrl:{value:!1,kind:d.VIEWER+d.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:d.VIEWER+d.PREFERENCE},imageResourcesPath:{value:"./images/",kind:d.VIEWER},maxCanvasPixels:{value:16777216,kind:d.VIEWER},forcePageColors:{value:!1,kind:d.VIEWER+d.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:d.VIEWER+d.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:d.VIEWER+d.PREFERENCE},pdfBugEnabled:{value:!1,kind:d.VIEWER+d.PREFERENCE},printResolution:{value:150,kind:d.VIEWER},sidebarViewOnLoad:{value:-1,kind:d.VIEWER+d.PREFERENCE},scrollModeOnLoad:{value:-1,kind:d.VIEWER+d.PREFERENCE},spreadModeOnLoad:{value:-1,kind:d.VIEWER+d.PREFERENCE},textLayerMode:{value:1,kind:d.VIEWER+d.PREFERENCE},useOnlyCssZoom:{value:!1,kind:d.VIEWER+d.PREFERENCE},viewerCssTheme:{value:0,kind:d.VIEWER+d.PREFERENCE},viewOnLoad:{value:0,kind:d.VIEWER+d.PREFERENCE},cMapPacked:{value:!0,kind:d.API},cMapUrl:{value:"../web/cmaps/",kind:d.API},disableAutoFetch:{value:!1,kind:d.API+d.PREFERENCE},disableFontFace:{value:!1,kind:d.API+d.PREFERENCE},disableRange:{value:!1,kind:d.API+d.PREFERENCE},disableStream:{value:!1,kind:d.API+d.PREFERENCE},docBaseUrl:{value:"",kind:d.API},enableXfa:{value:!0,kind:d.API+d.PREFERENCE},fontExtraProperties:{value:!1,kind:d.API},isEvalSupported:{value:!0,kind:d.API},isOffscreenCanvasSupported:{value:!0,kind:d.API},maxImageSize:{value:-1,kind:d.API},pdfBug:{value:!1,kind:d.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:d.API},verbosity:{value:1,kind:d.API},workerPort:{value:null,kind:d.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:d.WORKER}};i.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:d.VIEWER},i.disablePreferences={value:!1,kind:d.VIEWER},i.locale={value:navigator.language||"en-US",kind:d.VIEWER},i.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:d.VIEWER};const _=Object.create(null);class p{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(l){const g=_[l];if(g!==void 0)return g;const c=i[l];if(c!==void 0)return S[l]??c.value}static getAll(l=null){const g=Object.create(null);for(const c in i){const u=i[c];if(l){if((l&u.kind)===0)continue;if(l===d.PREFERENCE){const w=u.value,y=typeof w;if(y==="boolean"||y==="string"||y==="number"&&Number.isInteger(w)){g[c]=w;continue}throw new Error(`Invalid type for preference: ${c}`)}}const P=_[c];g[c]=P!==void 0?P:S[c]??u.value}return g}static set(l,g){_[l]=g}static setAll(l){for(const g in l)_[g]=l[g]}static remove(l){delete _[l]}}E.AppOptions=p,p._hasUserOptions=function(){return Object.keys(_).length>0}}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.StructTreeLayerBuilder=void 0;const S={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},d=/^H(\d+)$/;class i{#e=void 0;get renderingDone(){return this.#e!==void 0}render(p){if(this.#e!==void 0)return this.#e;const n=this.#i(p);return n?.classList.add("structTree"),this.#e=n}hide(){this.#e&&!this.#e.hidden&&(this.#e.hidden=!0)}show(){this.#e?.hidden&&(this.#e.hidden=!1)}#t(p,n){p.alt!==void 0&&n.setAttribute("aria-label",p.alt),p.id!==void 0&&n.setAttribute("aria-owns",p.id),p.lang!==void 0&&n.setAttribute("lang",p.lang)}#i(p){if(!p)return null;const n=document.createElement("span");if("role"in p){const{role:l}=p,g=l.match(d);g?(n.setAttribute("role","heading"),n.setAttribute("aria-level",g[1])):S[l]&&n.setAttribute("role",S[l])}if(this.#t(p,n),p.children)if(p.children.length===1&&"id"in p.children[0])this.#t(p.children[0],n);else for(const l of p.children)n.append(this.#i(l));return n}}E.StructTreeLayerBuilder=i}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.TextAccessibilityManager=void 0;var d=S(2);class i{#e=!1;#t=null;#i=new Map;#n=new Map;setTextMapping(p){this.#t=p}static#s(p,n){const l=p.getBoundingClientRect(),g=n.getBoundingClientRect();if(l.width===0&&l.height===0)return 1;if(g.width===0&&g.height===0)return-1;const c=l.y,u=l.y+l.height,P=l.y+l.height/2,w=g.y,y=g.y+g.height,e=g.y+g.height/2;if(P<=w&&e>=u)return-1;if(e<=c&&P>=y)return 1;const a=l.x+l.width/2,T=g.x+g.width/2;return a-T}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(i.#s),this.#i.size>0){const p=this.#t;for(const[n,l]of this.#i){if(!document.getElementById(n)){this.#i.delete(n);continue}this.#l(n,p[l])}}for(const[p,n]of this.#n)this.addPointerInTextLayer(p,n);this.#n.clear()}disable(){this.#e&&(this.#n.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(p){if(!this.#e){this.#n.delete(p);return}const n=this.#t;if(!n||n.length===0)return;const{id:l}=p,g=this.#i.get(l);if(g===void 0)return;const c=n[g];this.#i.delete(l);let u=c.getAttribute("aria-owns");u?.includes(l)&&(u=u.split(" ").filter(P=>P!==l).join(" "),u?c.setAttribute("aria-owns",u):(c.removeAttribute("aria-owns"),c.setAttribute("role","presentation")))}#l(p,n){const l=n.getAttribute("aria-owns");l?.includes(p)||n.setAttribute("aria-owns",l?`${l} ${p}`:p),n.removeAttribute("role")}addPointerInTextLayer(p,n){const{id:l}=p;if(!l)return;if(!this.#e){this.#n.set(p,n);return}n&&this.removePointerInTextLayer(p);const g=this.#t;if(!g||g.length===0)return;const c=(0,d.binarySearchFirstItem)(g,P=>i.#s(p,P)<0),u=Math.max(0,c-1);this.#l(l,g[u]),this.#i.set(l,u)}moveElementInDOM(p,n,l,g){if(this.addPointerInTextLayer(l,g),!p.hasChildNodes()){p.append(n);return}const c=Array.from(p.childNodes).filter(w=>w!==n);if(c.length===0)return;const u=l||n,P=(0,d.binarySearchFirstItem)(c,w=>i.#s(u,w)<0);P===0?c[0].before(n):c[P-1].after(n)}}E.TextAccessibilityManager=i}),((D,E)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.TextHighlighter=void 0;class S{constructor({findController:i,eventBus:_,pageIndex:p}){this.findController=i,this.matches=[],this.eventBus=_,this.pageIdx=p,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(i,_){this.textDivs=i,this.textContentItemsStr=_}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=i=>{(i.pageIndex===this.pageIdx||i.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(i,_){if(!i)return[];const{textContentItemsStr:p}=this;let n=0,l=0;const g=p.length-1,c=[];for(let u=0,P=i.length;u<P;u++){let w=i[u];for(;n!==g&&w>=l+p[n].length;)l+=p[n].length,n++;n===p.length&&console.error("Could not find a matching mapping");const y={begin:{divIdx:n,offset:w-l}};for(w+=_[u];n!==g&&w>l+p[n].length;)l+=p[n].length,n++;y.end={divIdx:n,offset:w-l},c.push(y)}return c}_renderMatches(i){if(i.length===0)return;const{findController:_,pageIdx:p}=this,{textContentItemsStr:n,textDivs:l}=this,g=p===_.selected.pageIdx,c=_.selected.matchIdx,u=_.state.highlightAll;let P=null;const w={offset:void 0};function y(I,U){const z=I.divIdx;return l[z].textContent="",e(z,0,I.offset,U)}function e(I,U,z,ie){let J=l[I];if(J.nodeType===Node.TEXT_NODE){const M=document.createElement("span");J.before(M),M.append(J),l[I]=M,J=M}const q=n[I].substring(U,z),W=document.createTextNode(q);if(ie){const M=document.createElement("span");return M.className=`${ie} appended`,M.append(W),J.append(M),ie.includes("selected")?M.offsetLeft:0}return J.append(W),0}let a=c,T=a+1;if(u)a=0,T=i.length;else if(!g)return;let O=-1,x=-1;for(let I=a;I<T;I++){const U=i[I],z=U.begin;if(z.divIdx===O&&z.offset===x)continue;O=z.divIdx,x=z.offset;const ie=U.end,J=g&&I===c,q=J?" selected":"";let W=0;if(!P||z.divIdx!==P.divIdx?(P!==null&&e(P.divIdx,P.offset,w.offset),y(z)):e(P.divIdx,P.offset,z.offset),z.divIdx===ie.divIdx)W=e(z.divIdx,z.offset,ie.offset,"highlight"+q);else{W=e(z.divIdx,z.offset,w.offset,"highlight begin"+q);for(let M=z.divIdx+1,C=ie.divIdx;M<C;M++)l[M].className="highlight middle"+q;y(ie,"highlight end"+q)}P=ie,J&&_.scrollMatchIntoView({element:l[z.divIdx],selectedLeft:W,pageIndex:p,matchIndex:c})}P&&e(P.divIdx,P.offset,w.offset)}_updateMatches(i=!1){if(!this.enabled&&!i)return;const{findController:_,matches:p,pageIdx:n}=this,{textContentItemsStr:l,textDivs:g}=this;let c=-1;for(const w of p){const y=Math.max(c,w.begin.divIdx);for(let e=y,a=w.end.divIdx;e<=a;e++){const T=g[e];T.textContent=l[e],T.className=""}c=w.end.divIdx+1}if(!_?.highlightMatches||i)return;const u=_.pageMatches[n]||null,P=_.pageMatchesLength[n]||null;this.matches=this._convertMatches(u,P),this._renderMatches(this.matches)}}E.TextHighlighter=S}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.TextLayerBuilder=void 0;var d=S(4),i=S(2);class _{#e=!1;#t=0;#i=0;#n=null;constructor({highlighter:n=null,accessibilityManager:l=null,isOffscreenCanvasSupported:g=!0,enablePermissions:c=!1}){this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=n,this.accessibilityManager=l,this.isOffscreenCanvasSupported=g,this.#e=c===!0,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}#s(){this.renderingDone=!0;const n=document.createElement("div");n.className="endOfContent",this.div.append(n),this.#l()}get numTextDivs(){return this.textDivs.length}async render(n){if(!this.#n)throw new Error('No "textContentSource" parameter specified.');const l=n.scale*(globalThis.devicePixelRatio||1),{rotation:g}=n;if(this.renderingDone){const c=g!==this.#t,u=l!==this.#i;(c||u)&&(this.hide(),(0,d.updateTextLayer)({container:this.div,viewport:n,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:u,mustRotate:c}),this.#i=l,this.#t=g),this.show();return}this.cancel(),this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr),this.accessibilityManager?.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,d.renderTextLayer)({textContentSource:this.#n,container:this.div,viewport:n,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,this.#s(),this.#i=l,this.#t=g,this.show(),this.accessibilityManager?.enable()}hide(){this.div.hidden||(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable(),this.accessibilityManager?.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(n){this.cancel(),this.#n=n}#l(){const{div:n}=this;n.addEventListener("mousedown",l=>{const g=n.querySelector(".endOfContent");if(!g)return;let c=l.target!==n;if(c&&=getComputedStyle(g).getPropertyValue("-moz-user-select")!=="none",c){const u=n.getBoundingClientRect(),P=Math.max(0,(l.pageY-u.top)/u.height);g.style.top=(P*100).toFixed(2)+"%"}g.classList.add("active")}),n.addEventListener("mouseup",()=>{const l=n.querySelector(".endOfContent");l&&(l.style.top="",l.classList.remove("active"))}),n.addEventListener("copy",l=>{if(!this.#e){const g=document.getSelection();l.clipboardData.setData("text/plain",(0,i.removeNullCharacters)((0,d.normalizeUnicode)(g.toString())))}l.preventDefault(),l.stopPropagation()})}}E.TextLayerBuilder=_}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.XfaLayerBuilder=void 0;var d=S(4);class i{constructor({pageDiv:p,pdfPage:n,annotationStorage:l=null,linkService:g,xfaHtml:c=null}){this.pageDiv=p,this.pdfPage=n,this.annotationStorage=l,this.linkService=g,this.xfaHtml=c,this.div=null,this._cancelled=!1}async render(p,n="display"){if(n==="print"){const c={viewport:p.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:n},u=document.createElement("div");return this.pageDiv.append(u),c.div=u,d.XfaLayer.render(c)}const l=await this.pdfPage.getXfa();if(this._cancelled||!l)return{textDivs:[]};const g={viewport:p.clone({dontFlip:!0}),div:this.div,xfaHtml:l,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:n};return this.div?d.XfaLayer.update(g):(this.div=document.createElement("div"),this.pageDiv.append(this.div),g.div=this.div,d.XfaLayer.render(g))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}E.XfaLayerBuilder=i}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFScriptingManager=void 0;var d=S(2),i=S(4);class _{constructor({eventBus:n,sandboxBundleSrc:l=null,scriptingFactory:g=null,docPropertiesLookup:c=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._ready=!1,this._eventBus=n,this._sandboxBundleSrc=l,this._scriptingFactory=g,this._docPropertiesLookup=c,this._scriptingFactory||window.addEventListener("updatefromsandbox",u=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:u.detail})})}setViewer(n){this._pdfViewer=n}async setDocument(n){if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=n,!n)return;const[l,g,c]=await Promise.all([n.getFieldObjects(),n.getCalculationOrderIds(),n.getJSActions()]);if(!l&&!c){await this._destroyScripting();return}if(n===this._pdfDocument){try{this._scripting=this._createScripting()}catch(u){console.error(`PDFScriptingManager.setDocument: "${u?.message}".`),await this._destroyScripting();return}this._internalEvents.set("updatefromsandbox",u=>{u?.source===window&&this._updateFromSandbox(u.detail)}),this._internalEvents.set("dispatcheventinsandbox",u=>{this._scripting?.dispatchEventInSandbox(u.detail)}),this._internalEvents.set("pagechanging",({pageNumber:u,previous:P})=>{u!==P&&(this._dispatchPageClose(P),this._dispatchPageOpen(u))}),this._internalEvents.set("pagerendered",({pageNumber:u})=>{this._pageOpenPending.has(u)&&u===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(u)}),this._internalEvents.set("pagesdestroy",async u=>{await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this._closeCapability?.resolve()});for(const[u,P]of this._internalEvents)this._eventBus._on(u,P);try{const u=await this._getDocProperties();if(n!==this._pdfDocument)return;await this._scripting.createSandbox({objects:l,calculationOrder:g,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...u,actions:c}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(u){console.error(`PDFScriptingManager.setDocument: "${u?.message}".`),await this._destroyScripting();return}await this._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{n===this._pdfDocument&&(this._ready=!0)})}}async dispatchWillSave(n){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(n){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(n){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(n){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,i.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,i.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,i.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(n){const l=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:g,siblings:c,command:u,value:P}=n;if(!g){switch(u){case"clear":console.clear();break;case"error":console.error(P);break;case"layout":{if(l)return;const y=(0,d.apiPageLayoutToViewerModes)(P);this._pdfViewer.spreadMode=y.spreadMode;break}case"page-num":this._pdfViewer.currentPageNumber=P+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(P);break;case"zoom":if(l)return;this._pdfViewer.currentScaleValue=P;break;case"SaveAs":this._eventBus.dispatch("download",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(l)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(l)return;this._pdfViewer.decreaseScale();break}return}if(l&&n.focus)return;delete n.id,delete n.siblings;const w=c?[g,...c]:[g];for(const y of w){const e=document.querySelector(`[data-element-id="${y}"]`);e?e.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:n})):this._pdfDocument?.annotationStorage.setValue(y,n)}}async _dispatchPageOpen(n,l=!1){const g=this._pdfDocument,c=this._visitedPages;if(l&&(this._closeCapability=new i.PromiseCapability),!this._closeCapability)return;const u=this._pdfViewer.getPageView(n-1);if(u?.renderingState!==d.RenderingStates.FINISHED){this._pageOpenPending.add(n);return}this._pageOpenPending.delete(n);const P=(async()=>{const w=await(c.has(n)?null:u.pdfPage?.getJSActions());g===this._pdfDocument&&await this._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:n,actions:w})})();c.set(n,P)}async _dispatchPageClose(n){const l=this._pdfDocument,g=this._visitedPages;if(!this._closeCapability||this._pageOpenPending.has(n))return;const c=g.get(n);c&&(g.set(n,null),await c,l===this._pdfDocument&&await this._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:n}))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:n}=S(22);return n(this._pdfDocument)}_createScripting(){if(this._destroyCapability=new i.PromiseCapability,this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:n}=S(22);return new n(this._sandboxBundleSrc)}async _destroyScripting(){if(!this._scripting){this._pdfDocument=null,this._destroyCapability?.resolve();return}this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise(n=>{setTimeout(n,1e3)})]).catch(n=>{}),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch{}for(const[n,l]of this._internalEvents)this._eventBus._off(n,l);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,this._ready=!1,this._destroyCapability?.resolve()}}E.PDFScriptingManager=_}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.GenericScripting=void 0,E.docPropertiesLookup=i;var d=S(4);async function i(p){const l="".split("#")[0];let{info:g,metadata:c,contentDispositionFilename:u,contentLength:P}=await p.getMetadata();if(!P){const{length:w}=await p.getDownloadInfo();P=w}return{...g,baseURL:l,filesize:P,filename:u||(0,d.getPdfFilenameFromUrl)(""),metadata:c?.getRaw(),authors:c?.get("dc:creator"),numPages:p.numPages,URL:""}}class _{constructor(n){this._ready=(0,d.loadScript)(n,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(n){(await this._ready).create(n)}async dispatchEventInSandbox(n){const l=await this._ready;setTimeout(()=>l.dispatchEvent(n),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}E.GenericScripting=_}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFSinglePageViewer=void 0;var d=S(2),i=S(24);class _ extends i.PDFViewer{_resetView(){super._resetView(),this._scrollMode=d.ScrollMode.PAGE,this._spreadMode=d.SpreadMode.NONE}set scrollMode(n){}_updateScrollMode(){}set spreadMode(n){}_updateSpreadMode(){}}E.PDFSinglePageViewer=_}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PagesCountLimit=E.PDFViewer=E.PDFPageViewBuffer=void 0;var d=S(4),i=S(2),_=S(5),p=S(13),n=S(25),l=S(1);const g=10,c={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};E.PagesCountLimit=c;function u(y){return Object.values(d.AnnotationEditorType).includes(y)&&y!==d.AnnotationEditorType.DISABLE}class P{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){const a=this.#e;a.has(e)&&a.delete(e),a.add(e),a.size>this.#t&&this.#i()}resize(e,a=null){this.#t=e;const T=this.#e;if(a){const O=T.size;let x=1;for(const I of T)if(a.has(I.id)&&(T.delete(I),T.add(I)),++x>O)break}for(;T.size>this.#t;)this.#i()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#i(){const e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}}E.PDFPageViewBuffer=P;class w{#e=null;#t=d.AnnotationEditorType.NONE;#i=null;#n=d.AnnotationMode.ENABLE_FORMS;#s=null;#l=null;#h=!1;#r=!1;#a=null;#d=!1;#c=0;#f=new ResizeObserver(this.#k.bind(this));#o=null;#u=null;#g=null;#b=i.TextLayerMode.ENABLE;constructor(e){const a="3.6.172";if(d.version!==a)throw new Error(`The API version "${d.version}" does not match the Viewer version "${a}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#f.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new l.SimpleLinkService,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this._scriptingManager=e.scriptingManager||null,this.#b=e.textLayerMode??i.TextLayerMode.ENABLE,this.#n=e.annotationMode??d.AnnotationMode.ENABLE_FORMS,this.#t=e.annotationEditorMode??d.AnnotationEditorType.NONE,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.useOnlyCssZoom=e.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n||_.NullL10n,this.#h=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new n.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue,this.scroll=(0,i.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=i.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#M()}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#n===d.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,a=!1){if(this._currentPageNumber===e)return a&&this.#E(),!0;if(!(0<e&&e<=this.pagesCount))return!1;const T=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:T}),a&&this.#E(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let a=e|0;if(this._pageLabels){const T=this._pageLabels.indexOf(e);T>=0&&(a=T+1)}this._setCurrentPageNumber(a,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==i.UNKNOWN_SCALE?this._currentScale:i.DEFAULT_SCALE}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#_(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#_(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!(0,i.isValidRotation)(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;const a=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#_(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:a}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#v(){const e=this;return{get annotationEditorUIManager(){return e.#i},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}}}#C(e){const a={annotationEditorMode:this.#t,annotationMode:this.#n,textLayerMode:this.#b};return e&&(!e.includes(d.PermissionFlag.COPY)&&this.#b===i.TextLayerMode.ENABLE&&(a.textLayerMode=i.TextLayerMode.ENABLE_PERMISSIONS),e.includes(d.PermissionFlag.MODIFY_CONTENTS)||(a.annotationEditorMode=d.AnnotationEditorType.DISABLE),!e.includes(d.PermissionFlag.MODIFY_ANNOTATIONS)&&!e.includes(d.PermissionFlag.FILL_INTERACTIVE_FORMS)&&this.#n===d.AnnotationMode.ENABLE_FORMS&&(a.annotationMode=d.AnnotationMode.ENABLE)),a}#A(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const e=new Promise(a=>{this.#u=()=>{document.visibilityState==="hidden"&&(a(),document.removeEventListener("visibilitychange",this.#u),this.#u=null)},document.addEventListener("visibilitychange",this.#u)});return Promise.race([this._onePageRenderedCapability.promise,e])}async getAllText(){const e=[],a=[];for(let T=1,O=this.pdfDocument.numPages;T<=O;++T){if(this.#d)return null;a.length=0;const x=await this.pdfDocument.getPage(T),{items:I}=await x.getTextContent();for(const U of I)U.str&&a.push(U.str),U.hasEOL&&a.push(`
`);e.push((0,i.removeNullCharacters)(a.join("")))}return e.join(`
`)}#w(e,a){const T=document.getSelection(),{focusNode:O,anchorNode:x}=T;if(x&&O&&T.containsNode(this.#a)){if(this.#r||e===i.TextLayerMode.ENABLE_PERMISSIONS){a.preventDefault(),a.stopPropagation();return}this.#r=!0;const I=this.container.style.cursor;this.container.style.cursor="wait";const U=z=>this.#d=z.key==="Escape";window.addEventListener("keydown",U),this.getAllText().then(async z=>{z!==null&&await navigator.clipboard.writeText(z)}).catch(z=>{console.warn(`Something goes wrong when extracting the text: ${z.message}`)}).finally(()=>{this.#r=!1,this.#d=!1,window.removeEventListener("keydown",U),this.container.style.cursor=I}),a.preventDefault(),a.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#i&&(this.#i.destroy(),this.#i=null)),this.pdfDocument=e,!e)return;const a=e.numPages,T=e.getPage(1),O=e.getOptionalContentConfig(),x=this.#h?e.getPermissions():Promise.resolve();if(a>c.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const I=this._scrollMode=i.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:I})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:a})},()=>{}),this._onBeforeDraw=I=>{const U=this._pages[I.pageNumber-1];U&&this.#e.push(U)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=I=>{I.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:I.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#u&&(document.removeEventListener("visibilitychange",this.#u),this.#u=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([T,x]).then(([I,U])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(I),this._optionalContentConfigPromise=O;const{annotationEditorMode:z,annotationMode:ie,textLayerMode:J}=this.#C(U);if(J!==i.TextLayerMode.DISABLE){const h=this.#a=document.createElement("div");h.id="hiddenCopyElement",this.viewer.before(h)}if(z!==d.AnnotationEditorType.DISABLE){const h=z;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):u(h)?(this.#i=new d.AnnotationEditorUIManager(this.container,this.eventBus,e?.annotationStorage),h!==d.AnnotationEditorType.NONE&&this.#i.updateMode(h)):console.error(`Invalid AnnotationEditor mode: ${h}`)}const q=this.#v.bind(this),W=this._scrollMode===i.ScrollMode.PAGE?null:this.viewer,M=this.currentScale,C=I.getViewport({scale:M*d.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",C.scale);for(let h=1;h<=a;++h){const r=new p.PDFPageView({container:W,eventBus:this.eventBus,id:h,scale:M,defaultViewport:C.clone(),optionalContentConfigPromise:O,renderingQueue:this.renderingQueue,textLayerMode:J,annotationMode:ie,imageResourcesPath:this.imageResourcesPath,useOnlyCssZoom:this.useOnlyCssZoom,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:q});this._pages.push(r)}const A=this._pages[0];A&&(A.setPdfPage(I),this.linkService.cachePageRef(1,I.ref)),this._scrollMode===i.ScrollMode.PAGE?this.#y():this._spreadMode!==i.SpreadMode.NONE&&this._updateSpreadMode(),this.#A().then(async()=>{if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#a&&(this.#l=this.#w.bind(this,J),document.addEventListener("copy",this.#l)),this.#i&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:this.#t}),e.loadingParams.disableAutoFetch||a>c.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let h=a-1;if(h<=0){this._pagesCapability.resolve();return}for(let r=2;r<=a;++r){const v=e.getPage(r).then(L=>{const s=this._pages[r-1];s.pdfPage||s.setPdfPage(L),this.linkService.cachePageRef(r,L.ref),--h===0&&this._pagesCapability.resolve()},L=>{console.error(`Unable to get page ${r} to initialize viewer`,L),--h===0&&this._pagesCapability.resolve()});r%c.PAUSE_EAGER_PAGE_INIT===0&&await v}}),this.eventBus.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:h})=>{e===this.pdfDocument&&h.Language&&(this.viewer.lang=h.Language)}),this.defaultRenderingQueue&&this.update()}).catch(I=>{console.error("Unable to initialize viewer",I),this._pagesCapability.reject(I)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let a=0,T=this._pages.length;a<T;a++)this._pages[a].setPageLabel(this._pageLabels?.[a]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=i.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#e=new P(g),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new d.PromiseCapability,this._onePageRenderedCapability=new d.PromiseCapability,this._pagesCapability=new d.PromiseCapability,this._scrollMode=i.ScrollMode.VERTICAL,this._previousScrollMode=i.ScrollMode.UNKNOWN,this._spreadMode=i.SpreadMode.NONE,this.#o={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#u&&(document.removeEventListener("visibilitychange",this.#u),this.#u=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#a&&(document.removeEventListener("copy",this.#l),this.#l=null,this.#a.remove(),this.#a=null)}#y(){if(this._scrollMode!==i.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const e=this._currentPageNumber,a=this.#o,T=this.viewer;if(T.textContent="",a.pages.length=0,this._spreadMode===i.SpreadMode.NONE&&!this.isInPresentationMode){const O=this._pages[e-1];T.append(O.div),a.pages.push(O)}else{const O=new Set,x=this._spreadMode-1;x===-1?O.add(e-1):e%2!==x?(O.add(e-1),O.add(e)):(O.add(e-2),O.add(e-1));const I=document.createElement("div");if(I.className="spread",this.isInPresentationMode){const U=document.createElement("div");U.className="dummyPage",I.append(U)}for(const U of O){const z=this._pages[U];z&&(I.append(z.div),a.pages.push(z))}T.append(I)}a.scrollDown=e>=a.previousPageNumber,a.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#S(e,a=null){const{div:T,id:O}=e;if(this._currentPageNumber!==O&&this._setCurrentPageNumber(O),this._scrollMode===i.ScrollMode.PAGE&&(this.#y(),this.update()),!a&&!this.isInPresentationMode){const x=T.offsetLeft+T.clientLeft,I=x+T.clientWidth,{scrollLeft:U,clientWidth:z}=this.container;(this._scrollMode===i.ScrollMode.HORIZONTAL||x<U||I>U+z)&&(a={left:0,top:0})}(0,i.scrollIntoView)(T,a),!this._currentScaleValue&&this._location&&(this._location=null)}#p(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#x(e,a,{noScroll:T=!1,preset:O=!1,drawingDelay:x=-1}){if(this._currentScaleValue=a.toString(),this.#p(e)){O&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:a});return}this.viewer.style.setProperty("--scale-factor",e*d.PixelsPerInch.PDF_TO_CSS_UNITS);const I=x>=0&&x<1e3;if(this.refresh(!0,{scale:e,drawingDelay:I?x:-1}),I&&(this.#g=setTimeout(()=>{this.#g=null,this.refresh()},x)),this._currentScale=e,!T){let U=this._currentPageNumber,z;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(U=this._location.pageNumber,z=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:U,destArray:z,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:O?a:void 0}),this.defaultRenderingQueue&&this.update()}get#T(){return this._spreadMode!==i.SpreadMode.NONE&&this._scrollMode!==i.ScrollMode.HORIZONTAL?2:1}#_(e,a){let T=parseFloat(e);if(T>0)a.preset=!1,this.#x(T,e,a);else{const O=this._pages[this._currentPageNumber-1];if(!O)return;let x=i.SCROLLBAR_PADDING,I=i.VERTICAL_PADDING;this.isInPresentationMode?(x=I=4,this._spreadMode!==i.SpreadMode.NONE&&(x*=2)):this.removePageBorders?x=I=0:this._scrollMode===i.ScrollMode.HORIZONTAL&&([x,I]=[I,x]);const U=(this.container.clientWidth-x)/O.width*O.scale/this.#T,z=(this.container.clientHeight-I)/O.height*O.scale;switch(e){case"page-actual":T=1;break;case"page-width":T=U;break;case"page-height":T=z;break;case"page-fit":T=Math.min(U,z);break;case"auto":const ie=(0,i.isPortraitOrientation)(O)?U:Math.min(z,U);T=Math.min(i.MAX_AUTO_SCALE,ie);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}a.preset=!0,this.#x(T,e,a)}}#E(){const e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#_(this._currentScaleValue,{noScroll:!0}),this.#S(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;const a=this._pageLabels.indexOf(e);return a<0?null:a+1}scrollPageIntoView({pageNumber:e,destArray:a=null,allowNegativeOffset:T=!1,ignoreDestinationZoom:O=!1}){if(!this.pdfDocument)return;const x=Number.isInteger(e)&&this._pages[e-1];if(!x){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!a){this._setCurrentPageNumber(e,!0);return}let I=0,U=0,z=0,ie=0,J,q;const W=x.rotation%180!==0,M=(W?x.height:x.width)/x.scale/d.PixelsPerInch.PDF_TO_CSS_UNITS,C=(W?x.width:x.height)/x.scale/d.PixelsPerInch.PDF_TO_CSS_UNITS;let A=0;switch(a[1].name){case"XYZ":I=a[2],U=a[3],A=a[4],I=I!==null?I:0,U=U!==null?U:C;break;case"Fit":case"FitB":A="page-fit";break;case"FitH":case"FitBH":U=a[2],A="page-width",U===null&&this._location?(I=this._location.left,U=this._location.top):(typeof U!="number"||U<0)&&(U=C);break;case"FitV":case"FitBV":I=a[2],z=M,ie=C,A="page-height";break;case"FitR":I=a[2],U=a[3],z=a[4]-I,ie=a[5]-U;let L=i.SCROLLBAR_PADDING,s=i.VERTICAL_PADDING;this.removePageBorders&&(L=s=0),J=(this.container.clientWidth-L)/z/d.PixelsPerInch.PDF_TO_CSS_UNITS,q=(this.container.clientHeight-s)/ie/d.PixelsPerInch.PDF_TO_CSS_UNITS,A=Math.min(Math.abs(J),Math.abs(q));break;default:console.error(`scrollPageIntoView: "${a[1].name}" is not a valid destination type.`);return}if(O||(A&&A!==this._currentScale?this.currentScaleValue=A:this._currentScale===i.UNKNOWN_SCALE&&(this.currentScaleValue=i.DEFAULT_SCALE_VALUE)),A==="page-fit"&&!a[4]){this.#S(x);return}const h=[x.viewport.convertToViewportPoint(I,U),x.viewport.convertToViewportPoint(I+z,U+ie)];let r=Math.min(h[0][0],h[1][0]),v=Math.min(h[0][1],h[1][1]);T||(r=Math.max(r,0),v=Math.max(v,0)),this.#S(x,{left:r,top:v})}_updateLocation(e){const a=this._currentScale,T=this._currentScaleValue,O=parseFloat(T)===a?Math.round(a*1e4)/100:T,x=e.id,I=this._pages[x-1],U=this.container,z=I.getPagePoint(U.scrollLeft-e.x,U.scrollTop-e.y),ie=Math.round(z[0]),J=Math.round(z[1]);let q=`#page=${x}`;this.isInPresentationMode||(q+=`&zoom=${O},${ie},${J}`),this._location={pageNumber:x,scale:O,top:J,left:ie,rotation:this._pagesRotation,pdfOpenParams:q}}update(){const e=this._getVisiblePages(),a=e.views,T=a.length;if(T===0)return;const O=Math.max(g,2*T+1);this.#e.resize(O,e.ids),this.renderingQueue.renderHighestPriority(e);const x=this._spreadMode===i.SpreadMode.NONE&&(this._scrollMode===i.ScrollMode.PAGE||this._scrollMode===i.ScrollMode.VERTICAL),I=this._currentPageNumber;let U=!1;for(const z of a){if(z.percent<100)break;if(z.id===I&&x){U=!0;break}}this._setCurrentPageNumber(U?I:a[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===i.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===i.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const e=this._scrollMode===i.ScrollMode.PAGE?this.#o.pages:this._pages,a=this._scrollMode===i.ScrollMode.HORIZONTAL,T=a&&this._isContainerRtl;return(0,i.getVisibleElements)({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:a,rtl:T})}isPageVisible(e){return this.pdfDocument?Number.isInteger(e)&&e>0&&e<=this.pagesCount?this._getVisiblePages().ids.has(e):(console.error(`isPageVisible: "${e}" is not a valid page.`),!1):!1}isPageCached(e){if(!this.pdfDocument)return!1;if(!(Number.isInteger(e)&&e>0&&e<=this.pagesCount))return console.error(`isPageCached: "${e}" is not a valid page.`),!1;const a=this._pages[e-1];return this.#e.has(a)}cleanup(){for(const e of this._pages)e.renderingState!==i.RenderingStates.FINISHED&&e.reset()}_cancelRendering(){for(const e of this._pages)e.cancelRendering()}async#m(e){if(e.pdfPage)return e.pdfPage;try{const a=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(a),this.linkService._cachedPageNumber?.(a.ref)||this.linkService.cachePageRef(e.id,a.ref),a}catch(a){return console.error("Unable to get page for page view",a),null}}#P(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case i.ScrollMode.PAGE:return this.#o.scrollDown;case i.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){const a=e||this._getVisiblePages(),T=this.#P(a),O=this._spreadMode!==i.SpreadMode.NONE&&this._scrollMode!==i.ScrollMode.HORIZONTAL,x=this.renderingQueue.getHighestPriority(a,this._pages,T,O);return x?(this.#m(x).then(()=>{this.renderingQueue.renderView(x)}),!0):!1}get hasEqualPageSizes(){const e=this._pages[0];for(let a=1,T=this._pages.length;a<T;++a){const O=this._pages[a];if(O.width!==e.width||O.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(a=>{const T=a.pdfPage.getViewport({scale:1}),O=(0,i.isPortraitOrientation)(T);if(e===void 0)e=O;else if(this.enablePrintAutoRotate&&O!==e)return{width:T.height,height:T.width,rotation:(T.rotation-90)%360};return{width:T.width,height:T.height,rotation:T.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!(0,i.isValidScrollMode)(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>c.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){const a=this._scrollMode,T=this.viewer;T.classList.toggle("scrollHorizontal",a===i.ScrollMode.HORIZONTAL),T.classList.toggle("scrollWrapped",a===i.ScrollMode.WRAPPED),!(!this.pdfDocument||!e)&&(a===i.ScrollMode.PAGE?this.#y():this._previousScrollMode===i.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#_(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!(0,i.isValidSpreadMode)(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;const a=this.viewer,T=this._pages;if(this._scrollMode===i.ScrollMode.PAGE)this.#y();else if(a.textContent="",this._spreadMode===i.SpreadMode.NONE)for(const O of this._pages)a.append(O.div);else{const O=this._spreadMode-1;let x=null;for(let I=0,U=T.length;I<U;++I)x===null?(x=document.createElement("div"),x.className="spread",a.append(x)):I%2===O&&(x=x.cloneNode(!1),a.append(x)),x.append(T[I].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#_(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,a=!1){switch(this._scrollMode){case i.ScrollMode.WRAPPED:{const{views:T}=this._getVisiblePages(),O=new Map;for(const{id:x,y:I,percent:U,widthPercent:z}of T){if(U===0||z<100)continue;let ie=O.get(I);ie||O.set(I,ie||=[]),ie.push(x)}for(const x of O.values()){const I=x.indexOf(e);if(I===-1)continue;const U=x.length;if(U===1)break;if(a)for(let z=I-1,ie=0;z>=ie;z--){const J=x[z],q=x[z+1]-1;if(J<q)return e-q}else for(let z=I+1,ie=U;z<ie;z++){const J=x[z],q=x[z-1]+1;if(J>q)return q-e}if(a){const z=x[0];if(z<e)return e-z+1}else{const z=x[U-1];if(z>e)return z-e+1}break}break}case i.ScrollMode.HORIZONTAL:break;case i.ScrollMode.PAGE:case i.ScrollMode.VERTICAL:{if(this._spreadMode===i.SpreadMode.NONE)break;const T=this._spreadMode-1;if(a&&e%2!==T)break;if(!a&&e%2===T)break;const{views:O}=this._getVisiblePages(),x=a?e-1:e+1;for(const{id:I,percent:U,widthPercent:z}of O)if(I===x){if(U>0&&z===100)return 2;break}break}}return 1}nextPage(){const e=this._currentPageNumber,a=this.pagesCount;if(e>=a)return!1;const T=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+T,a),!0}previousPage(){const e=this._currentPageNumber;if(e<=1)return!1;const a=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-a,1),!0}increaseScale({drawingDelay:e,scaleFactor:a,steps:T}={}){if(!this.pdfDocument)return;let O=this._currentScale;if(a>1)O=Math.round(O*a*100)/100;else{T??=1;do O=Math.ceil((O*i.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--T>0&&O<i.MAX_SCALE)}this.#_(Math.min(i.MAX_SCALE,O),{noScroll:!1,drawingDelay:e})}decreaseScale({drawingDelay:e,scaleFactor:a,steps:T}={}){if(!this.pdfDocument)return;let O=this._currentScale;if(a>0&&a<1)O=Math.round(O*a*100)/100;else{T??=1;do O=Math.floor((O/i.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--T>0&&O>i.MIN_SCALE)}this.#_(Math.max(i.MIN_SCALE,O),{noScroll:!1,drawingDelay:e})}#M(e=this.container.clientHeight){e!==this.#c&&(this.#c=e,i.docStyle.setProperty("--viewer-container-height",`${e}px`))}#k(e){for(const a of e)if(a.target===this.container){this.#M(Math.floor(a.borderBoxSize[0].blockSize)),this.#s=null;break}}get containerTopLeft(){return this.#s||=[this.container.offsetTop,this.container.offsetLeft]}get annotationEditorMode(){return this.#i?this.#t:d.AnnotationEditorType.DISABLE}set annotationEditorMode(e){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");if(this.#t!==e){if(!u(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);this.pdfDocument&&(this.#t=e,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:e}),this.#i.updateMode(e))}}set annotationEditorParams({type:e,value:a}){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");this.#i.updateParams(e,a)}refresh(e=!1,a=Object.create(null)){if(this.pdfDocument){for(const T of this._pages)T.update(a);this.#g!==null&&(clearTimeout(this.#g),this.#g=null),e||this.update()}}}E.PDFViewer=w}),((D,E,S)=>{Object.defineProperty(E,"__esModule",{value:!0}),E.PDFRenderingQueue=void 0;var d=S(4),i=S(2);const _=3e4;class p{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(l){this.pdfViewer=l}setThumbnailViewer(l){this.pdfThumbnailViewer=l}isHighestPriority(l){return this.highestPriorityPage===l.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(l){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(l)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),_)))}getHighestPriority(l,g,c,u=!1){const P=l.views,w=P.length;if(w===0)return null;for(let O=0;O<w;O++){const x=P[O].view;if(!this.isViewFinished(x))return x}const y=l.first.id,e=l.last.id;if(e-y+1>w){const O=l.ids;for(let x=1,I=e-y;x<I;x++){const U=c?y+x:e-x;if(O.has(U))continue;const z=g[U-1];if(!this.isViewFinished(z))return z}}let a=c?e:y-2,T=g[a];return T&&!this.isViewFinished(T)||u&&(a+=c?1:-1,T=g[a],T&&!this.isViewFinished(T))?T:null}isViewFinished(l){return l.renderingState===i.RenderingStates.FINISHED}renderView(l){switch(l.renderingState){case i.RenderingStates.FINISHED:return!1;case i.RenderingStates.PAUSED:this.highestPriorityPage=l.renderingId,l.resume();break;case i.RenderingStates.RUNNING:this.highestPriorityPage=l.renderingId;break;case i.RenderingStates.INITIAL:this.highestPriorityPage=l.renderingId,l.draw().finally(()=>{this.renderHighestPriority()}).catch(g=>{g instanceof d.RenderingCancelledException||console.error(`renderView: "${g}"`)});break}return!0}}E.PDFRenderingQueue=p})],m={};function R(D){var E=m[D];if(E!==void 0)return E.exports;var S=m[D]={exports:{}};return F[D](S,S.exports,R),S.exports}var H={};return(()=>{var D=H;Object.defineProperty(D,"__esModule",{value:!0}),Object.defineProperty(D,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return d.AnnotationLayerBuilder}}),D.DefaultXfaLayerFactory=D.DefaultTextLayerFactory=D.DefaultStructTreeLayerFactory=D.DefaultAnnotationLayerFactory=void 0,Object.defineProperty(D,"DownloadManager",{enumerable:!0,get:function(){return i.DownloadManager}}),Object.defineProperty(D,"EventBus",{enumerable:!0,get:function(){return _.EventBus}}),Object.defineProperty(D,"GenericL10n",{enumerable:!0,get:function(){return p.GenericL10n}}),Object.defineProperty(D,"LinkTarget",{enumerable:!0,get:function(){return E.LinkTarget}}),Object.defineProperty(D,"NullL10n",{enumerable:!0,get:function(){return n.NullL10n}}),Object.defineProperty(D,"PDFFindController",{enumerable:!0,get:function(){return l.PDFFindController}}),Object.defineProperty(D,"PDFHistory",{enumerable:!0,get:function(){return g.PDFHistory}}),Object.defineProperty(D,"PDFLinkService",{enumerable:!0,get:function(){return E.PDFLinkService}}),Object.defineProperty(D,"PDFPageView",{enumerable:!0,get:function(){return c.PDFPageView}}),Object.defineProperty(D,"PDFScriptingManager",{enumerable:!0,get:function(){return u.PDFScriptingManager}}),Object.defineProperty(D,"PDFSinglePageViewer",{enumerable:!0,get:function(){return P.PDFSinglePageViewer}}),Object.defineProperty(D,"PDFViewer",{enumerable:!0,get:function(){return w.PDFViewer}}),Object.defineProperty(D,"ProgressBar",{enumerable:!0,get:function(){return S.ProgressBar}}),Object.defineProperty(D,"RenderingStates",{enumerable:!0,get:function(){return S.RenderingStates}}),Object.defineProperty(D,"ScrollMode",{enumerable:!0,get:function(){return S.ScrollMode}}),Object.defineProperty(D,"SimpleLinkService",{enumerable:!0,get:function(){return E.SimpleLinkService}}),Object.defineProperty(D,"SpreadMode",{enumerable:!0,get:function(){return S.SpreadMode}}),Object.defineProperty(D,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return y.StructTreeLayerBuilder}}),Object.defineProperty(D,"TextLayerBuilder",{enumerable:!0,get:function(){return e.TextLayerBuilder}}),Object.defineProperty(D,"XfaLayerBuilder",{enumerable:!0,get:function(){return a.XfaLayerBuilder}}),Object.defineProperty(D,"parseQueryString",{enumerable:!0,get:function(){return S.parseQueryString}});var E=R(1),S=R(2),d=R(3),i=R(6),_=R(7),p=R(8),n=R(5),l=R(10),g=R(12),c=R(13),u=R(21),P=R(23),w=R(24),y=R(16),e=R(19),a=R(20);class T{constructor(){throw new Error("The `DefaultAnnotationLayerFactory` has been removed, please use the `annotationMode` option when initializing the `PDFPageView`-instance to control AnnotationLayer rendering.")}}D.DefaultAnnotationLayerFactory=T;class O{constructor(){throw new Error("The `DefaultStructTreeLayerFactory` has been removed, this functionality is automatically enabled when the TextLayer is used.")}}D.DefaultStructTreeLayerFactory=O;class x{constructor(){throw new Error("The `DefaultTextLayerFactory` has been removed, please use the `textLayerMode` option when initializing the `PDFPageView`-instance to control TextLayer rendering.")}}D.DefaultTextLayerFactory=x;class I{constructor(){throw new Error("The `DefaultXfaLayerFactory` has been removed, please use the `enableXfa` option when calling the `getDocument`-function to control XfaLayer rendering.")}}D.DefaultXfaLayerFactory=I})(),H})())})(pdf_viewer)),pdf_viewer.exports}var pdf_viewerExports=requirePdf_viewer();pdfExports.GlobalWorkerOptions.workerSrc="/static/pdfjs/pdf.worker.min.js";const _sfc_main=vue.defineComponent({name:"DocumentEditor",components:{ToolbarPagination:_sfc_main$1,ToolbarRotation:_sfc_main$2,ToolbarZoom:_sfc_main$3,ToolbarAnnotation:_sfc_main$4},props:{value:{type:String,required:!0},baseUrl:{type:String,required:!0},pagination:{type:Boolean,default:!0},zoom:{type:Boolean,default:!0},comment:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},rotation:{type:Boolean,default:!0}},data(){return{token:this.value,rotations:{},highlightingColor:"",commentingColor:"",loading:!0,error:"",currentPage:1,currentZoom:"",hasAnnotations:!1,savingInProgress:!1,interval:null,pages:1,pdfDocument:void 0,viewer:void 0}},computed:{hasBeenRotated(){return this.rotations&&Object.keys(this.rotations).length!==0},needsToBeSaved(){return this.hasBeenRotated||this.hasAnnotations}},mounted(){this.pdfDocument=void 0,this.getFile();const B=["changeCurrentPage","rotate","zoomIn","zoomOut","setScale","setHighlight","setCommenting","save"];for(const o of B)this.$el.addEventListener(o,(F=>{this[o](F.detail)}))},unmounted(){this.stopWatchingAnnotations()},methods:{getFile:async function(){if(this.token==="FileInfectedException")this.error=this.t("view_entry.file_infected");else try{const B=await doRequest(`${this.baseUrl}metadata/${this.token}`),o=await pdfExports.getDocument(B.url).promise,F=new pdf_viewerExports.PDFViewer({container:this.$refs.viewerContainer,eventBus:new pdf_viewerExports.EventBus,viewer:this.$refs.pdfViewer});F.setDocument(o),F.eventBus.on("pagechanging",R=>{this.currentPage=R.pageNumber;const H=new CustomEvent("pageChange",{detail:{pageNumber:R.pageNumber}});this.$el.dispatchEvent(H)}),F.eventBus.on("pagesinit",()=>{this.currentZoom=F.currentScaleValue="auto"}),this.pages=o.numPages;const m=new CustomEvent("numPages",{detail:{numPages:o.numPages}});this.$el.dispatchEvent(m),this.pdfDocument=vue.markRaw(o),this.viewer=vue.markRaw(F)}catch(B){this.error=B.message}this.loading=!1},rotate(B){(this.viewer?.getPageView(this.currentPage-1)).update({rotation:B}),this.viewer?.update(),B!==0?this.rotations[this.currentPage-1]=B:delete this.rotations[this.currentPage-1]},changeCurrentPage(B){this.viewer.currentPageNumber=B},zoomIn(){const B=this.viewer;B.increaseScale({scaleFactor:1.1}),this.currentZoom=B.currentScale.toString()},zoomOut(){const B=this.viewer;B.decreaseScale({scaleFactor:1.1}),this.currentZoom=B.currentScale.toString()},setScale(B){this.viewer.currentScaleValue=B,this.currentZoom=B},startWatchingAnnotations:function(){this.interval||(this.interval=window.setInterval(()=>this.updateNeedsToBeSaved(),500))},stopWatchingAnnotations:function(){this.interval&&window.clearInterval(this.interval),this.interval=null},setHighlight(B){const o=this.viewer;this.commentingColor="",this.highlightingColor=B,B?(this.startWatchingAnnotations(),o.annotationEditorMode=pdfExports.AnnotationEditorType.INK,o.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_THICKNESS,value:10},o.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_OPACITY,value:50},o.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_COLOR,value:B}):(this.stopWatchingAnnotations(),o.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},setCommenting(B){const o=this.viewer;this.highlightingColor="",this.commentingColor=B,B?(this.startWatchingAnnotations(),o.annotationEditorMode=pdfExports.AnnotationEditorType.FREETEXT,o.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_SIZE,value:10},o.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_COLOR,value:B}):(this.stopWatchingAnnotations(),o.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},updateNeedsToBeSaved(){this.hasAnnotations=!!this.pdfDocument&&this.pdfDocument.annotationStorage.size>0},async save(){if(!this.needsToBeSaved)return!1;this.savingInProgress=!0,this.setCommenting("");const B=await this.pdfDocument.saveDocument(),o=new Blob([B],{type:"application/pdf"}),F=new FormData;F.append("file",o),F.append("rotations",JSON.stringify(vue.toRaw(this.rotations)));try{const m=await doRequest(`${this.baseUrl}save-editor/${this.token}`,{method:"POST",headers:void 0,body:F});this.rotations={},this.hasAnnotations=!1,this.token=m.token,this.getFile()}catch(m){this.error=m.message}this.savingInProgress=!1}}}),_export_sfc=(B,o)=>{const F=B.__vccOpts||B;for(const[m,R]of o)F[m]=R;return F},_hoisted_1={class:"editor-container"},_hoisted_2={class:"wrapper"},_hoisted_3={ref:"viewerContainer",class:"viewerContainer",tabindex:"0"},_hoisted_4={class:"pdfViewer",ref:"pdfViewer"},_hoisted_5={class:"btn-toolbar",role:"toolbar"},_hoisted_6={key:0,class:"text-danger"};function _sfc_render(B,o,F,m,R,H){const D=vue.resolveComponent("ToolbarPagination"),E=vue.resolveComponent("ToolbarRotation"),S=vue.resolveComponent("ToolbarZoom"),d=vue.resolveComponent("ToolbarAnnotation");return vue.openBlock(),vue.createElementBlock("div",_hoisted_1,[vue.createElementVNode("div",_hoisted_2,[vue.createElementVNode("div",_hoisted_3,[vue.createElementVNode("div",_hoisted_4,null,512)],512)]),vue.createElementVNode("div",_hoisted_5,[B.pages&&B.pagination?(vue.openBlock(),vue.createBlock(D,{key:0,"current-page":B.currentPage,pages:B.pages,onOnChangeCurrentPage:B.changeCurrentPage},null,8,["current-page","pages","onOnChangeCurrentPage"])):vue.createCommentVNode("",!0),B.rotation?(vue.openBlock(),vue.createBlock(E,{key:1,"current-rotation":B.rotations[B.currentPage-1]||0,onOnRotate:B.rotate},null,8,["current-rotation","onOnRotate"])):vue.createCommentVNode("",!0),B.zoom&&B.currentZoom?(vue.openBlock(),vue.createBlock(S,{key:2,"current-zoom":B.currentZoom,onOnZoomIn:B.zoomIn,onOnZoomOut:B.zoomOut,onOnSetScale:B.setScale},null,8,["current-zoom","onOnZoomIn","onOnZoomOut","onOnSetScale"])):vue.createCommentVNode("",!0),B.highlight?(vue.openBlock(),vue.createBlock(d,{key:3,icon:"fa-highlighter","is-activated":B.highlightingColor!="",color:B.highlightingColor,"class-prefix":"bg",colors:{warning:"#ffff00",danger:"#ff0000",info:"#0000ff",success:"#00ff00"},onOnChange:B.setHighlight},null,8,["is-activated","color","onOnChange"])):vue.createCommentVNode("",!0),B.comment?(vue.openBlock(),vue.createBlock(d,{key:4,icon:"fa-message","is-activated":B.commentingColor!="",color:B.commentingColor,"class-prefix":"text",colors:{danger:"#a94442",warning:"#ffff00",info:"#31708f",success:"#3c763d",muted:"#ffffff"},onOnChange:B.setCommenting},null,8,["is-activated","color","onOnChange"])):vue.createCommentVNode("",!0),vue.createElementVNode("button",{type:"button",class:vue.normalizeClass(["btn",B.needsToBeSaved?"btn-primary":"btn-default disabled"]),onClick:o[0]||(o[0]=(...i)=>B.save&&B.save(...i))},[vue.createElementVNode("span",{class:vue.normalizeClass(["fas",B.savingInProgress?"fa-spinner fa-spin-pulse":`fa-save ${B.needsToBeSaved&&"fa-beat-fade"}`])},null,2)],2)]),B.error?(vue.openBlock(),vue.createElementBlock("p",_hoisted_6,vue.toDisplayString(B.error),1)):vue.createCommentVNode("",!0)])}const Editor=_export_sfc(_sfc_main,[["render",_sfc_render]]);function initEditors(){document.querySelectorAll(".osis-document-editor:not([data-v-app])").forEach(B=>{const o={baseUrl:"",value:"",...B.dataset};for(const F of["pagination","zoom","comment","highlight","rotation"])typeof B.dataset[F]<"u"&&(o[F]=B.dataset[F]==="true");runtimeDom.createApp(Editor,o).use(i18n).mount(B)})}initEditors();const observer=new MutationObserver(initEditors);observer.observe(document,{childList:!0,subtree:!0})}));
//# sourceMappingURL=osis-document-editor.umd.min.js.map
