(function(N,l){typeof exports=="object"&&typeof module<"u"?l(require("@vue/runtime-dom"),require("vue-i18n"),require("vue")):typeof define=="function"&&define.amd?define(["@vue/runtime-dom","vue-i18n","vue"],l):(N=typeof globalThis<"u"?globalThis:N||self,l(N.Vue,N.VueI18n,N.Vue))})(this,(function(runtimeDom,vueI18n,vue){"use strict";const resource$1={uploader:{specific_nb_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici un fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici "},{t:4,k:"count"},{t:3,v:" fichiers"}]}]}},min_max_drag_n_drop_label:{t:0,b:{t:2,i:[{t:3,v:"Glissez-déposez ici entre "},{t:4,k:"min"},{t:3,v:" et "},{t:4,k:"max"},{t:3,v:" fichiers"}]}},min_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici au-moins un fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici au-moins "},{t:4,k:"count"},{t:3,v:" fichiers"}]}]}},max_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Glissez-déposez ici votre fichier"},{t:2,i:[{t:3,v:"Glissez-déposez ici vos fichiers (maximum "},{t:4,k:"count"},{t:3,v:")"}]}]}},drag_n_drop_label:{t:0,b:{t:2,i:[{t:3}],s:"Glissez-déposez ici vos fichiers"}},add_file_label:{t:0,b:{t:2,i:[{t:3}],s:"ou cliquez-ici"}},max_size_label:{t:0,b:{t:2,i:[{t:3,v:"(taille maximum "},{t:4,k:"size"},{t:3,v:")"}]}},trigger_upload:{t:0,b:{t:2,i:[{t:3}],s:"Transférer"}}},upload_entry:{completion:{t:0,b:{t:2,i:[{t:4,k:"progress"},{t:3,v:"% transférés"}]}},too_large:{t:0,b:{t:2,i:[{t:3}],s:"Le fichier est trop lourd"}},wrong_type:{t:0,b:{t:1,c:[{t:2,i:[{t:3,v:'Le fichier doit être du type "'},{t:4,k:"types"},{t:3,v:'"'}]},{t:2,i:[{t:3,v:`Le fichier doit être d'un des types suivants : "`},{t:4,k:"types"},{t:3,v:'"'}]}]}},crop_header:{t:0,b:{t:2,i:[{t:3}],s:"Veuillez choisir la partie à garder."}},crop:{t:0,b:{t:2,i:[{t:3}],s:"Recadrer"}},cancel:{t:0,b:{t:2,i:[{t:3}],s:"Annuler"}}},view_entry:{rotate_left:{t:0,b:{t:2,i:[{t:3}],s:"Faire pivoter l'image à gauche"}},rotate_right:{t:0,b:{t:2,i:[{t:3}],s:"Faire pivoter l'image à droite"}},loading:{t:0,b:{t:2,i:[{t:3}],s:"Chargement..."}},close:{t:0,b:{t:2,i:[{t:3}],s:"Fermer"}},save:{t:0,b:{t:2,i:[{t:3}],s:"Enregistrer"}},file_infected:{t:0,b:{t:2,i:[{t:3}],s:"Le fichier référencé semble infecté par un virus"}}},editor:{pagination:{t:0,b:{t:2,i:[{t:4,k:"currentPage"},{t:3,v:" de "},{t:4,k:"pages"}]}},zoom:{auto:{t:0,b:{t:2,i:[{t:3}],s:"Zoom automatique"}},"page-width":{t:0,b:{t:2,i:[{t:3}],s:"Pleine largeur"}},"page-fit":{t:0,b:{t:2,i:[{t:3}],s:"Page entière"}},"page-actual":{t:0,b:{t:2,i:[{t:3}],s:"Taille réelle"}}},colors:{warning:{t:0,b:{t:2,i:[{t:3}],s:"Jaune"}},danger:{t:0,b:{t:2,i:[{t:3}],s:"Rouge"}},info:{t:0,b:{t:2,i:[{t:3}],s:"Bleu"}},success:{t:0,b:{t:2,i:[{t:3}],s:"Vert"}},muted:{t:0,b:{t:2,i:[{t:3}],s:"Blanc"}}}},error:{t:0,b:{t:2,i:[{t:3,v:"Erreur : "},{t:4,k:"error"}]}},request_error:{t:0,b:{t:2,i:[{t:3,v:"Erreur lors de la requête : "},{t:4,k:"error"}]}},units:[{t:0,b:{t:2,i:[{t:3}],s:"o"}},{t:0,b:{t:2,i:[{t:3}],s:"Ko"}},{t:0,b:{t:2,i:[{t:3}],s:"Mo"}},{t:0,b:{t:2,i:[{t:3}],s:"Go"}},{t:0,b:{t:2,i:[{t:3}],s:"To"}}]},resource={uploader:{specific_nb_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop one file here"},{t:2,i:[{t:3,v:"Drag and drop "},{t:4,k:"count"},{t:3,v:" files here"}]}]}},min_max_drag_n_drop_label:{t:0,b:{t:2,i:[{t:3,v:"Drag and drop between "},{t:4,k:"min"},{t:3,v:" and "},{t:4,k:"max"},{t:3,v:" files here"}]}},min_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop at least one file here"},{t:2,i:[{t:3,v:"Drag and drop at least "},{t:4,k:"count"},{t:3,v:" files here"}]}]}},max_drag_n_drop_label:{t:0,b:{t:1,c:[{t:2,i:[{t:3}],s:"Drag and drop your file here"},{t:2,i:[{t:3,v:"Drag and drop your files here (maximum "},{t:4,k:"count"},{t:3,v:")"}]}]}},drag_n_drop_label:{t:0,b:{t:2,i:[{t:3}],s:"Drag and drop your files here"}},add_file_label:{t:0,b:{t:2,i:[{t:3}],s:"or click here"}},max_size_label:{t:0,b:{t:2,i:[{t:3,v:"(max size "},{t:4,k:"size"},{t:3,v:")"}]}},trigger_upload:{t:0,b:{t:2,i:[{t:3}],s:"Upload"}}},upload_entry:{completion:{t:0,b:{t:2,i:[{t:4,k:"progress"},{t:3,v:"% uploaded"}]}},too_large:{t:0,b:{t:2,i:[{t:3}],s:"File is too large"}},wrong_type:{t:0,b:{t:1,c:[{t:2,i:[{t:3,v:'The file must have the following type: "'},{t:4,k:"types"},{t:3,v:'"'}]},{t:2,i:[{t:3,v:'The file must have one of the following types: "'},{t:4,k:"types"},{t:3,v:'"'}]}]}},crop_header:{t:0,b:{t:2,i:[{t:3}],s:"Please choose the part you want to keep."}},crop:{t:0,b:{t:2,i:[{t:3}],s:"Crop"}},cancel:{t:0,b:{t:2,i:[{t:3}],s:"Cancel"}}},view_entry:{rotate_left:{t:0,b:{t:2,i:[{t:3}],s:"Rotate image left"}},rotate_right:{t:0,b:{t:2,i:[{t:3}],s:"Rotate image right"}},loading:{t:0,b:{t:2,i:[{t:3}],s:"Loading..."}},close:{t:0,b:{t:2,i:[{t:3}],s:"Close"}},save:{t:0,b:{t:2,i:[{t:3}],s:"Save"}},file_infected:{t:0,b:{t:2,i:[{t:3}],s:"The referenced file appears to be infected with a virus"}}},editor:{pagination:{t:0,b:{t:2,i:[{t:4,k:"currentPage"},{t:3,v:" of "},{t:4,k:"pages"}]}},zoom:{auto:{t:0,b:{t:2,i:[{t:3}],s:"Automatic Zoom"}},"page-width":{t:0,b:{t:2,i:[{t:3}],s:"Page Width"}},"page-fit":{t:0,b:{t:2,i:[{t:3}],s:"Page Fit"}},"page-actual":{t:0,b:{t:2,i:[{t:3}],s:"Actual Size"}}},colors:{warning:{t:0,b:{t:2,i:[{t:3}],s:"Yellow"}},danger:{t:0,b:{t:2,i:[{t:3}],s:"Red"}},info:{t:0,b:{t:2,i:[{t:3}],s:"Blue"}},success:{t:0,b:{t:2,i:[{t:3}],s:"Green"}},muted:{t:0,b:{t:2,i:[{t:3}],s:"White"}}}},error:{t:0,b:{t:2,i:[{t:3,v:"Error: "},{t:4,k:"error"}]}},request_error:{t:0,b:{t:2,i:[{t:3,v:"Request error: "},{t:4,k:"error"}]}},units:[{t:0,b:{t:2,i:[{t:3}],s:"B"}},{t:0,b:{t:2,i:[{t:3}],s:"KB"}},{t:0,b:{t:2,i:[{t:3}],s:"MB"}},{t:0,b:{t:2,i:[{t:3}],s:"GB"}},{t:0,b:{t:2,i:[{t:3}],s:"TB"}}]},i18n=vueI18n.createI18n({legacy:!1,locale:document.documentElement.lang||"en",allowComposition:!0,messages:{en:resource,fr:resource$1}}),_hoisted_1$4={class:"btn-group dropup annotation-dropdown"},_hoisted_2$3={class:"dropdown-menu"},_hoisted_3$2=["onClick"],_sfc_main$4=vue.defineComponent({__name:"ToolbarAnnotation",props:{isActivated:{type:Boolean},color:{},classPrefix:{},icon:{},colors:{}},emits:["onChange"],setup(N){const l=i18n.global.t;return(k,g)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$4,[vue.createElementVNode("button",{class:vue.normalizeClass(["btn",k.isActivated?"btn-primary":"btn-default"]),type:"button",onClick:g[0]||(g[0]=M=>k.$emit("onChange",k.isActivated?"":k.color||Object.values(k.colors)[0]))},[vue.createElementVNode("span",{class:vue.normalizeClass(["fas",k.icon])},null,2)],2),g[1]||(g[1]=vue.createElementVNode("button",{type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","data-bs-toggle":"dropdown"},[vue.createElementVNode("span",{class:"caret"})],-1)),vue.createElementVNode("ul",_hoisted_2$3,[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(k.colors,(M,U)=>(vue.openBlock(),vue.createElementBlock("li",{key:U,class:vue.normalizeClass(`${k.classPrefix}-${U}`)},[vue.createElementVNode("a",{href:"#",class:vue.normalizeClass(`${k.classPrefix}-${U}`),onClick:vue.withModifiers(F=>k.$emit("onChange",M),["prevent"])},vue.toDisplayString(vue.unref(l)(`editor.colors.${U}`)),11,_hoisted_3$2)],2))),128))])]))}}),_hoisted_1$3={class:"btn-group"},_hoisted_2$2={class:"btn-group dropup",role:"group"},_hoisted_3$1={type:"button",class:"btn btn-default dropdown-toggle","data-toggle":"dropdown","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},_hoisted_4$1={class:"dropdown-menu"},_hoisted_5$1=["value"],_hoisted_6$1=["onClick"],_sfc_main$3=vue.defineComponent({__name:"ToolbarZoom",props:{currentZoom:{}},emits:["onZoomIn","onZoomOut","onSetScale"],setup(N){const l=i18n.global.t,k=["auto","page-actual","page-fit","page-width","0.5","0.75","1","1.25","1.5","2","3","4"];function g(M){return isNaN(parseFloat(M))?l(`editor.zoom.${M}`):`${Math.ceil(parseFloat(M)*100)}%`}return(M,U)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$3,[vue.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:U[0]||(U[0]=F=>M.$emit("onZoomOut"))},[...U[2]||(U[2]=[vue.createElementVNode("span",{class:"fas fa-magnifying-glass-minus"},null,-1)])]),vue.createElementVNode("div",_hoisted_2$2,[vue.createElementVNode("button",_hoisted_3$1,[vue.createTextVNode(vue.toDisplayString(g(M.currentZoom))+" ",1),U[3]||(U[3]=vue.createElementVNode("span",{class:"caret"},null,-1))]),vue.createElementVNode("ul",_hoisted_4$1,[(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(k,F=>vue.createElementVNode("li",{key:F,value:F,class:vue.normalizeClass(M.currentZoom==F?"active":"")},[vue.createElementVNode("a",{href:"#",onClick:vue.withModifiers(S=>M.$emit("onSetScale",F),["prevent"])},vue.toDisplayString(g(F)),9,_hoisted_6$1)],10,_hoisted_5$1)),64))])]),vue.createElementVNode("button",{class:"btn btn-default",type:"button",onClick:U[1]||(U[1]=F=>M.$emit("onZoomIn"))},[...U[4]||(U[4]=[vue.createElementVNode("span",{class:"fas fa-magnifying-glass-plus"},null,-1)])])]))}}),_hoisted_1$2={class:"btn-group"},_sfc_main$2=vue.defineComponent({__name:"ToolbarRotation",props:{currentRotation:{}},emits:["onRotate"],setup(N){return(l,k)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$2,[vue.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:k[0]||(k[0]=g=>l.$emit("onRotate",((l.currentRotation-90)%360+360)%360))},[...k[2]||(k[2]=[vue.createElementVNode("span",{class:"fas fa-rotate-left"},null,-1)])]),vue.createElementVNode("button",{type:"button",class:"btn btn-default",onClick:k[1]||(k[1]=g=>l.$emit("onRotate",((l.currentRotation+90)%360+360)%360))},[...k[3]||(k[3]=[vue.createElementVNode("span",{class:"fas fa-rotate-right"},null,-1)])])]))}}),_hoisted_1$1={class:"btn-group"},_hoisted_2$1={class:"btn btn-default disabled",role:"button"},_sfc_main$1=vue.defineComponent({__name:"ToolbarPagination",props:{currentPage:{},pages:{}},emits:["onChangeCurrentPage"],setup(N){const l=i18n.global.t;return(k,g)=>(vue.openBlock(),vue.createElementBlock("div",_hoisted_1$1,[vue.createElementVNode("button",{class:vue.normalizeClass(["btn btn-default",{disabled:k.currentPage==1}]),type:"button",onClick:g[0]||(g[0]=M=>k.currentPage!=1&&k.$emit("onChangeCurrentPage",k.currentPage-1))},[...g[2]||(g[2]=[vue.createElementVNode("span",{class:"fas fa-angle-up"},null,-1)])],2),vue.createElementVNode("a",_hoisted_2$1,vue.toDisplayString(vue.unref(l)("editor.pagination",{currentPage:k.currentPage,pages:k.pages})),1),vue.createElementVNode("button",{class:vue.normalizeClass(["btn btn-default",{disabled:k.currentPage==k.pages}]),type:"button",onClick:g[1]||(g[1]=M=>k.currentPage!=k.pages&&k.$emit("onChangeCurrentPage",k.currentPage+1))},[...g[3]||(g[3]=[vue.createElementVNode("span",{class:"fas fa-angle-down"},null,-1)])],2)]))}});async function doRequest(N,l){const k=await fetch(N,{headers:{"Content-Type":"application/json"},...l});if(k.status>=200&&k.status<300)return k.json();throw new Error(k.statusText)}function getAugmentedNamespace(N){if(Object.prototype.hasOwnProperty.call(N,"__esModule"))return N;var l=N.default;if(typeof l=="function"){var k=function g(){var M=!1;try{M=this instanceof g}catch{}return M?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};k.prototype=l.prototype}else k={};return Object.defineProperty(k,"__esModule",{value:!0}),Object.keys(N).forEach(function(g){var M=Object.getOwnPropertyDescriptor(N,g);Object.defineProperty(k,g,M.get?M:{enumerable:!0,get:function(){return N[g]}})}),k}function commonjsRequire(N){throw new Error('Could not dynamically require "'+N+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(l,k){module.exports=k()})(globalThis,()=>(()=>{var __webpack_modules__=[,((N,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.VerbosityLevel=l.Util=l.UnknownErrorException=l.UnexpectedResponseException=l.TextRenderingMode=l.RenderingIntentFlag=l.PromiseCapability=l.PermissionFlag=l.PasswordResponses=l.PasswordException=l.PageActionEventType=l.OPS=l.MissingPDFException=l.MAX_IMAGE_SIZE_TO_CACHE=l.LINE_FACTOR=l.LINE_DESCENT_FACTOR=l.InvalidPDFException=l.ImageKind=l.IDENTITY_MATRIX=l.FormatError=l.FeatureTest=l.FONT_IDENTITY_MATRIX=l.DocumentActionEventType=l.CMapCompressionType=l.BaseException=l.BASELINE_FACTOR=l.AnnotationType=l.AnnotationStateModelType=l.AnnotationReviewState=l.AnnotationReplyType=l.AnnotationMode=l.AnnotationMarkedState=l.AnnotationFlag=l.AnnotationFieldFlag=l.AnnotationEditorType=l.AnnotationEditorPrefix=l.AnnotationEditorParamsType=l.AnnotationBorderStyleType=l.AnnotationActionEventType=l.AbortException=void 0,l.assert=s,l.bytesToString=z,l.createValidAbsoluteUrl=L,l.getModificationDate=Te,l.getVerbosityLevel=x,l.info=P,l.isArrayBuffer=Ae,l.isArrayEqual=ve,l.normalizeUnicode=De,l.objectFromMap=J,l.objectSize=$,l.setVerbosityLevel=H,l.shadow=n,l.string32=se,l.stringToBytes=ee,l.stringToPDFString=ue,l.stringToUTF8String=fe,l.unreachable=c,l.utf8StringToString=de,l.warn=y;const k=[1,0,0,1,0,0];l.IDENTITY_MATRIX=k;const g=[.001,0,0,.001,0,0];l.FONT_IDENTITY_MATRIX=g;const M=1e7;l.MAX_IMAGE_SIZE_TO_CACHE=M;const U=1.35;l.LINE_FACTOR=U;const F=.35;l.LINE_DESCENT_FACTOR=F;const S=F/U;l.BASELINE_FACTOR=S;const A={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};l.RenderingIntentFlag=A;const h={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};l.AnnotationMode=h;const t="pdfjs_internal_editor_";l.AnnotationEditorPrefix=t;const m={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};l.AnnotationEditorType=m;const f={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};l.AnnotationEditorParamsType=f;const i={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};l.PermissionFlag=i;const a={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};l.TextRenderingMode=a;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};l.ImageKind=p;const o={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};l.AnnotationType=o;const d={MARKED:"Marked",REVIEW:"Review"};l.AnnotationStateModelType=d;const E={MARKED:"Marked",UNMARKED:"Unmarked"};l.AnnotationMarkedState=E;const C={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};l.AnnotationReviewState=C;const v={GROUP:"Group",REPLY:"R"};l.AnnotationReplyType=v;const e={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};l.AnnotationFlag=e;const r={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};l.AnnotationFieldFlag=r;const w={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};l.AnnotationBorderStyleType=w;const D={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};l.AnnotationActionEventType=D;const T={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};l.DocumentActionEventType=T;const I={O:"PageOpen",C:"PageClose"};l.PageActionEventType=I;const V={ERRORS:0,WARNINGS:1,INFOS:5};l.VerbosityLevel=V;const W={NONE:0,BINARY:1};l.CMapCompressionType=W;const te={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};l.OPS=te;const Q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};l.PasswordResponses=Q;let G=V.WARNINGS;function H(ne){Number.isInteger(ne)&&(G=ne)}function x(){return G}function P(ne){G>=V.INFOS&&console.log(`Info: ${ne}`)}function y(ne){G>=V.WARNINGS&&console.log(`Warning: ${ne}`)}function c(ne){throw new Error(ne)}function s(ne,K){ne||c(K)}function b(ne){switch(ne?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function L(ne,K=null,X=null){if(!ne)return null;try{if(X&&typeof ne=="string"&&(X.addDefaultProtocol&&ne.startsWith("www.")&&ne.match(/\./g)?.length>=2&&(ne=`http://${ne}`),X.tryConvertEncoding))try{ne=fe(ne)}catch{}const oe=K?new URL(ne,K):new URL(ne);if(b(oe))return oe}catch{}return null}function n(ne,K,X,oe=!1){return Object.defineProperty(ne,K,{value:X,enumerable:!oe,configurable:!0,writable:!1}),X}const u=(function(){function K(X,oe){this.constructor===K&&c("Cannot initialize BaseException."),this.message=X,this.name=oe}return K.prototype=new Error,K.constructor=K,K})();l.BaseException=u;class _ extends u{constructor(K,X){super(K,"PasswordException"),this.code=X}}l.PasswordException=_;class R extends u{constructor(K,X){super(K,"UnknownErrorException"),this.details=X}}l.UnknownErrorException=R;class O extends u{constructor(K){super(K,"InvalidPDFException")}}l.InvalidPDFException=O;class j extends u{constructor(K){super(K,"MissingPDFException")}}l.MissingPDFException=j;class B extends u{constructor(K,X){super(K,"UnexpectedResponseException"),this.status=X}}l.UnexpectedResponseException=B;class q extends u{constructor(K){super(K,"FormatError")}}l.FormatError=q;class Z extends u{constructor(K){super(K,"AbortException")}}l.AbortException=Z;function z(ne){(typeof ne!="object"||ne?.length===void 0)&&c("Invalid argument for bytesToString");const K=ne.length,X=8192;if(K<X)return String.fromCharCode.apply(null,ne);const oe=[];for(let he=0;he<K;he+=X){const pe=Math.min(he+X,K),ge=ne.subarray(he,pe);oe.push(String.fromCharCode.apply(null,ge))}return oe.join("")}function ee(ne){typeof ne!="string"&&c("Invalid argument for stringToBytes");const K=ne.length,X=new Uint8Array(K);for(let oe=0;oe<K;++oe)X[oe]=ne.charCodeAt(oe)&255;return X}function se(ne){return String.fromCharCode(ne>>24&255,ne>>16&255,ne>>8&255,ne&255)}function $(ne){return Object.keys(ne).length}function J(ne){const K=Object.create(null);for(const[X,oe]of ne)K[X]=oe;return K}function ie(){const ne=new Uint8Array(4);return ne[0]=1,new Uint32Array(ne.buffer,0,1)[0]===1}function Y(){try{return new Function(""),!0}catch{return!1}}class re{static get isLittleEndian(){return n(this,"isLittleEndian",ie())}static get isEvalSupported(){return n(this,"isEvalSupported",Y())}static get isOffscreenCanvasSupported(){return n(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?n(this,"platform",{isWin:!1,isMac:!1}):n(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}l.FeatureTest=re;const ae=[...Array(256).keys()].map(ne=>ne.toString(16).padStart(2,"0"));class le{static makeHexColor(K,X,oe){return`#${ae[K]}${ae[X]}${ae[oe]}`}static scaleMinMax(K,X){let oe;K[0]?(K[0]<0&&(oe=X[0],X[0]=X[1],X[1]=oe),X[0]*=K[0],X[1]*=K[0],K[3]<0&&(oe=X[2],X[2]=X[3],X[3]=oe),X[2]*=K[3],X[3]*=K[3]):(oe=X[0],X[0]=X[2],X[2]=oe,oe=X[1],X[1]=X[3],X[3]=oe,K[1]<0&&(oe=X[2],X[2]=X[3],X[3]=oe),X[2]*=K[1],X[3]*=K[1],K[2]<0&&(oe=X[0],X[0]=X[1],X[1]=oe),X[0]*=K[2],X[1]*=K[2]),X[0]+=K[4],X[1]+=K[4],X[2]+=K[5],X[3]+=K[5]}static transform(K,X){return[K[0]*X[0]+K[2]*X[1],K[1]*X[0]+K[3]*X[1],K[0]*X[2]+K[2]*X[3],K[1]*X[2]+K[3]*X[3],K[0]*X[4]+K[2]*X[5]+K[4],K[1]*X[4]+K[3]*X[5]+K[5]]}static applyTransform(K,X){const oe=K[0]*X[0]+K[1]*X[2]+X[4],he=K[0]*X[1]+K[1]*X[3]+X[5];return[oe,he]}static applyInverseTransform(K,X){const oe=X[0]*X[3]-X[1]*X[2],he=(K[0]*X[3]-K[1]*X[2]+X[2]*X[5]-X[4]*X[3])/oe,pe=(-K[0]*X[1]+K[1]*X[0]+X[4]*X[1]-X[5]*X[0])/oe;return[he,pe]}static getAxialAlignedBoundingBox(K,X){const oe=le.applyTransform(K,X),he=le.applyTransform(K.slice(2,4),X),pe=le.applyTransform([K[0],K[3]],X),ge=le.applyTransform([K[2],K[1]],X);return[Math.min(oe[0],he[0],pe[0],ge[0]),Math.min(oe[1],he[1],pe[1],ge[1]),Math.max(oe[0],he[0],pe[0],ge[0]),Math.max(oe[1],he[1],pe[1],ge[1])]}static inverseTransform(K){const X=K[0]*K[3]-K[1]*K[2];return[K[3]/X,-K[1]/X,-K[2]/X,K[0]/X,(K[2]*K[5]-K[4]*K[3])/X,(K[4]*K[1]-K[5]*K[0])/X]}static singularValueDecompose2dScale(K){const X=[K[0],K[2],K[1],K[3]],oe=K[0]*X[0]+K[1]*X[2],he=K[0]*X[1]+K[1]*X[3],pe=K[2]*X[0]+K[3]*X[2],ge=K[2]*X[1]+K[3]*X[3],Ce=(oe+ge)/2,Ee=Math.sqrt((oe+ge)**2-4*(oe*ge-pe*he))/2,we=Ce+Ee||1,be=Ce-Ee||1;return[Math.sqrt(we),Math.sqrt(be)]}static normalizeRect(K){const X=K.slice(0);return K[0]>K[2]&&(X[0]=K[2],X[2]=K[0]),K[1]>K[3]&&(X[1]=K[3],X[3]=K[1]),X}static intersect(K,X){const oe=Math.max(Math.min(K[0],K[2]),Math.min(X[0],X[2])),he=Math.min(Math.max(K[0],K[2]),Math.max(X[0],X[2]));if(oe>he)return null;const pe=Math.max(Math.min(K[1],K[3]),Math.min(X[1],X[3])),ge=Math.min(Math.max(K[1],K[3]),Math.max(X[1],X[3]));return pe>ge?null:[oe,pe,he,ge]}static bezierBoundingBox(K,X,oe,he,pe,ge,Ce,Ee){const we=[],be=[[],[]];let xe,Pe,Re,_e,Fe,Ie,Oe,Ne;for(let Be=0;Be<2;++Be){if(Be===0?(Pe=6*K-12*oe+6*pe,xe=-3*K+9*oe-9*pe+3*Ce,Re=3*oe-3*K):(Pe=6*X-12*he+6*ge,xe=-3*X+9*he-9*ge+3*Ee,Re=3*he-3*X),Math.abs(xe)<1e-12){if(Math.abs(Pe)<1e-12)continue;_e=-Re/Pe,0<_e&&_e<1&&we.push(_e);continue}Oe=Pe*Pe-4*Re*xe,Ne=Math.sqrt(Oe),!(Oe<0)&&(Fe=(-Pe+Ne)/(2*xe),0<Fe&&Fe<1&&we.push(Fe),Ie=(-Pe-Ne)/(2*xe),0<Ie&&Ie<1&&we.push(Ie))}let ke=we.length,Se;const Le=ke;for(;ke--;)_e=we[ke],Se=1-_e,be[0][ke]=Se*Se*Se*K+3*Se*Se*_e*oe+3*Se*_e*_e*pe+_e*_e*_e*Ce,be[1][ke]=Se*Se*Se*X+3*Se*Se*_e*he+3*Se*_e*_e*ge+_e*_e*_e*Ee;return be[0][Le]=K,be[1][Le]=X,be[0][Le+1]=Ce,be[1][Le+1]=Ee,be[0].length=be[1].length=Le+2,[Math.min(...be[0]),Math.min(...be[1]),Math.max(...be[0]),Math.max(...be[1])]}}l.Util=le;const ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ue(ne){if(ne[0]>="ï"){let X;if(ne[0]==="þ"&&ne[1]==="ÿ"?X="utf-16be":ne[0]==="ÿ"&&ne[1]==="þ"?X="utf-16le":ne[0]==="ï"&&ne[1]==="»"&&ne[2]==="¿"&&(X="utf-8"),X)try{const oe=new TextDecoder(X,{fatal:!0}),he=ee(ne);return oe.decode(he)}catch(oe){y(`stringToPDFString: "${oe}".`)}}const K=[];for(let X=0,oe=ne.length;X<oe;X++){const he=ce[ne.charCodeAt(X)];K.push(he?String.fromCharCode(he):ne.charAt(X))}return K.join("")}function fe(ne){return decodeURIComponent(escape(ne))}function de(ne){return unescape(encodeURIComponent(ne))}function Ae(ne){return typeof ne=="object"&&ne?.byteLength!==void 0}function ve(ne,K){if(ne.length!==K.length)return!1;for(let X=0,oe=ne.length;X<oe;X++)if(ne[X]!==K[X])return!1;return!0}function Te(ne=new Date){return[ne.getUTCFullYear().toString(),(ne.getUTCMonth()+1).toString().padStart(2,"0"),ne.getUTCDate().toString().padStart(2,"0"),ne.getUTCHours().toString().padStart(2,"0"),ne.getUTCMinutes().toString().padStart(2,"0"),ne.getUTCSeconds().toString().padStart(2,"0")].join("")}class me{#e=!1;constructor(){this.promise=new Promise((K,X)=>{this.resolve=oe=>{this.#e=!0,K(oe)},this.reject=oe=>{this.#e=!0,X(oe)}})}get settled(){return this.#e}}l.PromiseCapability=me;let ye=null,Me=null;function De(ne){return ye||(ye=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Me=new Map([["ﬅ","ſt"]])),ne.replaceAll(ye,(K,X,oe)=>X?X.normalize("NFKC"):Me.get(oe))}}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:N,NodeCMapReaderFactory:l,NodeFilterFactory:k,NodeStandardFontDataFactory:g}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=N,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=l,exports.DefaultFilterFactory=DefaultFilterFactory=k,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=g}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:N}=__w_pdfjs_require__(21);createPDFNetworkStream=l=>new N(l)}else{const{PDFNetworkStream:N}=__w_pdfjs_require__(24),{PDFFetchStream:l}=__w_pdfjs_require__(25);createPDFNetworkStream=k=>(0,_display_utils.isValidFetchUrl)(k.url)?new l(k):new N(k)}function getDocument(N){if(typeof N=="string"||N instanceof URL?N={url:N}:(0,_util.isArrayBuffer)(N)&&(N={data:N}),typeof N!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!N.url&&!N.data&&!N.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:k}=l,g=N.url?getUrlProp(N.url):null,M=N.data?getDataProp(N.data):null,U=N.httpHeaders||null,F=N.withCredentials===!0,S=N.password??null,A=N.range instanceof PDFDataRangeTransport?N.range:null,h=Number.isInteger(N.rangeChunkSize)&&N.rangeChunkSize>0?N.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=N.worker instanceof PDFWorker?N.worker:null;const m=N.verbosity,f=typeof N.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(N.docBaseUrl)?N.docBaseUrl:null,i=typeof N.cMapUrl=="string"?N.cMapUrl:null,a=N.cMapPacked!==!1,p=N.CMapReaderFactory||DefaultCMapReaderFactory,o=typeof N.standardFontDataUrl=="string"?N.standardFontDataUrl:null,d=N.StandardFontDataFactory||DefaultStandardFontDataFactory,E=N.stopAtErrors!==!0,C=Number.isInteger(N.maxImageSize)&&N.maxImageSize>-1?N.maxImageSize:-1,v=N.isEvalSupported!==!1,e=typeof N.isOffscreenCanvasSupported=="boolean"?N.isOffscreenCanvasSupported:!_is_node.isNodeJS,r=Number.isInteger(N.canvasMaxAreaInBytes)?N.canvasMaxAreaInBytes:-1,w=typeof N.disableFontFace=="boolean"?N.disableFontFace:_is_node.isNodeJS,D=N.fontExtraProperties===!0,T=N.enableXfa===!0,I=N.ownerDocument||globalThis.document,V=N.disableRange===!0,W=N.disableStream===!0,te=N.disableAutoFetch===!0,Q=N.pdfBug===!0,G=A?A.length:N.length??NaN,H=typeof N.useSystemFonts=="boolean"?N.useSystemFonts:!_is_node.isNodeJS&&!w,x=typeof N.useWorkerFetch=="boolean"?N.useWorkerFetch:p===_display_utils.DOMCMapReaderFactory&&d===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(i,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(o,document.baseURI),P=N.canvasFactory||new DefaultCanvasFactory({ownerDocument:I}),y=N.filterFactory||new DefaultFilterFactory({docId:k,ownerDocument:I}),c=null;(0,_util.setVerbosityLevel)(m);const s={canvasFactory:P,filterFactory:y};if(x||(s.cMapReaderFactory=new p({baseUrl:i,isCompressed:a}),s.standardFontDataFactory=new d({baseUrl:o})),!t){const n={verbosity:m,port:_worker_options.GlobalWorkerOptions.workerPort};t=n.port?PDFWorker.fromPort(n):new PDFWorker(n),l._worker=t}const b={docId:k,apiVersion:"3.6.172",data:M,password:S,disableAutoFetch:te,rangeChunkSize:h,length:G,docBaseUrl:f,enableXfa:T,evaluatorOptions:{maxImageSize:C,disableFontFace:w,ignoreErrors:E,isEvalSupported:v,isOffscreenCanvasSupported:e,canvasMaxAreaInBytes:r,fontExtraProperties:D,useSystemFonts:H,cMapUrl:x?i:null,standardFontDataUrl:x?o:null}},L={ignoreErrors:E,isEvalSupported:v,disableFontFace:w,fontExtraProperties:D,enableXfa:T,ownerDocument:I,disableAutoFetch:te,pdfBug:Q,styleElement:c};return t.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const n=_fetchDocument(t,b),u=new Promise(function(_){let R;A?R=new _transport_stream.PDFDataTransportStream({length:G,initialData:A.initialData,progressiveDone:A.progressiveDone,contentDispositionFilename:A.contentDispositionFilename,disableRange:V,disableStream:W},A):M||(R=createPDFNetworkStream({url:g,length:G,httpHeaders:U,withCredentials:F,rangeChunkSize:h,disableRange:V,disableStream:W})),_(R)});return Promise.all([n,u]).then(function([_,R]){if(l.destroyed)throw new Error("Loading aborted");const O=new _message_handler.MessageHandler(k,_,t.port),j=new WorkerTransport(O,l,R,L,s);l._transport=j,O.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(N,l){if(N.destroyed)throw new Error("Worker was destroyed");const k=await N.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(N.destroyed)throw new Error("Worker was destroyed");return k}function getUrlProp(N){if(N instanceof URL)return N.href;try{return new URL(N,window.location).href}catch{if(_is_node.isNodeJS&&typeof N=="string")return N}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(N){if(_is_node.isNodeJS&&typeof Buffer<"u"&&N instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(N);if(N instanceof Uint8Array&&N.byteLength===N.buffer.byteLength)return N;if(typeof N=="string")return(0,_util.stringToBytes)(N);if(typeof N=="object"&&!isNaN(N?.length)||(0,_util.isArrayBuffer)(N))return new Uint8Array(N);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await this._transport?.destroy(),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,k,g=!1,M=null){this.length=l,this.initialData=k,this.progressiveDone=g,this.contentDispositionFilename=M,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,k){for(const g of this._rangeListeners)g(l,k)}onDataProgress(l,k){this._readyCapability.promise.then(()=>{for(const g of this._progressListeners)g(l,k)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const k of this._progressiveReadListeners)k(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,k){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,k){this._pdfInfo=l,this._transport=k}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(l,k,g,M=!1){this._pageIndex=l,this._pageInfo=k,this._transport=g,this._stats=M?new _display_utils.StatTimer:null,this._pdfBug=M,this.commonObjs=g.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:k=this.rotate,offsetX:g=0,offsetY:M=0,dontFlip:U=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:k,offsetX:g,offsetY:M,dontFlip:U})}getAnnotations({intent:l="display"}={}){const k=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,k.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:l,viewport:k,intent:g="display",annotationMode:M=_util.AnnotationMode.ENABLE,transform:U=null,background:F=null,optionalContentConfigPromise:S=null,annotationCanvasMap:A=null,pageColors:h=null,printAnnotationStorage:t=null}){if(arguments[0]?.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");this._stats?.time("Overall");const m=this._transport.getRenderingIntent(g,M,t);this.#t=!1,this.#n(),S||(S=this._transport.getOptionalContentConfig());let f=this._intentStates.get(m.cacheKey);f||(f=Object.create(null),this._intentStates.set(m.cacheKey,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const i=!!(m.renderingIntent&_util.RenderingIntentFlag.PRINT);f.displayReadyCapability||(f.displayReadyCapability=new _util.PromiseCapability,f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const a=d=>{f.renderTasks.delete(p),(this._maybeCleanupAfterRender||i)&&(this.#t=!0),this.#i(!i),d?(p.capability.reject(d),this._abortOperatorList({intentState:f,reason:d instanceof Error?d:new Error(d)})):p.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},p=new InternalRenderTask({callback:a,params:{canvasContext:l,viewport:k,transform:U,background:F},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:A,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!i,pdfBug:this._pdfBug,pageColors:h});(f.renderTasks||=new Set).add(p);const o=p.task;return Promise.all([f.displayReadyCapability.promise,S]).then(([d,E])=>{if(this.#t){a();return}this._stats?.time("Rendering"),p.initializeGraphics({transparency:d,optionalContentConfig:E}),p.operatorListChanged()}).catch(a),o}getOperatorList({intent:l="display",annotationMode:k=_util.AnnotationMode.ENABLE,printAnnotationStorage:g=null}={}){function M(){F.operatorList.lastChunk&&(F.opListReadCapability.resolve(F.operatorList),F.renderTasks.delete(S))}const U=this._transport.getRenderingIntent(l,k,g,!0);let F=this._intentStates.get(U.cacheKey);F||(F=Object.create(null),this._intentStates.set(U.cacheKey,F));let S;return F.opListReadCapability||(S=Object.create(null),S.operatorListChanged=M,F.opListReadCapability=new _util.PromiseCapability,(F.renderTasks||=new Set).add(S),F.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(U)),F.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:k=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:k===!0},{highWaterMark:100,size(M){return M.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(g=>_xfa_text.XfaText.textContent(g));const k=this.streamTextContent(l);return new Promise(function(g,M){function U(){F.read().then(function({value:A,done:h}){if(h){g(S);return}Object.assign(S.styles,A.styles),S.items.push(...A.items),U()},M)}const F=k.getReader(),S={items:[],styles:Object.create(null)};U()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const k of this._intentStates.values())if(this._abortOperatorList({intentState:k,reason:new Error("Page was destroyed."),force:!0}),!k.opListReadCapability)for(const g of k.renderTasks)l.push(g.completed),g.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(l)}cleanup(l=!1){this.#t=!0;const k=this.#i(!1);return l&&k&&(this._stats&&=new _display_utils.StatTimer),k}#i(l=!1){if(this.#n(),!this.#t)return!1;if(l)return this.#e=setTimeout(()=>{this.#e=null,this.#i(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:k,operatorList:g}of this._intentStates.values())if(k.size>0||!g.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(l,k){const g=this._intentStates.get(k);g&&(this._stats?.timeEnd("Page Request"),g.displayReadyCapability?.resolve(l))}_renderPageChunk(l,k){for(let g=0,M=l.length;g<M;g++)k.operatorList.fnArray.push(l.fnArray[g]),k.operatorList.argsArray.push(l.argsArray[g]);k.operatorList.lastChunk=l.lastChunk,k.operatorList.separateAnnots=l.separateAnnots;for(const g of k.renderTasks)g.operatorListChanged();l.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:l,cacheKey:k,annotationStorageMap:g}){const U=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:k,annotationStorage:g}).getReader(),F=this._intentStates.get(k);F.streamReader=U;const S=()=>{U.read().then(({value:A,done:h})=>{if(h){F.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(A,F),S())},A=>{if(F.streamReader=null,!this._transport.destroyed){if(F.operatorList){F.operatorList.lastChunk=!0;for(const h of F.renderTasks)h.operatorListChanged();this.#i(!0)}if(F.displayReadyCapability)F.displayReadyCapability.reject(A);else if(F.opListReadCapability)F.opListReadCapability.reject(A);else throw A}})};S()}_abortOperatorList({intentState:l,reason:k,force:g=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!g){if(l.renderTasks.size>0)return;if(k instanceof _display_utils.RenderingCancelledException){let M=RENDERING_CANCELLED_TIMEOUT;k.extraDelay>0&&k.extraDelay<1e3&&(M+=k.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:k,force:!0})},M);return}}if(l.streamReader.cancel(new _util.AbortException(k.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[M,U]of this._intentStates)if(U===l){this._intentStates.delete(M);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(l,k){const g={data:structuredClone(l,k?{transfer:k}:null)};this.#t.then(()=>{for(const M of this.#e)M.call(this,g)})}addEventListener(l,k){this.#e.add(k)}removeEventListener(l,k){this.#e.delete(k)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const N=document?.currentScript?.src;N&&(PDFWorkerUtil.fallbackWorkerSrc=N.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(N,l){let k;try{if(k=new URL(N),!k.origin||k.origin==="null")return!1}catch{return!1}const g=new URL(l,k);return k.origin===g.origin},PDFWorkerUtil.createCDNWrapper=function(N){const l=`importScripts("${N}");`;return URL.createObjectURL(new Blob([l]))}}class PDFWorker{static#workerPorts=new WeakMap;constructor({name:N=null,port:l=null,verbosity:k=(0,_util.getVerbosityLevel)()}={}){if(l&&PDFWorker.#workerPorts.has(l))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=N,this.destroyed=!1,this.verbosity=k,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){PDFWorker.#workerPorts.set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(N){this._port=N,this._messageHandler=new _message_handler.MessageHandler("main","worker",N),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:N}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,N)||(N=PDFWorkerUtil.createCDNWrapper(new URL(N,window.location).href));const l=new Worker(N),k=new _message_handler.MessageHandler("main","worker",l),g=()=>{l.removeEventListener("error",M),k.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},M=()=>{this._webWorker||g()};l.addEventListener("error",M),k.on("test",F=>{if(l.removeEventListener("error",M),this.destroyed){g();return}F?(this._messageHandler=k,this._port=l,this._webWorker=l,this._readyCapability.resolve(),k.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),k.destroy(),l.terminate())}),k.on("ready",F=>{if(l.removeEventListener("error",M),this.destroyed){g();return}try{U()}catch{this._setupFakeWorker()}});const U=()=>{const F=new Uint8Array;k.send("test",F,[F.buffer])};U();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(N=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const k=`fake${PDFWorkerUtil.fakeWorkerId++}`,g=new _message_handler.MessageHandler(k+"_worker",k,l);N.setup(g,l);const M=new _message_handler.MessageHandler(k,k+"_worker",l);this._messageHandler=M,this._readyCapability.resolve(),M.send("configure",{verbosity:this.verbosity})}).catch(N=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${N.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(N){if(!N?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(N.port)?this.#workerPorts.get(N.port):new PDFWorker(N)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#i=new Map;constructor(l,k,g,M,U){this.messageHandler=l,this.loadingTask=k,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:M.ownerDocument,styleElement:M.styleElement}),this._params=M,this.canvasFactory=U.canvasFactory,this.filterFactory=U.filterFactory,this.cMapReaderFactory=U.cMapReaderFactory,this.standardFontDataFactory=U.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=g,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#n(l,k=null){const g=this.#e.get(l);if(g)return g;const M=this.messageHandler.sendWithPromise(l,k);return this.#e.set(l,M),M}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,k=_util.AnnotationMode.ENABLE,g=null,M=!1){let U=_util.RenderingIntentFlag.DISPLAY,F=null;switch(l){case"any":U=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":U=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(k){case _util.AnnotationMode.DISABLE:U+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:U+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:U+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,F=(U&_util.RenderingIntentFlag.PRINT&&g instanceof _annotation_storage.PrintAnnotationStorage?g:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${k}`)}return M&&(U+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:U,cacheKey:`${U}_${_annotation_storage.AnnotationStorage.getHash(F)}`,annotationStorageMap:F}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const g of this.#t.values())l.push(g._destroy());this.#t.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const k=this.messageHandler.sendWithPromise("Terminate",null);return l.push(k),Promise.all(l).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:k}=this;l.on("GetReader",(g,M)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=U=>{this._lastProgress={loaded:U.loaded,total:U.total}},M.onPull=()=>{this._fullReader.read().then(function({value:U,done:F}){if(F){M.close();return}(0,_util.assert)(U instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),M.enqueue(new Uint8Array(U),1,[U])}).catch(U=>{M.error(U)})},M.onCancel=U=>{this._fullReader.cancel(U),M.ready.catch(F=>{if(!this.destroyed)throw F})}}),l.on("ReaderHeadersReady",g=>{const M=new _util.PromiseCapability,U=this._fullReader;return U.headersReady.then(()=>{(!U.isStreamingSupported||!U.isRangeSupported)&&(this._lastProgress&&k.onProgress?.(this._lastProgress),U.onProgress=F=>{k.onProgress?.({loaded:F.loaded,total:F.total})}),M.resolve({isStreamingSupported:U.isStreamingSupported,isRangeSupported:U.isRangeSupported,contentLength:U.contentLength})},M.reject),M.promise}),l.on("GetRangeReader",(g,M)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const U=this._networkStream.getRangeReader(g.begin,g.end);if(!U){M.close();return}M.onPull=()=>{U.read().then(function({value:F,done:S}){if(S){M.close();return}(0,_util.assert)(F instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),M.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{M.error(F)})},M.onCancel=F=>{U.cancel(F),M.ready.catch(S=>{if(!this.destroyed)throw S})}}),l.on("GetDoc",({pdfInfo:g})=>{this._numPages=g.numPages,this._htmlForXfa=g.htmlForXfa,delete g.htmlForXfa,k._capability.resolve(new PDFDocumentProxy(g,this))}),l.on("DocException",function(g){let M;switch(g.name){case"PasswordException":M=new _util.PasswordException(g.message,g.code);break;case"InvalidPDFException":M=new _util.InvalidPDFException(g.message);break;case"MissingPDFException":M=new _util.MissingPDFException(g.message);break;case"UnexpectedResponseException":M=new _util.UnexpectedResponseException(g.message,g.status);break;case"UnknownErrorException":M=new _util.UnknownErrorException(g.message,g.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}k._capability.reject(M)}),l.on("PasswordRequest",g=>{if(this._passwordCapability=new _util.PromiseCapability,k.onPassword){const M=U=>{U instanceof Error?this._passwordCapability.reject(U):this._passwordCapability.resolve({password:U})};try{k.onPassword(M,g.code)}catch(U){this._passwordCapability.reject(U)}}else this._passwordCapability.reject(new _util.PasswordException(g.message,g.code));return this._passwordCapability.promise}),l.on("DataLoaded",g=>{k.onProgress?.({loaded:g.length,total:g.length}),this.downloadInfoCapability.resolve(g)}),l.on("StartRenderPage",g=>{if(this.destroyed)return;this.#t.get(g.pageIndex)._startRenderPage(g.transparency,g.cacheKey)}),l.on("commonobj",([g,M,U])=>{if(!this.destroyed&&!this.commonObjs.has(g))switch(M){case"Font":const F=this._params;if("error"in U){const h=U.error;(0,_util.warn)(`Error during font loading: ${h}`),this.commonObjs.resolve(g,h);break}const S=F.pdfBug&&globalThis.FontInspector?.enabled?(h,t)=>globalThis.FontInspector.fontAdded(h,t):null,A=new _font_loader.FontFaceObject(U,{isEvalSupported:F.isEvalSupported,disableFontFace:F.disableFontFace,ignoreErrors:F.ignoreErrors,inspectFont:S});this.fontLoader.bind(A).catch(h=>l.sendWithPromise("FontFallback",{id:g})).finally(()=>{!F.fontExtraProperties&&A.data&&(A.data=null),this.commonObjs.resolve(g,A)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(g,U);break;default:throw new Error(`Got unknown common object type ${M}`)}}),l.on("obj",([g,M,U,F])=>{if(this.destroyed)return;const S=this.#t.get(M);if(!S.objs.has(g))switch(U){case"Image":if(S.objs.resolve(g,F),F){let A;if(F.bitmap){const{width:h,height:t}=F;A=h*t*4}else A=F.data?.length||0;A>_util.MAX_IMAGE_SIZE_TO_CACHE&&(S._maybeCleanupAfterRender=!0)}break;case"Pattern":S.objs.resolve(g,F);break;default:throw new Error(`Got unknown object type ${U}`)}}),l.on("DocProgress",g=>{this.destroyed||k.onProgress?.({loaded:g.loaded,total:g.total})}),l.on("FetchBuiltInCMap",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(g):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",g=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(g):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const k=l-1,g=this.#i.get(k);if(g)return g;const M=this.messageHandler.sendWithPromise("GetPage",{pageIndex:k}).then(U=>{if(this.destroyed)throw new Error("Transport destroyed");const F=new PDFPageProxy(k,U,this,this._params.pdfBug);return this.#t.set(k,F),F});return this.#i.set(k,M),M}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,k){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:k})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",k=this.#e.get(l);if(k)return k;const g=this.messageHandler.sendWithPromise(l,null).then(M=>({info:M[0],metadata:M[1]?new _metadata.Metadata(M[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(l,g),g}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const k of this.#t.values())if(!k.cleanup())throw new Error(`startCleanup: Page ${k.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:k}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:k})}}class PDFObjects{#e=Object.create(null);#t(l){const k=this.#e[l];return k||(this.#e[l]={capability:new _util.PromiseCapability,data:null})}get(l,k=null){if(k){const M=this.#t(l);return M.capability.promise.then(()=>k(M.data)),null}const g=this.#e[l];if(!g?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${l}.`);return g.data}has(l){return this.#e[l]?.capability.settled||!1}resolve(l,k=null){const g=this.#t(l);g.data=k,g.capability.resolve()}clear(){for(const l in this.#e){const{data:k}=this.#e[l];k?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(l){this.#e=l,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(l=0){this.#e.cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=this.#e.operatorList;if(!l)return!1;const{annotationCanvasMap:k}=this.#e;return l.form||l.canvas&&k?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:l,params:k,objs:g,commonObjs:M,annotationCanvasMap:U,operatorList:F,pageIndex:S,canvasFactory:A,filterFactory:h,useRequestAnimationFrame:t=!1,pdfBug:m=!1,pageColors:f=null}){this.callback=l,this.params=k,this.objs=g,this.commonObjs=M,this.annotationCanvasMap=U,this.operatorListIdx=null,this.operatorList=F,this._pageIndex=S,this.canvasFactory=A,this.filterFactory=h,this._pdfBug=m,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=k.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:k}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:g,viewport:M,transform:U,background:F}=this.params;this.gfx=new _canvas.CanvasGraphics(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:k},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:U,viewport:M,transparency:l,background:F}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(l=null,k=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",k))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PrintAnnotationStorage=l.AnnotationStorage=void 0;var g=k(1),M=k(4),U=k(8);class F{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(h,t){const m=this.#t.get(h);return m===void 0?t:Object.assign(t,m)}getRawValue(h){return this.#t.get(h)}remove(h){if(this.#t.delete(h),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#t.values())if(t instanceof M.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(h,t){const m=this.#t.get(h);let f=!1;if(m!==void 0)for(const[i,a]of Object.entries(t))m[i]!==a&&(f=!0,m[i]=a);else f=!0,this.#t.set(h,t);f&&this.#i(),t instanceof M.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(h){return this.#t.has(h)}getAll(){return this.#t.size>0?(0,g.objectFromMap)(this.#t):null}setAll(h){for(const[t,m]of Object.entries(h))this.setValue(t,m)}get size(){return this.#t.size}#i(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new S(this)}get serializable(){if(this.#t.size===0)return null;const h=new Map;for(const[t,m]of this.#t){const f=m instanceof M.AnnotationEditor?m.serialize():m;f&&h.set(t,f)}return h}static getHash(h){if(!h)return"";const t=new U.MurmurHash3_64;for(const[m,f]of h)t.update(`${m}:${JSON.stringify(f)}`);return t.hexdigest()}}l.AnnotationStorage=F;class S extends F{#e=null;constructor(h){super(),this.#e=structuredClone(h.serializable)}get print(){(0,g.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}l.PrintAnnotationStorage=S}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationEditor=void 0;var g=k(5),M=k(1);class U{#e=this.focusin.bind(this);#t=this.focusout.bind(this);#i=!1;#n=!1;#s=!1;_uiManager=null;#l=U._zIndex++;static _colorManager=new g.ColorManager;static _zIndex=1;constructor(S){this.constructor===U&&(0,M.unreachable)("Cannot initialize AnnotationEditor."),this.parent=S.parent,this.id=S.id,this.width=this.height=null,this.pageIndex=S.parent.pageIndex,this.name=S.name,this.div=null,this._uiManager=S.uiManager;const{rotation:A,rawDims:{pageWidth:h,pageHeight:t,pageX:m,pageY:f}}=this.parent.viewport;this.rotation=A,this.pageRotation=(360+A-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[h,t],this.pageTranslation=[m,f];const[i,a]=this.parentDimensions;this.x=S.x/i,this.y=S.y/a,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,M.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(S){this._uiManager.addCommands(S)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#l}setParent(S){S!==null&&(this.pageIndex=S.pageIndex,this.pageDimensions=S.pageDimensions),this.parent=S}focusin(S){this.#i?this.#i=!1:this.parent.setSelected(this)}focusout(S){!this.isAttachedToDOM||S.relatedTarget?.closest(`#${this.id}`)||(S.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(S){const A=this.parent.div.getBoundingClientRect();this.startX=S.clientX-A.x,this.startY=S.clientY-A.y,S.dataTransfer.setData("text/plain",this.id),S.dataTransfer.effectAllowed="move"}setAt(S,A,h,t){const[m,f]=this.parentDimensions;[h,t]=this.screenToPageTranslation(h,t),this.x=(S+h)/m,this.y=(A+t)/f,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(S,A){const[h,t]=this.parentDimensions;[S,A]=this.screenToPageTranslation(S,A),this.x+=S/h,this.y+=A/t,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(S,A){switch(this.parentRotation){case 90:return[A,-S];case 180:return[-S,-A];case 270:return[-A,S];default:return[S,A]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:S}=this._uiManager.viewParameters,[A,h]=this.pageDimensions;return[A*S,h*S]}setDims(S,A){const[h,t]=this.parentDimensions;this.div.style.width=`${100*S/h}%`,this.div.style.height=`${100*A/t}%`}fixDims(){const{style:S}=this.div,{height:A,width:h}=S,t=h.endsWith("%"),m=A.endsWith("%");if(t&&m)return;const[f,i]=this.parentDimensions;t||(S.width=`${100*parseFloat(h)/f}%`),m||(S.height=`${100*parseFloat(A)/i}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#e),this.div.addEventListener("focusout",this.#t);const[S,A]=this.getInitialTranslation();return this.translate(S,A),(0,g.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(S){const{isMac:A}=M.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&A){S.preventDefault();return}S.ctrlKey&&!A||S.shiftKey||S.metaKey&&A?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#i=!0}getRect(S,A){const h=this.parentScale,[t,m]=this.pageDimensions,[f,i]=this.pageTranslation,a=S/h,p=A/h,o=this.x*t,d=this.y*m,E=this.width*t,C=this.height*m;switch(this.rotation){case 0:return[o+a+f,m-d-p-C+i,o+a+E+f,m-d-p+i];case 90:return[o+p+f,m-d+a+i,o+p+C+f,m-d+a+E+i];case 180:return[o-a-E+f,m-d+p+i,o-a+f,m-d+p+C+i];case 270:return[o-p-C+f,m-d-a-E+i,o-p+f,m-d-a+i];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(S,A){const[h,t,m,f]=S,i=m-h,a=f-t;switch(this.rotation){case 0:return[h,A-f,i,a];case 90:return[h,A-t,a,i];case 180:return[m,A-t,i,a];case 270:return[m,A-f,a,i];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#s=!0}disableEditMode(){this.#s=!1}isInEditMode(){return this.#s}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#e)}serialize(){(0,M.unreachable)("An editor must be serializable")}static deserialize(S,A,h){const t=new this.prototype.constructor({parent:A,id:A.getNextId(),uiManager:h});t.rotation=S.rotation;const[m,f]=t.pageDimensions,[i,a,p,o]=t.getRectInCurrentCoords(S.rect,f);return t.x=i/m,t.y=a/f,t.width=p/m,t.height=o/f,t}remove(){this.div.removeEventListener("focusin",this.#e),this.div.removeEventListener("focusout",this.#t),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(S,A){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#n}set isEditing(S){this.#n=S,S?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}l.AnnotationEditor=U}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.KeyboardManager=l.CommandManager=l.ColorManager=l.AnnotationEditorUIManager=void 0,l.bindEvents=U,l.opacityToHex=F;var g=k(1),M=k(6);function U(f,i,a){for(const p of a)i.addEventListener(p,f[p].bind(f))}function F(f){return Math.round(Math.min(255,Math.max(1,255*f))).toString(16).padStart(2,"0")}class S{#e=0;getId(){return`${g.AnnotationEditorPrefix}${this.#e++}`}}class A{#e=[];#t=!1;#i;#n=-1;constructor(i=128){this.#i=i}add({cmd:i,undo:a,mustExec:p,type:o=NaN,overwriteIfSameType:d=!1,keepUndo:E=!1}){if(p&&i(),this.#t)return;const C={cmd:i,undo:a,type:o};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(C);return}if(d&&this.#e[this.#n].type===o){E&&(C.undo=this.#e[this.#n].undo),this.#e[this.#n]=C;return}const v=this.#n+1;v===this.#i?this.#e.splice(0,1):(this.#n=v,v<this.#e.length&&this.#e.splice(v)),this.#e.push(C)}undo(){this.#n!==-1&&(this.#t=!0,this.#e[this.#n].undo(),this.#t=!1,this.#n-=1)}redo(){this.#n<this.#e.length-1&&(this.#n+=1,this.#t=!0,this.#e[this.#n].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}destroy(){this.#e=null}}l.CommandManager=A;class h{constructor(i){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:a}=g.FeatureTest.platform;for(const[p,o]of i)for(const d of p){const E=d.startsWith("mac+");a&&E?(this.callbacks.set(d.slice(4),o),this.allKeys.add(d.split("+").at(-1))):!a&&!E&&(this.callbacks.set(d,o),this.allKeys.add(d.split("+").at(-1)))}}#e(i){i.altKey&&this.buffer.push("alt"),i.ctrlKey&&this.buffer.push("ctrl"),i.metaKey&&this.buffer.push("meta"),i.shiftKey&&this.buffer.push("shift"),this.buffer.push(i.key);const a=this.buffer.join("+");return this.buffer.length=0,a}exec(i,a){if(!this.allKeys.has(a.key))return;const p=this.callbacks.get(this.#e(a));p&&(p.bind(i)(),a.stopPropagation(),a.preventDefault())}}l.KeyboardManager=h;class t{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const i=new Map([["CanvasText",null],["Canvas",null]]);return(0,M.getColorValues)(i),(0,g.shadow)(this,"_colors",i)}convert(i){const a=(0,M.getRGB)(i);if(!window.matchMedia("(forced-colors: active)").matches)return a;for(const[p,o]of this._colors)if(o.every((d,E)=>d===a[E]))return t._colorsMapping.get(p);return a}getHexCode(i){const a=this._colors.get(i);return a?g.Util.makeHexColor(...a):i}}l.ColorManager=t;class m{#e=null;#t=new Map;#i=new Map;#n=null;#s=new A;#l=0;#h=null;#r=new Set;#a=null;#d=new S;#c=!1;#f=g.AnnotationEditorType.NONE;#o=new Set;#u=this.copy.bind(this);#g=this.cut.bind(this);#b=this.paste.bind(this);#v=this.keydown.bind(this);#C=this.onEditingAction.bind(this);#A=this.onPageChanging.bind(this);#w=this.onScaleChanging.bind(this);#y=this.onRotationChanging.bind(this);#S={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#p=null;static _keyboardManager=new h([[["ctrl+a","mac+meta+a"],m.prototype.selectAll],[["ctrl+z","mac+meta+z"],m.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],m.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],m.prototype.delete],[["Escape","mac+Escape"],m.prototype.unselectAll]]);constructor(i,a,p){this.#p=i,this.#a=a,this.#a._on("editingaction",this.#C),this.#a._on("pagechanging",this.#A),this.#a._on("scalechanging",this.#w),this.#a._on("rotationchanging",this.#y),this.#n=p,this.viewParameters={realScale:M.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#T(),this.#a._off("editingaction",this.#C),this.#a._off("pagechanging",this.#A),this.#a._off("scalechanging",this.#w),this.#a._off("rotationchanging",this.#y);for(const i of this.#i.values())i.destroy();this.#i.clear(),this.#t.clear(),this.#r.clear(),this.#e=null,this.#o.clear(),this.#s.destroy()}onPageChanging({pageNumber:i}){this.#l=i-1}focusMainContainer(){this.#p.focus()}addShouldRescale(i){this.#r.add(i)}removeShouldRescale(i){this.#r.delete(i)}onScaleChanging({scale:i}){this.commitOrRemove(),this.viewParameters.realScale=i*M.PixelsPerInch.PDF_TO_CSS_UNITS;for(const a of this.#r)a.onScaleChanging()}onRotationChanging({pagesRotation:i}){this.commitOrRemove(),this.viewParameters.rotation=i}addToAnnotationStorage(i){!i.isEmpty()&&this.#n&&!this.#n.has(i.id)&&this.#n.setValue(i.id,i)}#x(){this.#p.addEventListener("keydown",this.#v)}#T(){this.#p.removeEventListener("keydown",this.#v)}#_(){document.addEventListener("copy",this.#u),document.addEventListener("cut",this.#g),document.addEventListener("paste",this.#b)}#E(){document.removeEventListener("copy",this.#u),document.removeEventListener("cut",this.#g),document.removeEventListener("paste",this.#b)}copy(i){if(i.preventDefault(),this.#e&&this.#e.commitOrRemove(),!this.hasSelection)return;const a=[];for(const p of this.#o)p.isEmpty()||a.push(p.serialize());a.length!==0&&i.clipboardData.setData("application/pdfjs",JSON.stringify(a))}cut(i){this.copy(i),this.delete()}paste(i){i.preventDefault();let a=i.clipboardData.getData("application/pdfjs");if(!a)return;try{a=JSON.parse(a)}catch(o){(0,g.warn)(`paste: "${o.message}".`);return}if(!Array.isArray(a))return;this.unselectAll();const p=this.#i.get(this.#l);try{const o=[];for(const C of a){const v=p.deserialize(C);if(!v)return;o.push(v)}const d=()=>{for(const C of o)this.#I(C);this.#L(o)},E=()=>{for(const C of o)C.remove()};this.addCommands({cmd:d,undo:E,mustExec:!0})}catch(o){(0,g.warn)(`paste: "${o.message}".`)}}keydown(i){this.getActive()?.shouldGetKeyboardEvents()||m._keyboardManager.exec(this,i)}onEditingAction(i){["undo","redo","delete","selectAll"].includes(i.name)&&this[i.name]()}#m(i){Object.entries(i).some(([p,o])=>this.#S[p]!==o)&&this.#a.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#S,i)})}#P(i){this.#a.dispatch("annotationeditorparamschanged",{source:this,details:i})}setEditingState(i){i?(this.#x(),this.#_(),this.#m({isEditing:this.#f!==g.AnnotationEditorType.NONE,isEmpty:this.#R(),hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:this.#s.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#T(),this.#E(),this.#m({isEditing:!1}))}registerEditorTypes(i){if(!this.#h){this.#h=i;for(const a of this.#h)this.#P(a.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#i.get(this.#l)}get currentPageIndex(){return this.#l}addLayer(i){this.#i.set(i.pageIndex,i),this.#c?i.enable():i.disable()}removeLayer(i){this.#i.delete(i.pageIndex)}updateMode(i){if(this.#f=i,i===g.AnnotationEditorType.NONE)this.setEditingState(!1),this.#k();else{this.setEditingState(!0),this.#M();for(const a of this.#i.values())a.updateMode(i)}}updateToolbar(i){i!==this.#f&&this.#a.dispatch("switchannotationeditormode",{source:this,mode:i})}updateParams(i,a){if(this.#h){for(const p of this.#o)p.updateParams(i,a);for(const p of this.#h)p.updateDefaultParams(i,a)}}#M(){if(!this.#c){this.#c=!0;for(const i of this.#i.values())i.enable()}}#k(){if(this.unselectAll(),this.#c){this.#c=!1;for(const i of this.#i.values())i.disable()}}getEditors(i){const a=[];for(const p of this.#t.values())p.pageIndex===i&&a.push(p);return a}getEditor(i){return this.#t.get(i)}addEditor(i){this.#t.set(i.id,i)}removeEditor(i){this.#t.delete(i.id),this.unselect(i),this.#n?.remove(i.id)}#I(i){const a=this.#i.get(i.pageIndex);a?a.addOrRebuild(i):this.addEditor(i)}setActiveEditor(i){this.#e!==i&&(this.#e=i,i&&this.#P(i.propertiesToUpdate))}toggleSelected(i){if(this.#o.has(i)){this.#o.delete(i),i.unselect(),this.#m({hasSelectedEditor:this.hasSelection});return}this.#o.add(i),i.select(),this.#P(i.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}setSelected(i){for(const a of this.#o)a!==i&&a.unselect();this.#o.clear(),this.#o.add(i),i.select(),this.#P(i.propertiesToUpdate),this.#m({hasSelectedEditor:!0})}isSelected(i){return this.#o.has(i)}unselect(i){i.unselect(),this.#o.delete(i),this.#m({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#o.size!==0}undo(){this.#s.undo(),this.#m({hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#R()})}redo(){this.#s.redo(),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:this.#s.hasSomethingToRedo(),isEmpty:this.#R()})}addCommands(i){this.#s.add(i),this.#m({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#R()})}#R(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const i of this.#t.values())return i.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const i=[...this.#o],a=()=>{for(const o of i)o.remove()},p=()=>{for(const o of i)this.#I(o)};this.addCommands({cmd:a,undo:p,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}#L(i){this.#o.clear();for(const a of i)a.isEmpty()||(this.#o.add(a),a.select());this.#m({hasSelectedEditor:!0})}selectAll(){for(const i of this.#o)i.commit();this.#L(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.#o.size!==0){for(const i of this.#o)i.unselect();this.#o.clear(),this.#m({hasSelectedEditor:!1})}}isActive(i){return this.#e===i}getActive(){return this.#e}getMode(){return this.#f}}l.AnnotationEditorUIManager=m}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.StatTimer=l.RenderingCancelledException=l.PixelsPerInch=l.PageViewport=l.PDFDateString=l.DOMStandardFontDataFactory=l.DOMSVGFactory=l.DOMFilterFactory=l.DOMCanvasFactory=l.DOMCMapReaderFactory=l.AnnotationPrefix=void 0,l.deprecated=w,l.getColorValues=W,l.getCurrentTransform=te,l.getCurrentTransformInverse=Q,l.getFilenameFromUrl=E,l.getPdfFilenameFromUrl=C,l.getRGB=V,l.getXfaPageViewport=I,l.isDataScheme=o,l.isPdfFile=d,l.isValidFetchUrl=e,l.loadScript=r,l.setLayerDimensions=G;var g=k(7),M=k(1);const U="http://www.w3.org/2000/svg",F="pdfjs_internal_id_";l.AnnotationPrefix=F;class S{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}l.PixelsPerInch=S;class A extends g.BaseFilterFactory{#e;#t;#i;#n;#s;#l;#h;#r=0;constructor({docId:x,ownerDocument:P=globalThis.document}={}){super(),this.#i=x,this.#n=P}get#a(){return this.#e||=new Map}get#d(){if(!this.#t){const x=this.#n.createElement("div"),{style:P}=x;P.visibility="hidden",P.contain="strict",P.width=P.height=0,P.position="absolute",P.top=P.left=0,P.zIndex=-1;const y=this.#n.createElementNS(U,"svg");y.setAttribute("width",0),y.setAttribute("height",0),this.#t=this.#n.createElementNS(U,"defs"),x.append(y),y.append(this.#t),this.#n.body.append(x)}return this.#t}#c(x,P,y){const c=this.#n.createElementNS(U,P);c.setAttribute("type","discrete"),c.setAttribute("tableValues",y),x.append(c)}addFilter(x){if(!x)return"none";let P=this.#a.get(x);if(P)return P;let y,c,s,b;if(x.length===1){const R=x[0],O=new Array(256);for(let j=0;j<256;j++)O[j]=R[j]/255;b=y=c=s=O.join(",")}else{const[R,O,j]=x,B=new Array(256),q=new Array(256),Z=new Array(256);for(let z=0;z<256;z++)B[z]=R[z]/255,q[z]=O[z]/255,Z[z]=j[z]/255;y=B.join(","),c=q.join(","),s=Z.join(","),b=`${y}${c}${s}`}if(P=this.#a.get(b),P)return this.#a.set(x,P),P;const L=`g_${this.#i}_transfer_map_${this.#r++}`,n=`url(#${L})`;this.#a.set(x,n),this.#a.set(b,n);const u=this.#n.createElementNS(U,"filter",U);u.setAttribute("id",L),u.setAttribute("color-interpolation-filters","sRGB");const _=this.#n.createElementNS(U,"feComponentTransfer");return u.append(_),this.#c(_,"feFuncR",y),this.#c(_,"feFuncG",c),this.#c(_,"feFuncB",s),this.#d.append(u),n}addHCMFilter(x,P){const y=`${x}-${P}`;if(this.#l===y)return this.#h;if(this.#l=y,this.#h="none",this.#s?.remove(),!x||!P)return this.#h;this.#d.style.color=x,x=getComputedStyle(this.#d).getPropertyValue("color");const c=V(x);x=M.Util.makeHexColor(...c),this.#d.style.color=P,P=getComputedStyle(this.#d).getPropertyValue("color");const s=V(P);if(P=M.Util.makeHexColor(...s),this.#d.style.color="",x==="#000000"&&P==="#ffffff"||x===P)return this.#h;const b=new Array(256);for(let j=0;j<=255;j++){const B=j/255;b[j]=B<=.03928?B/12.92:((B+.055)/1.055)**2.4}const L=b.join(","),n=`g_${this.#i}_hcm_filter`,u=this.#s=this.#n.createElementNS(U,"filter",U);u.setAttribute("id",n),u.setAttribute("color-interpolation-filters","sRGB");let _=this.#n.createElementNS(U,"feComponentTransfer");u.append(_),this.#c(_,"feFuncR",L),this.#c(_,"feFuncG",L),this.#c(_,"feFuncB",L);const R=this.#n.createElementNS(U,"feColorMatrix");R.setAttribute("type","matrix"),R.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),u.append(R),_=this.#n.createElementNS(U,"feComponentTransfer"),u.append(_);const O=(j,B)=>{const q=c[j]/255,Z=s[j]/255,z=new Array(B+1);for(let ee=0;ee<=B;ee++)z[ee]=q+ee/B*(Z-q);return z.join(",")};return this.#c(_,"feFuncR",O(0,5)),this.#c(_,"feFuncG",O(1,5)),this.#c(_,"feFuncB",O(2,5)),this.#d.append(u),this.#h=`url(#${n})`,this.#h}destroy(x=!1){x&&this.#h||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#r=0)}}l.DOMFilterFactory=A;class h extends g.BaseCanvasFactory{constructor({ownerDocument:x=globalThis.document}={}){super(),this._document=x}_createCanvas(x,P){const y=this._document.createElement("canvas");return y.width=x,y.height=P,y}}l.DOMCanvasFactory=h;async function t(H,x=!1){if(e(H,document.baseURI)){const P=await fetch(H);if(!P.ok)throw new Error(P.statusText);return x?new Uint8Array(await P.arrayBuffer()):(0,M.stringToBytes)(await P.text())}return new Promise((P,y)=>{const c=new XMLHttpRequest;c.open("GET",H,!0),x&&(c.responseType="arraybuffer"),c.onreadystatechange=()=>{if(c.readyState===XMLHttpRequest.DONE){if(c.status===200||c.status===0){let s;if(x&&c.response?s=new Uint8Array(c.response):!x&&c.responseText&&(s=(0,M.stringToBytes)(c.responseText)),s){P(s);return}}y(new Error(c.statusText))}},c.send(null)})}class m extends g.BaseCMapReaderFactory{_fetchData(x,P){return t(x,this.isCompressed).then(y=>({cMapData:y,compressionType:P}))}}l.DOMCMapReaderFactory=m;class f extends g.BaseStandardFontDataFactory{_fetchData(x){return t(x,!0)}}l.DOMStandardFontDataFactory=f;class i extends g.BaseSVGFactory{_createSVG(x){return document.createElementNS(U,x)}}l.DOMSVGFactory=i;class a{constructor({viewBox:x,scale:P,rotation:y,offsetX:c=0,offsetY:s=0,dontFlip:b=!1}){this.viewBox=x,this.scale=P,this.rotation=y,this.offsetX=c,this.offsetY=s;const L=(x[2]+x[0])/2,n=(x[3]+x[1])/2;let u,_,R,O;switch(y%=360,y<0&&(y+=360),y){case 180:u=-1,_=0,R=0,O=1;break;case 90:u=0,_=1,R=1,O=0;break;case 270:u=0,_=-1,R=-1,O=0;break;case 0:u=1,_=0,R=0,O=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}b&&(R=-R,O=-O);let j,B,q,Z;u===0?(j=Math.abs(n-x[1])*P+c,B=Math.abs(L-x[0])*P+s,q=(x[3]-x[1])*P,Z=(x[2]-x[0])*P):(j=Math.abs(L-x[0])*P+c,B=Math.abs(n-x[1])*P+s,q=(x[2]-x[0])*P,Z=(x[3]-x[1])*P),this.transform=[u*P,_*P,R*P,O*P,j-u*P*L-R*P*n,B-_*P*L-O*P*n],this.width=q,this.height=Z}get rawDims(){const{viewBox:x}=this;return(0,M.shadow)(this,"rawDims",{pageWidth:x[2]-x[0],pageHeight:x[3]-x[1],pageX:x[0],pageY:x[1]})}clone({scale:x=this.scale,rotation:P=this.rotation,offsetX:y=this.offsetX,offsetY:c=this.offsetY,dontFlip:s=!1}={}){return new a({viewBox:this.viewBox.slice(),scale:x,rotation:P,offsetX:y,offsetY:c,dontFlip:s})}convertToViewportPoint(x,P){return M.Util.applyTransform([x,P],this.transform)}convertToViewportRectangle(x){const P=M.Util.applyTransform([x[0],x[1]],this.transform),y=M.Util.applyTransform([x[2],x[3]],this.transform);return[P[0],P[1],y[0],y[1]]}convertToPdfPoint(x,P){return M.Util.applyInverseTransform([x,P],this.transform)}}l.PageViewport=a;class p extends M.BaseException{constructor(x,P,y=0){super(x,"RenderingCancelledException"),this.type=P,this.extraDelay=y}}l.RenderingCancelledException=p;function o(H){const x=H.length;let P=0;for(;P<x&&H[P].trim()==="";)P++;return H.substring(P,P+5).toLowerCase()==="data:"}function d(H){return typeof H=="string"&&/\.pdf$/i.test(H)}function E(H,x=!1){return x||([H]=H.split(/[#?]/,1)),H.substring(H.lastIndexOf("/")+1)}function C(H,x="document.pdf"){if(typeof H!="string")return x;if(o(H))return(0,M.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),x;const P=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,y=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,c=P.exec(H);let s=y.exec(c[1])||y.exec(c[2])||y.exec(c[3]);if(s&&(s=s[0],s.includes("%")))try{s=y.exec(decodeURIComponent(s))[0]}catch{}return s||x}class v{started=Object.create(null);times=[];time(x){x in this.started&&(0,M.warn)(`Timer is already running for ${x}`),this.started[x]=Date.now()}timeEnd(x){x in this.started||(0,M.warn)(`Timer has not been started for ${x}`),this.times.push({name:x,start:this.started[x],end:Date.now()}),delete this.started[x]}toString(){const x=[];let P=0;for(const{name:y}of this.times)P=Math.max(y.length,P);for(const{name:y,start:c,end:s}of this.times)x.push(`${y.padEnd(P)} ${s-c}ms
`);return x.join("")}}l.StatTimer=v;function e(H,x){try{const{protocol:P}=x?new URL(H,x):new URL(H);return P==="http:"||P==="https:"}catch{return!1}}function r(H,x=!1){return new Promise((P,y)=>{const c=document.createElement("script");c.src=H,c.onload=function(s){x&&c.remove(),P(s)},c.onerror=function(){y(new Error(`Cannot load script at: ${c.src}`))},(document.head||document.documentElement).append(c)})}function w(H){console.log("Deprecated API usage: "+H)}let D;class T{static toDateObject(x){if(!x||typeof x!="string")return null;D||(D=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const P=D.exec(x);if(!P)return null;const y=parseInt(P[1],10);let c=parseInt(P[2],10);c=c>=1&&c<=12?c-1:0;let s=parseInt(P[3],10);s=s>=1&&s<=31?s:1;let b=parseInt(P[4],10);b=b>=0&&b<=23?b:0;let L=parseInt(P[5],10);L=L>=0&&L<=59?L:0;let n=parseInt(P[6],10);n=n>=0&&n<=59?n:0;const u=P[7]||"Z";let _=parseInt(P[8],10);_=_>=0&&_<=23?_:0;let R=parseInt(P[9],10)||0;return R=R>=0&&R<=59?R:0,u==="-"?(b+=_,L+=R):u==="+"&&(b-=_,L-=R),new Date(Date.UTC(y,c,s,b,L,n))}}l.PDFDateString=T;function I(H,{scale:x=1,rotation:P=0}){const{width:y,height:c}=H.attributes.style,s=[0,0,parseInt(y),parseInt(c)];return new a({viewBox:s,scale:x,rotation:P})}function V(H){if(H.startsWith("#")){const x=parseInt(H.slice(1),16);return[(x&16711680)>>16,(x&65280)>>8,x&255]}return H.startsWith("rgb(")?H.slice(4,-1).split(",").map(x=>parseInt(x)):H.startsWith("rgba(")?H.slice(5,-1).split(",").map(x=>parseInt(x)).slice(0,3):((0,M.warn)(`Not a valid color format: "${H}"`),[0,0,0])}function W(H){const x=document.createElement("span");x.style.visibility="hidden",document.body.append(x);for(const P of H.keys()){x.style.color=P;const y=window.getComputedStyle(x).color;H.set(P,V(y))}x.remove()}function te(H){const{a:x,b:P,c:y,d:c,e:s,f:b}=H.getTransform();return[x,P,y,c,s,b]}function Q(H){const{a:x,b:P,c:y,d:c,e:s,f:b}=H.getTransform().invertSelf();return[x,P,y,c,s,b]}function G(H,x,P=!1,y=!0){if(x instanceof a){const{pageWidth:c,pageHeight:s}=x.rawDims,{style:b}=H,L=`calc(var(--scale-factor) * ${c}px)`,n=`calc(var(--scale-factor) * ${s}px)`;!P||x.rotation%180===0?(b.width=L,b.height=n):(b.width=n,b.height=L)}y&&H.setAttribute("data-main-rotation",x.rotation)}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.BaseStandardFontDataFactory=l.BaseSVGFactory=l.BaseFilterFactory=l.BaseCanvasFactory=l.BaseCMapReaderFactory=void 0;var g=k(1);class M{constructor(){this.constructor===M&&(0,g.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,m){return"none"}destroy(t=!1){}}l.BaseFilterFactory=M;class U{constructor(){this.constructor===U&&(0,g.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,m){if(t<=0||m<=0)throw new Error("Invalid canvas size");const f=this._createCanvas(t,m);return{canvas:f,context:f.getContext("2d")}}reset(t,m,f){if(!t.canvas)throw new Error("Canvas is not specified");if(m<=0||f<=0)throw new Error("Invalid canvas size");t.canvas.width=m,t.canvas.height=f}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,m){(0,g.unreachable)("Abstract method `_createCanvas` called.")}}l.BaseCanvasFactory=U;class F{constructor({baseUrl:t=null,isCompressed:m=!0}){this.constructor===F&&(0,g.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=m}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const m=this.baseUrl+t+(this.isCompressed?".bcmap":""),f=this.isCompressed?g.CMapCompressionType.BINARY:g.CMapCompressionType.NONE;return this._fetchData(m,f).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${m}`)})}_fetchData(t,m){(0,g.unreachable)("Abstract method `_fetchData` called.")}}l.BaseCMapReaderFactory=F;class S{constructor({baseUrl:t=null}){this.constructor===S&&(0,g.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const m=`${this.baseUrl}${t}`;return this._fetchData(m).catch(f=>{throw new Error(`Unable to load font data at: ${m}`)})}_fetchData(t){(0,g.unreachable)("Abstract method `_fetchData` called.")}}l.BaseStandardFontDataFactory=S;class A{constructor(){this.constructor===A&&(0,g.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,m,f=!1){if(t<=0||m<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),f||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${m}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${m}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,g.unreachable)("Abstract method `_createSVG` called.")}}l.BaseSVGFactory=A}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.MurmurHash3_64=void 0;var g=k(1);const M=3285377520,U=4294901760,F=65535;class S{constructor(h){this.h1=h?h&4294967295:M,this.h2=h?h&4294967295:M}update(h){let t,m;if(typeof h=="string"){t=new Uint8Array(h.length*2),m=0;for(let w=0,D=h.length;w<D;w++){const T=h.charCodeAt(w);T<=255?t[m++]=T:(t[m++]=T>>>8,t[m++]=T&255)}}else if((0,g.isArrayBuffer)(h))t=h.slice(),m=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const f=m>>2,i=m-f*4,a=new Uint32Array(t.buffer,0,f);let p=0,o=0,d=this.h1,E=this.h2;const C=3432918353,v=461845907,e=C&F,r=v&F;for(let w=0;w<f;w++)w&1?(p=a[w],p=p*C&U|p*e&F,p=p<<15|p>>>17,p=p*v&U|p*r&F,d^=p,d=d<<13|d>>>19,d=d*5+3864292196):(o=a[w],o=o*C&U|o*e&F,o=o<<15|o>>>17,o=o*v&U|o*r&F,E^=o,E=E<<13|E>>>19,E=E*5+3864292196);switch(p=0,i){case 3:p^=t[f*4+2]<<16;case 2:p^=t[f*4+1]<<8;case 1:p^=t[f*4],p=p*C&U|p*e&F,p=p<<15|p>>>17,p=p*v&U|p*r&F,f&1?d^=p:E^=p}this.h1=d,this.h2=E}hexdigest(){let h=this.h1,t=this.h2;return h^=t>>>1,h=h*3981806797&U|h*36045&F,t=t*4283543511&U|((t<<16|h>>>16)*2950163797&U)>>>16,h^=t>>>1,h=h*444984403&U|h*60499&F,t=t*3301882366&U|((t<<16|h>>>16)*3120437893&U)>>>16,h^=t>>>1,(h>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}l.MurmurHash3_64=S}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FontLoader=l.FontFaceObject=void 0;var g=k(1),M=k(10);class U{constructor({ownerDocument:A=globalThis.document,styleElement:h=null}){this._document=A,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(A){this.nativeFontFaces.push(A),this._document.fonts.add(A)}insertRule(A){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const h=this.styleElement.sheet;h.insertRule(A,h.cssRules.length)}clear(){for(const A of this.nativeFontFaces)this._document.fonts.delete(A);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(A){if(A.attached||A.missingFile)return;if(A.attached=!0,this.isFontLoadingAPISupported){const t=A.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(m){throw(0,g.warn)(`Failed to load font '${t.family}': '${m}'.`),A.disableFontFace=!0,m}}return}const h=A.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const m=this._queueLoadingCallback(t);this._prepareFontLoadEvent(A,m)})}}get isFontLoadingAPISupported(){const A=!!this._document?.fonts;return(0,g.shadow)(this,"isFontLoadingAPISupported",A)}get isSyncFontLoadingSupported(){let A=!1;return(M.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(A=!0),(0,g.shadow)(this,"isSyncFontLoadingSupported",A)}_queueLoadingCallback(A){function h(){for((0,g.assert)(!m.done,"completeRequest() cannot be called twice."),m.done=!0;t.length>0&&t[0].done;){const f=t.shift();setTimeout(f.callback,0)}}const{loadingRequests:t}=this,m={done:!1,complete:h,callback:A};return t.push(m),m}get _loadTestFont(){const A=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,g.shadow)(this,"_loadTestFont",A)}_prepareFontLoadEvent(A,h){function t(V,W){return V.charCodeAt(W)<<24|V.charCodeAt(W+1)<<16|V.charCodeAt(W+2)<<8|V.charCodeAt(W+3)&255}function m(V,W,te,Q){const G=V.substring(0,W),H=V.substring(W+te);return G+Q+H}let f,i;const a=this._document.createElement("canvas");a.width=1,a.height=1;const p=a.getContext("2d");let o=0;function d(V,W){if(++o>30){(0,g.warn)("Load test font never loaded."),W();return}if(p.font="30px "+V,p.fillText(".",0,20),p.getImageData(0,0,1,1).data[3]>0){W();return}setTimeout(d.bind(null,V,W))}const E=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=m(C,976,E.length,E);const e=16,r=1482184792;let w=t(C,e);for(f=0,i=E.length-3;f<i;f+=4)w=w-r+t(E,f)|0;f<E.length&&(w=w-r+t(E+"XXX",f)|0),C=m(C,e,4,(0,g.string32)(w));const D=`url(data:font/opentype;base64,${btoa(C)});`,T=`@font-face {font-family:"${E}";src:${D}}`;this.insertRule(T);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const V of[A.loadedName,E]){const W=this._document.createElement("span");W.textContent="Hi",W.style.fontFamily=V,I.append(W)}this._document.body.append(I),d(E,()=>{I.remove(),h.complete()})}}l.FontLoader=U;class F{constructor(A,{isEvalSupported:h=!0,disableFontFace:t=!1,ignoreErrors:m=!1,inspectFont:f=null}){this.compiledGlyphs=Object.create(null);for(const i in A)this[i]=A[i];this.isEvalSupported=h!==!1,this.disableFontFace=t===!0,this.ignoreErrors=m===!0,this._inspectFont=f}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let A;if(!this.cssFontInfo)A=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),A=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this._inspectFont?.(this),A}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const A=(0,g.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(A)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let m=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(m+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${m}src:${h}}`}return this._inspectFont?.(this,h),t}getPathGenerator(A,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let t;try{t=A.get(this.loadedName+"_path_"+h)}catch(m){if(!this.ignoreErrors)throw m;return(0,g.warn)(`getPathGenerator - ignoring character: "${m}".`),this.compiledGlyphs[h]=function(f,i){}}if(this.isEvalSupported&&g.FeatureTest.isEvalSupported){const m=[];for(const f of t){const i=f.args!==void 0?f.args.join(","):"";m.push("c.",f.cmd,"(",i,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",m.join(""))}return this.compiledGlyphs[h]=function(m,f){for(const i of t)i.cmd==="scale"&&(i.args=[f,-f]),m[i.cmd].apply(m,i.args)}}}l.FontFaceObject=F}),((N,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.isNodeJS=void 0;const k=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");l.isNodeJS=k}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.CanvasGraphics=void 0;var g=k(1),M=k(6),U=k(12),F=k(13),S=k(10);const A=16,h=100,t=4096,m=15,f=10,i=1e3,a=16;function p(y,c){if(y._removeMirroring)throw new Error("Context is already forwarding operations.");y.__originalSave=y.save,y.__originalRestore=y.restore,y.__originalRotate=y.rotate,y.__originalScale=y.scale,y.__originalTranslate=y.translate,y.__originalTransform=y.transform,y.__originalSetTransform=y.setTransform,y.__originalResetTransform=y.resetTransform,y.__originalClip=y.clip,y.__originalMoveTo=y.moveTo,y.__originalLineTo=y.lineTo,y.__originalBezierCurveTo=y.bezierCurveTo,y.__originalRect=y.rect,y.__originalClosePath=y.closePath,y.__originalBeginPath=y.beginPath,y._removeMirroring=()=>{y.save=y.__originalSave,y.restore=y.__originalRestore,y.rotate=y.__originalRotate,y.scale=y.__originalScale,y.translate=y.__originalTranslate,y.transform=y.__originalTransform,y.setTransform=y.__originalSetTransform,y.resetTransform=y.__originalResetTransform,y.clip=y.__originalClip,y.moveTo=y.__originalMoveTo,y.lineTo=y.__originalLineTo,y.bezierCurveTo=y.__originalBezierCurveTo,y.rect=y.__originalRect,y.closePath=y.__originalClosePath,y.beginPath=y.__originalBeginPath,delete y._removeMirroring},y.save=function(){c.save(),this.__originalSave()},y.restore=function(){c.restore(),this.__originalRestore()},y.translate=function(b,L){c.translate(b,L),this.__originalTranslate(b,L)},y.scale=function(b,L){c.scale(b,L),this.__originalScale(b,L)},y.transform=function(b,L,n,u,_,R){c.transform(b,L,n,u,_,R),this.__originalTransform(b,L,n,u,_,R)},y.setTransform=function(b,L,n,u,_,R){c.setTransform(b,L,n,u,_,R),this.__originalSetTransform(b,L,n,u,_,R)},y.resetTransform=function(){c.resetTransform(),this.__originalResetTransform()},y.rotate=function(b){c.rotate(b),this.__originalRotate(b)},y.clip=function(b){c.clip(b),this.__originalClip(b)},y.moveTo=function(s,b){c.moveTo(s,b),this.__originalMoveTo(s,b)},y.lineTo=function(s,b){c.lineTo(s,b),this.__originalLineTo(s,b)},y.bezierCurveTo=function(s,b,L,n,u,_){c.bezierCurveTo(s,b,L,n,u,_),this.__originalBezierCurveTo(s,b,L,n,u,_)},y.rect=function(s,b,L,n){c.rect(s,b,L,n),this.__originalRect(s,b,L,n)},y.closePath=function(){c.closePath(),this.__originalClosePath()},y.beginPath=function(){c.beginPath(),this.__originalBeginPath()}}class o{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,s,b){let L;return this.cache[c]!==void 0?(L=this.cache[c],this.canvasFactory.reset(L,s,b)):(L=this.canvasFactory.create(s,b),this.cache[c]=L),L}delete(c){delete this.cache[c]}clear(){for(const c in this.cache){const s=this.cache[c];this.canvasFactory.destroy(s),delete this.cache[c]}}}function d(y,c,s,b,L,n,u,_,R,O){const[j,B,q,Z,z,ee]=(0,M.getCurrentTransform)(y);if(B===0&&q===0){const J=u*j+z,ie=Math.round(J),Y=_*Z+ee,re=Math.round(Y),ae=(u+R)*j+z,le=Math.abs(Math.round(ae)-ie)||1,ce=(_+O)*Z+ee,ue=Math.abs(Math.round(ce)-re)||1;return y.setTransform(Math.sign(j),0,0,Math.sign(Z),ie,re),y.drawImage(c,s,b,L,n,0,0,le,ue),y.setTransform(j,B,q,Z,z,ee),[le,ue]}if(j===0&&Z===0){const J=_*q+z,ie=Math.round(J),Y=u*B+ee,re=Math.round(Y),ae=(_+O)*q+z,le=Math.abs(Math.round(ae)-ie)||1,ce=(u+R)*B+ee,ue=Math.abs(Math.round(ce)-re)||1;return y.setTransform(0,Math.sign(B),Math.sign(q),0,ie,re),y.drawImage(c,s,b,L,n,0,0,ue,le),y.setTransform(j,B,q,Z,z,ee),[ue,le]}y.drawImage(c,s,b,L,n,u,_,R,O);const se=Math.hypot(j,B),$=Math.hypot(q,Z);return[se*R,$*O]}function E(y){const{width:c,height:s}=y;if(c>i||s>i)return null;const b=1e3,L=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=c+1;let u=new Uint8Array(n*(s+1)),_,R,O;const j=c+7&-8;let B=new Uint8Array(j*s),q=0;for(const $ of y.data){let J=128;for(;J>0;)B[q++]=$&J?0:255,J>>=1}let Z=0;for(q=0,B[q]!==0&&(u[0]=1,++Z),R=1;R<c;R++)B[q]!==B[q+1]&&(u[R]=B[q]?2:1,++Z),q++;for(B[q]!==0&&(u[R]=2,++Z),_=1;_<s;_++){q=_*j,O=_*n,B[q-j]!==B[q]&&(u[O]=B[q]?1:8,++Z);let $=(B[q]?4:0)+(B[q-j]?8:0);for(R=1;R<c;R++)$=($>>2)+(B[q+1]?4:0)+(B[q-j+1]?8:0),L[$]&&(u[O+R]=L[$],++Z),q++;if(B[q-j]!==B[q]&&(u[O+R]=B[q]?2:4,++Z),Z>b)return null}for(q=j*(s-1),O=_*n,B[q]!==0&&(u[O]=8,++Z),R=1;R<c;R++)B[q]!==B[q+1]&&(u[O+R]=B[q]?4:8,++Z),q++;if(B[q]!==0&&(u[O+R]=4,++Z),Z>b)return null;const z=new Int32Array([0,n,-1,0,-n,0,0,0,1]),ee=new Path2D;for(_=0;Z&&_<=s;_++){let $=_*n;const J=$+c;for(;$<J&&!u[$];)$++;if($===J)continue;ee.moveTo($%n,_);const ie=$;let Y=u[$];do{const re=z[Y];do $+=re;while(!u[$]);const ae=u[$];ae!==5&&ae!==10?(Y=ae,u[$]=0):(Y=ae&51*Y>>4,u[$]&=Y>>2|Y<<2),ee.lineTo($%n,$/n|0),u[$]||--Z}while(ie!==$);--_}return B=null,u=null,function($){$.save(),$.scale(1/c,-1/s),$.translate(0,-s),$.fill(ee),$.beginPath(),$.restore()}}class C{constructor(c,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=g.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=g.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=g.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,c,s])}clone(){const c=Object.create(this);return c.clipBox=this.clipBox.slice(),c}setCurrentPoint(c,s){this.x=c,this.y=s}updatePathMinMax(c,s,b){[s,b]=g.Util.applyTransform([s,b],c),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,b),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,b)}updateRectMinMax(c,s){const b=g.Util.applyTransform(s,c),L=g.Util.applyTransform(s.slice(2),c);this.minX=Math.min(this.minX,b[0],L[0]),this.minY=Math.min(this.minY,b[1],L[1]),this.maxX=Math.max(this.maxX,b[0],L[0]),this.maxY=Math.max(this.maxY,b[1],L[1])}updateScalingPathMinMax(c,s){g.Util.scaleMinMax(c,s),this.minX=Math.min(this.minX,s[0]),this.maxX=Math.max(this.maxX,s[1]),this.minY=Math.min(this.minY,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(c,s,b,L,n,u,_,R,O,j){const B=g.Util.bezierBoundingBox(s,b,L,n,u,_,R,O);if(j){j[0]=Math.min(j[0],B[0],B[2]),j[1]=Math.max(j[1],B[0],B[2]),j[2]=Math.min(j[2],B[1],B[3]),j[3]=Math.max(j[3],B[1],B[3]);return}this.updateRectMinMax(c,B)}getPathBoundingBox(c=U.PathType.FILL,s=null){const b=[this.minX,this.minY,this.maxX,this.maxY];if(c===U.PathType.STROKE){s||(0,g.unreachable)("Stroke bounding box must include transform.");const L=g.Util.singularValueDecompose2dScale(s),n=L[0]*this.lineWidth/2,u=L[1]*this.lineWidth/2;b[0]-=n,b[1]-=u,b[2]+=n,b[3]+=u}return b}updateClipFromPath(){const c=g.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(c||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(c){this.clipBox=c,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(c=U.PathType.FILL,s=null){return g.Util.intersect(this.clipBox,this.getPathBoundingBox(c,s))}}function v(y,c){if(typeof ImageData<"u"&&c instanceof ImageData){y.putImageData(c,0,0);return}const s=c.height,b=c.width,L=s%a,n=(s-L)/a,u=L===0?n:n+1,_=y.createImageData(b,a);let R=0,O;const j=c.data,B=_.data;let q,Z,z,ee;if(c.kind===g.ImageKind.GRAYSCALE_1BPP){const se=j.byteLength,$=new Uint32Array(B.buffer,0,B.byteLength>>2),J=$.length,ie=b+7>>3,Y=4294967295,re=g.FeatureTest.isLittleEndian?4278190080:255;for(q=0;q<u;q++){for(z=q<n?a:L,O=0,Z=0;Z<z;Z++){const ae=se-R;let le=0;const ce=ae>ie?b:ae*8-7,ue=ce&-8;let fe=0,de=0;for(;le<ue;le+=8)de=j[R++],$[O++]=de&128?Y:re,$[O++]=de&64?Y:re,$[O++]=de&32?Y:re,$[O++]=de&16?Y:re,$[O++]=de&8?Y:re,$[O++]=de&4?Y:re,$[O++]=de&2?Y:re,$[O++]=de&1?Y:re;for(;le<ce;le++)fe===0&&(de=j[R++],fe=128),$[O++]=de&fe?Y:re,fe>>=1}for(;O<J;)$[O++]=0;y.putImageData(_,0,q*a)}}else if(c.kind===g.ImageKind.RGBA_32BPP){for(Z=0,ee=b*a*4,q=0;q<n;q++)B.set(j.subarray(R,R+ee)),R+=ee,y.putImageData(_,0,Z),Z+=a;q<u&&(ee=b*L*4,B.set(j.subarray(R,R+ee)),y.putImageData(_,0,Z))}else if(c.kind===g.ImageKind.RGB_24BPP)for(z=a,ee=b*z,q=0;q<u;q++){for(q>=n&&(z=L,ee=b*z),O=0,Z=ee;Z--;)B[O++]=j[R++],B[O++]=j[R++],B[O++]=j[R++],B[O++]=255;y.putImageData(_,0,q*a)}else throw new Error(`bad image kind: ${c.kind}`)}function e(y,c){if(c.bitmap){y.drawImage(c.bitmap,0,0);return}const s=c.height,b=c.width,L=s%a,n=(s-L)/a,u=L===0?n:n+1,_=y.createImageData(b,a);let R=0;const O=c.data,j=_.data;for(let B=0;B<u;B++){const q=B<n?a:L;({srcPos:R}=(0,F.convertBlackAndWhiteToRGBA)({src:O,srcPos:R,dest:j,width:b,height:q,nonBlackColor:0})),y.putImageData(_,0,B*a)}}function r(y,c){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const b of s)y[b]!==void 0&&(c[b]=y[b]);y.setLineDash!==void 0&&(c.setLineDash(y.getLineDash()),c.lineDashOffset=y.lineDashOffset)}function w(y){y.strokeStyle=y.fillStyle="#000000",y.fillRule="nonzero",y.globalAlpha=1,y.lineWidth=1,y.lineCap="butt",y.lineJoin="miter",y.miterLimit=10,y.globalCompositeOperation="source-over",y.font="10px sans-serif",y.setLineDash!==void 0&&(y.setLineDash([]),y.lineDashOffset=0),S.isNodeJS||(y.filter="none")}function D(y,c,s,b){const L=y.length;for(let n=3;n<L;n+=4){const u=y[n];if(u===0)y[n-3]=c,y[n-2]=s,y[n-1]=b;else if(u<255){const _=255-u;y[n-3]=y[n-3]*u+c*_>>8,y[n-2]=y[n-2]*u+s*_>>8,y[n-1]=y[n-1]*u+b*_>>8}}}function T(y,c,s){const b=y.length,L=1/255;for(let n=3;n<b;n+=4){const u=s?s[y[n]]:y[n];c[n]=c[n]*u*L|0}}function I(y,c,s){const b=y.length;for(let L=3;L<b;L+=4){const n=y[L-3]*77+y[L-2]*152+y[L-1]*28;c[L]=s?c[L]*s[n>>8]>>8:c[L]*n>>16}}function V(y,c,s,b,L,n,u,_,R,O,j){const B=!!n,q=B?n[0]:0,Z=B?n[1]:0,z=B?n[2]:0;let ee;L==="Luminosity"?ee=I:ee=T;const $=Math.min(b,Math.ceil(1048576/s));for(let J=0;J<b;J+=$){const ie=Math.min($,b-J),Y=y.getImageData(_-O,J+(R-j),s,ie),re=c.getImageData(_,J+R,s,ie);B&&D(Y.data,q,Z,z),ee(Y.data,re.data,u),c.putImageData(re,_,J+R)}}function W(y,c,s,b){const L=b[0],n=b[1],u=b[2]-L,_=b[3]-n;u===0||_===0||(V(c.context,s,u,_,c.subtype,c.backdrop,c.transferMap,L,n,c.offsetX,c.offsetY),y.save(),y.globalAlpha=1,y.globalCompositeOperation="source-over",y.setTransform(1,0,0,1,0,0),y.drawImage(s.canvas,0,0),y.restore())}function te(y,c){const s=g.Util.singularValueDecompose2dScale(y);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const b=Math.fround((globalThis.devicePixelRatio||1)*M.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:s[0]<=b||s[1]<=b}const Q=["butt","round","square"],G=["miter","round","bevel"],H={},x={};class P{constructor(c,s,b,L,n,{optionalContentConfig:u,markedContentStack:_=null},R,O){this.ctx=c,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=b,this.canvasFactory=L,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=_||[],this.optionalContentConfig=u,this.cachedCanvases=new o(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=O,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(c,s=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):s}beginDrawing({transform:c,viewport:s,transparency:b=!1,background:L=null}){const n=this.ctx.canvas.width,u=this.ctx.canvas.height,_=this.ctx.fillStyle;if(this.ctx.fillStyle=L||"#ffffff",this.ctx.fillRect(0,0,n,u),this.ctx.fillStyle=_,b){const R=this.cachedCanvases.getCanvas("transparent",n,u);this.compositeCtx=this.ctx,this.transparentCanvas=R.canvas,this.ctx=R.context,this.ctx.save(),this.ctx.transform(...(0,M.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),w(this.ctx),c&&(this.ctx.transform(...c),this.outputScaleX=c[0],this.outputScaleY=c[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=(0,M.getCurrentTransform)(this.ctx)}executeOperatorList(c,s,b,L){const n=c.argsArray,u=c.fnArray;let _=s||0;const R=n.length;if(R===_)return _;const O=R-_>f&&typeof b=="function",j=O?Date.now()+m:0;let B=0;const q=this.commonObjs,Z=this.objs;let z;for(;;){if(L!==void 0&&_===L.nextBreakPoint)return L.breakIt(_,b),_;if(z=u[_],z!==g.OPS.dependency)this[z].apply(this,n[_]);else for(const ee of n[_]){const se=ee.startsWith("g_")?q:Z;if(!se.has(ee))return se.get(ee,b),_}if(_++,_===R)return _;if(O&&++B>f){if(Date.now()>j)return b(),_;B=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const c of this._cachedBitmapsMap.values()){for(const s of c.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);c.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const c=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(c!=="none"){const s=this.ctx.filter;this.ctx.filter=c,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=s}}}_scaleImage(c,s){const b=c.width,L=c.height;let n=Math.max(Math.hypot(s[0],s[1]),1),u=Math.max(Math.hypot(s[2],s[3]),1),_=b,R=L,O="prescale1",j,B;for(;n>2&&_>1||u>2&&R>1;){let q=_,Z=R;n>2&&_>1&&(q=_>=16384?Math.floor(_/2)-1||1:Math.ceil(_/2),n/=_/q),u>2&&R>1&&(Z=R>=16384?Math.floor(R/2)-1||1:Math.ceil(R)/2,u/=R/Z),j=this.cachedCanvases.getCanvas(O,q,Z),B=j.context,B.clearRect(0,0,q,Z),B.drawImage(c,0,0,_,R,0,0,q,Z),c=j.canvas,_=q,R=Z,O=O==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:_,paintHeight:R}}_createMaskCanvas(c){const s=this.ctx,{width:b,height:L}=c,n=this.current.fillColor,u=this.current.patternFill,_=(0,M.getCurrentTransform)(s);let R,O,j,B;if((c.bitmap||c.data)&&c.count>1){const le=c.bitmap||c.data.buffer;O=JSON.stringify(u?_:[_.slice(0,4),n]),R=this._cachedBitmapsMap.get(le),R||(R=new Map,this._cachedBitmapsMap.set(le,R));const ce=R.get(O);if(ce&&!u){const ue=Math.round(Math.min(_[0],_[2])+_[4]),fe=Math.round(Math.min(_[1],_[3])+_[5]);return{canvas:ce,offsetX:ue,offsetY:fe}}j=ce}j||(B=this.cachedCanvases.getCanvas("maskCanvas",b,L),e(B.context,c));let q=g.Util.transform(_,[1/b,0,0,-1/L,0,0]);q=g.Util.transform(q,[1,0,0,1,0,-L]);const Z=g.Util.applyTransform([0,0],q),z=g.Util.applyTransform([b,L],q),ee=g.Util.normalizeRect([Z[0],Z[1],z[0],z[1]]),se=Math.round(ee[2]-ee[0])||1,$=Math.round(ee[3]-ee[1])||1,J=this.cachedCanvases.getCanvas("fillCanvas",se,$),ie=J.context,Y=Math.min(Z[0],z[0]),re=Math.min(Z[1],z[1]);ie.translate(-Y,-re),ie.transform(...q),j||(j=this._scaleImage(B.canvas,(0,M.getCurrentTransformInverse)(ie)),j=j.img,R&&u&&R.set(O,j)),ie.imageSmoothingEnabled=te((0,M.getCurrentTransform)(ie),c.interpolate),d(ie,j,0,0,j.width,j.height,0,0,b,L),ie.globalCompositeOperation="source-in";const ae=g.Util.transform((0,M.getCurrentTransformInverse)(ie),[1,0,0,1,-Y,-re]);return ie.fillStyle=u?n.getPattern(s,this,ae,U.PathType.FILL):n,ie.fillRect(0,0,b,L),R&&!u&&(this.cachedCanvases.delete("fillCanvas"),R.set(O,J.canvas)),{canvas:J.canvas,offsetX:Math.round(Y),offsetY:Math.round(re)}}setLineWidth(c){c!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=Q[c]}setLineJoin(c){this.ctx.lineJoin=G[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,s){const b=this.ctx;b.setLineDash!==void 0&&(b.setLineDash(c),b.lineDashOffset=s)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(const[s,b]of c)switch(s){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b[0],b[1]);break;case"CA":this.current.strokeAlpha=b;break;case"ca":this.current.fillAlpha=b,this.ctx.globalAlpha=b;break;case"BM":this.ctx.globalCompositeOperation=b;break;case"SMask":this.current.activeSMask=b?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(b);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const c=this.inSMaskMode;this.current.activeSMask&&!c?this.beginSMaskMode():!this.current.activeSMask&&c&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const c=this.ctx.canvas.width,s=this.ctx.canvas.height,b="smaskGroupAt"+this.groupLevel,L=this.cachedCanvases.getCanvas(b,c,s);this.suspendedCtx=this.ctx,this.ctx=L.context;const n=this.ctx;n.setTransform(...(0,M.getCurrentTransform)(this.suspendedCtx)),r(this.suspendedCtx,n),p(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),r(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(c){if(!this.current.activeSMask)return;c?(c[0]=Math.floor(c[0]),c[1]=Math.floor(c[1]),c[2]=Math.ceil(c[2]),c[3]=Math.ceil(c[3])):c=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,b=this.suspendedCtx;W(b,s,this.ctx,c),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(r(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),r(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(c,s,b,L,n,u){this.ctx.transform(c,s,b,L,n,u),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(c,s,b){const L=this.ctx,n=this.current;let u=n.x,_=n.y,R,O;const j=(0,M.getCurrentTransform)(L),B=j[0]===0&&j[3]===0||j[1]===0&&j[2]===0,q=B?b.slice(0):null;for(let Z=0,z=0,ee=c.length;Z<ee;Z++)switch(c[Z]|0){case g.OPS.rectangle:u=s[z++],_=s[z++];const se=s[z++],$=s[z++],J=u+se,ie=_+$;L.moveTo(u,_),se===0||$===0?L.lineTo(J,ie):(L.lineTo(J,_),L.lineTo(J,ie),L.lineTo(u,ie)),B||n.updateRectMinMax(j,[u,_,J,ie]),L.closePath();break;case g.OPS.moveTo:u=s[z++],_=s[z++],L.moveTo(u,_),B||n.updatePathMinMax(j,u,_);break;case g.OPS.lineTo:u=s[z++],_=s[z++],L.lineTo(u,_),B||n.updatePathMinMax(j,u,_);break;case g.OPS.curveTo:R=u,O=_,u=s[z+4],_=s[z+5],L.bezierCurveTo(s[z],s[z+1],s[z+2],s[z+3],u,_),n.updateCurvePathMinMax(j,R,O,s[z],s[z+1],s[z+2],s[z+3],u,_,q),z+=6;break;case g.OPS.curveTo2:R=u,O=_,L.bezierCurveTo(u,_,s[z],s[z+1],s[z+2],s[z+3]),n.updateCurvePathMinMax(j,R,O,u,_,s[z],s[z+1],s[z+2],s[z+3],q),u=s[z+2],_=s[z+3],z+=4;break;case g.OPS.curveTo3:R=u,O=_,u=s[z+2],_=s[z+3],L.bezierCurveTo(s[z],s[z+1],u,_,u,_),n.updateCurvePathMinMax(j,R,O,s[z],s[z+1],u,_,u,_,q),z+=4;break;case g.OPS.closePath:L.closePath();break}B&&n.updateScalingPathMinMax(j,q),n.setCurrentPoint(u,_)}closePath(){this.ctx.closePath()}stroke(c=!0){const s=this.ctx,b=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof b=="object"&&b?.getPattern?(s.save(),s.strokeStyle=b.getPattern(s,this,(0,M.getCurrentTransformInverse)(s),U.PathType.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),c&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c=!0){const s=this.ctx,b=this.current.fillColor,L=this.current.patternFill;let n=!1;L&&(s.save(),s.fillStyle=b.getPattern(s,this,(0,M.getCurrentTransformInverse)(s),U.PathType.FILL),n=!0);const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),n&&s.restore(),c&&this.consumePath(u)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=H}eoClip(){this.pendingClip=x}beginText(){this.current.textMatrix=g.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,s=this.ctx;if(c===void 0){s.beginPath();return}s.save(),s.beginPath();for(const b of c)s.setTransform(...b.transform),s.translate(b.x,b.y),b.addToPath(s,b.fontSize);s.restore(),s.clip(),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,s){const b=this.commonObjs.get(c),L=this.current;if(!b)throw new Error(`Can't find font for ${c}`);if(L.fontMatrix=b.fontMatrix||g.FONT_IDENTITY_MATRIX,(L.fontMatrix[0]===0||L.fontMatrix[3]===0)&&(0,g.warn)("Invalid font matrix for font "+c),s<0?(s=-s,L.fontDirection=-1):L.fontDirection=1,this.current.font=b,this.current.fontSize=s,b.isType3Font)return;const n=b.loadedName||"sans-serif";let u="normal";b.black?u="900":b.bold&&(u="bold");const _=b.italic?"italic":"normal",R=`"${n}", ${b.fallbackName}`;let O=s;s<A?O=A:s>h&&(O=h),this.current.fontSizeScale=s/O,this.ctx.font=`${_} ${u} ${O}px ${R}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,s){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=s}setLeadingMoveText(c,s){this.setLeading(-s),this.moveText(c,s)}setTextMatrix(c,s,b,L,n,u){this.current.textMatrix=[c,s,b,L,n,u],this.current.textMatrixScale=Math.hypot(c,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,s,b,L){const n=this.ctx,u=this.current,_=u.font,R=u.textRenderingMode,O=u.fontSize/u.fontSizeScale,j=R&g.TextRenderingMode.FILL_STROKE_MASK,B=!!(R&g.TextRenderingMode.ADD_TO_PATH_FLAG),q=u.patternFill&&!_.missingFile;let Z;(_.disableFontFace||B||q)&&(Z=_.getPathGenerator(this.commonObjs,c)),_.disableFontFace||q?(n.save(),n.translate(s,b),n.beginPath(),Z(n,O),L&&n.setTransform(...L),(j===g.TextRenderingMode.FILL||j===g.TextRenderingMode.FILL_STROKE)&&n.fill(),(j===g.TextRenderingMode.STROKE||j===g.TextRenderingMode.FILL_STROKE)&&n.stroke(),n.restore()):((j===g.TextRenderingMode.FILL||j===g.TextRenderingMode.FILL_STROKE)&&n.fillText(c,s,b),(j===g.TextRenderingMode.STROKE||j===g.TextRenderingMode.FILL_STROKE)&&n.strokeText(c,s,b)),B&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,M.getCurrentTransform)(n),x:s,y:b,fontSize:O,addToPath:Z})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const s=c.getImageData(0,0,10,10).data;let b=!1;for(let L=3;L<s.length;L+=4)if(s[L]>0&&s[L]<255){b=!0;break}return(0,g.shadow)(this,"isFontSubpixelAAEnabled",b)}showText(c){const s=this.current,b=s.font;if(b.isType3Font)return this.showType3Text(c);const L=s.fontSize;if(L===0)return;const n=this.ctx,u=s.fontSizeScale,_=s.charSpacing,R=s.wordSpacing,O=s.fontDirection,j=s.textHScale*O,B=c.length,q=b.vertical,Z=q?1:-1,z=b.defaultVMetrics,ee=L*s.fontMatrix[0],se=s.textRenderingMode===g.TextRenderingMode.FILL&&!b.disableFontFace&&!s.patternFill;n.save(),n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),O>0?n.scale(j,-1):n.scale(j,1);let $;if(s.patternFill){n.save();const ae=s.fillColor.getPattern(n,this,(0,M.getCurrentTransformInverse)(n),U.PathType.FILL);$=(0,M.getCurrentTransform)(n),n.restore(),n.fillStyle=ae}let J=s.lineWidth;const ie=s.textMatrixScale;if(ie===0||J===0){const ae=s.textRenderingMode&g.TextRenderingMode.FILL_STROKE_MASK;(ae===g.TextRenderingMode.STROKE||ae===g.TextRenderingMode.FILL_STROKE)&&(J=this.getSinglePixelWidth())}else J/=ie;if(u!==1&&(n.scale(u,u),J/=u),n.lineWidth=J,b.isInvalidPDFjsFont){const ae=[];let le=0;for(const ce of c)ae.push(ce.unicode),le+=ce.width;n.fillText(ae.join(""),0,0),s.x+=le*ee*j,n.restore(),this.compose();return}let Y=0,re;for(re=0;re<B;++re){const ae=c[re];if(typeof ae=="number"){Y+=Z*ae*L/1e3;continue}let le=!1;const ce=(ae.isSpace?R:0)+_,ue=ae.fontChar,fe=ae.accent;let de,Ae,ve=ae.width;if(q){const me=ae.vmetric||z,ye=-(ae.vmetric?me[1]:ve*.5)*ee,Me=me[2]*ee;ve=me?-me[0]:ve,de=ye/u,Ae=(Y+Me)/u}else de=Y/u,Ae=0;if(b.remeasure&&ve>0){const me=n.measureText(ue).width*1e3/L*u;if(ve<me&&this.isFontSubpixelAAEnabled){const ye=ve/me;le=!0,n.save(),n.scale(ye,1),de/=ye}else ve!==me&&(de+=(ve-me)/2e3*L/u)}if(this.contentVisible&&(ae.isInFont||b.missingFile)){if(se&&!fe)n.fillText(ue,de,Ae);else if(this.paintChar(ue,de,Ae,$),fe){const me=de+L*fe.offset.x/u,ye=Ae-L*fe.offset.y/u;this.paintChar(fe.fontChar,me,ye,$)}}let Te;q?Te=ve*ee-ce*O:Te=ve*ee+ce*O,Y+=Te,le&&n.restore()}q?s.y-=Y:s.x+=Y*j,n.restore(),this.compose()}showType3Text(c){const s=this.ctx,b=this.current,L=b.font,n=b.fontSize,u=b.fontDirection,_=L.vertical?1:-1,R=b.charSpacing,O=b.wordSpacing,j=b.textHScale*u,B=b.fontMatrix||g.FONT_IDENTITY_MATRIX,q=c.length,Z=b.textRenderingMode===g.TextRenderingMode.INVISIBLE;let z,ee,se,$;if(!(Z||n===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,s.save(),s.transform(...b.textMatrix),s.translate(b.x,b.y),s.scale(j,u),z=0;z<q;++z){if(ee=c[z],typeof ee=="number"){$=_*ee*n/1e3,this.ctx.translate($,0),b.x+=$*j;continue}const J=(ee.isSpace?O:0)+R,ie=L.charProcOperatorList[ee.operatorListId];if(!ie){(0,g.warn)(`Type3 character "${ee.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ee,this.save(),s.scale(n,n),s.transform(...B),this.executeOperatorList(ie),this.restore()),se=g.Util.applyTransform([ee.width,0],B)[0]*n+J,s.translate(se,0),b.x+=se*j}s.restore(),this.processingType3=null}}setCharWidth(c,s){}setCharWidthAndBounds(c,s,b,L,n,u){this.ctx.rect(b,L,n-b,u-L),this.ctx.clip(),this.endPath()}getColorN_Pattern(c){let s;if(c[0]==="TilingPattern"){const b=c[1],L=this.baseTransform||(0,M.getCurrentTransform)(this.ctx),n={createCanvasGraphics:u=>new P(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};s=new U.TilingPattern(c,b,this.ctx,n,L)}else s=this._getPattern(c[1],c[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,s,b){const L=g.Util.makeHexColor(c,s,b);this.ctx.strokeStyle=L,this.current.strokeColor=L}setFillRGBColor(c,s,b){const L=g.Util.makeHexColor(c,s,b);this.ctx.fillStyle=L,this.current.fillColor=L,this.current.patternFill=!1}_getPattern(c,s=null){let b;return this.cachedPatterns.has(c)?b=this.cachedPatterns.get(c):(b=(0,U.getShadingPattern)(this.getObject(c)),this.cachedPatterns.set(c,b)),s&&(b.matrix=s),b}shadingFill(c){if(!this.contentVisible)return;const s=this.ctx;this.save();const b=this._getPattern(c);s.fillStyle=b.getPattern(s,this,(0,M.getCurrentTransformInverse)(s),U.PathType.SHADING);const L=(0,M.getCurrentTransformInverse)(s);if(L){const n=s.canvas,u=n.width,_=n.height,R=g.Util.applyTransform([0,0],L),O=g.Util.applyTransform([0,_],L),j=g.Util.applyTransform([u,0],L),B=g.Util.applyTransform([u,_],L),q=Math.min(R[0],O[0],j[0],B[0]),Z=Math.min(R[1],O[1],j[1],B[1]),z=Math.max(R[0],O[0],j[0],B[0]),ee=Math.max(R[1],O[1],j[1],B[1]);this.ctx.fillRect(q,Z,z-q,ee-Z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,g.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,g.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform(...c),this.baseTransform=(0,M.getCurrentTransform)(this.ctx),s)){const b=s[2]-s[0],L=s[3]-s[1];this.ctx.rect(s[0],s[1],b,L),this.current.updateRectMinMax((0,M.getCurrentTransform)(this.ctx),s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;c.isolated||(0,g.info)("TODO: Support non-isolated groups."),c.knockout&&(0,g.warn)("Knockout groups not supported.");const b=(0,M.getCurrentTransform)(s);if(c.matrix&&s.transform(...c.matrix),!c.bbox)throw new Error("Bounding box is required.");let L=g.Util.getAxialAlignedBoundingBox(c.bbox,(0,M.getCurrentTransform)(s));const n=[0,0,s.canvas.width,s.canvas.height];L=g.Util.intersect(L,n)||[0,0,0,0];const u=Math.floor(L[0]),_=Math.floor(L[1]);let R=Math.max(Math.ceil(L[2])-u,1),O=Math.max(Math.ceil(L[3])-_,1),j=1,B=1;R>t&&(j=R/t,R=t),O>t&&(B=O/t,O=t),this.current.startNewPathAndClipBox([0,0,R,O]);let q="groupAt"+this.groupLevel;c.smask&&(q+="_smask_"+this.smaskCounter++%2);const Z=this.cachedCanvases.getCanvas(q,R,O),z=Z.context;z.scale(1/j,1/B),z.translate(-u,-_),z.transform(...b),c.smask?this.smaskStack.push({canvas:Z.canvas,context:z,offsetX:u,offsetY:_,scaleX:j,scaleY:B,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(u,_),s.scale(j,B),s.save()),r(s,z),this.ctx=z,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,b=this.groupStack.pop();if(this.ctx=b,this.ctx.imageSmoothingEnabled=!1,c.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const L=(0,M.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...L);const n=g.Util.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],L);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(c,s,b,L,n){if(this.#e(),w(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(s)&&s.length===4){const u=s[2]-s[0],_=s[3]-s[1];if(n&&this.annotationCanvasMap){b=b.slice(),b[4]-=s[0],b[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=_;const[R,O]=g.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(this.ctx)),{viewportScale:j}=this,B=Math.ceil(u*this.outputScaleX*j),q=Math.ceil(_*this.outputScaleY*j);this.annotationCanvas=this.canvasFactory.create(B,q);const{canvas:Z,context:z}=this.annotationCanvas;this.annotationCanvasMap.set(c,Z),this.annotationCanvas.savedCtx=this.ctx,this.ctx=z,this.ctx.save(),this.ctx.setTransform(R,0,0,-O,0,_*O),w(this.ctx)}else w(this.ctx),this.ctx.rect(s[0],s[1],u,_),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...b),this.transform(...L)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(c){if(!this.contentVisible)return;const s=c.count;c=this.getObject(c.data,c),c.count=s;const b=this.ctx,L=this.processingType3;if(L&&(L.compiled===void 0&&(L.compiled=E(c)),L.compiled)){L.compiled(b);return}const n=this._createMaskCanvas(c),u=n.canvas;b.save(),b.setTransform(1,0,0,1,0,0),b.drawImage(u,n.offsetX,n.offsetY),b.restore(),this.compose()}paintImageMaskXObjectRepeat(c,s,b=0,L=0,n,u){if(!this.contentVisible)return;c=this.getObject(c.data,c);const _=this.ctx;_.save();const R=(0,M.getCurrentTransform)(_);_.transform(s,b,L,n,0,0);const O=this._createMaskCanvas(c);_.setTransform(1,0,0,1,O.offsetX-R[4],O.offsetY-R[5]);for(let j=0,B=u.length;j<B;j+=2){const q=g.Util.transform(R,[s,b,L,n,u[j],u[j+1]]),[Z,z]=g.Util.applyTransform([0,0],q);_.drawImage(O.canvas,Z,z)}_.restore(),this.compose()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const s=this.ctx,b=this.current.fillColor,L=this.current.patternFill;for(const n of c){const{data:u,width:_,height:R,transform:O}=n,j=this.cachedCanvases.getCanvas("maskCanvas",_,R),B=j.context;B.save();const q=this.getObject(u,n);e(B,q),B.globalCompositeOperation="source-in",B.fillStyle=L?b.getPattern(B,this,(0,M.getCurrentTransformInverse)(s),U.PathType.FILL):b,B.fillRect(0,0,_,R),B.restore(),s.save(),s.transform(...O),s.scale(1,-1),d(s,j.canvas,0,0,_,R,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(c){if(!this.contentVisible)return;const s=this.getObject(c);if(!s){(0,g.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(c,s,b,L){if(!this.contentVisible)return;const n=this.getObject(c);if(!n){(0,g.warn)("Dependent image isn't ready yet");return}const u=n.width,_=n.height,R=[];for(let O=0,j=L.length;O<j;O+=2)R.push({transform:[s,0,0,b,L[O],L[O+1]],x:0,y:0,w:u,h:_});this.paintInlineImageXObjectGroup(n,R)}applyTransferMapsToCanvas(c){return this.current.transferMaps!=="none"&&(c.filter=this.current.transferMaps,c.drawImage(c.canvas,0,0),c.filter="none"),c.canvas}applyTransferMapsToBitmap(c){if(this.current.transferMaps==="none")return c.bitmap;const{bitmap:s,width:b,height:L}=c,n=this.cachedCanvases.getCanvas("inlineImage",b,L),u=n.context;return u.filter=this.current.transferMaps,u.drawImage(s,0,0),u.filter="none",n.canvas}paintInlineImageXObject(c){if(!this.contentVisible)return;const s=c.width,b=c.height,L=this.ctx;this.save(),S.isNodeJS||(L.filter="none"),L.scale(1/s,-1/b);let n;if(c.bitmap)n=this.applyTransferMapsToBitmap(c);else if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)n=c;else{const R=this.cachedCanvases.getCanvas("inlineImage",s,b).context;v(R,c),n=this.applyTransferMapsToCanvas(R)}const u=this._scaleImage(n,(0,M.getCurrentTransformInverse)(L));L.imageSmoothingEnabled=te((0,M.getCurrentTransform)(L),c.interpolate),d(L,u.img,0,0,u.paintWidth,u.paintHeight,0,-b,s,b),this.compose(),this.restore()}paintInlineImageXObjectGroup(c,s){if(!this.contentVisible)return;const b=this.ctx;let L;if(c.bitmap)L=c.bitmap;else{const n=c.width,u=c.height,R=this.cachedCanvases.getCanvas("inlineImage",n,u).context;v(R,c),L=this.applyTransferMapsToCanvas(R)}for(const n of s)b.save(),b.transform(...n.transform),b.scale(1,-1),d(b,L,n.x,n.y,n.w,n.h,0,-1,1,1),b.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(c){}markPointProps(c,s){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,s){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(c){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(c);const b=this.ctx;this.pendingClip&&(s||(this.pendingClip===x?b.clip("evenodd"):b.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),b.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const c=(0,M.getCurrentTransform)(this.ctx);if(c[1]===0&&c[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(c[0]),Math.abs(c[3]));else{const s=Math.abs(c[0]*c[3]-c[2]*c[1]),b=Math.hypot(c[0],c[2]),L=Math.hypot(c[1],c[3]);this._cachedGetSinglePixelWidth=Math.max(b,L)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:c}=this.current,s=(0,M.getCurrentTransform)(this.ctx);let b,L;if(s[1]===0&&s[2]===0){const n=Math.abs(s[0]),u=Math.abs(s[3]);if(c===0)b=1/n,L=1/u;else{const _=n*c,R=u*c;b=_<1?1/_:1,L=R<1?1/R:1}}else{const n=Math.abs(s[0]*s[3]-s[2]*s[1]),u=Math.hypot(s[0],s[1]),_=Math.hypot(s[2],s[3]);if(c===0)b=_/n,L=u/n;else{const R=c*n;b=_>R?_/R:1,L=u>R?u/R:1}}this._cachedScaleForStroking=[b,L]}return this._cachedScaleForStroking}rescaleAndStroke(c){const{ctx:s}=this,{lineWidth:b}=this.current,[L,n]=this.getScaleForStroking();if(s.lineWidth=b||1,L===1&&n===1){s.stroke();return}let u,_,R;c&&(u=(0,M.getCurrentTransform)(s),_=s.getLineDash().slice(),R=s.lineDashOffset),s.scale(L,n);const O=Math.max(L,n);s.setLineDash(s.getLineDash().map(j=>j/O)),s.lineDashOffset/=O,s.stroke(),c&&(s.setTransform(...u),s.setLineDash(_),s.lineDashOffset=R)}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}}l.CanvasGraphics=P;for(const y in g.OPS)P.prototype[y]!==void 0&&(P.prototype[g.OPS[y]]=P.prototype[y])}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.TilingPattern=l.PathType=void 0,l.getShadingPattern=i;var g=k(1),M=k(6);const U={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};l.PathType=U;function F(o,d){if(!d)return;const E=d[2]-d[0],C=d[3]-d[1],v=new Path2D;v.rect(d[0],d[1],E,C),o.clip(v)}class S{constructor(){this.constructor===S&&(0,g.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,g.unreachable)("Abstract method `getPattern` called.")}}class A extends S{constructor(d){super(),this._type=d[1],this._bbox=d[2],this._colorStops=d[3],this._p0=d[4],this._p1=d[5],this._r0=d[6],this._r1=d[7],this.matrix=null}_createGradient(d){let E;this._type==="axial"?E=d.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(E=d.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const C of this._colorStops)E.addColorStop(C[0],C[1]);return E}getPattern(d,E,C,v){let e;if(v===U.STROKE||v===U.FILL){const r=E.current.getClippedPathBoundingBox(v,(0,M.getCurrentTransform)(d))||[0,0,0,0],w=Math.ceil(r[2]-r[0])||1,D=Math.ceil(r[3]-r[1])||1,T=E.cachedCanvases.getCanvas("pattern",w,D,!0),I=T.context;I.clearRect(0,0,I.canvas.width,I.canvas.height),I.beginPath(),I.rect(0,0,I.canvas.width,I.canvas.height),I.translate(-r[0],-r[1]),C=g.Util.transform(C,[1,0,0,1,r[0],r[1]]),I.transform(...E.baseTransform),this.matrix&&I.transform(...this.matrix),F(I,this._bbox),I.fillStyle=this._createGradient(I),I.fill(),e=d.createPattern(T.canvas,"no-repeat");const V=new DOMMatrix(C);e.setTransform(V)}else F(d,this._bbox),e=this._createGradient(d);return e}}function h(o,d,E,C,v,e,r,w){const D=d.coords,T=d.colors,I=o.data,V=o.width*4;let W;D[E+1]>D[C+1]&&(W=E,E=C,C=W,W=e,e=r,r=W),D[C+1]>D[v+1]&&(W=C,C=v,v=W,W=r,r=w,w=W),D[E+1]>D[C+1]&&(W=E,E=C,C=W,W=e,e=r,r=W);const te=(D[E]+d.offsetX)*d.scaleX,Q=(D[E+1]+d.offsetY)*d.scaleY,G=(D[C]+d.offsetX)*d.scaleX,H=(D[C+1]+d.offsetY)*d.scaleY,x=(D[v]+d.offsetX)*d.scaleX,P=(D[v+1]+d.offsetY)*d.scaleY;if(Q>=P)return;const y=T[e],c=T[e+1],s=T[e+2],b=T[r],L=T[r+1],n=T[r+2],u=T[w],_=T[w+1],R=T[w+2],O=Math.round(Q),j=Math.round(P);let B,q,Z,z,ee,se,$,J;for(let ie=O;ie<=j;ie++){if(ie<H){let ce;ie<Q?ce=0:ce=(Q-ie)/(Q-H),B=te-(te-G)*ce,q=y-(y-b)*ce,Z=c-(c-L)*ce,z=s-(s-n)*ce}else{let ce;ie>P?ce=1:H===P?ce=0:ce=(H-ie)/(H-P),B=G-(G-x)*ce,q=b-(b-u)*ce,Z=L-(L-_)*ce,z=n-(n-R)*ce}let Y;ie<Q?Y=0:ie>P?Y=1:Y=(Q-ie)/(Q-P),ee=te-(te-x)*Y,se=y-(y-u)*Y,$=c-(c-_)*Y,J=s-(s-R)*Y;const re=Math.round(Math.min(B,ee)),ae=Math.round(Math.max(B,ee));let le=V*ie+re*4;for(let ce=re;ce<=ae;ce++)Y=(B-ce)/(B-ee),Y<0?Y=0:Y>1&&(Y=1),I[le++]=q-(q-se)*Y|0,I[le++]=Z-(Z-$)*Y|0,I[le++]=z-(z-J)*Y|0,I[le++]=255}}function t(o,d,E){const C=d.coords,v=d.colors;let e,r;switch(d.type){case"lattice":const w=d.verticesPerRow,D=Math.floor(C.length/w)-1,T=w-1;for(e=0;e<D;e++){let I=e*w;for(let V=0;V<T;V++,I++)h(o,E,C[I],C[I+1],C[I+w],v[I],v[I+1],v[I+w]),h(o,E,C[I+w+1],C[I+1],C[I+w],v[I+w+1],v[I+1],v[I+w])}break;case"triangles":for(e=0,r=C.length;e<r;e+=3)h(o,E,C[e],C[e+1],C[e+2],v[e],v[e+1],v[e+2]);break;default:throw new Error("illegal figure")}}class m extends S{constructor(d){super(),this._coords=d[2],this._colors=d[3],this._figures=d[4],this._bounds=d[5],this._bbox=d[7],this._background=d[8],this.matrix=null}_createMeshCanvas(d,E,C){const w=Math.floor(this._bounds[0]),D=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-w,I=Math.ceil(this._bounds[3])-D,V=Math.min(Math.ceil(Math.abs(T*d[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(I*d[1]*1.1)),3e3),te=T/V,Q=I/W,G={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-D,scaleX:1/te,scaleY:1/Q},H=V+4,x=W+4,P=C.getCanvas("mesh",H,x,!1),y=P.context,c=y.createImageData(V,W);if(E){const b=c.data;for(let L=0,n=b.length;L<n;L+=4)b[L]=E[0],b[L+1]=E[1],b[L+2]=E[2],b[L+3]=255}for(const b of this._figures)t(c,b,G);return y.putImageData(c,2,2),{canvas:P.canvas,offsetX:w-2*te,offsetY:D-2*Q,scaleX:te,scaleY:Q}}getPattern(d,E,C,v){F(d,this._bbox);let e;if(v===U.SHADING)e=g.Util.singularValueDecompose2dScale((0,M.getCurrentTransform)(d));else if(e=g.Util.singularValueDecompose2dScale(E.baseTransform),this.matrix){const w=g.Util.singularValueDecompose2dScale(this.matrix);e=[e[0]*w[0],e[1]*w[1]]}const r=this._createMeshCanvas(e,v===U.SHADING?null:this._background,E.cachedCanvases);return v!==U.SHADING&&(d.setTransform(...E.baseTransform),this.matrix&&d.transform(...this.matrix)),d.translate(r.offsetX,r.offsetY),d.scale(r.scaleX,r.scaleY),d.createPattern(r.canvas,"no-repeat")}}class f extends S{getPattern(){return"hotpink"}}function i(o){switch(o[0]){case"RadialAxial":return new A(o);case"Mesh":return new m(o);case"Dummy":return new f}throw new Error(`Unknown IR type: ${o[0]}`)}const a={COLORED:1,UNCOLORED:2};class p{static MAX_PATTERN_SIZE=3e3;constructor(d,E,C,v,e){this.operatorList=d[2],this.matrix=d[3]||[1,0,0,1,0,0],this.bbox=d[4],this.xstep=d[5],this.ystep=d[6],this.paintType=d[7],this.tilingType=d[8],this.color=E,this.ctx=C,this.canvasGraphicsFactory=v,this.baseTransform=e}createPatternCanvas(d){const E=this.operatorList,C=this.bbox,v=this.xstep,e=this.ystep,r=this.paintType,w=this.tilingType,D=this.color,T=this.canvasGraphicsFactory;(0,g.info)("TilingType: "+w);const I=C[0],V=C[1],W=C[2],te=C[3],Q=g.Util.singularValueDecompose2dScale(this.matrix),G=g.Util.singularValueDecompose2dScale(this.baseTransform),H=[Q[0]*G[0],Q[1]*G[1]],x=this.getSizeAndScale(v,this.ctx.canvas.width,H[0]),P=this.getSizeAndScale(e,this.ctx.canvas.height,H[1]),y=d.cachedCanvases.getCanvas("pattern",x.size,P.size,!0),c=y.context,s=T.createCanvasGraphics(c);s.groupLevel=d.groupLevel,this.setFillAndStrokeStyleToContext(s,r,D);let b=I,L=V,n=W,u=te;return I<0&&(b=0,n+=Math.abs(I)),V<0&&(L=0,u+=Math.abs(V)),c.translate(-(x.scale*b),-(P.scale*L)),s.transform(x.scale,0,0,P.scale,0,0),c.save(),this.clipBbox(s,b,L,n,u),s.baseTransform=(0,M.getCurrentTransform)(s.ctx),s.executeOperatorList(E),s.endDrawing(),{canvas:y.canvas,scaleX:x.scale,scaleY:P.scale,offsetX:b,offsetY:L}}getSizeAndScale(d,E,C){d=Math.abs(d);const v=Math.max(p.MAX_PATTERN_SIZE,E);let e=Math.ceil(d*C);return e>=v?e=v:C=e/d,{scale:C,size:e}}clipBbox(d,E,C,v,e){const r=v-E,w=e-C;d.ctx.rect(E,C,r,w),d.current.updateRectMinMax((0,M.getCurrentTransform)(d.ctx),[E,C,v,e]),d.clip(),d.endPath()}setFillAndStrokeStyleToContext(d,E,C){const v=d.ctx,e=d.current;switch(E){case a.COLORED:const r=this.ctx;v.fillStyle=r.fillStyle,v.strokeStyle=r.strokeStyle,e.fillColor=r.fillStyle,e.strokeColor=r.strokeStyle;break;case a.UNCOLORED:const w=g.Util.makeHexColor(C[0],C[1],C[2]);v.fillStyle=w,v.strokeStyle=w,e.fillColor=w,e.strokeColor=w;break;default:throw new g.FormatError(`Unsupported paint type: ${E}`)}}getPattern(d,E,C,v){let e=C;v!==U.SHADING&&(e=g.Util.transform(e,E.baseTransform),this.matrix&&(e=g.Util.transform(e,this.matrix)));const r=this.createPatternCanvas(E);let w=new DOMMatrix(e);w=w.translate(r.offsetX,r.offsetY),w=w.scale(1/r.scaleX,1/r.scaleY);const D=d.createPattern(r.canvas,"repeat");return D.setTransform(w),D}}l.TilingPattern=p}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.convertBlackAndWhiteToRGBA=U,l.convertToRGBA=M,l.grayToRGBA=S;var g=k(1);function M(A){switch(A.kind){case g.ImageKind.GRAYSCALE_1BPP:return U(A);case g.ImageKind.RGB_24BPP:return F(A)}return null}function U({src:A,srcPos:h=0,dest:t,width:m,height:f,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const p=g.FeatureTest.isLittleEndian?4278190080:255,[o,d]=a?[i,p]:[p,i],E=m>>3,C=m&7,v=A.length;t=new Uint32Array(t.buffer);let e=0;for(let r=0;r<f;r++){for(const D=h+E;h<D;h++){const T=h<v?A[h]:255;t[e++]=T&128?d:o,t[e++]=T&64?d:o,t[e++]=T&32?d:o,t[e++]=T&16?d:o,t[e++]=T&8?d:o,t[e++]=T&4?d:o,t[e++]=T&2?d:o,t[e++]=T&1?d:o}if(C===0)continue;const w=h<v?A[h++]:255;for(let D=0;D<C;D++)t[e++]=w&1<<7-D?d:o}return{srcPos:h,destPos:e}}function F({src:A,srcPos:h=0,dest:t,destPos:m=0,width:f,height:i}){let a=0;const p=A.length>>2,o=new Uint32Array(A.buffer,h,p);if(g.FeatureTest.isLittleEndian){for(;a<p-2;a+=3,m+=4){const d=o[a],E=o[a+1],C=o[a+2];t[m]=d|4278190080,t[m+1]=d>>>24|E<<8|4278190080,t[m+2]=E>>>16|C<<16|4278190080,t[m+3]=C>>>8|4278190080}for(let d=a*4,E=A.length;d<E;d+=3)t[m++]=A[d]|A[d+1]<<8|A[d+2]<<16|4278190080}else{for(;a<p-2;a+=3,m+=4){const d=o[a],E=o[a+1],C=o[a+2];t[m]=d|255,t[m+1]=d<<24|E>>>8|255,t[m+2]=E<<16|C>>>16|255,t[m+3]=C<<8|255}for(let d=a*4,E=A.length;d<E;d+=3)t[m++]=A[d]<<24|A[d+1]<<16|A[d+2]<<8|255}return{srcPos:h,destPos:m}}function S(A,h){if(g.FeatureTest.isLittleEndian)for(let t=0,m=A.length;t<m;t++)h[t]=A[t]*65793|4278190080;else for(let t=0,m=A.length;t<m;t++)h[t]=A[t]*16843008|255}}),((N,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.GlobalWorkerOptions=void 0;const k=Object.create(null);l.GlobalWorkerOptions=k,k.workerPort=null,k.workerSrc=""}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.MessageHandler=void 0;var g=k(1);const M={DATA:1,ERROR:2},U={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function F(A){switch(A instanceof Error||typeof A=="object"&&A!==null||(0,g.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),A.name){case"AbortException":return new g.AbortException(A.message);case"MissingPDFException":return new g.MissingPDFException(A.message);case"PasswordException":return new g.PasswordException(A.message,A.code);case"UnexpectedResponseException":return new g.UnexpectedResponseException(A.message,A.status);case"UnknownErrorException":return new g.UnknownErrorException(A.message,A.details);default:return new g.UnknownErrorException(A.message,A.toString())}}class S{constructor(h,t,m){this.sourceName=h,this.targetName=t,this.comObj=m,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=f=>{const i=f.data;if(i.targetName!==this.sourceName)return;if(i.stream){this.#t(i);return}if(i.callback){const p=i.callbackId,o=this.callbackCapabilities[p];if(!o)throw new Error(`Cannot resolve callback ${p}`);if(delete this.callbackCapabilities[p],i.callback===M.DATA)o.resolve(i.data);else if(i.callback===M.ERROR)o.reject(F(i.reason));else throw new Error("Unexpected callback case");return}const a=this.actionHandler[i.action];if(!a)throw new Error(`Unknown action from worker: ${i.action}`);if(i.callbackId){const p=this.sourceName,o=i.sourceName;new Promise(function(d){d(a(i.data))}).then(function(d){m.postMessage({sourceName:p,targetName:o,callback:M.DATA,callbackId:i.callbackId,data:d})},function(d){m.postMessage({sourceName:p,targetName:o,callback:M.ERROR,callbackId:i.callbackId,reason:F(d)})});return}if(i.streamId){this.#e(i);return}a(i.data)},m.addEventListener("message",this._onComObjOnMessage)}on(h,t){const m=this.actionHandler;if(m[h])throw new Error(`There is already an actionName called "${h}"`);m[h]=t}send(h,t,m){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:t},m)}sendWithPromise(h,t,m){const f=this.callbackId++,i=new g.PromiseCapability;this.callbackCapabilities[f]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:f,data:t},m)}catch(a){i.reject(a)}return i.promise}sendWithStream(h,t,m,f){const i=this.streamId++,a=this.sourceName,p=this.targetName,o=this.comObj;return new ReadableStream({start:d=>{const E=new g.PromiseCapability;return this.streamControllers[i]={controller:d,startCall:E,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:a,targetName:p,action:h,streamId:i,data:t,desiredSize:d.desiredSize},f),E.promise},pull:d=>{const E=new g.PromiseCapability;return this.streamControllers[i].pullCall=E,o.postMessage({sourceName:a,targetName:p,stream:U.PULL,streamId:i,desiredSize:d.desiredSize}),E.promise},cancel:d=>{(0,g.assert)(d instanceof Error,"cancel must have a valid reason");const E=new g.PromiseCapability;return this.streamControllers[i].cancelCall=E,this.streamControllers[i].isClosed=!0,o.postMessage({sourceName:a,targetName:p,stream:U.CANCEL,streamId:i,reason:F(d)}),E.promise}},m)}#e(h){const t=h.streamId,m=this.sourceName,f=h.sourceName,i=this.comObj,a=this,p=this.actionHandler[h.action],o={enqueue(d,E=1,C){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=E,v>0&&this.desiredSize<=0&&(this.sinkCapability=new g.PromiseCapability,this.ready=this.sinkCapability.promise),i.postMessage({sourceName:m,targetName:f,stream:U.ENQUEUE,streamId:t,chunk:d},C)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:m,targetName:f,stream:U.CLOSE,streamId:t}),delete a.streamSinks[t])},error(d){(0,g.assert)(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:m,targetName:f,stream:U.ERROR,streamId:t,reason:F(d)}))},sinkCapability:new g.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,new Promise(function(d){d(p(h.data,o))}).then(function(){i.postMessage({sourceName:m,targetName:f,stream:U.START_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:m,targetName:f,stream:U.START_COMPLETE,streamId:t,reason:F(d)})})}#t(h){const t=h.streamId,m=this.sourceName,f=h.sourceName,i=this.comObj,a=this.streamControllers[t],p=this.streamSinks[t];switch(h.stream){case U.START_COMPLETE:h.success?a.startCall.resolve():a.startCall.reject(F(h.reason));break;case U.PULL_COMPLETE:h.success?a.pullCall.resolve():a.pullCall.reject(F(h.reason));break;case U.PULL:if(!p){i.postMessage({sourceName:m,targetName:f,stream:U.PULL_COMPLETE,streamId:t,success:!0});break}p.desiredSize<=0&&h.desiredSize>0&&p.sinkCapability.resolve(),p.desiredSize=h.desiredSize,new Promise(function(o){o(p.onPull?.())}).then(function(){i.postMessage({sourceName:m,targetName:f,stream:U.PULL_COMPLETE,streamId:t,success:!0})},function(o){i.postMessage({sourceName:m,targetName:f,stream:U.PULL_COMPLETE,streamId:t,reason:F(o)})});break;case U.ENQUEUE:if((0,g.assert)(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(h.chunk);break;case U.CLOSE:if((0,g.assert)(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#i(a,t);break;case U.ERROR:(0,g.assert)(a,"error should have stream controller"),a.controller.error(F(h.reason)),this.#i(a,t);break;case U.CANCEL_COMPLETE:h.success?a.cancelCall.resolve():a.cancelCall.reject(F(h.reason)),this.#i(a,t);break;case U.CANCEL:if(!p)break;new Promise(function(o){o(p.onCancel?.(F(h.reason)))}).then(function(){i.postMessage({sourceName:m,targetName:f,stream:U.CANCEL_COMPLETE,streamId:t,success:!0})},function(o){i.postMessage({sourceName:m,targetName:f,stream:U.CANCEL_COMPLETE,streamId:t,reason:F(o)})}),p.sinkCapability.reject(F(h.reason)),p.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(h,t){await Promise.allSettled([h.startCall?.promise,h.pullCall?.promise,h.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}l.MessageHandler=S}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.Metadata=void 0;var g=k(1);class M{#e;#t;constructor({parsedData:F,rawData:S}){this.#e=F,this.#t=S}getRaw(){return this.#t}get(F){return this.#e.get(F)??null}getAll(){return(0,g.objectFromMap)(this.#e)}has(F){return this.#e.has(F)}}l.Metadata=M}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.OptionalContentConfig=void 0;var g=k(1),M=k(8);const U=Symbol("INTERNAL");class F{#e=!0;constructor(h,t){this.name=h,this.intent=t}get visible(){return this.#e}_setVisible(h,t){h!==U&&(0,g.unreachable)("Internal method `_setVisible` called."),this.#e=t}}class S{#e=null;#t=new Map;#i=null;#n=null;constructor(h){if(this.name=null,this.creator=null,h!==null){this.name=h.name,this.creator=h.creator,this.#n=h.order;for(const t of h.groups)this.#t.set(t.id,new F(t.name,t.intent));if(h.baseState==="OFF")for(const t of this.#t.values())t._setVisible(U,!1);for(const t of h.on)this.#t.get(t)._setVisible(U,!0);for(const t of h.off)this.#t.get(t)._setVisible(U,!1);this.#i=this.getHash()}}#s(h){const t=h.length;if(t<2)return!0;const m=h[0];for(let f=1;f<t;f++){const i=h[f];let a;if(Array.isArray(i))a=this.#s(i);else if(this.#t.has(i))a=this.#t.get(i).visible;else return(0,g.warn)(`Optional content group not found: ${i}`),!0;switch(m){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return m==="And"}isVisible(h){if(this.#t.size===0)return!0;if(!h)return(0,g.warn)("Optional content group not defined."),!0;if(h.type==="OCG")return this.#t.has(h.id)?this.#t.get(h.id).visible:((0,g.warn)(`Optional content group not found: ${h.id}`),!0);if(h.type==="OCMD"){if(h.expression)return this.#s(h.expression);if(!h.policy||h.policy==="AnyOn"){for(const t of h.ids){if(!this.#t.has(t))return(0,g.warn)(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(h.policy==="AllOn"){for(const t of h.ids){if(!this.#t.has(t))return(0,g.warn)(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(h.policy==="AnyOff"){for(const t of h.ids){if(!this.#t.has(t))return(0,g.warn)(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(h.policy==="AllOff"){for(const t of h.ids){if(!this.#t.has(t))return(0,g.warn)(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return(0,g.warn)(`Unknown optional content policy ${h.policy}.`),!0}return(0,g.warn)(`Unknown group type ${h.type}.`),!0}setVisibility(h,t=!0){if(!this.#t.has(h)){(0,g.warn)(`Optional content group not found: ${h}`);return}this.#t.get(h)._setVisible(U,!!t),this.#e=null}get hasInitialVisibility(){return this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,g.objectFromMap)(this.#t):null}getGroup(h){return this.#t.get(h)||null}getHash(){if(this.#e!==null)return this.#e;const h=new M.MurmurHash3_64;for(const[t,m]of this.#t)h.update(`${t}:${m.visible}`);return this.#e=h.hexdigest()}}l.OptionalContentConfig=S}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFDataTransportStream=void 0;var g=k(1),M=k(6);class U{constructor({length:h,initialData:t,progressiveDone:m=!1,contentDispositionFilename:f=null,disableRange:i=!1,disableStream:a=!1},p){if((0,g.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=m,this._contentDispositionFilename=f,t?.length>0){const o=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(o)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!a,this._isRangeSupported=!i,this._contentLength=h,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((o,d)=>{this._onReceiveData({begin:o,chunk:d})}),this._pdfDataRangeTransport.addProgressListener((o,d)=>{this._onProgress({loaded:o,total:d})}),this._pdfDataRangeTransport.addProgressiveReadListener(o=>{this._onReceiveData({chunk:o})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:h,chunk:t}){const m=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(h===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(m):this._queuedChunks.push(m);else{const f=this._rangeReaders.some(function(i){return i._begin!==h?!1:(i._enqueue(m),!0)});(0,g.assert)(f,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(h){h.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:h.loaded}):this._fullRequestReader?.onProgress?.({loaded:h.loaded,total:h.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const t=this._rangeReaders.indexOf(h);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,g.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new F(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,t){if(t<=this._progressiveDataLength)return null;const m=new S(this,h,t);return this._pdfDataRangeTransport.requestDataRange(h,t),this._rangeReaders.push(m),m}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(const t of this._rangeReaders.slice(0))t.cancel(h);this._pdfDataRangeTransport.abort()}}l.PDFDataTransportStream=U;class F{constructor(h,t,m=!1,f=null){this._stream=h,this._done=m||!1,this._filename=(0,M.isPdfFile)(f)?f:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=new g.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class S{constructor(h,t,m){this._stream=h,this._begin=t,this._end=m,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const h=new g.PromiseCapability;return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((N,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.XfaText=void 0;class k{static textContent(M){const U=[],F={items:U,styles:Object.create(null)};function S(A){if(!A)return;let h=null;const t=A.name;if(t==="#text")h=A.value;else if(k.shouldBuildText(t))A?.attributes?.textContent?h=A.attributes.textContent:A.value&&(h=A.value);else return;if(h!==null&&U.push({str:h}),!!A.children)for(const m of A.children)S(m)}return S(M),F}static shouldBuildText(M){return!(M==="textarea"||M==="input"||M==="option"||M==="select")}}l.XfaText=k}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.NodeStandardFontDataFactory=l.NodeFilterFactory=l.NodeCanvasFactory=l.NodeCMapReaderFactory=void 0;var g=k(7);const M=function(h){return new Promise((t,m)=>{require$$5.readFile(h,(i,a)=>{if(i||!a){m(new Error(i));return}t(new Uint8Array(a))})})};class U extends g.BaseFilterFactory{}l.NodeFilterFactory=U;class F extends g.BaseCanvasFactory{_createCanvas(t,m){return require$$5.createCanvas(t,m)}}l.NodeCanvasFactory=F;class S extends g.BaseCMapReaderFactory{_fetchData(t,m){return M(t).then(f=>({cMapData:f,compressionType:m}))}}l.NodeCMapReaderFactory=S;class A extends g.BaseStandardFontDataFactory{_fetchData(t){return M(t)}}l.NodeStandardFontDataFactory=A}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFNodeStream=void 0;var g=k(1),M=k(22);const U=require$$5,F=require$$5,S=require$$5,A=require$$5,h=/^file:\/\/\/[a-zA-Z]:\//;function t(C){const v=A.parse(C);return v.protocol==="file:"||v.host?v:/^[a-z]:[/\\]/i.test(C)?A.parse(`file:///${C}`):(v.host||(v.protocol="file:"),v)}class m{constructor(v){this.source=v,this.url=t(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new p(this),this._fullRequestReader}getRangeReader(v,e){if(e<=this._progressiveDataLength)return null;const r=this.isFsUrl?new E(this,v,e):new o(this,v,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(const e of this._rangeRequestReaders.slice(0))e.cancel(v)}}l.PDFNodeStream=m;class f{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=v.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=new g.PromiseCapability,this._headersCapability=new g.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new g.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new g.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class i{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new g.PromiseCapability;const e=v.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new g.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function a(C,v){return{protocol:C.protocol,auth:C.auth,host:C.hostname,port:C.port,path:C.path,method:"GET",headers:v}}class p extends f{constructor(v){super(v);const e=r=>{if(r.statusCode===404){const I=new g.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=I,this._headersCapability.reject(I);return}this._headersCapability.resolve(),this._setReadableStream(r);const w=I=>this._readableStream.headers[I.toLowerCase()],{allowRangeRequests:D,suggestedLength:T}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:w,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=D,this._contentLength=T||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(w)};this._request=null,this._url.protocol==="http:"?this._request=F.request(a(this._url,v.httpHeaders),e):this._request=S.request(a(this._url,v.httpHeaders),e),this._request.on("error",r=>{this._storedError=r,this._headersCapability.reject(r)}),this._request.end()}}class o extends i{constructor(v,e,r){super(v),this._httpHeaders={};for(const D in v.httpHeaders){const T=v.httpHeaders[D];T!==void 0&&(this._httpHeaders[D]=T)}this._httpHeaders.Range=`bytes=${e}-${r-1}`;const w=D=>{if(D.statusCode===404){const T=new g.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=T;return}this._setReadableStream(D)};this._request=null,this._url.protocol==="http:"?this._request=F.request(a(this._url,this._httpHeaders),w):this._request=S.request(a(this._url,this._httpHeaders),w),this._request.on("error",D=>{this._storedError=D}),this._request.end()}}class d extends f{constructor(v){super(v);let e=decodeURIComponent(this._url.path);h.test(this._url.href)&&(e=e.replace(/^\//,"")),U.lstat(e,(r,w)=>{if(r){r.code==="ENOENT"&&(r=new g.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=r,this._headersCapability.reject(r);return}this._contentLength=w.size,this._setReadableStream(U.createReadStream(e)),this._headersCapability.resolve()})}}class E extends i{constructor(v,e,r){super(v);let w=decodeURIComponent(this._url.path);h.test(this._url.href)&&(w=w.replace(/^\//,"")),this._setReadableStream(U.createReadStream(w,{start:e,end:r-1}))}}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.createResponseStatusError=A,l.extractFilenameFromHeader=S,l.validateRangeRequestCapabilities=F,l.validateResponseStatus=h;var g=k(1),M=k(23),U=k(6);function F({getResponseHeader:t,isHttp:m,rangeChunkSize:f,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},p=parseInt(t("Content-Length"),10);return!Number.isInteger(p)||(a.suggestedLength=p,p<=2*f)||i||!m||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function S(t){const m=t("Content-Disposition");if(m){let f=(0,M.getFilenameFromContentDispositionHeader)(m);if(f.includes("%"))try{f=decodeURIComponent(f)}catch{}if((0,U.isPdfFile)(f))return f}return null}function A(t,m){return t===404||t===0&&m.startsWith("file:")?new g.MissingPDFException('Missing PDF "'+m+'".'):new g.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${m}".`,t)}function h(t){return t===200||t===206}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.getFilenameFromContentDispositionHeader=M;var g=k(1);function M(U){let F=!0,S=A("filename\\*","i").exec(U);if(S){S=S[1];let p=f(S);return p=unescape(p),p=i(p),p=a(p),t(p)}if(S=m(U),S){const p=a(S);return t(p)}if(S=A("filename","i").exec(U),S){S=S[1];let p=f(S);return p=a(p),t(p)}function A(p,o){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',o)}function h(p,o){if(p){if(!/^[\x00-\xFF]+$/.test(o))return o;try{const d=new TextDecoder(p,{fatal:!0}),E=(0,g.stringToBytes)(o);o=d.decode(E),F=!1}catch{}}return o}function t(p){return F&&/[\x80-\xff]/.test(p)&&(p=h("utf-8",p),F&&(p=h("iso-8859-1",p))),p}function m(p){const o=[];let d;const E=A("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=E.exec(p))!==null;){let[,v,e,r]=d;if(v=parseInt(v,10),v in o){if(v===0)break;continue}o[v]=[e,r]}const C=[];for(let v=0;v<o.length&&v in o;++v){let[e,r]=o[v];r=f(r),e&&(r=unescape(r),v===0&&(r=i(r))),C.push(r)}return C.join("")}function f(p){if(p.startsWith('"')){const o=p.slice(1).split('\\"');for(let d=0;d<o.length;++d){const E=o[d].indexOf('"');E!==-1&&(o[d]=o[d].slice(0,E),o.length=d+1),o[d]=o[d].replaceAll(/\\(.)/g,"$1")}p=o.join('"')}return p}function i(p){const o=p.indexOf("'");if(o===-1)return p;const d=p.slice(0,o),C=p.slice(o+1).replace(/^[^']*'/,"");return h(d,C)}function a(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,d,E,C){if(E==="q"||E==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,e){return String.fromCharCode(parseInt(e,16))}),h(d,C);try{C=atob(C)}catch{}return h(d,C)})}return""}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFNetworkStream=void 0;var g=k(1),M=k(22);const U=200,F=206;function S(f){const i=f.response;return typeof i!="string"?i:(0,g.stringToBytes)(i).buffer}class A{constructor(i,a={}){this.url=i,this.isHttp=/^https?:/i.test(i),this.httpHeaders=this.isHttp&&a.httpHeaders||Object.create(null),this.withCredentials=a.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(i,a,p){const o={begin:i,end:a};for(const d in p)o[d]=p[d];return this.request(o)}requestFull(i){return this.request(i)}request(i){const a=new XMLHttpRequest,p=this.currXhrId++,o=this.pendingRequests[p]={xhr:a};a.open("GET",this.url),a.withCredentials=this.withCredentials;for(const d in this.httpHeaders){const E=this.httpHeaders[d];E!==void 0&&a.setRequestHeader(d,E)}return this.isHttp&&"begin"in i&&"end"in i?(a.setRequestHeader("Range",`bytes=${i.begin}-${i.end-1}`),o.expectedStatus=F):o.expectedStatus=U,a.responseType="arraybuffer",i.onError&&(a.onerror=function(d){i.onError(a.status)}),a.onreadystatechange=this.onStateChange.bind(this,p),a.onprogress=this.onProgress.bind(this,p),o.onHeadersReceived=i.onHeadersReceived,o.onDone=i.onDone,o.onError=i.onError,o.onProgress=i.onProgress,a.send(null),p}onProgress(i,a){const p=this.pendingRequests[i];p&&p.onProgress?.(a)}onStateChange(i,a){const p=this.pendingRequests[i];if(!p)return;const o=p.xhr;if(o.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),o.readyState!==4||!(i in this.pendingRequests))return;if(delete this.pendingRequests[i],o.status===0&&this.isHttp){p.onError?.(o.status);return}const d=o.status||U;if(!(d===U&&p.expectedStatus===F)&&d!==p.expectedStatus){p.onError?.(o.status);return}const C=S(o);if(d===F){const v=o.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);p.onDone({begin:parseInt(e[1],10),chunk:C})}else C?p.onDone({begin:0,chunk:C}):p.onError?.(o.status)}getRequestXhr(i){return this.pendingRequests[i].xhr}isPendingRequest(i){return i in this.pendingRequests}abortRequest(i){const a=this.pendingRequests[i].xhr;delete this.pendingRequests[i],a.abort()}}class h{constructor(i){this._source=i,this._manager=new A(i.url,{httpHeaders:i.httpHeaders,withCredentials:i.withCredentials}),this._rangeChunkSize=i.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(i){const a=this._rangeRequestReaders.indexOf(i);a>=0&&this._rangeRequestReaders.splice(a,1)}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(i,a){const p=new m(this._manager,i,a);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(i){this._fullRequestReader?.cancel(i);for(const a of this._rangeRequestReaders.slice(0))a.cancel(i)}}l.PDFNetworkStream=h;class t{constructor(i,a){this._manager=i;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=a.url,this._fullRequestId=i.requestFull(p),this._headersReceivedCapability=new g.PromiseCapability,this._disableRange=a.disableRange||!1,this._contentLength=a.length,this._rangeChunkSize=a.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const i=this._fullRequestId,a=this._manager.getRequestXhr(i),p=E=>a.getResponseHeader(E),{allowRangeRequests:o,suggestedLength:d}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(i),this._headersReceivedCapability.resolve()}_onDone(i){if(i&&(this._requests.length>0?this._requests.shift().resolve({value:i.chunk,done:!1}):this._cachedChunks.push(i.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(i){this._storedError=(0,M.createResponseStatusError)(i,this._url),this._headersReceivedCapability.reject(this._storedError);for(const a of this._requests)a.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(i){this.onProgress?.({loaded:i.loaded,total:i.lengthComputable?i.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const i=new g.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0,this._headersReceivedCapability.reject(i);for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class m{constructor(i,a,p){this._manager=i;const o={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=i.url,this._requestId=i.requestRange(a,p,o),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(i){const a=i.chunk;this._requests.length>0?this._requests.shift().resolve({value:a,done:!1}):this._queuedChunk=a,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(i){this._storedError=(0,M.createResponseStatusError)(i,this._url);for(const a of this._requests)a.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(i){this.isStreamingSupported||this.onProgress?.({loaded:i.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const a=this._queuedChunk;return this._queuedChunk=null,{value:a,done:!1}}if(this._done)return{value:void 0,done:!0};const i=new g.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.PDFFetchStream=void 0;var g=k(1),M=k(22);function U(m,f,i){return{method:"GET",headers:m,signal:i.signal,mode:"cors",credentials:f?"include":"same-origin",redirect:"follow"}}function F(m){const f=new Headers;for(const i in m){const a=m[i];a!==void 0&&f.append(i,a)}return f}function S(m){return m instanceof Uint8Array?m.buffer:m instanceof ArrayBuffer?m:((0,g.warn)(`getArrayBuffer - unexpected data format: ${m}`),new Uint8Array(m).buffer)}class A{constructor(f){this.source=f,this.isHttp=/^https?:/i.test(f.url),this.httpHeaders=this.isHttp&&f.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,g.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new h(this),this._fullRequestReader}getRangeReader(f,i){if(i<=this._progressiveDataLength)return null;const a=new t(this,f,i);return this._rangeRequestReaders.push(a),a}cancelAllRequests(f){this._fullRequestReader?.cancel(f);for(const i of this._rangeRequestReaders.slice(0))i.cancel(f)}}l.PDFFetchStream=A;class h{constructor(f){this._stream=f,this._reader=null,this._loaded=0,this._filename=null;const i=f.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=new g.PromiseCapability,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._headers=F(this._stream.httpHeaders);const a=i.url;fetch(a,U(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,M.validateResponseStatus)(p.status))throw(0,M.createResponseStatusError)(p.status,a);this._reader=p.body.getReader(),this._headersCapability.resolve();const o=C=>p.headers.get(C),{allowRangeRequests:d,suggestedLength:E}=(0,M.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=d,this._contentLength=E||this._contentLength,this._filename=(0,M.extractFilenameFromHeader)(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new g.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:f,done:i}=await this._reader.read();return i?{value:f,done:i}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:S(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}class t{constructor(f,i,a){this._stream=f,this._reader=null,this._loaded=0;const p=f.source;this._withCredentials=p.withCredentials||!1,this._readCapability=new g.PromiseCapability,this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=F(this._stream.httpHeaders),this._headers.append("Range",`bytes=${i}-${a-1}`);const o=p.url;fetch(o,U(this._headers,this._withCredentials,this._abortController)).then(d=>{if(!(0,M.validateResponseStatus)(d.status))throw(0,M.createResponseStatusError)(d.status,o);this._readCapability.resolve(),this._reader=d.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:f,done:i}=await this._reader.read();return i?{value:f,done:i}:(this._loaded+=f.byteLength,this.onProgress?.({loaded:this._loaded}),{value:S(f),done:!1})}cancel(f){this._reader?.cancel(f),this._abortController.abort()}}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.TextLayerRenderTask=void 0,l.renderTextLayer=p,l.updateTextLayer=o;var g=k(1),M=k(6);const U=1e5,F=30,S=.8,A=new Map;function h(d,E){let C;if(E&&g.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(d,d).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=d,C=v.getContext("2d",{alpha:!1})}return C}function t(d,E){const C=A.get(d);if(C)return C;const v=h(F,E);v.font=`${F}px ${d}`;const e=v.measureText("");let r=e.fontBoundingBoxAscent,w=Math.abs(e.fontBoundingBoxDescent);if(r){const T=r/(r+w);return A.set(d,T),v.canvas.width=v.canvas.height=0,T}v.strokeStyle="red",v.clearRect(0,0,F,F),v.strokeText("g",0,0);let D=v.getImageData(0,0,F,F).data;w=0;for(let T=D.length-1-3;T>=0;T-=4)if(D[T]>0){w=Math.ceil(T/4/F);break}v.clearRect(0,0,F,F),v.strokeText("A",0,F),D=v.getImageData(0,0,F,F).data,r=0;for(let T=0,I=D.length;T<I;T+=4)if(D[T]>0){r=F-Math.floor(T/4/F);break}if(v.canvas.width=v.canvas.height=0,r){const T=r/(r+w);return A.set(d,T),T}return A.set(d,S),S}function m(d,E,C){const v=document.createElement("span"),e={angle:0,canvasWidth:0,hasText:E.str!=="",hasEOL:E.hasEOL,fontSize:0};d._textDivs.push(v);const r=g.Util.transform(d._transform,E.transform);let w=Math.atan2(r[1],r[0]);const D=C[E.fontName];D.vertical&&(w+=Math.PI/2);const T=Math.hypot(r[2],r[3]),I=T*t(D.fontFamily,d._isOffscreenCanvasSupported);let V,W;w===0?(V=r[4],W=r[5]-I):(V=r[4]+I*Math.sin(w),W=r[5]-I*Math.cos(w));const te="calc(var(--scale-factor)*",Q=v.style;d._container===d._rootContainer?(Q.left=`${(100*V/d._pageWidth).toFixed(2)}%`,Q.top=`${(100*W/d._pageHeight).toFixed(2)}%`):(Q.left=`${te}${V.toFixed(2)}px)`,Q.top=`${te}${W.toFixed(2)}px)`),Q.fontSize=`${te}${T.toFixed(2)}px)`,Q.fontFamily=D.fontFamily,e.fontSize=T,v.setAttribute("role","presentation"),v.textContent=E.str,v.dir=E.dir,d._fontInspectorEnabled&&(v.dataset.fontName=E.fontName),w!==0&&(e.angle=w*(180/Math.PI));let G=!1;if(E.str.length>1)G=!0;else if(E.str!==" "&&E.transform[0]!==E.transform[3]){const H=Math.abs(E.transform[0]),x=Math.abs(E.transform[3]);H!==x&&Math.max(H,x)/Math.min(H,x)>1.5&&(G=!0)}G&&(e.canvasWidth=D.vertical?E.height:E.width),d._textDivProperties.set(v,e),d._isReadableStream&&d._layoutText(v)}function f(d){const{div:E,scale:C,properties:v,ctx:e,prevFontSize:r,prevFontFamily:w}=d,{style:D}=E;let T="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:I}=D,{canvasWidth:V,fontSize:W}=v;(r!==W||w!==I)&&(e.font=`${W*C}px ${I}`,d.prevFontSize=W,d.prevFontFamily=I);const{width:te}=e.measureText(E.textContent);te>0&&(T=`scaleX(${V*C/te})`)}v.angle!==0&&(T=`rotate(${v.angle}deg) ${T}`),T.length>0&&(D.transform=T)}function i(d){if(d._canceled)return;const E=d._textDivs,C=d._capability;if(E.length>U){C.resolve();return}if(!d._isReadableStream)for(const e of E)d._layoutText(e);C.resolve()}class a{constructor({textContentSource:E,container:C,viewport:v,textDivs:e,textDivProperties:r,textContentItemsStr:w,isOffscreenCanvasSupported:D}){this._textContentSource=E,this._isReadableStream=E instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=e||[],this._textContentItemsStr=w||[],this._isOffscreenCanvasSupported=D,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=r||new WeakMap,this._canceled=!1,this._capability=new g.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:h(0,D)};const{pageWidth:T,pageHeight:I,pageX:V,pageY:W}=v.rawDims;this._transform=[1,0,0,-1,-V,W+I],this._pageWidth=T,this._pageHeight=I,(0,M.setLayerDimensions)(C,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new g.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new g.AbortException("TextLayer task cancelled."))}_processItems(E,C){for(const v of E){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),e.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),m(this,v,C)}}_layoutText(E){const C=this._layoutTextParams.properties=this._textDivProperties.get(E);if(this._layoutTextParams.div=E,f(this._layoutTextParams),C.hasText&&this._container.append(E),C.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const E=new g.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:e,done:r})=>{if(r){E.resolve();return}Object.assign(C,e.styles),this._processItems(e.items,C),v()},E.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:e}=this._textContentSource;this._processItems(v,e),E.resolve()}else throw new Error('No "textContentSource" parameter specified.');E.promise.then(()=>{C=null,i(this)},this._capability.reject)}}l.TextLayerRenderTask=a;function p(d){!d.textContentSource&&(d.textContent||d.textContentStream)&&((0,M.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),d.textContentSource=d.textContent||d.textContentStream);const{container:E,viewport:C}=d,v=getComputedStyle(E),e=v.getPropertyValue("visibility"),r=parseFloat(v.getPropertyValue("--scale-factor"));e==="visible"&&(!r||Math.abs(r-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const w=new a(d);return w._render(),w}function o({container:d,viewport:E,textDivs:C,textDivProperties:v,isOffscreenCanvasSupported:e,mustRotate:r=!0,mustRescale:w=!0}){if(r&&(0,M.setLayerDimensions)(d,{rotation:E.rotation}),w){const D=h(0,e),I={prevFontSize:null,prevFontFamily:null,div:null,scale:E.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:D};for(const V of C)I.properties=v.get(V),I.div=V,f(I)}}}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationEditorLayer=void 0;var g=k(1),M=k(5),U=k(28),F=k(29),S=k(6);class A{#e;#t=!1;#i=this.pointerup.bind(this);#n=this.pointerdown.bind(this);#s=new Map;#l=!1;#h=!1;#r;static _initialized=!1;constructor(t){A._initialized||(A._initialized=!0,U.FreeTextEditor.initialize(t.l10n),F.InkEditor.initialize(t.l10n)),t.uiManager.registerEditorTypes([U.FreeTextEditor,F.InkEditor]),this.#r=t.uiManager,this.pageIndex=t.pageIndex,this.div=t.div,this.#e=t.accessibilityManager,this.#r.addLayer(this)}get isEmpty(){return this.#s.size===0}updateToolbar(t){this.#r.updateToolbar(t)}updateMode(t=this.#r.getMode()){this.#f(),t===g.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#r.unselectAll(),t!==g.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",t===g.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",t===g.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(t){if(!t&&this.#r.getMode()!==g.AnnotationEditorType.INK)return;if(!t){for(const f of this.#s.values())if(f.isEmpty()){f.setInBackground();return}}this.#c({offsetX:0,offsetY:0}).setInBackground()}setEditingState(t){this.#r.setEditingState(t)}addCommands(t){this.#r.addCommands(t)}enable(){this.div.style.pointerEvents="auto";for(const t of this.#s.values())t.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const t of this.#s.values())t.disableEditing();this.#f(),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(t){this.#r.getActive()!==t&&this.#r.setActiveEditor(t)}enableClick(){this.div.addEventListener("pointerdown",this.#n),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#n),this.div.removeEventListener("pointerup",this.#i)}attach(t){this.#s.set(t.id,t)}detach(t){this.#s.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv)}remove(t){this.#r.removeEditor(t),this.detach(t),t.div.style.display="none",setTimeout(()=>{t.div.style.display="",t.div.remove(),t.isAttachedToDOM=!1,document.activeElement===document.body&&this.#r.focusMainContainer()},0),this.#h||this.addInkEditorIfNeeded(!1)}#a(t){t.parent!==this&&(this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(this.#a(t),this.#r.addEditor(t),this.attach(t),!t.isAttachedToDOM){const m=t.render();this.div.append(m),t.isAttachedToDOM=!0}this.moveEditorInDOM(t),t.onceAdded(),this.#r.addToAnnotationStorage(t)}moveEditorInDOM(t){this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?t.rebuild():this.add(t)}addANewEditor(t){const m=()=>{this.addOrRebuild(t)},f=()=>{t.remove()};this.addCommands({cmd:m,undo:f,mustExec:!0})}addUndoableEditor(t){const m=()=>{this.addOrRebuild(t)},f=()=>{t.remove()};this.addCommands({cmd:m,undo:f,mustExec:!1})}getNextId(){return this.#r.getId()}#d(t){switch(this.#r.getMode()){case g.AnnotationEditorType.FREETEXT:return new U.FreeTextEditor(t);case g.AnnotationEditorType.INK:return new F.InkEditor(t)}return null}deserialize(t){switch(t.annotationType){case g.AnnotationEditorType.FREETEXT:return U.FreeTextEditor.deserialize(t,this,this.#r);case g.AnnotationEditorType.INK:return F.InkEditor.deserialize(t,this,this.#r)}return null}#c(t){const m=this.getNextId(),f=this.#d({parent:this,id:m,x:t.offsetX,y:t.offsetY,uiManager:this.#r});return f&&this.add(f),f}setSelected(t){this.#r.setSelected(t)}toggleSelected(t){this.#r.toggleSelected(t)}isSelected(t){return this.#r.isSelected(t)}unselect(t){this.#r.unselect(t)}pointerup(t){const{isMac:m}=g.FeatureTest.platform;if(!(t.button!==0||t.ctrlKey&&m)&&t.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}this.#c(t)}}pointerdown(t){const{isMac:m}=g.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&m||t.target!==this.div)return;this.#l=!0;const f=this.#r.getActive();this.#t=!f||f.isEmpty()}drop(t){const m=t.dataTransfer.getData("text/plain"),f=this.#r.getEditor(m);if(!f)return;t.preventDefault(),t.dataTransfer.dropEffect="move",this.#a(f);const i=this.div.getBoundingClientRect(),a=t.clientX-i.x,p=t.clientY-i.y;f.translate(a-f.startX,p-f.startY),this.moveEditorInDOM(f),f.div.focus()}dragover(t){t.preventDefault()}destroy(){this.#r.getActive()?.parent===this&&this.#r.setActiveEditor(null);for(const t of this.#s.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#r.removeLayer(this)}#f(){this.#h=!0;for(const t of this.#s.values())t.isEmpty()&&t.remove();this.#h=!1}render({viewport:t}){this.viewport=t,(0,S.setLayerDimensions)(this.div,t),(0,M.bindEvents)(this,this.div,["dragover","drop"]);for(const m of this.#r.getEditors(this.pageIndex))this.add(m);this.updateMode()}update({viewport:t}){this.#r.commitOrRemove(),this.viewport=t,(0,S.setLayerDimensions)(this.div,{rotation:t.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:t,pageHeight:m}=this.viewport.rawDims;return[t,m]}}l.AnnotationEditorLayer=A}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.FreeTextEditor=void 0;var g=k(1),M=k(5),U=k(4);class F extends U.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#i=this.editorDivInput.bind(this);#n=this.editorDivKeydown.bind(this);#s;#l="";#h=`${this.id}-editor`;#r=!1;#a;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new M.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],F.prototype.commitOrRemove]]);static _type="freetext";constructor(A){super({...A,name:"freeTextEditor"}),this.#s=A.color||F._defaultColor||U.AnnotationEditor._defaultLineColor,this.#a=A.fontSize||F._defaultFontSize}static initialize(A){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(t=>[t,A.get(t)]));const h=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(h.getPropertyValue("--freetext-padding"))}static updateDefaultParams(A,h){switch(A){case g.AnnotationEditorParamsType.FREETEXT_SIZE:F._defaultFontSize=h;break;case g.AnnotationEditorParamsType.FREETEXT_COLOR:F._defaultColor=h;break}}updateParams(A,h){switch(A){case g.AnnotationEditorParamsType.FREETEXT_SIZE:this.#d(h);break;case g.AnnotationEditorParamsType.FREETEXT_COLOR:this.#c(h);break}}static get defaultPropertiesToUpdate(){return[[g.AnnotationEditorParamsType.FREETEXT_SIZE,F._defaultFontSize],[g.AnnotationEditorParamsType.FREETEXT_COLOR,F._defaultColor||U.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[g.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[g.AnnotationEditorParamsType.FREETEXT_COLOR,this.#s]]}#d(A){const h=m=>{this.editorDiv.style.fontSize=`calc(${m}px * var(--scale-factor))`,this.translate(0,-(m-this.#a)*this.parentScale),this.#a=m,this.#o()},t=this.#a;this.addCommands({cmd:()=>{h(A)},undo:()=>{h(t)},mustExec:!0,type:g.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#c(A){const h=this.#s;this.addCommands({cmd:()=>{this.#s=this.editorDiv.style.color=A},undo:()=>{this.#s=this.editorDiv.style.color=h},mustExec:!0,type:g.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){const A=this.parentScale;return[-F._internalPadding*A,-(F._internalPadding+this.#a)*A]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(g.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#n),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#i))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#h),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#n),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#i),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(A){super.focusin(A),A.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}#f(){const A=this.editorDiv.getElementsByTagName("div");if(A.length===0)return this.editorDiv.innerText;const h=[];for(const t of A)h.push(t.innerText.replace(/\r\n?|\n/,""));return h.join(`
`)}#o(){const[A,h]=this.parentDimensions;let t;if(this.isAttachedToDOM)t=this.div.getBoundingClientRect();else{const{currentLayer:m,div:f}=this,i=f.style.display;f.style.display="hidden",m.div.append(this.div),t=f.getBoundingClientRect(),f.remove(),f.style.display=i}this.width=t.width/A,this.height=t.height/h}commit(){this.isInEditMode()&&(super.commit(),this.#r||(this.#r=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#l=this.#f().trimEnd(),this.#o())}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(A){this.enableEditMode(),this.editorDiv.focus()}keydown(A){A.target===this.div&&A.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(A){F._keyboardManager.exec(this,A)}editorDivFocus(A){this.isEditing=!0}editorDivBlur(A){this.isEditing=!1}editorDivInput(A){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let A,h;this.width&&(A=this.x,h=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#h),this.enableEditing(),F._l10nPromise.get("editor_free_text2_aria_label").then(m=>this.editorDiv?.setAttribute("aria-label",m)),F._l10nPromise.get("free_text2_default_content").then(m=>this.editorDiv?.setAttribute("default-content",m)),this.editorDiv.contentEditable=!0;const{style:t}=this.editorDiv;if(t.fontSize=`calc(${this.#a}px * var(--scale-factor))`,t.color=this.#s,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,M.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[m,f]=this.parentDimensions;this.setAt(A*m,h*f,this.width*m,this.height*f);for(const i of this.#l.split(`
`)){const a=document.createElement("div");a.append(i?document.createTextNode(i):document.createElement("br")),this.editorDiv.append(a)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(A,h,t){const m=super.deserialize(A,h,t);return m.#a=A.fontSize,m.#s=g.Util.makeHexColor(...A.color),m.#l=A.value,m}serialize(){if(this.isEmpty())return null;const A=F._internalPadding*this.parentScale,h=this.getRect(A,A),t=U.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#s);return{annotationType:g.AnnotationEditorType.FREETEXT,color:t,fontSize:this.#a,value:this.#l,pageIndex:this.pageIndex,rect:h,rotation:this.rotation}}}l.FreeTextEditor=F}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.InkEditor=void 0,Object.defineProperty(l,"fitCurve",{enumerable:!0,get:function(){return U.fitCurve}});var g=k(1),M=k(4),U=k(30),F=k(5);const S=16;class A extends M.AnnotationEditor{#e=0;#t=0;#i=0;#n=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#l=this.canvasPointerup.bind(this);#h=this.canvasPointerdown.bind(this);#r=!1;#a=!1;#d=null;#c=null;#f=0;#o=0;#u=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(t){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(m=>[m,t.get(m)]))}static updateDefaultParams(t,m){switch(t){case g.AnnotationEditorParamsType.INK_THICKNESS:A._defaultThickness=m;break;case g.AnnotationEditorParamsType.INK_COLOR:A._defaultColor=m;break;case g.AnnotationEditorParamsType.INK_OPACITY:A._defaultOpacity=m/100;break}}updateParams(t,m){switch(t){case g.AnnotationEditorParamsType.INK_THICKNESS:this.#g(m);break;case g.AnnotationEditorParamsType.INK_COLOR:this.#b(m);break;case g.AnnotationEditorParamsType.INK_OPACITY:this.#v(m);break}}static get defaultPropertiesToUpdate(){return[[g.AnnotationEditorParamsType.INK_THICKNESS,A._defaultThickness],[g.AnnotationEditorParamsType.INK_COLOR,A._defaultColor||M.AnnotationEditor._defaultLineColor],[g.AnnotationEditorParamsType.INK_OPACITY,Math.round(A._defaultOpacity*100)]]}get propertiesToUpdate(){return[[g.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||A._defaultThickness],[g.AnnotationEditorParamsType.INK_COLOR,this.color||A._defaultColor||M.AnnotationEditor._defaultLineColor],[g.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??A._defaultOpacity))]]}#g(t){const m=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#F()},undo:()=>{this.thickness=m,this.#F()},mustExec:!0,type:g.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#b(t){const m=this.color;this.addCommands({cmd:()=>{this.color=t,this.#p()},undo:()=>{this.color=m,this.#p()},mustExec:!0,type:g.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#v(t){t/=100;const m=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#p()},undo:()=>{this.opacity=m,this.#p()},mustExec:!0,type:g.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(this.#T(),this.#_()),this.isAttachedToDOM||(this.parent.add(this),this.#E()),this.#F())}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#c.disconnect(),this.#c=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,m]=this.parentDimensions,f=this.width*t,i=this.height*m;this.setDimensions(f,i)}enableEditMode(){this.#r||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#h),this.canvas.addEventListener("pointerup",this.#l))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#h),this.canvas.removeEventListener("pointerup",this.#l))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#C(){const{parentRotation:t,parentDimensions:[m,f]}=this;switch(t){case 90:return[0,f,f,m];case 180:return[m,f,m,f];case 270:return[m,0,f,m];default:return[0,0,m,f]}}#A(){const{ctx:t,color:m,opacity:f,thickness:i,parentScale:a,scaleFactor:p}=this;t.lineWidth=i*a/p,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${m}${(0,F.opacityToHex)(f)}`}#w(t,m){this.isEditing=!0,this.#a||(this.#a=!0,this.#E(),this.thickness||=A._defaultThickness,this.color||=A._defaultColor||M.AnnotationEditor._defaultLineColor,this.opacity??=A._defaultOpacity),this.currentPath.push([t,m]),this.#d=null,this.#A(),this.ctx.beginPath(),this.ctx.moveTo(t,m),this.#u=()=>{this.#u&&(this.#d&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#p(),this.ctx.lineTo(...this.#d),this.#d=null,this.ctx.stroke()),window.requestAnimationFrame(this.#u))},window.requestAnimationFrame(this.#u)}#y(t,m){const[f,i]=this.currentPath.at(-1);t===f&&m===i||(this.currentPath.push([t,m]),this.#d=[t,m])}#S(t,m){this.ctx.closePath(),this.#u=null,t=Math.min(Math.max(t,0),this.canvas.width),m=Math.min(Math.max(m,0),this.canvas.height);const[f,i]=this.currentPath.at(-1);(t!==f||m!==i)&&this.currentPath.push([t,m]);let a;if(this.currentPath.length!==1)a=(0,U.fitCurve)(this.currentPath,30,null);else{const E=[t,m];a=[[E,E.slice(),E.slice(),E]]}const p=A.#M(a);this.currentPath.length=0;const o=()=>{this.paths.push(a),this.bezierPath2D.push(p),this.rebuild()},d=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#T(),this.#_()),this.#F())};this.addCommands({cmd:o,undo:d,mustExec:!0})}#p(){if(this.isEmpty()){this.#P();return}this.#A();const{canvas:t,ctx:m}=this;m.setTransform(1,0,0,1,0,0),m.clearRect(0,0,t.width,t.height),this.#P();for(const f of this.bezierPath2D)m.stroke(f)}commit(){this.#r||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#r=!0,this.div.classList.add("disabled"),this.#F(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(t){super.focusin(t),this.enableEditMode()}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#r||(this.setInForeground(),t.type!=="mouse"&&this.div.focus(),t.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#n),this.#w(t.offsetX,t.offsetY))}canvasPointermove(t){t.stopPropagation(),this.#y(t.offsetX,t.offsetY)}canvasPointerup(t){t.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(t.stopPropagation(),this.#x(t),this.setInBackground())}canvasPointerleave(t){this.#x(t),this.setInBackground()}#x(t){this.#S(t.offsetX,t.offsetY),this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#n),this.addToAnnotationStorage()}#T(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",A._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#_(){this.#c=new ResizeObserver(t=>{const m=t[0].contentRect;m.width&&m.height&&this.setDimensions(m.width,m.height)}),this.#c.observe(this.div)}render(){if(this.div)return this.div;let t,m;this.width&&(t=this.x,m=this.y),super.render(),A._l10nPromise.get("editor_ink2_aria_label").then(o=>this.div?.setAttribute("aria-label",o));const[f,i,a,p]=this.#C();if(this.setAt(f,i,0,0),this.setDims(a,p),this.#T(),this.width){const[o,d]=this.parentDimensions;this.setAt(t*o,m*d,this.width*o,this.height*d),this.#a=!0,this.#E(),this.setDims(this.width*o,this.height*d),this.#p(),this.#O(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#_(),this.div}#E(){if(!this.#a)return;const[t,m]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*m),this.#P()}setDimensions(t,m){const f=Math.round(t),i=Math.round(m);if(this.#f===f&&this.#o===i)return;this.#f=f,this.#o=i,this.canvas.style.visibility="hidden",this.#e&&Math.abs(this.#e-t/m)>.01&&(m=Math.ceil(t/this.#e),this.setDims(t,m));const[a,p]=this.parentDimensions;this.width=t/a,this.height=m/p,this.#r&&this.#m(t,m),this.#E(),this.#p(),this.canvas.style.visibility="visible",this.fixDims()}#m(t,m){const f=this.#D(),i=(t-f)/this.#i,a=(m-f)/this.#t;this.scaleFactor=Math.min(i,a)}#P(){const t=this.#D()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#M(t){const m=new Path2D;for(let f=0,i=t.length;f<i;f++){const[a,p,o,d]=t[f];f===0&&m.moveTo(...a),m.bezierCurveTo(p[0],p[1],o[0],o[1],d[0],d[1])}return m}#k(t,m,f,i){const p=[],o=this.thickness/2;let d,E;for(const C of this.paths){d=[],E=[];for(let v=0,e=C.length;v<e;v++){const[r,w,D,T]=C[v],I=t*(r[0]+m)+o,V=i-t*(r[1]+f)-o,W=t*(w[0]+m)+o,te=i-t*(w[1]+f)-o,Q=t*(D[0]+m)+o,G=i-t*(D[1]+f)-o,H=t*(T[0]+m)+o,x=i-t*(T[1]+f)-o;v===0&&(d.push(I,V),E.push(I,V)),d.push(W,te,Q,G,H,x),this.#I(I,V,W,te,Q,G,H,x,4,E)}p.push({bezier:d,points:E})}return p}#I(t,m,f,i,a,p,o,d,E,C){if(this.#R(t,m,f,i,a,p,o,d)){C.push(o,d);return}for(let v=1;v<E-1;v++){const e=v/E,r=1-e;let w=e*t+r*f,D=e*m+r*i,T=e*f+r*a,I=e*i+r*p;const V=e*a+r*o,W=e*p+r*d;w=e*w+r*T,D=e*D+r*I,T=e*T+r*V,I=e*I+r*W,w=e*w+r*T,D=e*D+r*I,C.push(w,D)}C.push(o,d)}#R(t,m,f,i,a,p,o,d){const C=(3*f-2*t-o)**2,v=(3*i-2*m-d)**2,e=(3*a-t-2*o)**2,r=(3*p-m-2*d)**2;return Math.max(C,e)+Math.max(v,r)<=10}#L(){let t=1/0,m=-1/0,f=1/0,i=-1/0;for(const a of this.paths)for(const[p,o,d,E]of a){const C=g.Util.bezierBoundingBox(...p,...o,...d,...E);t=Math.min(t,C[0]),f=Math.min(f,C[1]),m=Math.max(m,C[2]),i=Math.max(i,C[3])}return[t,f,m,i]}#D(){return this.#r?Math.ceil(this.thickness*this.parentScale):0}#F(t=!1){if(this.isEmpty())return;if(!this.#r){this.#p();return}const m=this.#L(),f=this.#D();this.#i=Math.max(S,m[2]-m[0]),this.#t=Math.max(S,m[3]-m[1]);const i=Math.ceil(f+this.#i*this.scaleFactor),a=Math.ceil(f+this.#t*this.scaleFactor),[p,o]=this.parentDimensions;this.width=i/p,this.height=a/o,this.#e=i/a,this.#O();const d=this.translationX,E=this.translationY;this.translationX=-m[0],this.translationY=-m[1],this.#E(),this.#p(),this.#f=i,this.#o=a,this.setDims(i,a);const C=t?f/this.scaleFactor/2:0;this.translate(d-this.translationX-C,E-this.translationY-C)}#O(){const{style:t}=this.div;this.#e>=1?(t.minHeight=`${S}px`,t.minWidth=`${Math.round(this.#e*S)}px`):(t.minWidth=`${S}px`,t.minHeight=`${Math.round(S/this.#e)}px`)}static deserialize(t,m,f){const i=super.deserialize(t,m,f);i.thickness=t.thickness,i.color=g.Util.makeHexColor(...t.color),i.opacity=t.opacity;const[a,p]=i.pageDimensions,o=i.width*a,d=i.height*p,E=i.parentScale,C=t.thickness/2;i.#e=o/d,i.#r=!0,i.#f=Math.round(o),i.#o=Math.round(d);for(const{bezier:e}of t.paths){const r=[];i.paths.push(r);let w=E*(e[0]-C),D=E*(d-e[1]-C);for(let I=2,V=e.length;I<V;I+=6){const W=E*(e[I]-C),te=E*(d-e[I+1]-C),Q=E*(e[I+2]-C),G=E*(d-e[I+3]-C),H=E*(e[I+4]-C),x=E*(d-e[I+5]-C);r.push([[w,D],[W,te],[Q,G],[H,x]]),w=H,D=x}const T=this.#M(r);i.bezierPath2D.push(T)}const v=i.#L();return i.#i=Math.max(S,v[2]-v[0]),i.#t=Math.max(S,v[3]-v[1]),i.#m(o,d),i}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),m=this.rotation%180===0?t[3]-t[1]:t[2]-t[0],f=M.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:g.AnnotationEditorType.INK,color:f,thickness:this.thickness,opacity:this.opacity,paths:this.#k(this.scaleFactor/this.parentScale,this.translationX,this.translationY,m),pageIndex:this.pageIndex,rect:t,rotation:this.rotation}}}l.InkEditor=A}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.fitCurve=void 0;const g=k(31);l.fitCurve=g}),(N=>{function l(a,p,o){if(!Array.isArray(a))throw new TypeError("First argument should be an array");if(a.forEach(v=>{if(!Array.isArray(v)||v.some(e=>typeof e!="number")||v.length!==a[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),a=a.filter((v,e)=>e===0||!v.every((r,w)=>r===a[e-1][w])),a.length<2)return[];const d=a.length,E=m(a[1],a[0]),C=m(a[d-2],a[d-1]);return k(a,E,C,p,o)}function k(a,p,o,d,E){var v,e,r,w,D,T,I,V,W,te,Q,G,H;if(a.length===2)return G=f.vectorLen(f.subtract(a[0],a[1]))/3,v=[a[0],f.addArrays(a[0],f.mulItems(p,G)),f.addArrays(a[1],f.mulItems(o,G)),a[1]],[v];if(e=S(a),[v,w,T]=g(a,e,e,p,o,E),w===0||w<d)return[v];if(w<d*d)for(r=e,D=w,I=T,H=0;H<20;H++){if(r=U(v,a,r),[v,w,T]=g(a,e,r,p,o,E),w<d)return[v];if(T===I){let x=w/D;if(x>.9999&&x<1.0001)break}D=w,I=T}return Q=[],V=f.subtract(a[T-1],a[T+1]),V.every(x=>x===0)&&(V=f.subtract(a[T-1],a[T]),[V[0],V[1]]=[-V[1],V[0]]),W=f.normalize(V),te=f.mulItems(W,-1),Q=Q.concat(k(a.slice(0,T+1),p,W,d,E)),Q=Q.concat(k(a.slice(T),te,o,d,E)),Q}function g(a,p,o,d,E,C){var v,e,r;return v=M(a,o,d,E),[e,r]=A(a,v,p),C&&C({bez:v,points:a,params:p,maxErr:e,maxPoint:r}),[v,e,r]}function M(a,p,o,d){var E,C,v,e,r,w,D,T,I,V,W,te,Q,G,H,x,P,y=a[0],c=a[a.length-1];for(E=[y,null,null,c],C=f.zeros_Xx2x2(p.length),Q=0,G=p.length;Q<G;Q++)x=p[Q],P=1-x,v=C[Q],v[0]=f.mulItems(o,3*x*(P*P)),v[1]=f.mulItems(d,3*P*(x*x));for(e=[[0,0],[0,0]],r=[0,0],Q=0,G=a.length;Q<G;Q++)x=p[Q],v=C[Q],e[0][0]+=f.dot(v[0],v[0]),e[0][1]+=f.dot(v[0],v[1]),e[1][0]+=f.dot(v[0],v[1]),e[1][1]+=f.dot(v[1],v[1]),H=f.subtract(a[Q],i.q([y,y,c,c],x)),r[0]+=f.dot(v[0],H),r[1]+=f.dot(v[1],H);return w=e[0][0]*e[1][1]-e[1][0]*e[0][1],D=e[0][0]*r[1]-e[1][0]*r[0],T=r[0]*e[1][1]-r[1]*e[0][1],I=w===0?0:T/w,V=w===0?0:D/w,te=f.vectorLen(f.subtract(y,c)),W=1e-6*te,I<W||V<W?(E[1]=f.addArrays(y,f.mulItems(o,te/3)),E[2]=f.addArrays(c,f.mulItems(d,te/3))):(E[1]=f.addArrays(y,f.mulItems(o,I)),E[2]=f.addArrays(c,f.mulItems(d,V))),E}function U(a,p,o){return o.map((d,E)=>F(a,p[E],d))}function F(a,p,o){var d=f.subtract(i.q(a,o),p),E=i.qprime(a,o),C=f.mulMatrix(d,E),v=f.sum(f.squareItems(E))+2*f.mulMatrix(d,i.qprimeprime(a,o));return v===0?o:o-C/v}function S(a){var p=[],o,d,E;return a.forEach((C,v)=>{o=v?d+f.vectorLen(f.subtract(C,E)):0,p.push(o),d=o,E=C}),p=p.map(C=>C/d),p}function A(a,p,o){var d,E,C,v,e,r,w,D;E=0,C=Math.floor(a.length/2);const T=h(p,10);for(e=0,r=a.length;e<r;e++)w=a[e],D=t(p,o[e],T,10),v=f.subtract(i.q(p,D),w),d=v[0]*v[0]+v[1]*v[1],d>E&&(E=d,C=e);return[E,C]}var h=function(a,p){for(var o,d=[0],E=a[0],C=0,v=1;v<=p;v++)o=i.q(a,v/p),C+=f.vectorLen(f.subtract(o,E)),d.push(C),E=o;return d=d.map(e=>e/C),d};function t(a,p,o,d){if(p<0)return 0;if(p>1)return 1;for(var E,C,v,e,r,w=1;w<=d;w++)if(p<=o[w]){e=(w-1)/d,v=w/d,C=o[w-1],E=o[w],r=(p-C)/(E-C)*(v-e)+e;break}return r}function m(a,p){return f.normalize(f.subtract(a,p))}class f{static zeros_Xx2x2(p){for(var o=[];p--;)o.push([0,0]);return o}static mulItems(p,o){return p.map(d=>d*o)}static mulMatrix(p,o){return p.reduce((d,E,C)=>d+E*o[C],0)}static subtract(p,o){return p.map((d,E)=>d-o[E])}static addArrays(p,o){return p.map((d,E)=>d+o[E])}static addItems(p,o){return p.map(d=>d+o)}static sum(p){return p.reduce((o,d)=>o+d)}static dot(p,o){return f.mulMatrix(p,o)}static vectorLen(p){return Math.hypot(...p)}static divItems(p,o){return p.map(d=>d/o)}static squareItems(p){return p.map(o=>o*o)}static normalize(p){return this.divItems(p,this.vectorLen(p))}}class i{static q(p,o){var d=1-o,E=f.mulItems(p[0],d*d*d),C=f.mulItems(p[1],3*d*d*o),v=f.mulItems(p[2],3*d*o*o),e=f.mulItems(p[3],o*o*o);return f.addArrays(f.addArrays(E,C),f.addArrays(v,e))}static qprime(p,o){var d=1-o,E=f.mulItems(f.subtract(p[1],p[0]),3*d*d),C=f.mulItems(f.subtract(p[2],p[1]),6*d*o),v=f.mulItems(f.subtract(p[3],p[2]),3*o*o);return f.addArrays(f.addArrays(E,C),v)}static qprimeprime(p,o){return f.addArrays(f.mulItems(f.addArrays(f.subtract(p[2],f.mulItems(p[1],2)),p[0]),6*(1-o)),f.mulItems(f.addArrays(f.subtract(p[3],f.mulItems(p[2],2)),p[1]),6*o))}}N.exports=l,N.exports.fitCubic=k,N.exports.createTangent=m}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.AnnotationLayer=void 0;var g=k(1),M=k(6),U=k(3),F=k(33),S=k(34);const A=1e3,h=9,t=new WeakSet;function m(L){return{width:L[2]-L[0],height:L[3]-L[1]}}class f{static create(n){switch(n.data.annotationType){case g.AnnotationType.LINK:return new a(n);case g.AnnotationType.TEXT:return new p(n);case g.AnnotationType.WIDGET:switch(n.data.fieldType){case"Tx":return new d(n);case"Btn":return n.data.radioButton?new C(n):n.data.checkBox?new E(n):new v(n);case"Ch":return new e(n)}return new o(n);case g.AnnotationType.POPUP:return new r(n);case g.AnnotationType.FREETEXT:return new D(n);case g.AnnotationType.LINE:return new T(n);case g.AnnotationType.SQUARE:return new I(n);case g.AnnotationType.CIRCLE:return new V(n);case g.AnnotationType.POLYLINE:return new W(n);case g.AnnotationType.CARET:return new Q(n);case g.AnnotationType.INK:return new G(n);case g.AnnotationType.POLYGON:return new te(n);case g.AnnotationType.HIGHLIGHT:return new H(n);case g.AnnotationType.UNDERLINE:return new x(n);case g.AnnotationType.SQUIGGLY:return new P(n);case g.AnnotationType.STRIKEOUT:return new y(n);case g.AnnotationType.STAMP:return new c(n);case g.AnnotationType.FILEATTACHMENT:return new s(n);default:return new i(n)}}}class i{constructor(n,{isRenderable:u=!1,ignoreBorder:_=!1,createQuadrilaterals:R=!1}={}){this.isRenderable=u,this.data=n.data,this.layer=n.layer,this.page=n.page,this.viewport=n.viewport,this.linkService=n.linkService,this.downloadManager=n.downloadManager,this.imageResourcesPath=n.imageResourcesPath,this.renderForms=n.renderForms,this.svgFactory=n.svgFactory,this.annotationStorage=n.annotationStorage,this.enableScripting=n.enableScripting,this.hasJSActions=n.hasJSActions,this._fieldObjects=n.fieldObjects,u&&(this.container=this._createContainer(_)),R&&(this.quadrilaterals=this._createQuadrilaterals(_))}_createContainer(n=!1){const{data:u,page:_,viewport:R}=this,O=document.createElement("section");O.setAttribute("data-annotation-id",u.id),u.noRotate&&O.classList.add("norotate");const{pageWidth:j,pageHeight:B,pageX:q,pageY:Z}=R.rawDims,{width:z,height:ee}=m(u.rect),se=g.Util.normalizeRect([u.rect[0],_.view[3]-u.rect[1]+_.view[1],u.rect[2],_.view[3]-u.rect[3]+_.view[1]]);if(!n&&u.borderStyle.width>0){O.style.borderWidth=`${u.borderStyle.width}px`;const J=u.borderStyle.horizontalCornerRadius,ie=u.borderStyle.verticalCornerRadius;if(J>0||ie>0){const re=`calc(${J}px * var(--scale-factor)) / calc(${ie}px * var(--scale-factor))`;O.style.borderRadius=re}else if(this instanceof C){const re=`calc(${z}px * var(--scale-factor)) / calc(${ee}px * var(--scale-factor))`;O.style.borderRadius=re}switch(u.borderStyle.style){case g.AnnotationBorderStyleType.SOLID:O.style.borderStyle="solid";break;case g.AnnotationBorderStyleType.DASHED:O.style.borderStyle="dashed";break;case g.AnnotationBorderStyleType.BEVELED:(0,g.warn)("Unimplemented border style: beveled");break;case g.AnnotationBorderStyleType.INSET:(0,g.warn)("Unimplemented border style: inset");break;case g.AnnotationBorderStyleType.UNDERLINE:O.style.borderBottomStyle="solid";break}const Y=u.borderColor||null;Y?O.style.borderColor=g.Util.makeHexColor(Y[0]|0,Y[1]|0,Y[2]|0):O.style.borderWidth=0}O.style.left=`${100*(se[0]-q)/j}%`,O.style.top=`${100*(se[1]-Z)/B}%`;const{rotation:$}=u;return u.hasOwnCanvas||$===0?(O.style.width=`${100*z/j}%`,O.style.height=`${100*ee/B}%`):this.setRotation($,O),O}setRotation(n,u=this.container){const{pageWidth:_,pageHeight:R}=this.viewport.rawDims,{width:O,height:j}=m(this.data.rect);let B,q;n%180===0?(B=100*O/_,q=100*j/R):(B=100*j/_,q=100*O/R),u.style.width=`${B}%`,u.style.height=`${q}%`,u.setAttribute("data-main-rotation",(360-n)%360)}get _commonActions(){const n=(u,_,R)=>{const O=R.detail[u];R.target.style[_]=F.ColorConverters[`${O[0]}_HTML`](O.slice(1))};return(0,g.shadow)(this,"_commonActions",{display:u=>{const _=u.detail.display%2===1;this.container.style.visibility=_?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:_,print:u.detail.display===0||u.detail.display===3})},print:u=>{this.annotationStorage.setValue(this.data.id,{print:u.detail.print})},hidden:u=>{this.container.style.visibility=u.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:u.detail.hidden})},focus:u=>{setTimeout(()=>u.target.focus({preventScroll:!1}),0)},userName:u=>{u.target.title=u.detail.userName},readonly:u=>{u.detail.readonly?u.target.setAttribute("readonly",""):u.target.removeAttribute("readonly")},required:u=>{this._setRequired(u.target,u.detail.required)},bgColor:u=>{n("bgColor","backgroundColor",u)},fillColor:u=>{n("fillColor","backgroundColor",u)},fgColor:u=>{n("fgColor","color",u)},textColor:u=>{n("textColor","color",u)},borderColor:u=>{n("borderColor","borderColor",u)},strokeColor:u=>{n("strokeColor","borderColor",u)},rotation:u=>{const _=u.detail.rotation;this.setRotation(_),this.annotationStorage.setValue(this.data.id,{rotation:_})}})}_dispatchEventFromSandbox(n,u){const _=this._commonActions;for(const R of Object.keys(u.detail))(n[R]||_[R])?.(u)}_setDefaultPropertiesFromJS(n){if(!this.enableScripting)return;const u=this.annotationStorage.getRawValue(this.data.id);if(!u)return;const _=this._commonActions;for(const[R,O]of Object.entries(u)){const j=_[R];if(j){const B={detail:{[R]:O},target:n};j(B),delete u[R]}}}_createQuadrilaterals(n=!1){if(!this.data.quadPoints)return null;const u=[],_=this.data.rect;for(const R of this.data.quadPoints)this.data.rect=[R[2].x,R[2].y,R[1].x,R[1].y],u.push(this._createContainer(n));return this.data.rect=_,u}_createPopup(n,u){let _=this.container;this.quadrilaterals&&(n||=this.quadrilaterals,_=this.quadrilaterals[0]),n||(n=document.createElement("div"),n.classList.add("popupTriggerArea"),_.append(n));const O=new w({container:_,trigger:n,color:u.color,titleObj:u.titleObj,modificationDate:u.modificationDate,contentsObj:u.contentsObj,richText:u.richText,hideWrapper:!0}).render();O.style.left="100%",_.append(O)}_renderQuadrilaterals(n){for(const u of this.quadrilaterals)u.classList.add(n);return this.quadrilaterals}render(){(0,g.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(n,u=null){const _=[];if(this._fieldObjects){const R=this._fieldObjects[n];if(R)for(const{page:O,id:j,exportValues:B}of R){if(O===-1||j===u)continue;const q=typeof B=="string"?B:null,Z=document.querySelector(`[data-element-id="${j}"]`);if(Z&&!t.has(Z)){(0,g.warn)(`_getElementsByName - element not allowed: ${j}`);continue}_.push({id:j,exportValue:q,domElement:Z})}return _}for(const R of document.getElementsByName(n)){const{exportValue:O}=R,j=R.getAttribute("data-element-id");j!==u&&t.has(R)&&_.push({id:j,exportValue:O,domElement:R})}return _}}class a extends i{constructor(n,u=null){super(n,{isRenderable:!0,ignoreBorder:!!u?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=n.data.isTooltipOnly}render(){const{data:n,linkService:u}=this,_=document.createElement("a");_.setAttribute("data-element-id",n.id);let R=!1;return n.url?(u.addLinkAttributes(_,n.url,n.newWindow),R=!0):n.action?(this._bindNamedAction(_,n.action),R=!0):n.attachment?(this._bindAttachment(_,n.attachment),R=!0):n.setOCGState?(this.#t(_,n.setOCGState),R=!0):n.dest?(this._bindLink(_,n.dest),R=!0):(n.actions&&(n.actions.Action||n.actions["Mouse Up"]||n.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(_,n),R=!0),n.resetForm?(this._bindResetFormAction(_,n.resetForm),R=!0):this.isTooltipOnly&&!R&&(this._bindLink(_,""),R=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((O,j)=>{const B=j===0?_:_.cloneNode();return O.append(B),O}):(this.container.classList.add("linkAnnotation"),R&&this.container.append(_),this.container)}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(n,u){n.href=this.linkService.getDestinationHash(u),n.onclick=()=>(u&&this.linkService.goToDestination(u),!1),(u||u==="")&&this.#e()}_bindNamedAction(n,u){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeNamedAction(u),!1),this.#e()}_bindAttachment(n,u){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,u.content,u.filename),!1),this.#e()}#t(n,u){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(u),!1),this.#e()}_bindJSAction(n,u){n.href=this.linkService.getAnchorUrl("");const _=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const R of Object.keys(u.actions)){const O=_.get(R);O&&(n[O]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u.id,name:R}}),!1))}n.onclick||(n.onclick=()=>!1),this.#e()}_bindResetFormAction(n,u){const _=n.onclick;if(_||(n.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,g.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),_||(n.onclick=()=>!1);return}n.onclick=()=>{_?.();const{fields:R,refs:O,include:j}=u,B=[];if(R.length!==0||O.length!==0){const z=new Set(O);for(const ee of R){const se=this._fieldObjects[ee]||[];for(const{id:$}of se)z.add($)}for(const ee of Object.values(this._fieldObjects))for(const se of ee)z.has(se.id)===j&&B.push(se)}else for(const z of Object.values(this._fieldObjects))B.push(...z);const q=this.annotationStorage,Z=[];for(const z of B){const{id:ee}=z;switch(Z.push(ee),z.type){case"text":{const $=z.defaultValue||"";q.setValue(ee,{value:$});break}case"checkbox":case"radiobutton":{const $=z.defaultValue===z.exportValues;q.setValue(ee,{value:$});break}case"combobox":case"listbox":{const $=z.defaultValue||"";q.setValue(ee,{value:$});break}default:continue}const se=document.querySelector(`[data-element-id="${ee}"]`);if(se){if(!t.has(se)){(0,g.warn)(`_bindResetFormAction - element not allowed: ${ee}`);continue}}else continue;se.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Z,name:"ResetForm"}}),!1}}}class p extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u})}render(){this.container.classList.add("textAnnotation");const n=document.createElement("img");return n.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",n.alt="[{{type}} Annotation]",n.dataset.l10nId="text_annotation_type",n.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(n,this.data),this.container.append(n),this.container}}class o extends i{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(n){this.data.hasOwnCanvas&&(n.previousSibling?.nodeName==="CANVAS"&&(n.previousSibling.hidden=!0),n.hidden=!1)}_getKeyModifier(n){const{isWin:u,isMac:_}=g.FeatureTest.platform;return u&&n.ctrlKey||_&&n.metaKey}_setEventListener(n,u,_,R){u.includes("mouse")?n.addEventListener(u,O=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:R(O),shift:O.shiftKey,modifier:this._getKeyModifier(O)}})}):n.addEventListener(u,O=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:R(O)}})})}_setEventListeners(n,u,_){for(const[R,O]of u)(O==="Action"||this.data.actions?.[O])&&this._setEventListener(n,R,O,_)}_setBackgroundColor(n){const u=this.data.backgroundColor||null;n.style.backgroundColor=u===null?"transparent":g.Util.makeHexColor(u[0],u[1],u[2])}_setTextStyle(n){const u=["left","center","right"],{fontColor:_}=this.data.defaultAppearanceData,R=this.data.defaultAppearanceData.fontSize||h,O=n.style;let j;const B=2,q=Z=>Math.round(10*Z)/10;if(this.data.multiLine){const Z=Math.abs(this.data.rect[3]-this.data.rect[1]-B),z=Math.round(Z/(g.LINE_FACTOR*R))||1,ee=Z/z;j=Math.min(R,q(ee/g.LINE_FACTOR))}else{const Z=Math.abs(this.data.rect[3]-this.data.rect[1]-B);j=Math.min(R,q(Z/g.LINE_FACTOR))}O.fontSize=`calc(${j}px * var(--scale-factor))`,O.color=g.Util.makeHexColor(_[0],_[1],_[2]),this.data.textAlignment!==null&&(O.textAlign=u[this.data.textAlignment])}_setRequired(n,u){u?n.setAttribute("required",!0):n.removeAttribute("required"),n.setAttribute("aria-required",u)}}class d extends o{constructor(n){const u=n.renderForms||!n.data.hasAppearance&&!!n.data.fieldValue;super(n,{isRenderable:u})}setPropertyOnSiblings(n,u,_,R){const O=this.annotationStorage;for(const j of this._getElementsByName(n.name,n.id))j.domElement&&(j.domElement[u]=_),O.setValue(j.id,{[R]:_})}render(){const n=this.annotationStorage,u=this.data.id;this.container.classList.add("textWidgetAnnotation");let _=null;if(this.renderForms){const R=n.getValue(u,{value:this.data.fieldValue});let O=R.formattedValue||R.value||"";const j=n.getValue(u,{charLimit:this.data.maxLen}).charLimit;j&&O.length>j&&(O=O.slice(0,j));const B={userValue:O,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(_=document.createElement("textarea"),_.textContent=O,this.data.doNotScroll&&(_.style.overflowY="hidden")):(_=document.createElement("input"),_.type="text",_.setAttribute("value",O),this.data.doNotScroll&&(_.style.overflowX="hidden")),this.data.hasOwnCanvas&&(_.hidden=!0),t.add(_),_.setAttribute("data-element-id",u),_.disabled=this.data.readOnly,_.name=this.data.fieldName,_.tabIndex=A,this._setRequired(_,this.data.required),j&&(_.maxLength=j),_.addEventListener("input",Z=>{n.setValue(u,{value:Z.target.value}),this.setPropertyOnSiblings(_,"value",Z.target.value,"value")}),_.addEventListener("resetform",Z=>{const z=this.data.defaultFieldValue??"";_.value=B.userValue=z,B.formattedValue=null});let q=Z=>{const{formattedValue:z}=B;z!=null&&(Z.target.value=z),Z.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){_.addEventListener("focus",z=>{const{target:ee}=z;B.userValue&&(ee.value=B.userValue),B.lastCommittedValue=ee.value,B.commitKey=1}),_.addEventListener("updatefromsandbox",z=>{this.showElementAndHideCanvas(z.target);const ee={value(se){B.userValue=se.detail.value??"",n.setValue(u,{value:B.userValue.toString()}),se.target.value=B.userValue},formattedValue(se){const{formattedValue:$}=se.detail;B.formattedValue=$,$!=null&&se.target!==document.activeElement&&(se.target.value=$),n.setValue(u,{formattedValue:$})},selRange(se){se.target.setSelectionRange(...se.detail.selRange)},charLimit:se=>{const{charLimit:$}=se.detail,{target:J}=se;if($===0){J.removeAttribute("maxLength");return}J.setAttribute("maxLength",$);let ie=B.userValue;!ie||ie.length<=$||(ie=ie.slice(0,$),J.value=B.userValue=ie,n.setValue(u,{value:ie}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:ie,willCommit:!0,commitKey:1,selStart:J.selectionStart,selEnd:J.selectionEnd}}))}};this._dispatchEventFromSandbox(ee,z)}),_.addEventListener("keydown",z=>{B.commitKey=1;let ee=-1;if(z.key==="Escape"?ee=0:z.key==="Enter"&&!this.data.multiLine?ee=2:z.key==="Tab"&&(B.commitKey=3),ee===-1)return;const{value:se}=z.target;B.lastCommittedValue!==se&&(B.lastCommittedValue=se,B.userValue=se,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:se,willCommit:!0,commitKey:ee,selStart:z.target.selectionStart,selEnd:z.target.selectionEnd}}))});const Z=q;q=null,_.addEventListener("blur",z=>{if(!z.relatedTarget)return;const{value:ee}=z.target;B.userValue=ee,B.lastCommittedValue!==ee&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:ee,willCommit:!0,commitKey:B.commitKey,selStart:z.target.selectionStart,selEnd:z.target.selectionEnd}}),Z(z)}),this.data.actions?.Keystroke&&_.addEventListener("beforeinput",z=>{B.lastCommittedValue=null;const{data:ee,target:se}=z,{value:$,selectionStart:J,selectionEnd:ie}=se;let Y=J,re=ie;switch(z.inputType){case"deleteWordBackward":{const ae=$.substring(0,J).match(/\w*[^\w]*$/);ae&&(Y-=ae[0].length);break}case"deleteWordForward":{const ae=$.substring(J).match(/^[^\w]*\w*/);ae&&(re+=ae[0].length);break}case"deleteContentBackward":J===ie&&(Y-=1);break;case"deleteContentForward":J===ie&&(re+=1);break}z.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:$,change:ee||"",willCommit:!1,selStart:Y,selEnd:re}})}),this._setEventListeners(_,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],z=>z.target.value)}if(q&&_.addEventListener("blur",q),this.data.comb){const z=(this.data.rect[2]-this.data.rect[0])/j;_.classList.add("comb"),_.style.letterSpacing=`calc(${z}px * var(--scale-factor) - 1ch)`}}else _=document.createElement("div"),_.textContent=this.data.fieldValue,_.style.verticalAlign="middle",_.style.display="table-cell";return this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}class E extends o{constructor(n){super(n,{isRenderable:n.renderForms})}render(){const n=this.annotationStorage,u=this.data,_=u.id;let R=n.getValue(_,{value:u.exportValue===u.fieldValue}).value;typeof R=="string"&&(R=R!=="Off",n.setValue(_,{value:R})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const O=document.createElement("input");return t.add(O),O.setAttribute("data-element-id",_),O.disabled=u.readOnly,this._setRequired(O,this.data.required),O.type="checkbox",O.name=u.fieldName,R&&O.setAttribute("checked",!0),O.setAttribute("exportValue",u.exportValue),O.tabIndex=A,O.addEventListener("change",j=>{const{name:B,checked:q}=j.target;for(const Z of this._getElementsByName(B,_)){const z=q&&Z.exportValue===u.exportValue;Z.domElement&&(Z.domElement.checked=z),n.setValue(Z.id,{value:z})}n.setValue(_,{value:q})}),O.addEventListener("resetform",j=>{const B=u.defaultFieldValue||"Off";j.target.checked=B===u.exportValue}),this.enableScripting&&this.hasJSActions&&(O.addEventListener("updatefromsandbox",j=>{const B={value(q){q.target.checked=q.detail.value!=="Off",n.setValue(_,{value:q.target.checked})}};this._dispatchEventFromSandbox(B,j)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class C extends o{constructor(n){super(n,{isRenderable:n.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const n=this.annotationStorage,u=this.data,_=u.id;let R=n.getValue(_,{value:u.fieldValue===u.buttonValue}).value;typeof R=="string"&&(R=R!==u.buttonValue,n.setValue(_,{value:R}));const O=document.createElement("input");if(t.add(O),O.setAttribute("data-element-id",_),O.disabled=u.readOnly,this._setRequired(O,this.data.required),O.type="radio",O.name=u.fieldName,R&&O.setAttribute("checked",!0),O.tabIndex=A,O.addEventListener("change",j=>{const{name:B,checked:q}=j.target;for(const Z of this._getElementsByName(B,_))n.setValue(Z.id,{value:!1});n.setValue(_,{value:q})}),O.addEventListener("resetform",j=>{const B=u.defaultFieldValue;j.target.checked=B!=null&&B===u.buttonValue}),this.enableScripting&&this.hasJSActions){const j=u.buttonValue;O.addEventListener("updatefromsandbox",B=>{const q={value:Z=>{const z=j===Z.detail.value;for(const ee of this._getElementsByName(Z.target.name)){const se=z&&ee.id===_;ee.domElement&&(ee.domElement.checked=se),n.setValue(ee.id,{value:se})}}};this._dispatchEventFromSandbox(q,B)}),this._setEventListeners(O,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.checked)}return this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class v extends a{constructor(n){super(n,{ignoreBorder:n.data.hasAppearance})}render(){const n=super.render();n.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(n.title=this.data.alternativeText);const u=n.lastChild;return this.enableScripting&&this.hasJSActions&&u&&(this._setDefaultPropertiesFromJS(u),u.addEventListener("updatefromsandbox",_=>{this._dispatchEventFromSandbox({},_)})),n}}class e extends o{constructor(n){super(n,{isRenderable:n.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const n=this.annotationStorage,u=this.data.id,_=n.getValue(u,{value:this.data.fieldValue}),R=document.createElement("select");t.add(R),R.setAttribute("data-element-id",u),R.disabled=this.data.readOnly,this._setRequired(R,this.data.required),R.name=this.data.fieldName,R.tabIndex=A;let O=this.data.combo&&this.data.options.length>0;this.data.combo||(R.size=this.data.options.length,this.data.multiSelect&&(R.multiple=!0)),R.addEventListener("resetform",z=>{const ee=this.data.defaultFieldValue;for(const se of R.options)se.selected=se.value===ee});for(const z of this.data.options){const ee=document.createElement("option");ee.textContent=z.displayValue,ee.value=z.exportValue,_.value.includes(z.exportValue)&&(ee.setAttribute("selected",!0),O=!1),R.append(ee)}let j=null;if(O){const z=document.createElement("option");z.value=" ",z.setAttribute("hidden",!0),z.setAttribute("selected",!0),R.prepend(z),j=()=>{z.remove(),R.removeEventListener("input",j),j=null},R.addEventListener("input",j)}const B=z=>{const ee=z?"value":"textContent",{options:se,multiple:$}=R;return $?Array.prototype.filter.call(se,J=>J.selected).map(J=>J[ee]):se.selectedIndex===-1?null:se[se.selectedIndex][ee]};let q=B(!1);const Z=z=>{const ee=z.target.options;return Array.prototype.map.call(ee,se=>({displayValue:se.textContent,exportValue:se.value}))};return this.enableScripting&&this.hasJSActions?(R.addEventListener("updatefromsandbox",z=>{const ee={value(se){j?.();const $=se.detail.value,J=new Set(Array.isArray($)?$:[$]);for(const ie of R.options)ie.selected=J.has(ie.value);n.setValue(u,{value:B(!0)}),q=B(!1)},multipleSelection(se){R.multiple=!0},remove(se){const $=R.options,J=se.detail.remove;$[J].selected=!1,R.remove(J),$.length>0&&Array.prototype.findIndex.call($,Y=>Y.selected)===-1&&($[0].selected=!0),n.setValue(u,{value:B(!0),items:Z(se)}),q=B(!1)},clear(se){for(;R.length!==0;)R.remove(0);n.setValue(u,{value:null,items:[]}),q=B(!1)},insert(se){const{index:$,displayValue:J,exportValue:ie}=se.detail.insert,Y=R.children[$],re=document.createElement("option");re.textContent=J,re.value=ie,Y?Y.before(re):R.append(re),n.setValue(u,{value:B(!0),items:Z(se)}),q=B(!1)},items(se){const{items:$}=se.detail;for(;R.length!==0;)R.remove(0);for(const J of $){const{displayValue:ie,exportValue:Y}=J,re=document.createElement("option");re.textContent=ie,re.value=Y,R.append(re)}R.options.length>0&&(R.options[0].selected=!0),n.setValue(u,{value:B(!0),items:Z(se)}),q=B(!1)},indices(se){const $=new Set(se.detail.indices);for(const J of se.target.options)J.selected=$.has(J.index);n.setValue(u,{value:B(!0)}),q=B(!1)},editable(se){se.target.disabled=!se.detail.editable}};this._dispatchEventFromSandbox(ee,z)}),R.addEventListener("input",z=>{const ee=B(!0);n.setValue(u,{value:ee}),z.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:q,changeEx:ee,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(R,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],z=>z.target.value)):R.addEventListener("input",function(z){n.setValue(u,{value:B(!0)})}),this.data.combo&&this._setTextStyle(R),this._setBackgroundColor(R),this._setDefaultPropertiesFromJS(R),this.container.append(R),this.container}}class r extends i{static IGNORE_TYPES=new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]);constructor(n){const{data:u}=n,_=!r.IGNORE_TYPES.has(u.parentType)&&!!(u.titleObj?.str||u.contentsObj?.str||u.richText?.str);super(n,{isRenderable:_})}render(){this.container.classList.add("popupAnnotation");const n=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(n.length===0)return this.container;const u=new w({container:this.container,trigger:Array.from(n),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),_=this.page,R=g.Util.normalizeRect([this.data.parentRect[0],_.view[3]-this.data.parentRect[1]+_.view[1],this.data.parentRect[2],_.view[3]-this.data.parentRect[3]+_.view[1]]),O=R[0]+this.data.parentRect[2]-this.data.parentRect[0],j=R[1],{pageWidth:B,pageHeight:q,pageX:Z,pageY:z}=this.viewport.rawDims;return this.container.style.left=`${100*(O-Z)/B}%`,this.container.style.top=`${100*(j-z)/q}%`,this.container.append(u.render()),this.container}}class w{constructor(n){this.container=n.container,this.trigger=n.trigger,this.color=n.color,this.titleObj=n.titleObj,this.modificationDate=n.modificationDate,this.contentsObj=n.contentsObj,this.richText=n.richText,this.hideWrapper=n.hideWrapper||!1,this.pinned=!1}render(){const u=document.createElement("div");u.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?u:this.container,this.hideElement.hidden=!0;const _=document.createElement("div");_.classList.add("popup");const R=this.color;if(R){const B=.7*(255-R[0])+R[0],q=.7*(255-R[1])+R[1],Z=.7*(255-R[2])+R[2];_.style.backgroundColor=g.Util.makeHexColor(B|0,q|0,Z|0)}const O=document.createElement("h1");O.dir=this.titleObj.dir,O.textContent=this.titleObj.str,_.append(O);const j=M.PDFDateString.toDateObject(this.modificationDate);if(j){const B=document.createElement("span");B.classList.add("popupDate"),B.textContent="{{date}}, {{time}}",B.dataset.l10nId="annotation_date_string",B.dataset.l10nArgs=JSON.stringify({date:j.toLocaleDateString(),time:j.toLocaleTimeString()}),_.append(B)}if(this.richText?.str&&(!this.contentsObj?.str||this.contentsObj.str===this.richText.str))S.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:_}),_.lastChild.classList.add("richText","popupContent");else{const B=this._formatContents(this.contentsObj);_.append(B)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const B of this.trigger)B.addEventListener("click",this._toggle.bind(this)),B.addEventListener("mouseover",this._show.bind(this,!1)),B.addEventListener("mouseout",this._hide.bind(this,!1));return _.addEventListener("click",this._hide.bind(this,!0)),u.append(_),u}_formatContents({str:n,dir:u}){const _=document.createElement("p");_.classList.add("popupContent"),_.dir=u;const R=n.split(/(?:\r\n?|\n)/);for(let O=0,j=R.length;O<j;++O){const B=R[O];_.append(document.createTextNode(B)),O<j-1&&_.append(document.createElement("br"))}return _}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(n=!1){n&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(n=!0){n&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class D extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0}),this.textContent=n.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const n=document.createElement("div");n.classList.add("annotationTextContent"),n.setAttribute("role","comment");for(const u of this.textContent){const _=document.createElement("span");_.textContent=u,n.append(_)}this.container.append(n)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const n=this.data,{width:u,height:_}=m(n.rect),R=this.svgFactory.create(u,_,!0),O=this.svgFactory.createElement("svg:line");return O.setAttribute("x1",n.rect[2]-n.lineCoordinates[0]),O.setAttribute("y1",n.rect[3]-n.lineCoordinates[1]),O.setAttribute("x2",n.rect[2]-n.lineCoordinates[2]),O.setAttribute("y2",n.rect[3]-n.lineCoordinates[3]),O.setAttribute("stroke-width",n.borderStyle.width||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),R.append(O),this.container.append(R),this._createPopup(O,n),this.container}}class I extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const n=this.data,{width:u,height:_}=m(n.rect),R=this.svgFactory.create(u,_,!0),O=n.borderStyle.width,j=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",O/2),j.setAttribute("y",O/2),j.setAttribute("width",u-O),j.setAttribute("height",_-O),j.setAttribute("stroke-width",O||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),R.append(j),this.container.append(R),this._createPopup(j,n),this.container}}class V extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const n=this.data,{width:u,height:_}=m(n.rect),R=this.svgFactory.create(u,_,!0),O=n.borderStyle.width,j=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",u/2),j.setAttribute("cy",_/2),j.setAttribute("rx",u/2-O/2),j.setAttribute("ry",_/2-O/2),j.setAttribute("stroke-width",O||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),R.append(j),this.container.append(R),this._createPopup(j,n),this.container}}class W extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:u,height:_}=m(n.rect),R=this.svgFactory.create(u,_,!0);let O=[];for(const B of n.vertices){const q=B.x-n.rect[0],Z=n.rect[3]-B.y;O.push(q+","+Z)}O=O.join(" ");const j=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",O),j.setAttribute("stroke-width",n.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),R.append(j),this.container.append(R),this._createPopup(j,n),this.container}}class te extends W{constructor(n){super(n),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class G extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const n=this.data,{width:u,height:_}=m(n.rect),R=this.svgFactory.create(u,_,!0);for(const O of n.inkLists){let j=[];for(const q of O){const Z=q.x-n.rect[0],z=n.rect[3]-q.y;j.push(`${Z},${z}`)}j=j.join(" ");const B=this.svgFactory.createElement(this.svgElementName);B.setAttribute("points",j),B.setAttribute("stroke-width",n.borderStyle.width||1),B.setAttribute("stroke","transparent"),B.setAttribute("fill","transparent"),this._createPopup(B,n),R.append(B)}return this.container.append(R),this.container}}class H extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class x extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class P extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class y extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class c extends i{constructor(n){const u=!!(n.data.hasPopup||n.data.titleObj?.str||n.data.contentsObj?.str||n.data.richText?.str);super(n,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class s extends i{constructor(n){super(n,{isRenderable:!0});const{filename:u,content:_}=this.data.file;this.filename=(0,M.getFilenameFromUrl)(u,!0),this.content=_,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:u,content:_})}render(){this.container.classList.add("fileAttachmentAnnotation");let n;return this.data.hasAppearance?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),n.classList.add("popupTriggerArea"),n.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(n,this.data),this.container.append(n),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class b{static#e(n,u,_,R){const O=n.firstChild||n;O.id=`${M.AnnotationPrefix}${u}`,_.append(n),R?.moveElementInDOM(_,n,O,!1)}static render(n){const{annotations:u,div:_,viewport:R,accessibilityManager:O}=n;(0,M.setLayerDimensions)(_,R);const j={data:null,layer:_,page:n.page,viewport:R,linkService:n.linkService,downloadManager:n.downloadManager,imageResourcesPath:n.imageResourcesPath||"",renderForms:n.renderForms!==!1,svgFactory:new M.DOMSVGFactory,annotationStorage:n.annotationStorage||new U.AnnotationStorage,enableScripting:n.enableScripting===!0,hasJSActions:n.hasJSActions,fieldObjects:n.fieldObjects};let B=0;for(const q of u){if(q.noHTML)continue;if(q.annotationType!==g.AnnotationType.POPUP){const{width:ee,height:se}=m(q.rect);if(ee<=0||se<=0)continue}j.data=q;const Z=f.create(j);if(!Z.isRenderable)continue;const z=Z.render();if(q.hidden&&(z.style.visibility="hidden"),Array.isArray(z))for(const ee of z)ee.style.zIndex=B++,b.#e(ee,q.id,_,O);else z.style.zIndex=B++,Z instanceof r?_.prepend(z):b.#e(z,q.id,_,O)}this.#t(_,n.annotationCanvasMap)}static update(n){const{annotationCanvasMap:u,div:_,viewport:R}=n;(0,M.setLayerDimensions)(_,{rotation:R.rotation}),this.#t(_,u),_.hidden=!1}static#t(n,u){if(u){for(const[_,R]of u){const O=n.querySelector(`[data-annotation-id="${_}"]`);if(!O)continue;const{firstChild:j}=O;j?j.nodeName==="CANVAS"?j.replaceWith(R):j.before(R):O.append(R)}u.clear()}}}l.AnnotationLayer=b}),((N,l)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.ColorConverters=void 0;function k(M){return Math.floor(Math.max(0,Math.min(1,M))*255).toString(16).padStart(2,"0")}class g{static CMYK_G([U,F,S,A]){return["G",1-Math.min(1,.3*U+.59*S+.11*F+A)]}static G_CMYK([U]){return["CMYK",0,0,0,1-U]}static G_RGB([U]){return["RGB",U,U,U]}static G_HTML([U]){const F=k(U);return`#${F}${F}${F}`}static RGB_G([U,F,S]){return["G",.3*U+.59*F+.11*S]}static RGB_HTML([U,F,S]){const A=k(U),h=k(F),t=k(S);return`#${A}${h}${t}`}static T_HTML(){return"#00000000"}static CMYK_RGB([U,F,S,A]){return["RGB",1-Math.min(1,U+A),1-Math.min(1,S+A),1-Math.min(1,F+A)]}static CMYK_HTML(U){const F=this.CMYK_RGB(U).slice(1);return this.RGB_HTML(F)}static RGB_CMYK([U,F,S]){const A=1-U,h=1-F,t=1-S,m=Math.min(A,h,t);return["CMYK",A,h,t,m]}}l.ColorConverters=g}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.XfaLayer=void 0;var g=k(19);class M{static setupStorage(F,S,A,h,t){const m=h.getValue(S,{value:null});switch(A.name){case"textarea":if(m.value!==null&&(F.textContent=m.value),t==="print")break;F.addEventListener("input",f=>{h.setValue(S,{value:f.target.value})});break;case"input":if(A.attributes.type==="radio"||A.attributes.type==="checkbox"){if(m.value===A.attributes.xfaOn?F.setAttribute("checked",!0):m.value===A.attributes.xfaOff&&F.removeAttribute("checked"),t==="print")break;F.addEventListener("change",f=>{h.setValue(S,{value:f.target.checked?f.target.getAttribute("xfaOn"):f.target.getAttribute("xfaOff")})})}else{if(m.value!==null&&F.setAttribute("value",m.value),t==="print")break;F.addEventListener("input",f=>{h.setValue(S,{value:f.target.value})})}break;case"select":if(m.value!==null)for(const f of A.children)f.attributes.value===m.value&&(f.attributes.selected=!0);F.addEventListener("input",f=>{const i=f.target.options,a=i.selectedIndex===-1?"":i[i.selectedIndex].value;h.setValue(S,{value:a})});break}}static setAttributes({html:F,element:S,storage:A=null,intent:h,linkService:t}){const{attributes:m}=S,f=F instanceof HTMLAnchorElement;m.type==="radio"&&(m.name=`${m.name}-${h}`);for(const[i,a]of Object.entries(m))if(a!=null)switch(i){case"class":a.length&&F.setAttribute(i,a.join(" "));break;case"dataId":break;case"id":F.setAttribute("data-element-id",a);break;case"style":Object.assign(F.style,a);break;case"textContent":F.textContent=a;break;default:(!f||i!=="href"&&i!=="newWindow")&&F.setAttribute(i,a)}f&&t.addLinkAttributes(F,m.href,m.newWindow),A&&m.dataId&&this.setupStorage(F,m.dataId,S,A)}static render(F){const S=F.annotationStorage,A=F.linkService,h=F.xfaHtml,t=F.intent||"display",m=document.createElement(h.name);h.attributes&&this.setAttributes({html:m,element:h,intent:t,linkService:A});const f=[[h,-1,m]],i=F.div;if(i.append(m),F.viewport){const p=`matrix(${F.viewport.transform.join(",")})`;i.style.transform=p}t!=="richText"&&i.setAttribute("class","xfaLayer xfaFont");const a=[];for(;f.length>0;){const[p,o,d]=f.at(-1);if(o+1===p.children.length){f.pop();continue}const E=p.children[++f.at(-1)[1]];if(E===null)continue;const{name:C}=E;if(C==="#text"){const e=document.createTextNode(E.value);a.push(e),d.append(e);continue}let v;if(E?.attributes?.xmlns?v=document.createElementNS(E.attributes.xmlns,C):v=document.createElement(C),d.append(v),E.attributes&&this.setAttributes({html:v,element:E,storage:S,intent:t,linkService:A}),E.children&&E.children.length>0)f.push([E,-1,v]);else if(E.value){const e=document.createTextNode(E.value);g.XfaText.shouldBuildText(C)&&a.push(e),v.append(e)}}for(const p of i.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:a}}static update(F){const S=`matrix(${F.viewport.transform.join(",")})`;F.div.style.transform=S,F.div.hidden=!1}}l.XfaLayer=M}),((N,l,k)=>{Object.defineProperty(l,"__esModule",{value:!0}),l.SVGGraphics=void 0;var g=k(6),M=k(1),U=k(10);let F=class{constructor(){(0,M.unreachable)("Not implemented: SVGGraphics")}};l.SVGGraphics=F;{let p=function(e){let r=[];const w=[];for(const D of e){if(D.fn==="save"){r.push({fnId:92,fn:"group",items:[]}),w.push(r),r=r.at(-1).items;continue}D.fn==="restore"?r=w.pop():r.push(D)}return r},o=function(e){if(Number.isInteger(e))return e.toString();const r=e.toFixed(10);let w=r.length-1;if(r[w]!=="0")return r;do w--;while(r[w]==="0");return r.substring(0,r[w]==="."?w:w+1)},d=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${o(e[0])} ${o(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const r=Math.acos(e[0])*180/Math.PI;return`rotate(${o(r)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${o(e[4])} ${o(e[5])})`;return`matrix(${o(e[0])} ${o(e[1])} ${o(e[2])} ${o(e[3])} ${o(e[4])} ${o(e[5])})`};const S={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},A="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",t=["butt","round","square"],m=["miter","round","bevel"],f=function(e,r="",w=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!w)return URL.createObjectURL(new Blob([e],{type:r}));const D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let T=`data:${r};base64,`;for(let I=0,V=e.length;I<V;I+=3){const W=e[I]&255,te=e[I+1]&255,Q=e[I+2]&255,G=W>>2,H=(W&3)<<4|te>>4,x=I+1<V?(te&15)<<2|Q>>6:64,P=I+2<V?Q&63:64;T+=D[G]+D[H]+D[x]+D[P]}return T},i=(function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),r=12,w=new Int32Array(256);for(let Q=0;Q<256;Q++){let G=Q;for(let H=0;H<8;H++)G&1?G=3988292384^G>>1&2147483647:G=G>>1&2147483647;w[Q]=G}function D(Q,G,H){let x=-1;for(let P=G;P<H;P++){const y=(x^Q[P])&255,c=w[y];x=x>>>8^c}return x^-1}function T(Q,G,H,x){let P=x;const y=G.length;H[P]=y>>24&255,H[P+1]=y>>16&255,H[P+2]=y>>8&255,H[P+3]=y&255,P+=4,H[P]=Q.charCodeAt(0)&255,H[P+1]=Q.charCodeAt(1)&255,H[P+2]=Q.charCodeAt(2)&255,H[P+3]=Q.charCodeAt(3)&255,P+=4,H.set(G,P),P+=G.length;const c=D(H,x+4,P);H[P]=c>>24&255,H[P+1]=c>>16&255,H[P+2]=c>>8&255,H[P+3]=c&255}function I(Q,G,H){let x=1,P=0;for(let y=G;y<H;++y)x=(x+(Q[y]&255))%65521,P=(P+x)%65521;return P<<16|x}function V(Q){if(!U.isNodeJS)return W(Q);try{let G;parseInt(process.versions.node)>=8?G=Q:G=Buffer.from(Q);const H=require$$5.deflateSync(G,{level:9});return H instanceof Uint8Array?H:new Uint8Array(H)}catch(G){(0,M.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+G)}return W(Q)}function W(Q){let G=Q.length;const H=65535,x=Math.ceil(G/H),P=new Uint8Array(2+G+x*5+4);let y=0;P[y++]=120,P[y++]=156;let c=0;for(;G>H;)P[y++]=0,P[y++]=255,P[y++]=255,P[y++]=0,P[y++]=0,P.set(Q.subarray(c,c+H),y),y+=H,c+=H,G-=H;P[y++]=1,P[y++]=G&255,P[y++]=G>>8&255,P[y++]=~G&65535&255,P[y++]=(~G&65535)>>8&255,P.set(Q.subarray(c),y),y+=Q.length-c;const s=I(Q,0,Q.length);return P[y++]=s>>24&255,P[y++]=s>>16&255,P[y++]=s>>8&255,P[y++]=s&255,P}function te(Q,G,H,x){const P=Q.width,y=Q.height;let c,s,b;const L=Q.data;switch(G){case M.ImageKind.GRAYSCALE_1BPP:s=0,c=1,b=P+7>>3;break;case M.ImageKind.RGB_24BPP:s=2,c=8,b=P*3;break;case M.ImageKind.RGBA_32BPP:s=6,c=8,b=P*4;break;default:throw new Error("invalid format")}const n=new Uint8Array((1+b)*y);let u=0,_=0;for(let Z=0;Z<y;++Z)n[u++]=0,n.set(L.subarray(_,_+b),u),_+=b,u+=b;if(G===M.ImageKind.GRAYSCALE_1BPP&&x){u=0;for(let Z=0;Z<y;Z++){u++;for(let z=0;z<b;z++)n[u++]^=255}}const R=new Uint8Array([P>>24&255,P>>16&255,P>>8&255,P&255,y>>24&255,y>>16&255,y>>8&255,y&255,c,s,0,0,0]),O=V(n),j=e.length+r*3+R.length+O.length,B=new Uint8Array(j);let q=0;return B.set(e,q),q+=e.length,T("IHDR",R,B,q),q+=r+R.length,T("IDATA",O,B,q),q+=r+O.length,T("IEND",new Uint8Array(0),B,q),f(B,"image/png",H)}return function(G,H,x){const P=G.kind===void 0?M.ImageKind.GRAYSCALE_1BPP:G.kind;return te(G,P,H,x)}})();class a{constructor(){this.fontSizeScale=1,this.fontWeight=S.fontWeight,this.fontSize=0,this.textMatrix=M.IDENTITY_MATRIX,this.fontMatrix=M.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=M.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=S.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(r,w){this.x=r,this.y=w}}let E=0,C=0,v=0;l.SVGGraphics=F=class{constructor(e,r,w=!1){(0,g.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new g.DOMSVGFactory,this.current=new a,this.transformMatrix=M.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=r,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!w,this._operatorIdMapping=[];for(const D in M.OPS)this._operatorIdMapping[M.OPS[D]]=D}getObject(e,r=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):r}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const r=e.fnArray,w=e.argsArray;for(let D=0,T=r.length;D<T;D++)if(r[D]===M.OPS.dependency)for(const I of w[D]){const V=I.startsWith("g_")?this.commonObjs:this.objs,W=new Promise(te=>{V.get(I,te)});this.current.dependencies.push(W)}return Promise.all(this.current.dependencies)}transform(e,r,w,D,T,I){const V=[e,r,w,D,T,I];this.transformMatrix=M.Util.transform(this.transformMatrix,V),this.tgrp=null}getSVG(e,r){this.viewport=r;const w=this._initialize(r);return this.loadDependencies(e).then(()=>(this.transformMatrix=M.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),w))}convertOpList(e){const r=this._operatorIdMapping,w=e.argsArray,D=e.fnArray,T=[];for(let I=0,V=D.length;I<V;I++){const W=D[I];T.push({fnId:W,fn:r[W],args:w[I]})}return p(T)}executeOpTree(e){for(const r of e){const w=r.fn,D=r.fnId,T=r.args;switch(D|0){case M.OPS.beginText:this.beginText();break;case M.OPS.dependency:break;case M.OPS.setLeading:this.setLeading(T);break;case M.OPS.setLeadingMoveText:this.setLeadingMoveText(T[0],T[1]);break;case M.OPS.setFont:this.setFont(T);break;case M.OPS.showText:this.showText(T[0]);break;case M.OPS.showSpacedText:this.showText(T[0]);break;case M.OPS.endText:this.endText();break;case M.OPS.moveText:this.moveText(T[0],T[1]);break;case M.OPS.setCharSpacing:this.setCharSpacing(T[0]);break;case M.OPS.setWordSpacing:this.setWordSpacing(T[0]);break;case M.OPS.setHScale:this.setHScale(T[0]);break;case M.OPS.setTextMatrix:this.setTextMatrix(T[0],T[1],T[2],T[3],T[4],T[5]);break;case M.OPS.setTextRise:this.setTextRise(T[0]);break;case M.OPS.setTextRenderingMode:this.setTextRenderingMode(T[0]);break;case M.OPS.setLineWidth:this.setLineWidth(T[0]);break;case M.OPS.setLineJoin:this.setLineJoin(T[0]);break;case M.OPS.setLineCap:this.setLineCap(T[0]);break;case M.OPS.setMiterLimit:this.setMiterLimit(T[0]);break;case M.OPS.setFillRGBColor:this.setFillRGBColor(T[0],T[1],T[2]);break;case M.OPS.setStrokeRGBColor:this.setStrokeRGBColor(T[0],T[1],T[2]);break;case M.OPS.setStrokeColorN:this.setStrokeColorN(T);break;case M.OPS.setFillColorN:this.setFillColorN(T);break;case M.OPS.shadingFill:this.shadingFill(T[0]);break;case M.OPS.setDash:this.setDash(T[0],T[1]);break;case M.OPS.setRenderingIntent:this.setRenderingIntent(T[0]);break;case M.OPS.setFlatness:this.setFlatness(T[0]);break;case M.OPS.setGState:this.setGState(T[0]);break;case M.OPS.fill:this.fill();break;case M.OPS.eoFill:this.eoFill();break;case M.OPS.stroke:this.stroke();break;case M.OPS.fillStroke:this.fillStroke();break;case M.OPS.eoFillStroke:this.eoFillStroke();break;case M.OPS.clip:this.clip("nonzero");break;case M.OPS.eoClip:this.clip("evenodd");break;case M.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case M.OPS.paintImageXObject:this.paintImageXObject(T[0]);break;case M.OPS.paintInlineImageXObject:this.paintInlineImageXObject(T[0]);break;case M.OPS.paintImageMaskXObject:this.paintImageMaskXObject(T[0]);break;case M.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(T[0],T[1]);break;case M.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case M.OPS.closePath:this.closePath();break;case M.OPS.closeStroke:this.closeStroke();break;case M.OPS.closeFillStroke:this.closeFillStroke();break;case M.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case M.OPS.nextLine:this.nextLine();break;case M.OPS.transform:this.transform(T[0],T[1],T[2],T[3],T[4],T[5]);break;case M.OPS.constructPath:this.constructPath(T[0],T[1]);break;case M.OPS.endPath:this.endPath();break;case 92:this.group(r.items);break;default:(0,M.warn)(`Unimplemented operator ${w}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,r,w,D,T,I){const V=this.current;V.textMatrix=V.lineMatrix=[e,r,w,D,T,I],V.textMatrixScale=Math.hypot(e,r),V.x=V.lineX=0,V.y=V.lineY=0,V.xcoords=[],V.ycoords=[],V.tspan=this.svgFactory.createElement("svg:tspan"),V.tspan.setAttributeNS(null,"font-family",V.fontFamily),V.tspan.setAttributeNS(null,"font-size",`${o(V.fontSize)}px`),V.tspan.setAttributeNS(null,"y",o(-V.y)),V.txtElement=this.svgFactory.createElement("svg:text"),V.txtElement.append(V.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=M.IDENTITY_MATRIX,e.lineMatrix=M.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,r){const w=this.current;w.x=w.lineX+=e,w.y=w.lineY+=r,w.xcoords=[],w.ycoords=[],w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${o(w.fontSize)}px`),w.tspan.setAttributeNS(null,"y",o(-w.y))}showText(e){const r=this.current,w=r.font,D=r.fontSize;if(D===0)return;const T=r.fontSizeScale,I=r.charSpacing,V=r.wordSpacing,W=r.fontDirection,te=r.textHScale*W,Q=w.vertical,G=Q?1:-1,H=w.defaultVMetrics,x=D*r.fontMatrix[0];let P=0;for(const s of e){if(s===null){P+=W*V;continue}else if(typeof s=="number"){P+=G*s*D/1e3;continue}const b=(s.isSpace?V:0)+I,L=s.fontChar;let n,u,_=s.width;if(Q){let O;const j=s.vmetric||H;O=s.vmetric?j[1]:_*.5,O=-O*x;const B=j[2]*x;_=j?-j[0]:_,n=O/T,u=(P+B)/T}else n=P/T,u=0;(s.isInFont||w.missingFile)&&(r.xcoords.push(r.x+n),Q&&r.ycoords.push(-r.y+u),r.tspan.textContent+=L);let R;Q?R=_*x-b*W:R=_*x+b*W,P+=R}r.tspan.setAttributeNS(null,"x",r.xcoords.map(o).join(" ")),Q?r.tspan.setAttributeNS(null,"y",r.ycoords.map(o).join(" ")):r.tspan.setAttributeNS(null,"y",o(-r.y)),Q?r.y-=P:r.x+=P*te,r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${o(r.fontSize)}px`),r.fontStyle!==S.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==S.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);const y=r.textRenderingMode&M.TextRenderingMode.FILL_STROKE_MASK;if(y===M.TextRenderingMode.FILL||y===M.TextRenderingMode.FILL_STROKE?(r.fillColor!==S.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===M.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),y===M.TextRenderingMode.STROKE||y===M.TextRenderingMode.FILL_STROKE){const s=1/(r.textMatrixScale||1);this._setStrokeAttributes(r.tspan,s)}let c=r.textMatrix;r.textRise!==0&&(c=c.slice(),c[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",`${d(c)} scale(${o(te)}, -1)`),r.txtElement.setAttributeNS(A,"xml:space","preserve"),r.txtElement.append(r.tspan),r.txtgrp.append(r.txtElement),this._ensureTransformGroup().append(r.txtElement)}setLeadingMoveText(e,r){this.setLeading(-r),this.moveText(e,r)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const r=f(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${r}); }
`}setFont(e){const r=this.current,w=this.commonObjs.get(e[0]);let D=e[1];r.font=w,this.embedFonts&&!w.missingFile&&!this.embeddedFonts[w.loadedName]&&(this.addFontStyle(w),this.embeddedFonts[w.loadedName]=w),r.fontMatrix=w.fontMatrix||M.FONT_IDENTITY_MATRIX;let T="normal";w.black?T="900":w.bold&&(T="bold");const I=w.italic?"italic":"normal";D<0?(D=-D,r.fontDirection=-1):r.fontDirection=1,r.fontSize=D,r.fontFamily=w.loadedName,r.fontWeight=T,r.fontStyle=I,r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"y",o(-r.y)),r.xcoords=[],r.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&M.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement?.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=t[e]}setLineJoin(e){this.current.lineJoin=m[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,r,w){this.current.strokeColor=M.Util.makeHexColor(e,r,w)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,r,w){this.current.fillColor=M.Util.makeHexColor(e,r,w),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const r=this.viewport.width,w=this.viewport.height,D=M.Util.inverseTransform(this.transformMatrix),T=M.Util.applyTransform([0,0],D),I=M.Util.applyTransform([0,w],D),V=M.Util.applyTransform([r,0],D),W=M.Util.applyTransform([r,w],D),te=Math.min(T[0],I[0],V[0],W[0]),Q=Math.min(T[1],I[1],V[1],W[1]),G=Math.max(T[0],I[0],V[0],W[0]),H=Math.max(T[1],I[1],V[1],W[1]),x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x",te),x.setAttributeNS(null,"y",Q),x.setAttributeNS(null,"width",G-te),x.setAttributeNS(null,"height",H-Q),x.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&x.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(x)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const r=e[1],w=e[2],D=e[3]||M.IDENTITY_MATRIX,[T,I,V,W]=e[4],te=e[5],Q=e[6],G=e[7],H=`shading${v++}`,[x,P,y,c]=M.Util.normalizeRect([...M.Util.applyTransform([T,I],D),...M.Util.applyTransform([V,W],D)]),[s,b]=M.Util.singularValueDecompose2dScale(D),L=te*s,n=Q*b,u=this.svgFactory.createElement("svg:pattern");u.setAttributeNS(null,"id",H),u.setAttributeNS(null,"patternUnits","userSpaceOnUse"),u.setAttributeNS(null,"width",L),u.setAttributeNS(null,"height",n),u.setAttributeNS(null,"x",`${x}`),u.setAttributeNS(null,"y",`${P}`);const _=this.svg,R=this.transformMatrix,O=this.current.fillColor,j=this.current.strokeColor,B=this.svgFactory.create(y-x,c-P);if(this.svg=B,this.transformMatrix=D,G===2){const q=M.Util.makeHexColor(...r);this.current.fillColor=q,this.current.strokeColor=q}return this.executeOpTree(this.convertOpList(w)),this.svg=_,this.transformMatrix=R,this.current.fillColor=O,this.current.strokeColor=j,u.append(B.childNodes[0]),this.defs.append(u),`url(#${H})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const r=`shading${v++}`,w=e[3];let D;switch(e[1]){case"axial":const T=e[4],I=e[5];D=this.svgFactory.createElement("svg:linearGradient"),D.setAttributeNS(null,"id",r),D.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),D.setAttributeNS(null,"x1",T[0]),D.setAttributeNS(null,"y1",T[1]),D.setAttributeNS(null,"x2",I[0]),D.setAttributeNS(null,"y2",I[1]);break;case"radial":const V=e[4],W=e[5],te=e[6],Q=e[7];D=this.svgFactory.createElement("svg:radialGradient"),D.setAttributeNS(null,"id",r),D.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),D.setAttributeNS(null,"cx",W[0]),D.setAttributeNS(null,"cy",W[1]),D.setAttributeNS(null,"r",Q),D.setAttributeNS(null,"fx",V[0]),D.setAttributeNS(null,"fy",V[1]),D.setAttributeNS(null,"fr",te);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const T of w){const I=this.svgFactory.createElement("svg:stop");I.setAttributeNS(null,"offset",T[0]),I.setAttributeNS(null,"stop-color",T[1]),D.append(I)}return this.defs.append(D),`url(#${r})`;case"Mesh":return(0,M.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,r){this.current.dashArray=e,this.current.dashPhase=r}constructPath(e,r){const w=this.current;let D=w.x,T=w.y,I=[],V=0;for(const W of e)switch(W|0){case M.OPS.rectangle:D=r[V++],T=r[V++];const te=r[V++],Q=r[V++],G=D+te,H=T+Q;I.push("M",o(D),o(T),"L",o(G),o(T),"L",o(G),o(H),"L",o(D),o(H),"Z");break;case M.OPS.moveTo:D=r[V++],T=r[V++],I.push("M",o(D),o(T));break;case M.OPS.lineTo:D=r[V++],T=r[V++],I.push("L",o(D),o(T));break;case M.OPS.curveTo:D=r[V+4],T=r[V+5],I.push("C",o(r[V]),o(r[V+1]),o(r[V+2]),o(r[V+3]),o(D),o(T)),V+=6;break;case M.OPS.curveTo2:I.push("C",o(D),o(T),o(r[V]),o(r[V+1]),o(r[V+2]),o(r[V+3])),D=r[V+2],T=r[V+3],V+=4;break;case M.OPS.curveTo3:D=r[V+2],T=r[V+3],I.push("C",o(r[V]),o(r[V+1]),o(D),o(T),o(D),o(T)),V+=4;break;case M.OPS.closePath:I.push("Z");break}I=I.join(" "),w.path&&e.length>0&&e[0]!==M.OPS.rectangle&&e[0]!==M.OPS.moveTo?I=w.path.getAttributeNS(null,"d")+I:(w.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(w.path)),w.path.setAttributeNS(null,"d",I),w.path.setAttributeNS(null,"fill","none"),w.element=w.path,w.setCurrentPoint(D,T)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const r=`clippath${E++}`,w=this.svgFactory.createElement("svg:clipPath");w.setAttributeNS(null,"id",r),w.setAttributeNS(null,"transform",d(this.transformMatrix));const D=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?D.setAttributeNS(null,"clip-rule","evenodd"):D.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,w.append(D),this.defs.append(w),e.activeClipUrl){e.clipGroup=null;for(const T of this.extraStack)T.clipGroup=null;w.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${r})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const r=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",r)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[r,w]of e)switch(r){case"LW":this.setLineWidth(w);break;case"LC":this.setLineCap(w);break;case"LJ":this.setLineJoin(w);break;case"ML":this.setMiterLimit(w);break;case"D":this.setDash(w[0],w[1]);break;case"RI":this.setRenderingIntent(w);break;case"FL":this.setFlatness(w);break;case"Font":this.setFont(w);break;case"CA":this.setStrokeAlpha(w);break;case"ca":this.setFillAlpha(w);break;default:(0,M.warn)(`Unimplemented graphic state operator ${r}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,r=1){const w=this.current;let D=w.dashArray;r!==1&&D.length>0&&(D=D.map(function(T){return r*T})),e.setAttributeNS(null,"stroke",w.strokeColor),e.setAttributeNS(null,"stroke-opacity",w.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",o(w.miterLimit)),e.setAttributeNS(null,"stroke-linecap",w.lineCap),e.setAttributeNS(null,"stroke-linejoin",w.lineJoin),e.setAttributeNS(null,"stroke-width",o(r*w.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",D.map(o).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",o(r*w.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const r=this.getObject(e);if(!r){(0,M.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(r)}paintInlineImageXObject(e,r){const w=e.width,D=e.height,T=i(e,this.forceDataSchema,!!r),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",o(w)),I.setAttributeNS(null,"height",o(D)),this.current.element=I,this.clip("nonzero");const V=this.svgFactory.createElement("svg:image");V.setAttributeNS(h,"xlink:href",T),V.setAttributeNS(null,"x","0"),V.setAttributeNS(null,"y",o(-D)),V.setAttributeNS(null,"width",o(w)+"px"),V.setAttributeNS(null,"height",o(D)+"px"),V.setAttributeNS(null,"transform",`scale(${o(1/w)} ${o(-1/D)})`),r?r.append(V):this._ensureTransformGroup().append(V)}paintImageMaskXObject(e){const r=this.getObject(e.data,e);if(r.bitmap){(0,M.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const w=this.current,D=r.width,T=r.height,I=w.fillColor;w.maskId=`mask${C++}`;const V=this.svgFactory.createElement("svg:mask");V.setAttributeNS(null,"id",w.maskId);const W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",o(D)),W.setAttributeNS(null,"height",o(T)),W.setAttributeNS(null,"fill",I),W.setAttributeNS(null,"mask",`url(#${w.maskId})`),this.defs.append(V),this._ensureTransformGroup().append(W),this.paintInlineImageXObject(r,V)}paintFormXObjectBegin(e,r){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),r){const w=r[2]-r[0],D=r[3]-r[1],T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x",r[0]),T.setAttributeNS(null,"y",r[1]),T.setAttributeNS(null,"width",o(w)),T.setAttributeNS(null,"height",o(D)),this.current.element=T,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const r=this.svgFactory.create(e.width,e.height),w=this.svgFactory.createElement("svg:defs");r.append(w),this.defs=w;const D=this.svgFactory.createElement("svg:g");return D.setAttributeNS(null,"transform",d(e.transform)),r.append(D),this.svg=D,r}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",d(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}})],__webpack_module_cache__={};function __w_pdfjs_require__(N){var l=__webpack_module_cache__[N];if(l!==void 0)return l.exports;var k=__webpack_module_cache__[N]={exports:{}};return __webpack_modules__[N](k,k.exports,__w_pdfjs_require__),k.exports}var __webpack_exports__={};return(()=>{var N=__webpack_exports__;Object.defineProperty(N,"__esModule",{value:!0}),Object.defineProperty(N,"AbortException",{enumerable:!0,get:function(){return l.AbortException}}),Object.defineProperty(N,"AnnotationEditorLayer",{enumerable:!0,get:function(){return U.AnnotationEditorLayer}}),Object.defineProperty(N,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return l.AnnotationEditorParamsType}}),Object.defineProperty(N,"AnnotationEditorType",{enumerable:!0,get:function(){return l.AnnotationEditorType}}),Object.defineProperty(N,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return F.AnnotationEditorUIManager}}),Object.defineProperty(N,"AnnotationLayer",{enumerable:!0,get:function(){return S.AnnotationLayer}}),Object.defineProperty(N,"AnnotationMode",{enumerable:!0,get:function(){return l.AnnotationMode}}),Object.defineProperty(N,"CMapCompressionType",{enumerable:!0,get:function(){return l.CMapCompressionType}}),Object.defineProperty(N,"FeatureTest",{enumerable:!0,get:function(){return l.FeatureTest}}),Object.defineProperty(N,"GlobalWorkerOptions",{enumerable:!0,get:function(){return A.GlobalWorkerOptions}}),Object.defineProperty(N,"InvalidPDFException",{enumerable:!0,get:function(){return l.InvalidPDFException}}),Object.defineProperty(N,"MissingPDFException",{enumerable:!0,get:function(){return l.MissingPDFException}}),Object.defineProperty(N,"OPS",{enumerable:!0,get:function(){return l.OPS}}),Object.defineProperty(N,"PDFDataRangeTransport",{enumerable:!0,get:function(){return k.PDFDataRangeTransport}}),Object.defineProperty(N,"PDFDateString",{enumerable:!0,get:function(){return g.PDFDateString}}),Object.defineProperty(N,"PDFWorker",{enumerable:!0,get:function(){return k.PDFWorker}}),Object.defineProperty(N,"PasswordResponses",{enumerable:!0,get:function(){return l.PasswordResponses}}),Object.defineProperty(N,"PermissionFlag",{enumerable:!0,get:function(){return l.PermissionFlag}}),Object.defineProperty(N,"PixelsPerInch",{enumerable:!0,get:function(){return g.PixelsPerInch}}),Object.defineProperty(N,"PromiseCapability",{enumerable:!0,get:function(){return l.PromiseCapability}}),Object.defineProperty(N,"RenderingCancelledException",{enumerable:!0,get:function(){return g.RenderingCancelledException}}),Object.defineProperty(N,"SVGGraphics",{enumerable:!0,get:function(){return h.SVGGraphics}}),Object.defineProperty(N,"UnexpectedResponseException",{enumerable:!0,get:function(){return l.UnexpectedResponseException}}),Object.defineProperty(N,"Util",{enumerable:!0,get:function(){return l.Util}}),Object.defineProperty(N,"VerbosityLevel",{enumerable:!0,get:function(){return l.VerbosityLevel}}),Object.defineProperty(N,"XfaLayer",{enumerable:!0,get:function(){return t.XfaLayer}}),Object.defineProperty(N,"build",{enumerable:!0,get:function(){return k.build}}),Object.defineProperty(N,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return l.createValidAbsoluteUrl}}),Object.defineProperty(N,"getDocument",{enumerable:!0,get:function(){return k.getDocument}}),Object.defineProperty(N,"getFilenameFromUrl",{enumerable:!0,get:function(){return g.getFilenameFromUrl}}),Object.defineProperty(N,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return g.getPdfFilenameFromUrl}}),Object.defineProperty(N,"getXfaPageViewport",{enumerable:!0,get:function(){return g.getXfaPageViewport}}),Object.defineProperty(N,"isDataScheme",{enumerable:!0,get:function(){return g.isDataScheme}}),Object.defineProperty(N,"isPdfFile",{enumerable:!0,get:function(){return g.isPdfFile}}),Object.defineProperty(N,"loadScript",{enumerable:!0,get:function(){return g.loadScript}}),Object.defineProperty(N,"normalizeUnicode",{enumerable:!0,get:function(){return l.normalizeUnicode}}),Object.defineProperty(N,"renderTextLayer",{enumerable:!0,get:function(){return M.renderTextLayer}}),Object.defineProperty(N,"setLayerDimensions",{enumerable:!0,get:function(){return g.setLayerDimensions}}),Object.defineProperty(N,"shadow",{enumerable:!0,get:function(){return l.shadow}}),Object.defineProperty(N,"updateTextLayer",{enumerable:!0,get:function(){return M.updateTextLayer}}),Object.defineProperty(N,"version",{enumerable:!0,get:function(){return k.version}});var l=__w_pdfjs_require__(1),k=__w_pdfjs_require__(2),g=__w_pdfjs_require__(6),M=__w_pdfjs_require__(26),U=__w_pdfjs_require__(27),F=__w_pdfjs_require__(5),S=__w_pdfjs_require__(32),A=__w_pdfjs_require__(14),h=__w_pdfjs_require__(35),t=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf)),pdf.exports}var pdfExports=requirePdf(),pdf_viewer={exports:{}},hasRequiredPdf_viewer;function requirePdf_viewer(){return hasRequiredPdf_viewer||(hasRequiredPdf_viewer=1,(function(N,l){(function(g,M){N.exports=M()})(globalThis,()=>(()=>{var k=[,((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.SimpleLinkService=S.PDFLinkService=S.LinkTarget=void 0;var h=A(2);const t="noopener noreferrer nofollow",m={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};S.LinkTarget=m;function f(p,{url:o,target:d,rel:E,enabled:C=!0}={}){if(!o||typeof o!="string")throw new Error('A valid "url" parameter must provided.');const v=(0,h.removeNullCharacters)(o);C?p.href=p.title=v:(p.href="",p.title=`Disabled: ${v}`,p.onclick=()=>!1);let e="";switch(d){case m.NONE:break;case m.SELF:e="_self";break;case m.BLANK:e="_blank";break;case m.PARENT:e="_parent";break;case m.TOP:e="_top";break}p.target=e,p.rel=typeof E=="string"?E:t}class i{#e=new Map;constructor({eventBus:o,externalLinkTarget:d=null,externalLinkRel:E=null,ignoreDestinationZoom:C=!1}={}){this.eventBus=o,this.externalLinkTarget=d,this.externalLinkRel=E,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=C,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(o,d=null){this.baseUrl=d,this.pdfDocument=o,this.#e.clear()}setViewer(o){this.pdfViewer=o}setHistory(o){this.pdfHistory=o}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(o){this.pdfViewer.currentPageNumber=o}get rotation(){return this.pdfViewer.pagesRotation}set rotation(o){this.pdfViewer.pagesRotation=o}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}#t(o,d=null,E){const C=E[0];let v;if(typeof C=="object"&&C!==null){if(v=this._cachedPageNumber(C),!v){this.pdfDocument.getPageIndex(C).then(e=>{this.cachePageRef(e+1,C),this.#t(o,d,E)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${C}" is not a valid page reference, for dest="${o}".`)});return}}else if(Number.isInteger(C))v=C+1;else{console.error(`PDFLinkService.#goToDestinationHelper: "${C}" is not a valid destination reference, for dest="${o}".`);return}if(!v||v<1||v>this.pagesCount){console.error(`PDFLinkService.#goToDestinationHelper: "${v}" is not a valid page number, for dest="${o}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:d,explicitDest:E,pageNumber:v})),this.pdfViewer.scrollPageIntoView({pageNumber:v,destArray:E,ignoreDestinationZoom:this._ignoreDestinationZoom})}async goToDestination(o){if(!this.pdfDocument)return;let d,E;if(typeof o=="string"?(d=o,E=await this.pdfDocument.getDestination(o)):(d=null,E=await o),!Array.isArray(E)){console.error(`PDFLinkService.goToDestination: "${E}" is not a valid destination array, for dest="${o}".`);return}this.#t(o,d,E)}goToPage(o){if(!this.pdfDocument)return;const d=typeof o=="string"&&this.pdfViewer.pageLabelToPageNumber(o)||o|0;if(!(Number.isInteger(d)&&d>0&&d<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${o}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(d)),this.pdfViewer.scrollPageIntoView({pageNumber:d})}addLinkAttributes(o,d,E=!1){f(o,{url:d,target:E?m.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(o){if(typeof o=="string"){if(o.length>0)return this.getAnchorUrl("#"+escape(o))}else if(Array.isArray(o)){const d=JSON.stringify(o);if(d.length>0)return this.getAnchorUrl("#"+escape(d))}return this.getAnchorUrl("")}getAnchorUrl(o){return this.baseUrl?this.baseUrl+o:o}setHash(o){if(!this.pdfDocument)return;let d,E;if(o.includes("=")){const C=(0,h.parseQueryString)(o);if(C.has("search")){const v=C.get("search").replaceAll('"',""),e=C.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:e?v:v.match(/\S+/g)})}if(C.has("page")&&(d=C.get("page")|0||1),C.has("zoom")){const v=C.get("zoom").split(","),e=v[0],r=parseFloat(e);e.includes("Fit")?e==="Fit"||e==="FitB"?E=[null,{name:e}]:e==="FitH"||e==="FitBH"||e==="FitV"||e==="FitBV"?E=[null,{name:e},v.length>1?v[1]|0:null]:e==="FitR"?v.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):E=[null,{name:e},v[1]|0,v[2]|0,v[3]|0,v[4]|0]:console.error(`PDFLinkService.setHash: "${e}" is not a valid zoom value.`):E=[null,{name:"XYZ"},v.length>1?v[1]|0:null,v.length>2?v[2]|0:null,r?r/100:e]}E?this.pdfViewer.scrollPageIntoView({pageNumber:d||this.page,destArray:E,allowNegativeOffset:!0}):d&&(this.page=d),C.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:C.get("pagemode")}),C.has("nameddest")&&this.goToDestination(C.get("nameddest"))}else{E=unescape(o);try{E=JSON.parse(E),Array.isArray(E)||(E=E.toString())}catch{}if(typeof E=="string"||i.#i(E)){this.goToDestination(E);return}console.error(`PDFLinkService.setHash: "${unescape(o)}" is not a valid destination.`)}}executeNamedAction(o){switch(o){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:o})}async executeSetOCGState(o){const d=this.pdfDocument,E=await this.pdfViewer.optionalContentConfigPromise;if(d!==this.pdfDocument)return;let C;for(const v of o.state){switch(v){case"ON":case"OFF":case"Toggle":C=v;continue}switch(C){case"ON":E.setVisibility(v,!0);break;case"OFF":E.setVisibility(v,!1);break;case"Toggle":const e=E.getGroup(v);e&&E.setVisibility(v,!e.visible);break}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(E)}cachePageRef(o,d){if(!d)return;const E=d.gen===0?`${d.num}R`:`${d.num}R${d.gen}`;this.#e.set(E,o)}_cachedPageNumber(o){if(!o)return null;const d=o.gen===0?`${o.num}R`:`${o.num}R${o.gen}`;return this.#e.get(d)||null}isPageVisible(o){return this.pdfViewer.isPageVisible(o)}isPageCached(o){return this.pdfViewer.isPageCached(o)}static#i(o){if(!Array.isArray(o))return!1;const d=o.length;if(d<2)return!1;const E=o[0];if(!(typeof E=="object"&&Number.isInteger(E.num)&&Number.isInteger(E.gen))&&!(Number.isInteger(E)&&E>=0))return!1;const C=o[1];if(!(typeof C=="object"&&typeof C.name=="string"))return!1;let v=!0;switch(C.name){case"XYZ":if(d!==5)return!1;break;case"Fit":case"FitB":return d===2;case"FitH":case"FitBH":case"FitV":case"FitBV":if(d!==3)return!1;break;case"FitR":if(d!==6)return!1;v=!1;break;default:return!1}for(let e=2;e<d;e++){const r=o[e];if(!(typeof r=="number"||v&&r===null))return!1}return!0}}S.PDFLinkService=i;class a{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(o){}get rotation(){return 0}set rotation(o){}get isInPresentationMode(){return!1}async goToDestination(o){}goToPage(o){}addLinkAttributes(o,d,E=!1){f(o,{url:d,enabled:this.externalLinkEnabled})}getDestinationHash(o){return"#"}getAnchorUrl(o){return"#"}setHash(o){}executeNamedAction(o){}executeSetOCGState(o){}cachePageRef(o,d){}isPageVisible(o){return!0}isPageCached(o){return!0}}S.SimpleLinkService=a}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.animationStarted=S.VERTICAL_PADDING=S.UNKNOWN_SCALE=S.TextLayerMode=S.SpreadMode=S.SidebarView=S.ScrollMode=S.SCROLLBAR_PADDING=S.RenderingStates=S.ProgressBar=S.PresentationModeState=S.OutputScale=S.MIN_SCALE=S.MAX_SCALE=S.MAX_AUTO_SCALE=S.DEFAULT_SCALE_VALUE=S.DEFAULT_SCALE_DELTA=S.DEFAULT_SCALE=S.CursorTool=S.AutoPrintRegExp=void 0,S.apiPageLayoutToViewerModes=z,S.apiPageModeToSidebarView=ee,S.approximateFraction=H,S.backtrackBeforeAllVisibleElements=y,S.binarySearchFirstItem=G,S.docStyle=void 0,S.getActiveOrFocusedElement=Z,S.getPageSizeInches=P,S.getVisibleElements=c,S.isPortraitOrientation=R,S.isValidRotation=n,S.isValidScrollMode=u,S.isValidSpreadMode=_,S.noContextMenuHandler=s,S.normalizeWheelEventDelta=L,S.normalizeWheelEventDirection=b,S.parseQueryString=W,S.removeNullCharacters=Q,S.roundToDivide=x,S.scrollIntoView=I,S.toggleCheckedBtn=se,S.watchScroll=V;const A="auto";S.DEFAULT_SCALE_VALUE=A;const h=1;S.DEFAULT_SCALE=h;const t=1.1;S.DEFAULT_SCALE_DELTA=t;const m=.1;S.MIN_SCALE=m;const f=10;S.MAX_SCALE=f;const i=0;S.UNKNOWN_SCALE=i;const a=1.25;S.MAX_AUTO_SCALE=a;const p=40;S.SCROLLBAR_PADDING=p;const o=5;S.VERTICAL_PADDING=o;const d={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};S.RenderingStates=d;const E={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};S.PresentationModeState=E;const C={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};S.SidebarView=C;const v={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};S.TextLayerMode=v;const e={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};S.ScrollMode=e;const r={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};S.SpreadMode=r;const w={SELECT:0,HAND:1,ZOOM:2};S.CursorTool=w;const D=/\bprint\s*\(/;S.AutoPrintRegExp=D;class T{constructor(){const J=window.devicePixelRatio||1;this.sx=J,this.sy=J}get scaled(){return this.sx!==1||this.sy!==1}}S.OutputScale=T;function I($,J,ie=!1){let Y=$.offsetParent;if(!Y){console.error("offsetParent is not set -- cannot scroll");return}let re=$.offsetTop+$.clientTop,ae=$.offsetLeft+$.clientLeft;for(;Y.clientHeight===Y.scrollHeight&&Y.clientWidth===Y.scrollWidth||ie&&(Y.classList.contains("markedContent")||getComputedStyle(Y).overflow==="hidden");)if(re+=Y.offsetTop,ae+=Y.offsetLeft,Y=Y.offsetParent,!Y)return;J&&(J.top!==void 0&&(re+=J.top),J.left!==void 0&&(ae+=J.left,Y.scrollLeft=ae)),Y.scrollTop=re}function V($,J){const ie=function(ae){re||(re=window.requestAnimationFrame(function(){re=null;const ce=$.scrollLeft,ue=Y.lastX;ce!==ue&&(Y.right=ce>ue),Y.lastX=ce;const fe=$.scrollTop,de=Y.lastY;fe!==de&&(Y.down=fe>de),Y.lastY=fe,J(Y)}))},Y={right:!0,down:!0,lastX:$.scrollLeft,lastY:$.scrollTop,_eventHandler:ie};let re=null;return $.addEventListener("scroll",ie,!0),Y}function W($){const J=new Map;for(const[ie,Y]of new URLSearchParams($))J.set(ie.toLowerCase(),Y);return J}const te=/[\x01-\x1F]/g;function Q($,J=!1){return typeof $!="string"?(console.error("The argument must be a string."),$):(J&&($=$.replaceAll(te," ")),$.replaceAll("\0",""))}function G($,J,ie=0){let Y=ie,re=$.length-1;if(re<0||!J($[re]))return $.length;if(J($[Y]))return Y;for(;Y<re;){const ae=Y+re>>1,le=$[ae];J(le)?re=ae:Y=ae+1}return Y}function H($){if(Math.floor($)===$)return[$,1];const J=1/$,ie=8;if(J>ie)return[1,ie];if(Math.floor(J)===J)return[1,J];const Y=$>1?J:$;let re=0,ae=1,le=1,ce=1;for(;;){const fe=re+le,de=ae+ce;if(de>ie)break;Y<=fe/de?(le=fe,ce=de):(re=fe,ae=de)}let ue;return Y-re/ae<le/ce-Y?ue=Y===$?[re,ae]:[ae,re]:ue=Y===$?[le,ce]:[ce,le],ue}function x($,J){const ie=$%J;return ie===0?$:Math.round($-ie+J)}function P({view:$,userUnit:J,rotate:ie}){const[Y,re,ae,le]=$,ce=ie%180!==0,ue=(ae-Y)/72*J,fe=(le-re)/72*J;return{width:ce?fe:ue,height:ce?ue:fe}}function y($,J,ie){if($<2)return $;let Y=J[$].div,re=Y.offsetTop+Y.clientTop;re>=ie&&(Y=J[$-1].div,re=Y.offsetTop+Y.clientTop);for(let ae=$-2;ae>=0&&(Y=J[ae].div,!(Y.offsetTop+Y.clientTop+Y.clientHeight<=re));--ae)$=ae;return $}function c({scrollEl:$,views:J,sortByVisibility:ie=!1,horizontal:Y=!1,rtl:re=!1}){const ae=$.scrollTop,le=ae+$.clientHeight,ce=$.scrollLeft,ue=ce+$.clientWidth;function fe(ne){const K=ne.div;return K.offsetTop+K.clientTop+K.clientHeight>ae}function de(ne){const K=ne.div,X=K.offsetLeft+K.clientLeft,oe=X+K.clientWidth;return re?X<ue:oe>ce}const Ae=[],ve=new Set,Te=J.length;let me=G(J,Y?de:fe);me>0&&me<Te&&!Y&&(me=y(me,J,ae));let ye=Y?ue:-1;for(let ne=me;ne<Te;ne++){const K=J[ne],X=K.div,oe=X.offsetLeft+X.clientLeft,he=X.offsetTop+X.clientTop,pe=X.clientWidth,ge=X.clientHeight,Ce=oe+pe,Ee=he+ge;if(ye===-1)Ee>=le&&(ye=Ee);else if((Y?oe:he)>ye)break;if(Ee<=ae||he>=le||Ce<=ce||oe>=ue)continue;const we=Math.max(0,ae-he)+Math.max(0,Ee-le),be=Math.max(0,ce-oe)+Math.max(0,Ce-ue),xe=(ge-we)/ge,Pe=(pe-be)/pe,Re=xe*Pe*100|0;Ae.push({id:K.id,x:oe,y:he,view:K,percent:Re,widthPercent:Pe*100|0}),ve.add(K.id)}const Me=Ae[0],De=Ae.at(-1);return ie&&Ae.sort(function(ne,K){const X=ne.percent-K.percent;return Math.abs(X)>.001?-X:ne.id-K.id}),{first:Me,last:De,views:Ae,ids:ve}}function s($){$.preventDefault()}function b($){let J=Math.hypot($.deltaX,$.deltaY);const ie=Math.atan2($.deltaY,$.deltaX);return-.25*Math.PI<ie&&ie<.75*Math.PI&&(J=-J),J}function L($){const J=$.deltaMode;let ie=b($);const Y=30,re=30;return J===WheelEvent.DOM_DELTA_PIXEL?ie/=Y*re:J===WheelEvent.DOM_DELTA_LINE&&(ie/=re),ie}function n($){return Number.isInteger($)&&$%90===0}function u($){return Number.isInteger($)&&Object.values(e).includes($)&&$!==e.UNKNOWN}function _($){return Number.isInteger($)&&Object.values(r).includes($)&&$!==r.UNKNOWN}function R($){return $.width<=$.height}const O=new Promise(function($){window.requestAnimationFrame($)});S.animationStarted=O;const j=document.documentElement.style;S.docStyle=j;function B($,J,ie){return Math.min(Math.max($,J),ie)}class q{#e=null;#t=null;#i=0;#n=null;#s=!0;constructor(J){this.#e=J.classList,this.#n=J.style}get percent(){return this.#i}set percent(J){if(this.#i=B(J,0,100),isNaN(J)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#i}%`)}setWidth(J){if(!J)return;const Y=J.parentNode.offsetWidth-J.offsetWidth;Y>0&&this.#n.setProperty("--progressBar-end-offset",`${Y}px`)}setDisableAutoFetch(J=5e3){isNaN(this.#i)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},J))}hide(){this.#s&&(this.#s=!1,this.#e.add("hidden"))}show(){this.#s||(this.#s=!0,this.#e.remove("hidden"))}}S.ProgressBar=q;function Z(){let $=document,J=$.activeElement||$.querySelector(":focus");for(;J?.shadowRoot;)$=J.shadowRoot,J=$.activeElement||$.querySelector(":focus");return J}function z($){let J=e.VERTICAL,ie=r.NONE;switch($){case"SinglePage":J=e.PAGE;break;case"OneColumn":break;case"TwoPageLeft":J=e.PAGE;case"TwoColumnLeft":ie=r.ODD;break;case"TwoPageRight":J=e.PAGE;case"TwoColumnRight":ie=r.EVEN;break}return{scrollMode:J,spreadMode:ie}}function ee($){switch($){case"UseNone":return C.NONE;case"UseThumbs":return C.THUMBS;case"UseOutlines":return C.OUTLINE;case"UseAttachments":return C.ATTACHMENTS;case"UseOC":return C.LAYERS}return C.NONE}function se($,J,ie=null){$.classList.toggle("toggled",J),$.setAttribute("aria-checked",J),ie?.classList.toggle("hidden",!J)}}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.AnnotationLayerBuilder=void 0;var h=A(4),t=A(5),m=A(2);class f{#e=0;#t=null;constructor({pageDiv:a,pdfPage:p,linkService:o,downloadManager:d,annotationStorage:E=null,imageResourcesPath:C="",renderForms:v=!0,l10n:e=t.NullL10n,enableScripting:r=!1,hasJSActionsPromise:w=null,fieldObjectsPromise:D=null,annotationCanvasMap:T=null,accessibilityManager:I=null}){this.pageDiv=a,this.pdfPage=p,this.linkService=o,this.downloadManager=d,this.imageResourcesPath=C,this.renderForms=v,this.l10n=e,this.annotationStorage=E,this.enableScripting=r,this._hasJSActionsPromise=w||Promise.resolve(!1),this._fieldObjectsPromise=D||Promise.resolve(null),this._annotationCanvasMap=T,this._accessibilityManager=I,this.div=null,this._cancelled=!1,this._eventBus=o.eventBus}async render(a,p="display"){if(this.div){if(this._cancelled||this.#e===0)return;h.AnnotationLayer.update({viewport:a.clone({dontFlip:!0}),div:this.div,annotationCanvasMap:this._annotationCanvasMap});return}const[o,d,E]=await Promise.all([this.pdfPage.getAnnotations({intent:p}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(!this._cancelled){if(this.#e=o.length,this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.append(this.div),this.#e===0){this.hide();return}h.AnnotationLayer.render({viewport:a.clone({dontFlip:!0}),div:this.div,annotations:o,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:d,fieldObjects:E,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager}),this.l10n.translate(this.div),this.linkService.isInPresentationMode&&this.#i(m.PresentationModeState.FULLSCREEN),this.#t||(this.#t=C=>{this.#i(C.state)},this._eventBus?._on("presentationmodechanged",this.#t))}}cancel(){this._cancelled=!0,this.#t&&(this._eventBus?._off("presentationmodechanged",this.#t),this.#t=null)}hide(){this.div&&(this.div.hidden=!0)}#i(a){if(!this.div)return;let p=!1;switch(a){case m.PresentationModeState.FULLSCREEN:p=!0;break;case m.PresentationModeState.NORMAL:break;default:return}for(const o of this.div.childNodes)o.hasAttribute("data-internal-link")||(o.inert=p)}}S.AnnotationLayerBuilder=f}),(F=>{let S;typeof window<"u"&&window["pdfjs-dist/build/pdf"]?S=window["pdfjs-dist/build/pdf"]:S=requirePdf(),F.exports=S}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.NullL10n=void 0,S.fixupLangCode=m,S.getL10nFallback=h;const A={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image"};A.print_progress_percent="{{progress}}%";function h(a,p){switch(a){case"find_match_count":a=`find_match_count[${p.total===1?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${p.limit===1?"one":"other"}]`;break}return A[a]||""}const t={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};function m(a){return t[a?.toLowerCase()]||a}function f(a,p){return p?a.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(o,d)=>d in p?p[d]:"{{"+d+"}}"):a}const i={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(a,p=null,o=h(a,p)){return f(o,p)},async translate(a){}};S.NullL10n=i}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.DownloadManager=void 0;var h=A(4);function t(f,i){const a=document.createElement("a");if(!a.click)throw new Error('DownloadManager: "a.click()" is not supported.');a.href=f,a.target="_parent","download"in a&&(a.download=i),(document.body||document.documentElement).append(a),a.click(),a.remove()}class m{#e=new WeakMap;downloadUrl(i,a,p){if(!(0,h.createValidAbsoluteUrl)(i,"http://example.com")){console.error(`downloadUrl - not a valid URL: ${i}`);return}t(i+"#pdfjs.action=download",a)}downloadData(i,a,p){const o=URL.createObjectURL(new Blob([i],{type:p}));t(o,a)}openOrDownloadData(i,a,p){const d=(0,h.isPdfFile)(p)?"application/pdf":"";return this.downloadData(a,p,d),!1}download(i,a,p,o){const d=URL.createObjectURL(i);t(d,p)}}S.DownloadManager=m}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.WaitOnType=S.EventBus=S.AutomationEventBus=void 0,S.waitOnEventOrTimeout=h;const A={EVENT:"event",TIMEOUT:"timeout"};S.WaitOnType=A;function h({target:f,name:i,delay:a=0}){return new Promise(function(p,o){if(typeof f!="object"||!(i&&typeof i=="string")||!(Number.isInteger(a)&&a>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function d(e){f instanceof t?f._off(i,E):f.removeEventListener(i,E),v&&clearTimeout(v),p(e)}const E=d.bind(null,A.EVENT);f instanceof t?f._on(i,E):f.addEventListener(i,E);const C=d.bind(null,A.TIMEOUT),v=setTimeout(C,a)})}class t{#e=Object.create(null);on(i,a,p=null){this._on(i,a,{external:!0,once:p?.once})}off(i,a,p=null){this._off(i,a,{external:!0,once:p?.once})}dispatch(i,a){const p=this.#e[i];if(!p||p.length===0)return;let o;for(const{listener:d,external:E,once:C}of p.slice(0)){if(C&&this._off(i,d),E){(o||=[]).push(d);continue}d(a)}if(o){for(const d of o)d(a);o=null}}_on(i,a,p=null){(this.#e[i]||=[]).push({listener:a,external:p?.external===!0,once:p?.once===!0})}_off(i,a,p=null){const o=this.#e[i];if(o){for(let d=0,E=o.length;d<E;d++)if(o[d].listener===a){o.splice(d,1);return}}}}S.EventBus=t;class m extends t{dispatch(i,a){throw new Error("Not implemented: AutomationEventBus.dispatch")}}S.AutomationEventBus=m}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.GenericL10n=void 0,A(9);var h=A(5);const t=document.webL10n;class m{constructor(i){this._lang=i,this._ready=new Promise((a,p)=>{t.setLanguage((0,h.fixupLangCode)(i),()=>{a(t)})})}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(i,a=null,p=(0,h.getL10nFallback)(i,a)){return(await this._ready).get(i,a,p)}async translate(i){return(await this._ready).translate(i)}}S.GenericL10n=m}),(()=>{document.webL10n=(function(F,S,A){var h={},t="",m="textContent",f="",i={},a="loading",p=!0;function o(){return S.querySelectorAll('link[type="application/l10n"]')}function d(){var G=S.querySelector('script[type="application/l10n"]');return G?JSON.parse(G.innerHTML):null}function E(G){return G?G.querySelectorAll("*[data-l10n-id]"):[]}function C(G){if(!G)return{};var H=G.getAttribute("data-l10n-id"),x=G.getAttribute("data-l10n-args"),P={};if(x)try{P=JSON.parse(x)}catch{console.warn("could not parse arguments for #"+H)}return{id:H,args:P}}function v(G,H,x){H=H||function(c){},x=x||function(){};var P=new XMLHttpRequest;P.open("GET",G,p),P.overrideMimeType&&P.overrideMimeType("text/plain; charset=utf-8"),P.onreadystatechange=function(){P.readyState==4&&(P.status==200||P.status===0?H(P.responseText):x())},P.onerror=x,P.ontimeout=x;try{P.send(null)}catch{x()}}function e(G,H,x,P){var y=G.replace(/[^\/]*$/,"")||"./";function c(b){return b.lastIndexOf("\\")<0?b:b.replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function s(b,L){var n={},u=/^\s*|\s*$/,_=/^\s*#|^\s*$/,R=/^\s*\[(.*)\]\s*$/,O=/^\s*@import\s+url\((.*)\)\s*$/i,j=/^([^=\s]*)\s*=\s*(.+)$/;function B(Z,z,ee){var se=Z.replace(u,"").split(/[\r\n]+/),$="*",J=H.split("-",1)[0],ie=!1,Y="";function re(){for(;;){if(!se.length){ee();return}var ae=se.shift();if(!_.test(ae)){if(z){if(Y=R.exec(ae),Y){$=Y[1].toLowerCase(),ie=$!=="*"&&$!==H&&$!==J;continue}else if(ie)continue;if(Y=O.exec(ae),Y){q(y+Y[1],re);return}}var le=ae.match(j);le&&le.length==3&&(n[le[1]]=c(le[2]))}}}re()}function q(Z,z){v(Z,function(ee){B(ee,!1,z)},function(){console.warn(Z+" not found."),z()})}B(b,!0,function(){L(n)})}v(G,function(b){t+=b,s(b,function(L){for(var n in L){var u,_,R=n.lastIndexOf(".");R>0?(u=n.substring(0,R),_=n.substring(R+1)):(u=n,_=m),h[u]||(h[u]={}),h[u][_]=L[n]}x&&x()})},P)}function r(G,H){G&&(G=G.toLowerCase()),H=H||function(){},w(),f=G;var x=o(),P=x.length;if(P===0){var y=d();if(y&&y.locales&&y.default_locale){if(console.log("using the embedded JSON directory, early way out"),h=y.locales[G],!h){var c=y.default_locale.toLowerCase();for(var s in y.locales)if(s=s.toLowerCase(),s===G){h=y.locales[G];break}else s===c&&(h=y.locales[c])}H()}else console.log("no resource to load, early way out");a="complete";return}var b=null,L=0;b=function(){L++,L>=P&&(H(),a="complete")};function n(R){var O=R.href;this.load=function(j,B){e(O,j,B,function(){console.warn(O+" not found."),console.warn('"'+j+'" resource not found'),f="",B()})}}for(var u=0;u<P;u++){var _=new n(x[u]);_.load(G,b)}}function w(){h={},t="",f=""}function D(G){var H={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3};function x(s,b){return b.indexOf(s)!==-1}function P(s,b,L){return b<=s&&s<=L}var y={0:function(s){return"other"},1:function(s){return P(s%100,3,10)?"few":s===0?"zero":P(s%100,11,99)?"many":s==2?"two":s==1?"one":"other"},2:function(s){return s!==0&&s%10===0?"many":s==2?"two":s==1?"one":"other"},3:function(s){return s==1?"one":"other"},4:function(s){return P(s,0,1)?"one":"other"},5:function(s){return P(s,0,2)&&s!=2?"one":"other"},6:function(s){return s===0?"zero":s%10==1&&s%100!=11?"one":"other"},7:function(s){return s==2?"two":s==1?"one":"other"},8:function(s){return P(s,3,6)?"few":P(s,7,10)?"many":s==2?"two":s==1?"one":"other"},9:function(s){return s===0||s!=1&&P(s%100,1,19)?"few":s==1?"one":"other"},10:function(s){return P(s%10,2,9)&&!P(s%100,11,19)?"few":s%10==1&&!P(s%100,11,19)?"one":"other"},11:function(s){return P(s%10,2,4)&&!P(s%100,12,14)?"few":s%10===0||P(s%10,5,9)||P(s%100,11,14)?"many":s%10==1&&s%100!=11?"one":"other"},12:function(s){return P(s,2,4)?"few":s==1?"one":"other"},13:function(s){return P(s%10,2,4)&&!P(s%100,12,14)?"few":s!=1&&P(s%10,0,1)||P(s%10,5,9)||P(s%100,12,14)?"many":s==1?"one":"other"},14:function(s){return P(s%100,3,4)?"few":s%100==2?"two":s%100==1?"one":"other"},15:function(s){return s===0||P(s%100,2,10)?"few":P(s%100,11,19)?"many":s==1?"one":"other"},16:function(s){return s%10==1&&s!=11?"one":"other"},17:function(s){return s==3?"few":s===0?"zero":s==6?"many":s==2?"two":s==1?"one":"other"},18:function(s){return s===0?"zero":P(s,0,2)&&s!==0&&s!=2?"one":"other"},19:function(s){return P(s,2,10)?"few":P(s,0,1)?"one":"other"},20:function(s){return(P(s%10,3,4)||s%10==9)&&!(P(s%100,10,19)||P(s%100,70,79)||P(s%100,90,99))?"few":s%1e6===0&&s!==0?"many":s%10==2&&!x(s%100,[12,72,92])?"two":s%10==1&&!x(s%100,[11,71,91])?"one":"other"},21:function(s){return s===0?"zero":s==1?"one":"other"},22:function(s){return P(s,0,1)||P(s,11,99)?"one":"other"},23:function(s){return P(s%10,1,2)||s%20===0?"one":"other"},24:function(s){return P(s,3,10)||P(s,13,19)?"few":x(s,[2,12])?"two":x(s,[1,11])?"one":"other"}},c=H[G.replace(/-.*$/,"")];return c in y?y[c]:(console.warn("plural form unknown for ["+G+"]"),function(){return"other"})}i.plural=function(G,H,x,P){var y=parseFloat(H);if(isNaN(y)||P!=m)return G;i._pluralRules||(i._pluralRules=D(f));var c="["+i._pluralRules(y)+"]";return y===0&&x+"[zero]"in h?G=h[x+"[zero]"][P]:y==1&&x+"[one]"in h?G=h[x+"[one]"][P]:y==2&&x+"[two]"in h?G=h[x+"[two]"][P]:x+c in h?G=h[x+c][P]:x+"[other]"in h&&(G=h[x+"[other]"][P]),G};function T(G,H,x){var P=h[G];if(!P){if(console.warn("#"+G+" is undefined."),!x)return null;P=x}var y={};for(var c in P){var s=P[c];s=I(s,H,G,c),s=V(s,H,G),y[c]=s}return y}function I(G,H,x,P){var y=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/,c=y.exec(G);if(!c||!c.length)return G;var s=c[1],b=c[2],L;if(H&&b in H?L=H[b]:b in h&&(L=h[b]),s in i){var n=i[s];G=n(G,L,x,P)}return G}function V(G,H,x){var P=/\{\{\s*(.+?)\s*\}\}/g;return G.replace(P,function(y,c){return H&&c in H?H[c]:c in h?h[c]:(console.log("argument {{"+c+"}} for #"+x+" is undefined."),y)})}function W(G){var H=C(G);if(H.id){var x=T(H.id,H.args);if(!x){console.warn("#"+H.id+" is undefined.");return}if(x[m]){if(te(G)===0)G[m]=x[m];else{for(var P=G.childNodes,y=!1,c=0,s=P.length;c<s;c++)P[c].nodeType===3&&/\S/.test(P[c].nodeValue)&&(y?P[c].nodeValue="":(P[c].nodeValue=x[m],y=!0));if(!y){var b=S.createTextNode(x[m]);G.prepend(b)}}delete x[m]}for(var L in x)G[L]=x[L]}}function te(G){if(G.children)return G.children.length;if(typeof G.childElementCount<"u")return G.childElementCount;for(var H=0,x=0;x<G.childNodes.length;x++)H+=G.nodeType===1?1:0;return H}function Q(G){G=G||S.documentElement;for(var H=E(G),x=H.length,P=0;P<x;P++)W(H[P]);W(G)}return{get:function(G,H,x){var P=G.lastIndexOf("."),y=m;P>0&&(y=G.substring(P+1),G=G.substring(0,P));var c;x&&(c={},c[y]=x);var s=T(G,H,c);return s&&y in s?s[y]:"{{"+G+"}}"},getData:function(){return h},getText:function(){return t},getLanguage:function(){return f},setLanguage:function(G,H){r(G,function(){H&&H()})},getDirection:function(){var G=["ar","he","fa","ps","ur"],H=f.split("-",1)[0];return G.indexOf(H)>=0?"rtl":"ltr"},translate:Q,getReadyState:function(){return a},ready:function(G){if(G)a=="complete"||a=="interactive"?F.setTimeout(function(){G()}):S.addEventListener&&S.addEventListener("localized",function H(){S.removeEventListener("localized",H),G()});else return}}})(window,document)}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFFindController=S.FindState=void 0;var h=A(2),t=A(11),m=A(4);const f={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};S.FindState=f;const i=250,a=-50,p=-400,o={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},d=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let E;const C=new RegExp("\\p{M}+","gu"),v=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),e=new RegExp("([^\\p{M}])\\p{M}*$","u"),r=new RegExp("^\\p{M}*([^\\p{M}])","u"),w=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,D=new Map,T="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",I=new Map;let V=null,W=null;function te(H){const x=[];let P;for(;(P=w.exec(H))!==null;){let{index:j}=P;for(const B of P[0]){let q=D.get(B);q||(q=B.normalize("NFD").length,D.set(B,q)),x.push([q,j++])}}let y;if(x.length===0&&V)y=V;else if(x.length>0&&W)y=W;else{const j=Object.keys(o).join(""),B=(0,t.getNormalizeWithNFKC)(),z=`([${j}])|([${B}])|((?:゙|゚)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[぀-ヿ])\\n)|(\\n)`;x.length===0?y=V=new RegExp(z+"|(\\u0000)","gum"):y=W=new RegExp(z+`|(${T})`,"gum")}const c=[];for(;(P=C.exec(H))!==null;)c.push([P[0].length,P.index]);let s=H.normalize("NFD");const b=[[0,0]];let L=0,n=0,u=0,_=0,R=0,O=!1;return s=s.replace(y,(j,B,q,Z,z,ee,se,$,J,ie)=>{if(ie-=_,B){const Y=o[B],re=Y.length;for(let ae=1;ae<re;ae++)b.push([ie-u+ae,u-ae]);return u-=re-1,Y}if(q){let Y=I.get(q);Y||(Y=q.normalize("NFKC"),I.set(q,Y));const re=Y.length;for(let ae=1;ae<re;ae++)b.push([ie-u+ae,u-ae]);return u-=re-1,Y}if(Z)return O=!0,ie+R===c[L]?.[1]?++L:(b.push([ie-1-u+1,u-1]),u-=1,_+=1),b.push([ie-u+1,u]),_+=1,R+=1,Z.charAt(0);if(z){const Y=z.endsWith(`
`),re=Y?z.length-2:z.length;O=!0;let ae=re;ie+R===c[L]?.[1]&&(ae-=c[L][0],++L);for(let le=1;le<=ae;le++)b.push([ie-1-u+le,u-le]);return u-=ae,_+=ae,Y?(ie+=re-1,b.push([ie-u+1,1+u]),u+=1,_+=1,R+=1,z.slice(0,re)):z}if(ee){const Y=ee.length-2;return b.push([ie-u+Y,1+u]),u+=1,_+=1,R+=1,ee.slice(0,-2)}if(se){const Y=se.length-1;return b.push([ie-u+Y,u]),_+=1,R+=1,se.slice(0,-1)}if($)return b.push([ie-u+1,u-1]),u-=1,_+=1,R+=1," ";if(ie+R===x[n]?.[1]){const Y=x[n][0]-1;++n;for(let re=1;re<=Y;re++)b.push([ie-(u-re),u-re]);u-=Y,_+=Y}return J}),b.push([s.length,u]),[s,b,O]}function Q(H,x,P){if(!H)return[x,P];const y=x,c=x+P-1;let s=(0,h.binarySearchFirstItem)(H,_=>_[0]>=y);H[s][0]>y&&--s;let b=(0,h.binarySearchFirstItem)(H,_=>_[0]>=c,s);H[b][0]>c&&--b;const L=y+H[s][1],u=c+H[b][1]+1-L;return[L,u]}class G{#e=null;#t=!0;#i=0;constructor({linkService:x,eventBus:P,updateMatchesCountOnProgress:y=!0}){this._linkService=x,this._eventBus=P,this.#t=y,this.#s(),P._on("find",this.#n.bind(this)),P._on("findbarclose",this.#w.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(x){this._pdfDocument&&this.#s(),x&&(this._pdfDocument=x,this._firstPageCapability.resolve())}#n(x){if(!x)return;x.phraseSearch===!1&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),typeof x.query=="string"&&(x.query=x.query.match(/\S+/g)));const P=this._pdfDocument,{type:y}=x;(this.#e===null||this.#h(x))&&(this._dirtyMatch=!0),this.#e=x,y!=="highlightallchange"&&this.#p(f.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||P&&this._pdfDocument!==P)return;this.#f();const c=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),y?this._dirtyMatch?this.#g():y==="again"?(this.#g(),c&&this.#e.highlightAll&&this.#u()):y==="highlightallchange"?(s?this.#g():this._highlightMatches=!0,this.#u()):this.#g():this._findTimeout=setTimeout(()=>{this.#g(),this._findTimeout=null},i)})}scrollMatchIntoView({element:x=null,selectedLeft:P=0,pageIndex:y=-1,matchIndex:c=-1}){if(!this._scrollMatches||!x)return;if(c===-1||c!==this._selected.matchIdx)return;if(y===-1||y!==this._selected.pageIdx)return;this._scrollMatches=!1;const s={top:a,left:P+p};(0,h.scrollIntoView)(x,s,!0)}#s(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#i=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new m.PromiseCapability}get#l(){const{query:x}=this.#e;return typeof x=="string"?(x!==this._rawQuery&&(this._rawQuery=x,[this._normalizedQuery]=te(x)),this._normalizedQuery):(x||[]).filter(P=>!!P).map(P=>te(P)[0])}#h(x){const P=x.query,y=this.#e.query,c=typeof P;if(c!==typeof y)return!0;if(c==="string"){if(P!==y)return!0}else if(JSON.stringify(P)!==JSON.stringify(y))return!0;switch(x.type){case"again":const b=this._selected.pageIdx+1,L=this._linkService;return b>=1&&b<=L.pagesCount&&b!==L.page&&!L.isPageVisible(b);case"highlightallchange":return!1}return!0}#r(x,P,y){let c=x.slice(0,P).match(e);if(c){const s=x.charCodeAt(P),b=c[1].charCodeAt(0);if((0,t.getCharacterType)(s)===(0,t.getCharacterType)(b))return!1}if(c=x.slice(P+y).match(r),c){const s=x.charCodeAt(P+y-1),b=c[1].charCodeAt(0);if((0,t.getCharacterType)(s)===(0,t.getCharacterType)(b))return!1}return!0}#a(x,P,y,c){const s=this._pageMatches[y]=[],b=this._pageMatchesLength[y]=[];if(!x)return;const L=this._pageDiffs[y];let n;for(;(n=x.exec(c))!==null;){if(P&&!this.#r(c,n.index,n[0].length))continue;const[u,_]=Q(L,n.index,n[0].length);_&&(s.push(u),b.push(_))}}#d(x,P){const{matchDiacritics:y}=this.#e;let c=!1;x=x.replaceAll(v,(b,L,n,u,_,R)=>L?`[ ]*\\${L}[ ]*`:n?`[ ]*${n}[ ]*`:u?"[ ]+":y?_||R:_?d.has(_.charCodeAt(0))?_:"":P?(c=!0,`${R}\\p{M}*`):R);const s="[ ]*";return x.endsWith(s)&&(x=x.slice(0,x.length-s.length)),y&&P&&(E||=String.fromCharCode(...d),c=!0,x=`${x}(?=[${E}]|[^\\p{M}]|$)`),[c,x]}#c(x){let P=this.#l;if(P.length===0)return;const{caseSensitive:y,entireWord:c}=this.#e,s=this._pageContents[x],b=this._hasDiacritics[x];let L=!1;typeof P=="string"?[L,P]=this.#d(P,b):P=P.sort().reverse().map(_=>{const[R,O]=this.#d(_,b);return L||=R,`(${O})`}).join("|");const n=`g${L?"u":""}${y?"":"i"}`;P=P?new RegExp(P,n):null,this.#a(P,c,x,s),this.#e.highlightAll&&this.#o(x),this._resumePageIdx===x&&(this._resumePageIdx=null,this.#v());const u=this._pageMatches[x].length;this._matchesCountTotal+=u,this.#t?u>0&&this.#S():++this.#i===this._linkService.pagesCount&&this.#S()}#f(){if(this._extractTextPromises.length>0)return;let x=Promise.resolve();const P={disableNormalization:!0};for(let y=0,c=this._linkService.pagesCount;y<c;y++){const s=new m.PromiseCapability;this._extractTextPromises[y]=s.promise,x=x.then(()=>this._pdfDocument.getPage(y+1).then(b=>b.getTextContent(P)).then(b=>{const L=[];for(const n of b.items)L.push(n.str),n.hasEOL&&L.push(`
`);[this._pageContents[y],this._pageDiffs[y],this._hasDiacritics[y]]=te(L.join("")),s.resolve()},b=>{console.error(`Unable to get text content for page ${y+1}`,b),this._pageContents[y]="",this._pageDiffs[y]=null,this._hasDiacritics[y]=!1,s.resolve()}))}}#o(x){this._scrollMatches&&this._selected.pageIdx===x&&(this._linkService.page=x+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:x})}#u(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#g(){const x=this.#e.findPrevious,P=this._linkService.page-1,y=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=P,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#i=0,this._matchesCountTotal=0,this.#u();for(let b=0;b<y;b++)this._pendingFindMatches.has(b)||(this._pendingFindMatches.add(b),this._extractTextPromises[b].then(()=>{this._pendingFindMatches.delete(b),this.#c(b)}))}if(this.#l.length===0){this.#p(f.FOUND);return}if(this._resumePageIdx)return;const s=this._offset;if(this._pagesToSearch=y,s.matchIdx!==null){const b=this._pageMatches[s.pageIdx].length;if(!x&&s.matchIdx+1<b||x&&s.matchIdx>0){s.matchIdx=x?s.matchIdx-1:s.matchIdx+1,this.#A(!0);return}this.#C(x)}this.#v()}#b(x){const P=this._offset,y=x.length,c=this.#e.findPrevious;return y?(P.matchIdx=c?y-1:0,this.#A(!0),!0):(this.#C(c),P.wrapped&&(P.matchIdx=null,this._pagesToSearch<0)?(this.#A(!1),!0):!1)}#v(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let x=null;do{const P=this._offset.pageIdx;if(x=this._pageMatches[P],!x){this._resumePageIdx=P;break}}while(!this.#b(x))}#C(x){const P=this._offset,y=this._linkService.pagesCount;P.pageIdx=x?P.pageIdx-1:P.pageIdx+1,P.matchIdx=null,this._pagesToSearch--,(P.pageIdx>=y||P.pageIdx<0)&&(P.pageIdx=x?y-1:0,P.wrapped=!0)}#A(x=!1){let P=f.NOT_FOUND;const y=this._offset.wrapped;if(this._offset.wrapped=!1,x){const c=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,P=y?f.WRAPPED:f.FOUND,c!==-1&&c!==this._selected.pageIdx&&this.#o(c)}this.#p(P,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#o(this._selected.pageIdx))}#w(x){const P=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||P&&this._pdfDocument!==P||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#p(f.FOUND),this._highlightMatches=!1,this.#u())})}#y(){const{pageIdx:x,matchIdx:P}=this._selected;let y=0,c=this._matchesCountTotal;if(P!==-1){for(let s=0;s<x;s++)y+=this._pageMatches[s]?.length||0;y+=P+1}return(y<1||y>c)&&(y=c=0),{current:y,total:c}}#S(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#y()})}#p(x,P=!1){!this.#t&&(this.#i!==this._linkService.pagesCount||x===f.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:x,previous:P,matchesCount:this.#y(),rawQuery:this.#e?.query??null})}}S.PDFFindController=G}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.CharacterType=void 0,S.getCharacterType=C,S.getNormalizeWithNFKC=e;const A={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};S.CharacterType=A;function h(r){return r<11904}function t(r){return(r&65408)===0}function m(r){return r>=97&&r<=122||r>=65&&r<=90}function f(r){return r>=48&&r<=57}function i(r){return r===32||r===9||r===13||r===10}function a(r){return r>=13312&&r<=40959||r>=63744&&r<=64255}function p(r){return r>=12448&&r<=12543}function o(r){return r>=12352&&r<=12447}function d(r){return r>=65376&&r<=65439}function E(r){return(r&65408)===3584}function C(r){return h(r)?t(r)?i(r)?A.SPACE:m(r)||f(r)||r===95?A.ALPHA_LETTER:A.PUNCT:E(r)?A.THAI_LETTER:r===160?A.SPACE:A.ALPHA_LETTER:a(r)?A.HAN_LETTER:p(r)?A.KATAKANA_LETTER:o(r)?A.HIRAGANA_LETTER:d(r)?A.HALFWIDTH_KATAKANA_LETTER:A.ALPHA_LETTER}let v;function e(){return v||=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦",v}}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFHistory=void 0,S.isDestArraysEqual=d,S.isDestHashesEqual=o;var h=A(2),t=A(7);const m=1e3,f=50,i=1e3;function a(){return document.location.hash}class p{constructor({linkService:C,eventBus:v}){this.linkService=C,this.eventBus=v,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",e=>{this._isPagesLoaded=!!e.pagesCount},{once:!0})})}initialize({fingerprint:C,resetHistory:v=!1,updateUrl:e=!1}){if(!C||typeof C!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const r=this._fingerprint!==""&&this._fingerprint!==C;this._fingerprint=C,this._updateUrl=e===!0,this._initialized=!0,this._bindEvents();const w=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=a(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(w,!0)||v){const{hash:T,page:I,rotation:V}=this._parseCurrentHash(!0);if(!T||r||v){this._pushOrReplaceState(null,!0);return}this._pushOrReplaceState({hash:T,page:I,rotation:V},!0);return}const D=w.destination;this._updateInternalState(D,w.uid,!0),D.rotation!==void 0&&(this._initialRotation=D.rotation),D.dest?(this._initialBookmark=JSON.stringify(D.dest),this._destination.page=null):D.hash?this._initialBookmark=D.hash:D.page&&(this._initialBookmark=`page=${D.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:C=null,explicitDest:v,pageNumber:e}){if(!this._initialized)return;if(C&&typeof C!="string"){console.error(`PDFHistory.push: "${C}" is not a valid namedDest parameter.`);return}else if(Array.isArray(v)){if(!this._isValidPage(e)&&(e!==null||this._destination)){console.error(`PDFHistory.push: "${e}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${v}" is not a valid explicitDest parameter.`);return}const r=C||JSON.stringify(v);if(!r)return;let w=!1;if(this._destination&&(o(this._destination.hash,r)||d(this._destination.dest,v))){if(this._destination.page)return;w=!0}this._popStateInProgress&&!w||(this._pushOrReplaceState({dest:v,hash:r,page:e,rotation:this.linkService.rotation},w),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(C){if(this._initialized){if(!this._isValidPage(C)){console.error(`PDFHistory.pushPage: "${C}" is not a valid page number.`);return}this._destination?.page!==C&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${C}`,page:C,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const C=window.history.state;this._isValidState(C)&&C.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const C=window.history.state;this._isValidState(C)&&C.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(C,v=!1){const e=v||!this._destination,r={fingerprint:this._fingerprint,uid:e?this._uid:this._uid+1,destination:C};this._updateInternalState(C,r.uid);let w;if(this._updateUrl&&C?.hash){const D=document.location.href.split("#")[0];D.startsWith("file://")||(w=`${D}#${C.hash}`)}e?window.history.replaceState(r,"",w):window.history.pushState(r,"",w)}_tryPushCurrentPosition(C=!1){if(!this._position)return;let v=this._position;if(C&&(v=Object.assign(Object.create(null),this._position),v.temporary=!0),!this._destination){this._pushOrReplaceState(v);return}if(this._destination.temporary){this._pushOrReplaceState(v,!0);return}if(this._destination.hash===v.hash||!this._destination.page&&this._numPositionUpdates<=f)return;let e=!1;if(this._destination.page>=v.first&&this._destination.page<=v.page){if(this._destination.dest!==void 0||!this._destination.first)return;e=!0}this._pushOrReplaceState(v,e)}_isValidPage(C){return Number.isInteger(C)&&C>0&&C<=this.linkService.pagesCount}_isValidState(C,v=!1){if(!C)return!1;if(C.fingerprint!==this._fingerprint)if(v){if(typeof C.fingerprint!="string"||C.fingerprint.length!==this._fingerprint.length)return!1;const[e]=performance.getEntriesByType("navigation");if(e?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(C.uid)||C.uid<0||C.destination===null||typeof C.destination!="object")}_updateInternalState(C,v,e=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),e&&C?.temporary&&delete C.temporary,this._destination=C,this._uid=v,this._maxUid=Math.max(this._maxUid,v),this._numPositionUpdates=0}_parseCurrentHash(C=!1){const v=unescape(a()).substring(1),e=(0,h.parseQueryString)(v),r=e.get("nameddest")||"";let w=e.get("page")|0;return(!this._isValidPage(w)||C&&r.length>0)&&(w=null),{hash:v,page:w,rotation:this.linkService.rotation}}_updateViewarea({location:C}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:C.pdfOpenParams.substring(1),page:this.linkService.page,first:C.pageNumber,rotation:C.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},i))}_popState({state:C}){const v=a(),e=this._currentHash!==v;if(this._currentHash=v,!C){this._uid++;const{hash:w,page:D,rotation:T}=this._parseCurrentHash();this._pushOrReplaceState({hash:w,page:D,rotation:T},!0);return}if(!this._isValidState(C))return;this._popStateInProgress=!0,e&&(this._blockHashChange++,(0,t.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:m}).then(()=>{this._blockHashChange--}));const r=C.destination;this._updateInternalState(r,C.uid,!0),(0,h.isValidRotation)(r.rotation)&&(this.linkService.rotation=r.rotation),r.dest?this.linkService.goToDestination(r.dest):r.hash?this.linkService.setHash(r.hash):r.page&&(this.linkService.page=r.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}S.PDFHistory=p;function o(E,C){return typeof E!="string"||typeof C!="string"?!1:E===C||(0,h.parseQueryString)(E).get("nameddest")===C}function d(E,C){function v(e,r){if(typeof e!=typeof r||Array.isArray(e)||Array.isArray(r))return!1;if(e!==null&&typeof e=="object"&&r!==null){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const w in e)if(!v(e[w],r[w]))return!1;return!0}return e===r||Number.isNaN(e)&&Number.isNaN(r)}if(!(Array.isArray(E)&&Array.isArray(C))||E.length!==C.length)return!1;for(let e=0,r=E.length;e<r;e++)if(!v(E[e],C[e]))return!1;return!0}}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFPageView=void 0;var h=A(4),t=A(2),m=A(14),f=A(3),i=A(15),a=A(5),p=A(1),o=A(16),d=A(17),E=A(18),C=A(19),v=A(20);const e=i.compatibilityParams.maxCanvasPixels||16777216,r=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new p.SimpleLinkService}});class w{#e=h.AnnotationMode.ENABLE_FORMS;#t=null;#i=null;#n=null;#s=null;#l=t.RenderingStates.INITIAL;#h=t.TextLayerMode.ENABLE;#r={initialOptionalContent:!0,regularAnnotations:!0};#a=new WeakMap;constructor(T){const I=T.container,V=T.defaultViewport;this.id=T.id,this.renderingId="page"+this.id,this.#t=T.layerProperties||r,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=T.scale||t.DEFAULT_SCALE,this.viewport=V,this.pdfPageRotate=V.rotation,this._optionalContentConfigPromise=T.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.#h=T.textLayerMode??t.TextLayerMode.ENABLE,this.#e=T.annotationMode??h.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=T.imageResourcesPath||"",this.useOnlyCssZoom=T.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=T.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=T.maxCanvasPixels||e,this.pageColors=T.pageColors||null,this.eventBus=T.eventBus,this.renderingQueue=T.renderingQueue,this.l10n=T.l10n||a.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const W=document.createElement("div");if(W.className="page",W.setAttribute("data-page-number",this.id),W.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(te=>{W.setAttribute("aria-label",te)}),this.div=W,this.#d(),I?.append(W),this._isStandalone){I?.style.setProperty("--scale-factor",this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:te}=T;te&&te.then(Q=>{te===this._optionalContentConfigPromise&&(this.#r.initialOptionalContent=Q.hasInitialVisibility)})}}get renderingState(){return this.#l}set renderingState(T){if(T!==this.#l)switch(this.#l=T,this.#i&&(clearTimeout(this.#i),this.#i=null),T){case t.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case t.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),this.#i=setTimeout(()=>{this.div.classList.add("loading"),this.#i=null},0);break;case t.RenderingStates.INITIAL:case t.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#d(){const{viewport:T}=this;if(this.pdfPage){if(this.#n===T.rotation)return;this.#n=T.rotation}(0,h.setLayerDimensions)(this.div,T,!0,!1)}setPdfPage(T){this.pdfPage=T,this.pdfPageRotate=T.rotate;const I=(this.rotation+this.pdfPageRotate)%360;this.viewport=T.getViewport({scale:this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:I}),this.#d(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}get _textHighlighter(){return(0,h.shadow)(this,"_textHighlighter",new E.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#t().findController}))}async#c(){let T=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(I){console.error(`#renderAnnotationLayer: "${I}".`),T=I}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:T})}}async#f(){let T=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(I){console.error(`#renderAnnotationEditorLayer: "${I}".`),T=I}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:T})}}async#o(){let T=null;try{const I=await this.xfaLayer.render(this.viewport,"display");I?.textDivs&&this._textHighlighter&&this.#b(I.textDivs)}catch(I){console.error(`#renderXfaLayer: "${I}".`),T=I}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:T})}}async#u(){const{pdfPage:T,textLayer:I,viewport:V}=this;if(!I)return;let W=null;try{if(!I.renderingDone){const te=T.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});I.setTextContentSource(te)}await I.render(V)}catch(te){if(te instanceof h.AbortException)return;console.error(`#renderTextLayer: "${te}".`),W=te}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:I.numTextDivs,error:W}),this.#g()}async#g(){if(!this.textLayer)return;this.structTreeLayer||=new o.StructTreeLayerBuilder;const T=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),I=this.structTreeLayer?.render(T);I&&this.canvas?.append(I),this.structTreeLayer?.show()}async#b(T){const I=await this.pdfPage.getTextContent(),V=[];for(const W of I.items)V.push(W.str);this._textHighlighter.setTextMapping(T,V),this._textHighlighter.enable()}_resetZoomLayer(T=!1){if(!this.zoomLayer)return;const I=this.zoomLayer.firstChild;this.#a.delete(I),I.width=0,I.height=0,T&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:T=!1,keepAnnotationLayer:I=!1,keepAnnotationEditorLayer:V=!1,keepXfaLayer:W=!1,keepTextLayer:te=!1}={}){this.cancelRendering({keepAnnotationLayer:I,keepAnnotationEditorLayer:V,keepXfaLayer:W,keepTextLayer:te}),this.renderingState=t.RenderingStates.INITIAL;const Q=this.div,G=Q.childNodes,H=T&&this.zoomLayer||null,x=I&&this.annotationLayer?.div||null,P=V&&this.annotationEditorLayer?.div||null,y=W&&this.xfaLayer?.div||null,c=te&&this.textLayer?.div||null;for(let s=G.length-1;s>=0;s--){const b=G[s];switch(b){case H:case x:case P:case y:case c:continue}b.remove()}Q.removeAttribute("data-loaded"),x&&this.annotationLayer.hide(),P&&this.annotationEditorLayer.hide(),y&&this.xfaLayer.hide(),c&&this.textLayer.hide(),this.structTreeLayer?.hide(),H||(this.canvas&&(this.#a.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:T=0,rotation:I=null,optionalContentConfigPromise:V=null,drawingDelay:W=-1}){this.scale=T||this.scale,typeof I=="number"&&(this.rotation=I),V instanceof Promise&&(this._optionalContentConfigPromise=V,V.then(x=>{V===this._optionalContentConfigPromise&&(this.#r.initialOptionalContent=x.hasInitialVisibility)}));const te=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:this.scale*h.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:te}),this.#d(),this._isStandalone&&this.div.parentNode?.style.setProperty("--scale-factor",this.viewport.scale);let Q=!1;if(this.canvas&&this.maxCanvasPixels>0){const{width:x,height:P}=this.viewport,{sx:y,sy:c}=this.outputScale;(Math.floor(x)*y|0)*(Math.floor(P)*c|0)>this.maxCanvasPixels&&(Q=!0)}const G=this.useOnlyCssZoom||this.hasRestrictedScaling&&Q,H=!G&&W>=0&&W<1e3;if(this.canvas){if(H||G){H&&this.renderingState!==t.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:W}),this.renderingState=t.RenderingStates.FINISHED),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!H,hideTextLayer:H}),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#s});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:T=!1,keepAnnotationEditorLayer:I=!1,keepXfaLayer:V=!1,keepTextLayer:W=!1,cancelExtraDelay:te=0}={}){this.renderTask&&(this.renderTask.cancel(te),this.renderTask=null),this.resume=null,this.textLayer&&(!W||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!T||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!I||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!V||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:T,redrawAnnotationLayer:I=!1,redrawAnnotationEditorLayer:V=!1,redrawXfaLayer:W=!1,redrawTextLayer:te=!1,hideTextLayer:Q=!1}){if(!T.hasAttribute("zooming")){T.setAttribute("zooming",!0);const{style:H}=T;H.width=H.height=""}const G=this.#a.get(T);if(this.viewport!==G){const H=this.viewport.rotation-G.rotation,x=Math.abs(H);let P=1,y=1;if(x===90||x===270){const{width:c,height:s}=this.viewport;P=s/c,y=c/s}T.style.transform=`rotate(${H}deg) scale(${P}, ${y})`}I&&this.annotationLayer&&this.#c(),V&&this.annotationEditorLayer&&this.#f(),W&&this.xfaLayer&&this.#o(),this.textLayer&&(Q?(this.textLayer.hide(),this.structTreeLayer?.hide()):te&&this.#u())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(T,I){return this.viewport.convertToPdfPoint(T,I)}async#v(T,I=null){if(T===this.renderTask&&(this.renderTask=null),I instanceof h.RenderingCancelledException){this.#s=null;return}if(this.#s=I,this.renderingState=t.RenderingStates.FINISHED,this._resetZoomLayer(!0),this.#r.regularAnnotations=!T.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#s}),I)throw I}async draw(){this.renderingState!==t.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:T,l10n:I,pageColors:V,pdfPage:W,viewport:te}=this;if(!W)throw this.renderingState=t.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=t.RenderingStates.RUNNING;const Q=document.createElement("div");if(Q.classList.add("canvasWrapper"),T.append(Q),!this.textLayer&&this.#h!==t.TextLayerMode.DISABLE&&!W.isPureXfa&&(this._accessibilityManager||=new d.TextAccessibilityManager,this.textLayer=new C.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:this.#h===t.TextLayerMode.ENABLE_PERMISSIONS}),T.append(this.textLayer.div)),!this.annotationLayer&&this.#e!==h.AnnotationMode.DISABLE){const{annotationStorage:B,downloadManager:q,enableScripting:Z,fieldObjectsPromise:z,hasJSActionsPromise:ee,linkService:se}=this.#t();this._annotationCanvasMap||=new Map,this.annotationLayer=new f.AnnotationLayerBuilder({pageDiv:T,pdfPage:W,annotationStorage:B,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===h.AnnotationMode.ENABLE_FORMS,linkService:se,downloadManager:q,l10n:I,enableScripting:Z,hasJSActionsPromise:ee,fieldObjectsPromise:z,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const G=B=>{if(c?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=t.RenderingStates.PAUSED,this.resume=()=>{this.renderingState=t.RenderingStates.RUNNING,B()};return}B()},{width:H,height:x}=te,P=document.createElement("canvas");P.setAttribute("role","presentation"),P.hidden=!0;const y=!!(V?.background&&V?.foreground);let c=B=>{(!y||B)&&(P.hidden=!1,c=null)};Q.append(P),this.canvas=P;const s=P.getContext("2d",{alpha:!1}),b=this.outputScale=new t.OutputScale;if(this.useOnlyCssZoom){const B=te.clone({scale:h.PixelsPerInch.PDF_TO_CSS_UNITS});b.sx*=B.width/H,b.sy*=B.height/x}if(this.maxCanvasPixels>0){const B=H*x,q=Math.sqrt(this.maxCanvasPixels/B);b.sx>q||b.sy>q?(b.sx=q,b.sy=q,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const L=(0,t.approximateFraction)(b.sx),n=(0,t.approximateFraction)(b.sy);P.width=(0,t.roundToDivide)(H*b.sx,L[0]),P.height=(0,t.roundToDivide)(x*b.sy,n[0]);const{style:u}=P;u.width=(0,t.roundToDivide)(H,L[1])+"px",u.height=(0,t.roundToDivide)(x,n[1])+"px",this.#a.set(P,te);const _=b.scaled?[b.sx,0,0,b.sy,0,0]:null,R={canvasContext:s,transform:_,viewport:te,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:V},O=this.renderTask=this.pdfPage.render(R);O.onContinue=G;const j=O.promise.then(async()=>{if(c?.(!0),await this.#v(O),this.#u(),this.annotationLayer&&await this.#c(),!this.annotationEditorLayer){const{annotationEditorUIManager:B}=this.#t();if(!B)return;this.annotationEditorLayer=new m.AnnotationEditorLayerBuilder({uiManager:B,pageDiv:T,pdfPage:W,l10n:I,accessibilityManager:this._accessibilityManager})}this.#f()},B=>(B instanceof h.RenderingCancelledException||c?.(!0),this.#v(O,B)));if(W.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&T.append(this.xfaLayer.div);else{const{annotationStorage:B,linkService:q}=this.#t();this.xfaLayer=new v.XfaLayerBuilder({pageDiv:T,pdfPage:W,annotationStorage:B,linkService:q})}this.#o()}return T.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),j}setPageLabel(T){this.pageLabel=typeof T=="string"?T:null,this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent:T,regularAnnotations:I}=this.#r;return T&&I?this.canvas:null}}S.PDFPageView=w}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.AnnotationEditorLayerBuilder=void 0;var h=A(4),t=A(5);class m{#e;constructor(i){this.pageDiv=i.pageDiv,this.pdfPage=i.pdfPage,this.accessibilityManager=i.accessibilityManager,this.l10n=i.l10n||t.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#e=i.uiManager}async render(i,a="display"){if(a!=="display"||this._cancelled)return;const p=i.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:p}),this.show();return}const o=this.div=document.createElement("div");o.className="annotationEditorLayer",o.tabIndex=0,o.hidden=!0,this.pageDiv.append(o),this.annotationEditorLayer=new h.AnnotationEditorLayer({uiManager:this.#e,div:o,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:p});const d={viewport:p,div:o,annotations:null,intent:a};this.annotationEditorLayer.render(d),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isEmpty||(this.div.hidden=!1)}}S.AnnotationEditorLayerBuilder=m}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.compatibilityParams=S.OptionKind=S.AppOptions=void 0;const A=Object.create(null);S.compatibilityParams=A;{const i=navigator.userAgent||"",a=navigator.platform||"",p=navigator.maxTouchPoints||1,o=/Android/.test(i),d=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||a==="MacIntel"&&p>1;(function(){(d||o)&&(A.maxCanvasPixels=5242880)})()}const h={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};S.OptionKind=h;const t={annotationEditorMode:{value:0,kind:h.VIEWER+h.PREFERENCE},annotationMode:{value:2,kind:h.VIEWER+h.PREFERENCE},cursorToolOnLoad:{value:0,kind:h.VIEWER+h.PREFERENCE},defaultZoomDelay:{value:400,kind:h.VIEWER+h.PREFERENCE},defaultZoomValue:{value:"",kind:h.VIEWER+h.PREFERENCE},disableHistory:{value:!1,kind:h.VIEWER},disablePageLabels:{value:!1,kind:h.VIEWER+h.PREFERENCE},enableFloatingToolbar:{value:!1,kind:h.VIEWER+h.PREFERENCE},enablePermissions:{value:!1,kind:h.VIEWER+h.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:h.VIEWER+h.PREFERENCE},enableScripting:{value:!0,kind:h.VIEWER+h.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:h.VIEWER},externalLinkTarget:{value:0,kind:h.VIEWER+h.PREFERENCE},historyUpdateUrl:{value:!1,kind:h.VIEWER+h.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:h.VIEWER+h.PREFERENCE},imageResourcesPath:{value:"./images/",kind:h.VIEWER},maxCanvasPixels:{value:16777216,kind:h.VIEWER},forcePageColors:{value:!1,kind:h.VIEWER+h.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:h.VIEWER+h.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:h.VIEWER+h.PREFERENCE},pdfBugEnabled:{value:!1,kind:h.VIEWER+h.PREFERENCE},printResolution:{value:150,kind:h.VIEWER},sidebarViewOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},scrollModeOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},spreadModeOnLoad:{value:-1,kind:h.VIEWER+h.PREFERENCE},textLayerMode:{value:1,kind:h.VIEWER+h.PREFERENCE},useOnlyCssZoom:{value:!1,kind:h.VIEWER+h.PREFERENCE},viewerCssTheme:{value:0,kind:h.VIEWER+h.PREFERENCE},viewOnLoad:{value:0,kind:h.VIEWER+h.PREFERENCE},cMapPacked:{value:!0,kind:h.API},cMapUrl:{value:"../web/cmaps/",kind:h.API},disableAutoFetch:{value:!1,kind:h.API+h.PREFERENCE},disableFontFace:{value:!1,kind:h.API+h.PREFERENCE},disableRange:{value:!1,kind:h.API+h.PREFERENCE},disableStream:{value:!1,kind:h.API+h.PREFERENCE},docBaseUrl:{value:"",kind:h.API},enableXfa:{value:!0,kind:h.API+h.PREFERENCE},fontExtraProperties:{value:!1,kind:h.API},isEvalSupported:{value:!0,kind:h.API},isOffscreenCanvasSupported:{value:!0,kind:h.API},maxImageSize:{value:-1,kind:h.API},pdfBug:{value:!1,kind:h.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:h.API},verbosity:{value:1,kind:h.API},workerPort:{value:null,kind:h.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:h.WORKER}};t.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:h.VIEWER},t.disablePreferences={value:!1,kind:h.VIEWER},t.locale={value:navigator.language||"en-US",kind:h.VIEWER},t.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:h.VIEWER};const m=Object.create(null);class f{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(a){const p=m[a];if(p!==void 0)return p;const o=t[a];if(o!==void 0)return A[a]??o.value}static getAll(a=null){const p=Object.create(null);for(const o in t){const d=t[o];if(a){if((a&d.kind)===0)continue;if(a===h.PREFERENCE){const C=d.value,v=typeof C;if(v==="boolean"||v==="string"||v==="number"&&Number.isInteger(C)){p[o]=C;continue}throw new Error(`Invalid type for preference: ${o}`)}}const E=m[o];p[o]=E!==void 0?E:A[o]??d.value}return p}static set(a,p){m[a]=p}static setAll(a){for(const p in a)m[p]=a[p]}static remove(a){delete m[a]}}S.AppOptions=f,f._hasUserOptions=function(){return Object.keys(m).length>0}}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.StructTreeLayerBuilder=void 0;const A={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},h=/^H(\d+)$/;class t{#e=void 0;get renderingDone(){return this.#e!==void 0}render(f){if(this.#e!==void 0)return this.#e;const i=this.#i(f);return i?.classList.add("structTree"),this.#e=i}hide(){this.#e&&!this.#e.hidden&&(this.#e.hidden=!0)}show(){this.#e?.hidden&&(this.#e.hidden=!1)}#t(f,i){f.alt!==void 0&&i.setAttribute("aria-label",f.alt),f.id!==void 0&&i.setAttribute("aria-owns",f.id),f.lang!==void 0&&i.setAttribute("lang",f.lang)}#i(f){if(!f)return null;const i=document.createElement("span");if("role"in f){const{role:a}=f,p=a.match(h);p?(i.setAttribute("role","heading"),i.setAttribute("aria-level",p[1])):A[a]&&i.setAttribute("role",A[a])}if(this.#t(f,i),f.children)if(f.children.length===1&&"id"in f.children[0])this.#t(f.children[0],i);else for(const a of f.children)i.append(this.#i(a));return i}}S.StructTreeLayerBuilder=t}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.TextAccessibilityManager=void 0;var h=A(2);class t{#e=!1;#t=null;#i=new Map;#n=new Map;setTextMapping(f){this.#t=f}static#s(f,i){const a=f.getBoundingClientRect(),p=i.getBoundingClientRect();if(a.width===0&&a.height===0)return 1;if(p.width===0&&p.height===0)return-1;const o=a.y,d=a.y+a.height,E=a.y+a.height/2,C=p.y,v=p.y+p.height,e=p.y+p.height/2;if(E<=C&&e>=d)return-1;if(e<=o&&E>=v)return 1;const r=a.x+a.width/2,w=p.x+p.width/2;return r-w}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(t.#s),this.#i.size>0){const f=this.#t;for(const[i,a]of this.#i){if(!document.getElementById(i)){this.#i.delete(i);continue}this.#l(i,f[a])}}for(const[f,i]of this.#n)this.addPointerInTextLayer(f,i);this.#n.clear()}disable(){this.#e&&(this.#n.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(f){if(!this.#e){this.#n.delete(f);return}const i=this.#t;if(!i||i.length===0)return;const{id:a}=f,p=this.#i.get(a);if(p===void 0)return;const o=i[p];this.#i.delete(a);let d=o.getAttribute("aria-owns");d?.includes(a)&&(d=d.split(" ").filter(E=>E!==a).join(" "),d?o.setAttribute("aria-owns",d):(o.removeAttribute("aria-owns"),o.setAttribute("role","presentation")))}#l(f,i){const a=i.getAttribute("aria-owns");a?.includes(f)||i.setAttribute("aria-owns",a?`${a} ${f}`:f),i.removeAttribute("role")}addPointerInTextLayer(f,i){const{id:a}=f;if(!a)return;if(!this.#e){this.#n.set(f,i);return}i&&this.removePointerInTextLayer(f);const p=this.#t;if(!p||p.length===0)return;const o=(0,h.binarySearchFirstItem)(p,E=>t.#s(f,E)<0),d=Math.max(0,o-1);this.#l(a,p[d]),this.#i.set(a,d)}moveElementInDOM(f,i,a,p){if(this.addPointerInTextLayer(a,p),!f.hasChildNodes()){f.append(i);return}const o=Array.from(f.childNodes).filter(C=>C!==i);if(o.length===0)return;const d=a||i,E=(0,h.binarySearchFirstItem)(o,C=>t.#s(d,C)<0);E===0?o[0].before(i):o[E-1].after(i)}}S.TextAccessibilityManager=t}),((F,S)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.TextHighlighter=void 0;class A{constructor({findController:t,eventBus:m,pageIndex:f}){this.findController=t,this.matches=[],this.eventBus=m,this.pageIdx=f,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,m){this.textDivs=t,this.textContentItemsStr=m}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=t=>{(t.pageIndex===this.pageIdx||t.pageIndex===-1)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(t,m){if(!t)return[];const{textContentItemsStr:f}=this;let i=0,a=0;const p=f.length-1,o=[];for(let d=0,E=t.length;d<E;d++){let C=t[d];for(;i!==p&&C>=a+f[i].length;)a+=f[i].length,i++;i===f.length&&console.error("Could not find a matching mapping");const v={begin:{divIdx:i,offset:C-a}};for(C+=m[d];i!==p&&C>a+f[i].length;)a+=f[i].length,i++;v.end={divIdx:i,offset:C-a},o.push(v)}return o}_renderMatches(t){if(t.length===0)return;const{findController:m,pageIdx:f}=this,{textContentItemsStr:i,textDivs:a}=this,p=f===m.selected.pageIdx,o=m.selected.matchIdx,d=m.state.highlightAll;let E=null;const C={offset:void 0};function v(I,V){const W=I.divIdx;return a[W].textContent="",e(W,0,I.offset,V)}function e(I,V,W,te){let Q=a[I];if(Q.nodeType===Node.TEXT_NODE){const x=document.createElement("span");Q.before(x),x.append(Q),a[I]=x,Q=x}const G=i[I].substring(V,W),H=document.createTextNode(G);if(te){const x=document.createElement("span");return x.className=`${te} appended`,x.append(H),Q.append(x),te.includes("selected")?x.offsetLeft:0}return Q.append(H),0}let r=o,w=r+1;if(d)r=0,w=t.length;else if(!p)return;let D=-1,T=-1;for(let I=r;I<w;I++){const V=t[I],W=V.begin;if(W.divIdx===D&&W.offset===T)continue;D=W.divIdx,T=W.offset;const te=V.end,Q=p&&I===o,G=Q?" selected":"";let H=0;if(!E||W.divIdx!==E.divIdx?(E!==null&&e(E.divIdx,E.offset,C.offset),v(W)):e(E.divIdx,E.offset,W.offset),W.divIdx===te.divIdx)H=e(W.divIdx,W.offset,te.offset,"highlight"+G);else{H=e(W.divIdx,W.offset,C.offset,"highlight begin"+G);for(let x=W.divIdx+1,P=te.divIdx;x<P;x++)a[x].className="highlight middle"+G;v(te,"highlight end"+G)}E=te,Q&&m.scrollMatchIntoView({element:a[W.divIdx],selectedLeft:H,pageIndex:f,matchIndex:o})}E&&e(E.divIdx,E.offset,C.offset)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:m,matches:f,pageIdx:i}=this,{textContentItemsStr:a,textDivs:p}=this;let o=-1;for(const C of f){const v=Math.max(o,C.begin.divIdx);for(let e=v,r=C.end.divIdx;e<=r;e++){const w=p[e];w.textContent=a[e],w.className=""}o=C.end.divIdx+1}if(!m?.highlightMatches||t)return;const d=m.pageMatches[i]||null,E=m.pageMatchesLength[i]||null;this.matches=this._convertMatches(d,E),this._renderMatches(this.matches)}}S.TextHighlighter=A}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.TextLayerBuilder=void 0;var h=A(4),t=A(2);class m{#e=!1;#t=0;#i=0;#n=null;constructor({highlighter:i=null,accessibilityManager:a=null,isOffscreenCanvasSupported:p=!0,enablePermissions:o=!1}){this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=i,this.accessibilityManager=a,this.isOffscreenCanvasSupported=p,this.#e=o===!0,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}#s(){this.renderingDone=!0;const i=document.createElement("div");i.className="endOfContent",this.div.append(i),this.#l()}get numTextDivs(){return this.textDivs.length}async render(i){if(!this.#n)throw new Error('No "textContentSource" parameter specified.');const a=i.scale*(globalThis.devicePixelRatio||1),{rotation:p}=i;if(this.renderingDone){const o=p!==this.#t,d=a!==this.#i;(o||d)&&(this.hide(),(0,h.updateTextLayer)({container:this.div,viewport:i,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:d,mustRotate:o}),this.#i=a,this.#t=p),this.show();return}this.cancel(),this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr),this.accessibilityManager?.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,h.renderTextLayer)({textContentSource:this.#n,container:this.div,viewport:i,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,this.#s(),this.#i=a,this.#t=p,this.show(),this.accessibilityManager?.enable()}hide(){this.div.hidden||(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable(),this.accessibilityManager?.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(i){this.cancel(),this.#n=i}#l(){const{div:i}=this;i.addEventListener("mousedown",a=>{const p=i.querySelector(".endOfContent");if(!p)return;let o=a.target!==i;if(o&&=getComputedStyle(p).getPropertyValue("-moz-user-select")!=="none",o){const d=i.getBoundingClientRect(),E=Math.max(0,(a.pageY-d.top)/d.height);p.style.top=(E*100).toFixed(2)+"%"}p.classList.add("active")}),i.addEventListener("mouseup",()=>{const a=i.querySelector(".endOfContent");a&&(a.style.top="",a.classList.remove("active"))}),i.addEventListener("copy",a=>{if(!this.#e){const p=document.getSelection();a.clipboardData.setData("text/plain",(0,t.removeNullCharacters)((0,h.normalizeUnicode)(p.toString())))}a.preventDefault(),a.stopPropagation()})}}S.TextLayerBuilder=m}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.XfaLayerBuilder=void 0;var h=A(4);class t{constructor({pageDiv:f,pdfPage:i,annotationStorage:a=null,linkService:p,xfaHtml:o=null}){this.pageDiv=f,this.pdfPage=i,this.annotationStorage=a,this.linkService=p,this.xfaHtml=o,this.div=null,this._cancelled=!1}async render(f,i="display"){if(i==="print"){const o={viewport:f.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i},d=document.createElement("div");return this.pageDiv.append(d),o.div=d,h.XfaLayer.render(o)}const a=await this.pdfPage.getXfa();if(this._cancelled||!a)return{textDivs:[]};const p={viewport:f.clone({dontFlip:!0}),div:this.div,xfaHtml:a,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i};return this.div?h.XfaLayer.update(p):(this.div=document.createElement("div"),this.pageDiv.append(this.div),p.div=this.div,h.XfaLayer.render(p))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}S.XfaLayerBuilder=t}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFScriptingManager=void 0;var h=A(2),t=A(4);class m{constructor({eventBus:i,sandboxBundleSrc:a=null,scriptingFactory:p=null,docPropertiesLookup:o=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._ready=!1,this._eventBus=i,this._sandboxBundleSrc=a,this._scriptingFactory=p,this._docPropertiesLookup=o,this._scriptingFactory||window.addEventListener("updatefromsandbox",d=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:d.detail})})}setViewer(i){this._pdfViewer=i}async setDocument(i){if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=i,!i)return;const[a,p,o]=await Promise.all([i.getFieldObjects(),i.getCalculationOrderIds(),i.getJSActions()]);if(!a&&!o){await this._destroyScripting();return}if(i===this._pdfDocument){try{this._scripting=this._createScripting()}catch(d){console.error(`PDFScriptingManager.setDocument: "${d?.message}".`),await this._destroyScripting();return}this._internalEvents.set("updatefromsandbox",d=>{d?.source===window&&this._updateFromSandbox(d.detail)}),this._internalEvents.set("dispatcheventinsandbox",d=>{this._scripting?.dispatchEventInSandbox(d.detail)}),this._internalEvents.set("pagechanging",({pageNumber:d,previous:E})=>{d!==E&&(this._dispatchPageClose(E),this._dispatchPageOpen(d))}),this._internalEvents.set("pagerendered",({pageNumber:d})=>{this._pageOpenPending.has(d)&&d===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(d)}),this._internalEvents.set("pagesdestroy",async d=>{await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this._closeCapability?.resolve()});for(const[d,E]of this._internalEvents)this._eventBus._on(d,E);try{const d=await this._getDocProperties();if(i!==this._pdfDocument)return;await this._scripting.createSandbox({objects:a,calculationOrder:p,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...d,actions:o}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(d){console.error(`PDFScriptingManager.setDocument: "${d?.message}".`),await this._destroyScripting();return}await this._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{i===this._pdfDocument&&(this._ready=!0)})}}async dispatchWillSave(i){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(i){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(i){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(i){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,t.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,t.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,t.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(i){const a=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:p,siblings:o,command:d,value:E}=i;if(!p){switch(d){case"clear":console.clear();break;case"error":console.error(E);break;case"layout":{if(a)return;const v=(0,h.apiPageLayoutToViewerModes)(E);this._pdfViewer.spreadMode=v.spreadMode;break}case"page-num":this._pdfViewer.currentPageNumber=E+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(E);break;case"zoom":if(a)return;this._pdfViewer.currentScaleValue=E;break;case"SaveAs":this._eventBus.dispatch("download",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(a)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(a)return;this._pdfViewer.decreaseScale();break}return}if(a&&i.focus)return;delete i.id,delete i.siblings;const C=o?[p,...o]:[p];for(const v of C){const e=document.querySelector(`[data-element-id="${v}"]`);e?e.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:i})):this._pdfDocument?.annotationStorage.setValue(v,i)}}async _dispatchPageOpen(i,a=!1){const p=this._pdfDocument,o=this._visitedPages;if(a&&(this._closeCapability=new t.PromiseCapability),!this._closeCapability)return;const d=this._pdfViewer.getPageView(i-1);if(d?.renderingState!==h.RenderingStates.FINISHED){this._pageOpenPending.add(i);return}this._pageOpenPending.delete(i);const E=(async()=>{const C=await(o.has(i)?null:d.pdfPage?.getJSActions());p===this._pdfDocument&&await this._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:i,actions:C})})();o.set(i,E)}async _dispatchPageClose(i){const a=this._pdfDocument,p=this._visitedPages;if(!this._closeCapability||this._pageOpenPending.has(i))return;const o=p.get(i);o&&(p.set(i,null),await o,a===this._pdfDocument&&await this._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:i}))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);const{docPropertiesLookup:i}=A(22);return i(this._pdfDocument)}_createScripting(){if(this._destroyCapability=new t.PromiseCapability,this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:i}=A(22);return new i(this._sandboxBundleSrc)}async _destroyScripting(){if(!this._scripting){this._pdfDocument=null,this._destroyCapability?.resolve();return}this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise(i=>{setTimeout(i,1e3)})]).catch(i=>{}),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch{}for(const[i,a]of this._internalEvents)this._eventBus._off(i,a);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,this._ready=!1,this._destroyCapability?.resolve()}}S.PDFScriptingManager=m}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.GenericScripting=void 0,S.docPropertiesLookup=t;var h=A(4);async function t(f){const a="".split("#")[0];let{info:p,metadata:o,contentDispositionFilename:d,contentLength:E}=await f.getMetadata();if(!E){const{length:C}=await f.getDownloadInfo();E=C}return{...p,baseURL:a,filesize:E,filename:d||(0,h.getPdfFilenameFromUrl)(""),metadata:o?.getRaw(),authors:o?.get("dc:creator"),numPages:f.numPages,URL:""}}class m{constructor(i){this._ready=(0,h.loadScript)(i,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}async createSandbox(i){(await this._ready).create(i)}async dispatchEventInSandbox(i){const a=await this._ready;setTimeout(()=>a.dispatchEvent(i),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}S.GenericScripting=m}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFSinglePageViewer=void 0;var h=A(2),t=A(24);class m extends t.PDFViewer{_resetView(){super._resetView(),this._scrollMode=h.ScrollMode.PAGE,this._spreadMode=h.SpreadMode.NONE}set scrollMode(i){}_updateScrollMode(){}set spreadMode(i){}_updateSpreadMode(){}}S.PDFSinglePageViewer=m}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PagesCountLimit=S.PDFViewer=S.PDFPageViewBuffer=void 0;var h=A(4),t=A(2),m=A(5),f=A(13),i=A(25),a=A(1);const p=10,o={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};S.PagesCountLimit=o;function d(v){return Object.values(h.AnnotationEditorType).includes(v)&&v!==h.AnnotationEditorType.DISABLE}class E{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){const r=this.#e;r.has(e)&&r.delete(e),r.add(e),r.size>this.#t&&this.#i()}resize(e,r=null){this.#t=e;const w=this.#e;if(r){const D=w.size;let T=1;for(const I of w)if(r.has(I.id)&&(w.delete(I),w.add(I)),++T>D)break}for(;w.size>this.#t;)this.#i()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#i(){const e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}}S.PDFPageViewBuffer=E;class C{#e=null;#t=h.AnnotationEditorType.NONE;#i=null;#n=h.AnnotationMode.ENABLE_FORMS;#s=null;#l=null;#h=!1;#r=!1;#a=null;#d=!1;#c=0;#f=new ResizeObserver(this.#k.bind(this));#o=null;#u=null;#g=null;#b=t.TextLayerMode.ENABLE;constructor(e){const r="3.6.172";if(h.version!==r)throw new Error(`The API version "${h.version}" does not match the Viewer version "${r}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#f.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new a.SimpleLinkService,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this._scriptingManager=e.scriptingManager||null,this.#b=e.textLayerMode??t.TextLayerMode.ENABLE,this.#n=e.annotationMode??h.AnnotationMode.ENABLE_FORMS,this.#t=e.annotationEditorMode??h.AnnotationEditorType.NONE,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.useOnlyCssZoom=e.useOnlyCssZoom||!1,this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n||m.NullL10n,this.#h=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("PDFViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new i.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue,this.scroll=(0,t.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=t.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#M()}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#n===h.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,r=!1){if(this._currentPageNumber===e)return r&&this.#E(),!0;if(!(0<e&&e<=this.pagesCount))return!1;const w=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:w}),r&&this.#E(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let r=e|0;if(this._pageLabels){const w=this._pageLabels.indexOf(e);w>=0&&(r=w+1)}this._setCurrentPageNumber(r,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==t.UNKNOWN_SCALE?this._currentScale:t.DEFAULT_SCALE}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#_(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#_(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!(0,t.isValidRotation)(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;const r=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#_(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:r}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#v(){const e=this;return{get annotationEditorUIManager(){return e.#i},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}}}#C(e){const r={annotationEditorMode:this.#t,annotationMode:this.#n,textLayerMode:this.#b};return e&&(!e.includes(h.PermissionFlag.COPY)&&this.#b===t.TextLayerMode.ENABLE&&(r.textLayerMode=t.TextLayerMode.ENABLE_PERMISSIONS),e.includes(h.PermissionFlag.MODIFY_CONTENTS)||(r.annotationEditorMode=h.AnnotationEditorType.DISABLE),!e.includes(h.PermissionFlag.MODIFY_ANNOTATIONS)&&!e.includes(h.PermissionFlag.FILL_INTERACTIVE_FORMS)&&this.#n===h.AnnotationMode.ENABLE_FORMS&&(r.annotationMode=h.AnnotationMode.ENABLE)),r}#A(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return Promise.resolve();const e=new Promise(r=>{this.#u=()=>{document.visibilityState==="hidden"&&(r(),document.removeEventListener("visibilitychange",this.#u),this.#u=null)},document.addEventListener("visibilitychange",this.#u)});return Promise.race([this._onePageRenderedCapability.promise,e])}async getAllText(){const e=[],r=[];for(let w=1,D=this.pdfDocument.numPages;w<=D;++w){if(this.#d)return null;r.length=0;const T=await this.pdfDocument.getPage(w),{items:I}=await T.getTextContent();for(const V of I)V.str&&r.push(V.str),V.hasEOL&&r.push(`
`);e.push((0,t.removeNullCharacters)(r.join("")))}return e.join(`
`)}#w(e,r){const w=document.getSelection(),{focusNode:D,anchorNode:T}=w;if(T&&D&&w.containsNode(this.#a)){if(this.#r||e===t.TextLayerMode.ENABLE_PERMISSIONS){r.preventDefault(),r.stopPropagation();return}this.#r=!0;const I=this.container.style.cursor;this.container.style.cursor="wait";const V=W=>this.#d=W.key==="Escape";window.addEventListener("keydown",V),this.getAllText().then(async W=>{W!==null&&await navigator.clipboard.writeText(W)}).catch(W=>{console.warn(`Something goes wrong when extracting the text: ${W.message}`)}).finally(()=>{this.#r=!1,this.#d=!1,window.removeEventListener("keydown",V),this.container.style.cursor=I}),r.preventDefault(),r.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#i&&(this.#i.destroy(),this.#i=null)),this.pdfDocument=e,!e)return;const r=e.numPages,w=e.getPage(1),D=e.getOptionalContentConfig(),T=this.#h?e.getPermissions():Promise.resolve();if(r>o.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const I=this._scrollMode=t.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:I})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:r})},()=>{}),this._onBeforeDraw=I=>{const V=this._pages[I.pageNumber-1];V&&this.#e.push(V)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=I=>{I.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:I.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#u&&(document.removeEventListener("visibilitychange",this.#u),this.#u=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([w,T]).then(([I,V])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(I),this._optionalContentConfigPromise=D;const{annotationEditorMode:W,annotationMode:te,textLayerMode:Q}=this.#C(V);if(Q!==t.TextLayerMode.DISABLE){const c=this.#a=document.createElement("div");c.id="hiddenCopyElement",this.viewer.before(c)}if(W!==h.AnnotationEditorType.DISABLE){const c=W;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):d(c)?(this.#i=new h.AnnotationEditorUIManager(this.container,this.eventBus,e?.annotationStorage),c!==h.AnnotationEditorType.NONE&&this.#i.updateMode(c)):console.error(`Invalid AnnotationEditor mode: ${c}`)}const G=this.#v.bind(this),H=this._scrollMode===t.ScrollMode.PAGE?null:this.viewer,x=this.currentScale,P=I.getViewport({scale:x*h.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",P.scale);for(let c=1;c<=r;++c){const s=new f.PDFPageView({container:H,eventBus:this.eventBus,id:c,scale:x,defaultViewport:P.clone(),optionalContentConfigPromise:D,renderingQueue:this.renderingQueue,textLayerMode:Q,annotationMode:te,imageResourcesPath:this.imageResourcesPath,useOnlyCssZoom:this.useOnlyCssZoom,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:G});this._pages.push(s)}const y=this._pages[0];y&&(y.setPdfPage(I),this.linkService.cachePageRef(1,I.ref)),this._scrollMode===t.ScrollMode.PAGE?this.#y():this._spreadMode!==t.SpreadMode.NONE&&this._updateSpreadMode(),this.#A().then(async()=>{if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#a&&(this.#l=this.#w.bind(this,Q),document.addEventListener("copy",this.#l)),this.#i&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:this.#t}),e.loadingParams.disableAutoFetch||r>o.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let c=r-1;if(c<=0){this._pagesCapability.resolve();return}for(let s=2;s<=r;++s){const b=e.getPage(s).then(L=>{const n=this._pages[s-1];n.pdfPage||n.setPdfPage(L),this.linkService.cachePageRef(s,L.ref),--c===0&&this._pagesCapability.resolve()},L=>{console.error(`Unable to get page ${s} to initialize viewer`,L),--c===0&&this._pagesCapability.resolve()});s%o.PAUSE_EAGER_PAGE_INIT===0&&await b}}),this.eventBus.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:c})=>{e===this.pdfDocument&&c.Language&&(this.viewer.lang=c.Language)}),this.defaultRenderingQueue&&this.update()}).catch(I=>{console.error("Unable to initialize viewer",I),this._pagesCapability.reject(I)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let r=0,w=this._pages.length;r<w;r++)this._pages[r].setPageLabel(this._pageLabels?.[r]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=t.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#e=new E(p),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new h.PromiseCapability,this._onePageRenderedCapability=new h.PromiseCapability,this._pagesCapability=new h.PromiseCapability,this._scrollMode=t.ScrollMode.VERTICAL,this._previousScrollMode=t.ScrollMode.UNKNOWN,this._spreadMode=t.SpreadMode.NONE,this.#o={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#u&&(document.removeEventListener("visibilitychange",this.#u),this.#u=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#a&&(document.removeEventListener("copy",this.#l),this.#l=null,this.#a.remove(),this.#a=null)}#y(){if(this._scrollMode!==t.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const e=this._currentPageNumber,r=this.#o,w=this.viewer;if(w.textContent="",r.pages.length=0,this._spreadMode===t.SpreadMode.NONE&&!this.isInPresentationMode){const D=this._pages[e-1];w.append(D.div),r.pages.push(D)}else{const D=new Set,T=this._spreadMode-1;T===-1?D.add(e-1):e%2!==T?(D.add(e-1),D.add(e)):(D.add(e-2),D.add(e-1));const I=document.createElement("div");if(I.className="spread",this.isInPresentationMode){const V=document.createElement("div");V.className="dummyPage",I.append(V)}for(const V of D){const W=this._pages[V];W&&(I.append(W.div),r.pages.push(W))}w.append(I)}r.scrollDown=e>=r.previousPageNumber,r.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#S(e,r=null){const{div:w,id:D}=e;if(this._currentPageNumber!==D&&this._setCurrentPageNumber(D),this._scrollMode===t.ScrollMode.PAGE&&(this.#y(),this.update()),!r&&!this.isInPresentationMode){const T=w.offsetLeft+w.clientLeft,I=T+w.clientWidth,{scrollLeft:V,clientWidth:W}=this.container;(this._scrollMode===t.ScrollMode.HORIZONTAL||T<V||I>V+W)&&(r={left:0,top:0})}(0,t.scrollIntoView)(w,r),!this._currentScaleValue&&this._location&&(this._location=null)}#p(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#x(e,r,{noScroll:w=!1,preset:D=!1,drawingDelay:T=-1}){if(this._currentScaleValue=r.toString(),this.#p(e)){D&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:r});return}this.viewer.style.setProperty("--scale-factor",e*h.PixelsPerInch.PDF_TO_CSS_UNITS);const I=T>=0&&T<1e3;if(this.refresh(!0,{scale:e,drawingDelay:I?T:-1}),I&&(this.#g=setTimeout(()=>{this.#g=null,this.refresh()},T)),this._currentScale=e,!w){let V=this._currentPageNumber,W;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(V=this._location.pageNumber,W=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:V,destArray:W,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:D?r:void 0}),this.defaultRenderingQueue&&this.update()}get#T(){return this._spreadMode!==t.SpreadMode.NONE&&this._scrollMode!==t.ScrollMode.HORIZONTAL?2:1}#_(e,r){let w=parseFloat(e);if(w>0)r.preset=!1,this.#x(w,e,r);else{const D=this._pages[this._currentPageNumber-1];if(!D)return;let T=t.SCROLLBAR_PADDING,I=t.VERTICAL_PADDING;this.isInPresentationMode?(T=I=4,this._spreadMode!==t.SpreadMode.NONE&&(T*=2)):this.removePageBorders?T=I=0:this._scrollMode===t.ScrollMode.HORIZONTAL&&([T,I]=[I,T]);const V=(this.container.clientWidth-T)/D.width*D.scale/this.#T,W=(this.container.clientHeight-I)/D.height*D.scale;switch(e){case"page-actual":w=1;break;case"page-width":w=V;break;case"page-height":w=W;break;case"page-fit":w=Math.min(V,W);break;case"auto":const te=(0,t.isPortraitOrientation)(D)?V:Math.min(W,V);w=Math.min(t.MAX_AUTO_SCALE,te);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}r.preset=!0,this.#x(w,e,r)}}#E(){const e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#_(this._currentScaleValue,{noScroll:!0}),this.#S(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;const r=this._pageLabels.indexOf(e);return r<0?null:r+1}scrollPageIntoView({pageNumber:e,destArray:r=null,allowNegativeOffset:w=!1,ignoreDestinationZoom:D=!1}){if(!this.pdfDocument)return;const T=Number.isInteger(e)&&this._pages[e-1];if(!T){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!r){this._setCurrentPageNumber(e,!0);return}let I=0,V=0,W=0,te=0,Q,G;const H=T.rotation%180!==0,x=(H?T.height:T.width)/T.scale/h.PixelsPerInch.PDF_TO_CSS_UNITS,P=(H?T.width:T.height)/T.scale/h.PixelsPerInch.PDF_TO_CSS_UNITS;let y=0;switch(r[1].name){case"XYZ":I=r[2],V=r[3],y=r[4],I=I!==null?I:0,V=V!==null?V:P;break;case"Fit":case"FitB":y="page-fit";break;case"FitH":case"FitBH":V=r[2],y="page-width",V===null&&this._location?(I=this._location.left,V=this._location.top):(typeof V!="number"||V<0)&&(V=P);break;case"FitV":case"FitBV":I=r[2],W=x,te=P,y="page-height";break;case"FitR":I=r[2],V=r[3],W=r[4]-I,te=r[5]-V;let L=t.SCROLLBAR_PADDING,n=t.VERTICAL_PADDING;this.removePageBorders&&(L=n=0),Q=(this.container.clientWidth-L)/W/h.PixelsPerInch.PDF_TO_CSS_UNITS,G=(this.container.clientHeight-n)/te/h.PixelsPerInch.PDF_TO_CSS_UNITS,y=Math.min(Math.abs(Q),Math.abs(G));break;default:console.error(`scrollPageIntoView: "${r[1].name}" is not a valid destination type.`);return}if(D||(y&&y!==this._currentScale?this.currentScaleValue=y:this._currentScale===t.UNKNOWN_SCALE&&(this.currentScaleValue=t.DEFAULT_SCALE_VALUE)),y==="page-fit"&&!r[4]){this.#S(T);return}const c=[T.viewport.convertToViewportPoint(I,V),T.viewport.convertToViewportPoint(I+W,V+te)];let s=Math.min(c[0][0],c[1][0]),b=Math.min(c[0][1],c[1][1]);w||(s=Math.max(s,0),b=Math.max(b,0)),this.#S(T,{left:s,top:b})}_updateLocation(e){const r=this._currentScale,w=this._currentScaleValue,D=parseFloat(w)===r?Math.round(r*1e4)/100:w,T=e.id,I=this._pages[T-1],V=this.container,W=I.getPagePoint(V.scrollLeft-e.x,V.scrollTop-e.y),te=Math.round(W[0]),Q=Math.round(W[1]);let G=`#page=${T}`;this.isInPresentationMode||(G+=`&zoom=${D},${te},${Q}`),this._location={pageNumber:T,scale:D,top:Q,left:te,rotation:this._pagesRotation,pdfOpenParams:G}}update(){const e=this._getVisiblePages(),r=e.views,w=r.length;if(w===0)return;const D=Math.max(p,2*w+1);this.#e.resize(D,e.ids),this.renderingQueue.renderHighestPriority(e);const T=this._spreadMode===t.SpreadMode.NONE&&(this._scrollMode===t.ScrollMode.PAGE||this._scrollMode===t.ScrollMode.VERTICAL),I=this._currentPageNumber;let V=!1;for(const W of r){if(W.percent<100)break;if(W.id===I&&T){V=!0;break}}this._setCurrentPageNumber(V?I:r[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===t.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===t.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const e=this._scrollMode===t.ScrollMode.PAGE?this.#o.pages:this._pages,r=this._scrollMode===t.ScrollMode.HORIZONTAL,w=r&&this._isContainerRtl;return(0,t.getVisibleElements)({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:r,rtl:w})}isPageVisible(e){return this.pdfDocument?Number.isInteger(e)&&e>0&&e<=this.pagesCount?this._getVisiblePages().ids.has(e):(console.error(`isPageVisible: "${e}" is not a valid page.`),!1):!1}isPageCached(e){if(!this.pdfDocument)return!1;if(!(Number.isInteger(e)&&e>0&&e<=this.pagesCount))return console.error(`isPageCached: "${e}" is not a valid page.`),!1;const r=this._pages[e-1];return this.#e.has(r)}cleanup(){for(const e of this._pages)e.renderingState!==t.RenderingStates.FINISHED&&e.reset()}_cancelRendering(){for(const e of this._pages)e.cancelRendering()}async#m(e){if(e.pdfPage)return e.pdfPage;try{const r=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(r),this.linkService._cachedPageNumber?.(r.ref)||this.linkService.cachePageRef(e.id,r.ref),r}catch(r){return console.error("Unable to get page for page view",r),null}}#P(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case t.ScrollMode.PAGE:return this.#o.scrollDown;case t.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){const r=e||this._getVisiblePages(),w=this.#P(r),D=this._spreadMode!==t.SpreadMode.NONE&&this._scrollMode!==t.ScrollMode.HORIZONTAL,T=this.renderingQueue.getHighestPriority(r,this._pages,w,D);return T?(this.#m(T).then(()=>{this.renderingQueue.renderView(T)}),!0):!1}get hasEqualPageSizes(){const e=this._pages[0];for(let r=1,w=this._pages.length;r<w;++r){const D=this._pages[r];if(D.width!==e.width||D.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(r=>{const w=r.pdfPage.getViewport({scale:1}),D=(0,t.isPortraitOrientation)(w);if(e===void 0)e=D;else if(this.enablePrintAutoRotate&&D!==e)return{width:w.height,height:w.width,rotation:(w.rotation-90)%360};return{width:w.width,height:w.height,rotation:w.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!(0,t.isValidScrollMode)(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>o.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){const r=this._scrollMode,w=this.viewer;w.classList.toggle("scrollHorizontal",r===t.ScrollMode.HORIZONTAL),w.classList.toggle("scrollWrapped",r===t.ScrollMode.WRAPPED),!(!this.pdfDocument||!e)&&(r===t.ScrollMode.PAGE?this.#y():this._previousScrollMode===t.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#_(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!(0,t.isValidSpreadMode)(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;const r=this.viewer,w=this._pages;if(this._scrollMode===t.ScrollMode.PAGE)this.#y();else if(r.textContent="",this._spreadMode===t.SpreadMode.NONE)for(const D of this._pages)r.append(D.div);else{const D=this._spreadMode-1;let T=null;for(let I=0,V=w.length;I<V;++I)T===null?(T=document.createElement("div"),T.className="spread",r.append(T)):I%2===D&&(T=T.cloneNode(!1),r.append(T)),T.append(w[I].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#_(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,r=!1){switch(this._scrollMode){case t.ScrollMode.WRAPPED:{const{views:w}=this._getVisiblePages(),D=new Map;for(const{id:T,y:I,percent:V,widthPercent:W}of w){if(V===0||W<100)continue;let te=D.get(I);te||D.set(I,te||=[]),te.push(T)}for(const T of D.values()){const I=T.indexOf(e);if(I===-1)continue;const V=T.length;if(V===1)break;if(r)for(let W=I-1,te=0;W>=te;W--){const Q=T[W],G=T[W+1]-1;if(Q<G)return e-G}else for(let W=I+1,te=V;W<te;W++){const Q=T[W],G=T[W-1]+1;if(Q>G)return G-e}if(r){const W=T[0];if(W<e)return e-W+1}else{const W=T[V-1];if(W>e)return W-e+1}break}break}case t.ScrollMode.HORIZONTAL:break;case t.ScrollMode.PAGE:case t.ScrollMode.VERTICAL:{if(this._spreadMode===t.SpreadMode.NONE)break;const w=this._spreadMode-1;if(r&&e%2!==w)break;if(!r&&e%2===w)break;const{views:D}=this._getVisiblePages(),T=r?e-1:e+1;for(const{id:I,percent:V,widthPercent:W}of D)if(I===T){if(V>0&&W===100)return 2;break}break}}return 1}nextPage(){const e=this._currentPageNumber,r=this.pagesCount;if(e>=r)return!1;const w=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+w,r),!0}previousPage(){const e=this._currentPageNumber;if(e<=1)return!1;const r=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-r,1),!0}increaseScale({drawingDelay:e,scaleFactor:r,steps:w}={}){if(!this.pdfDocument)return;let D=this._currentScale;if(r>1)D=Math.round(D*r*100)/100;else{w??=1;do D=Math.ceil((D*t.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--w>0&&D<t.MAX_SCALE)}this.#_(Math.min(t.MAX_SCALE,D),{noScroll:!1,drawingDelay:e})}decreaseScale({drawingDelay:e,scaleFactor:r,steps:w}={}){if(!this.pdfDocument)return;let D=this._currentScale;if(r>0&&r<1)D=Math.round(D*r*100)/100;else{w??=1;do D=Math.floor((D/t.DEFAULT_SCALE_DELTA).toFixed(2)*10)/10;while(--w>0&&D>t.MIN_SCALE)}this.#_(Math.max(t.MIN_SCALE,D),{noScroll:!1,drawingDelay:e})}#M(e=this.container.clientHeight){e!==this.#c&&(this.#c=e,t.docStyle.setProperty("--viewer-container-height",`${e}px`))}#k(e){for(const r of e)if(r.target===this.container){this.#M(Math.floor(r.borderBoxSize[0].blockSize)),this.#s=null;break}}get containerTopLeft(){return this.#s||=[this.container.offsetTop,this.container.offsetLeft]}get annotationEditorMode(){return this.#i?this.#t:h.AnnotationEditorType.DISABLE}set annotationEditorMode(e){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");if(this.#t!==e){if(!d(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);this.pdfDocument&&(this.#t=e,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:e}),this.#i.updateMode(e))}}set annotationEditorParams({type:e,value:r}){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");this.#i.updateParams(e,r)}refresh(e=!1,r=Object.create(null)){if(this.pdfDocument){for(const w of this._pages)w.update(r);this.#g!==null&&(clearTimeout(this.#g),this.#g=null),e||this.update()}}}S.PDFViewer=C}),((F,S,A)=>{Object.defineProperty(S,"__esModule",{value:!0}),S.PDFRenderingQueue=void 0;var h=A(4),t=A(2);const m=3e4;class f{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(a){this.pdfViewer=a}setThumbnailViewer(a){this.pdfThumbnailViewer=a}isHighestPriority(a){return this.highestPriorityPage===a.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(a){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(a)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),m)))}getHighestPriority(a,p,o,d=!1){const E=a.views,C=E.length;if(C===0)return null;for(let D=0;D<C;D++){const T=E[D].view;if(!this.isViewFinished(T))return T}const v=a.first.id,e=a.last.id;if(e-v+1>C){const D=a.ids;for(let T=1,I=e-v;T<I;T++){const V=o?v+T:e-T;if(D.has(V))continue;const W=p[V-1];if(!this.isViewFinished(W))return W}}let r=o?e:v-2,w=p[r];return w&&!this.isViewFinished(w)||d&&(r+=o?1:-1,w=p[r],w&&!this.isViewFinished(w))?w:null}isViewFinished(a){return a.renderingState===t.RenderingStates.FINISHED}renderView(a){switch(a.renderingState){case t.RenderingStates.FINISHED:return!1;case t.RenderingStates.PAUSED:this.highestPriorityPage=a.renderingId,a.resume();break;case t.RenderingStates.RUNNING:this.highestPriorityPage=a.renderingId;break;case t.RenderingStates.INITIAL:this.highestPriorityPage=a.renderingId,a.draw().finally(()=>{this.renderHighestPriority()}).catch(p=>{p instanceof h.RenderingCancelledException||console.error(`renderView: "${p}"`)});break}return!0}}S.PDFRenderingQueue=f})],g={};function M(F){var S=g[F];if(S!==void 0)return S.exports;var A=g[F]={exports:{}};return k[F](A,A.exports,M),A.exports}var U={};return(()=>{var F=U;Object.defineProperty(F,"__esModule",{value:!0}),Object.defineProperty(F,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return h.AnnotationLayerBuilder}}),F.DefaultXfaLayerFactory=F.DefaultTextLayerFactory=F.DefaultStructTreeLayerFactory=F.DefaultAnnotationLayerFactory=void 0,Object.defineProperty(F,"DownloadManager",{enumerable:!0,get:function(){return t.DownloadManager}}),Object.defineProperty(F,"EventBus",{enumerable:!0,get:function(){return m.EventBus}}),Object.defineProperty(F,"GenericL10n",{enumerable:!0,get:function(){return f.GenericL10n}}),Object.defineProperty(F,"LinkTarget",{enumerable:!0,get:function(){return S.LinkTarget}}),Object.defineProperty(F,"NullL10n",{enumerable:!0,get:function(){return i.NullL10n}}),Object.defineProperty(F,"PDFFindController",{enumerable:!0,get:function(){return a.PDFFindController}}),Object.defineProperty(F,"PDFHistory",{enumerable:!0,get:function(){return p.PDFHistory}}),Object.defineProperty(F,"PDFLinkService",{enumerable:!0,get:function(){return S.PDFLinkService}}),Object.defineProperty(F,"PDFPageView",{enumerable:!0,get:function(){return o.PDFPageView}}),Object.defineProperty(F,"PDFScriptingManager",{enumerable:!0,get:function(){return d.PDFScriptingManager}}),Object.defineProperty(F,"PDFSinglePageViewer",{enumerable:!0,get:function(){return E.PDFSinglePageViewer}}),Object.defineProperty(F,"PDFViewer",{enumerable:!0,get:function(){return C.PDFViewer}}),Object.defineProperty(F,"ProgressBar",{enumerable:!0,get:function(){return A.ProgressBar}}),Object.defineProperty(F,"RenderingStates",{enumerable:!0,get:function(){return A.RenderingStates}}),Object.defineProperty(F,"ScrollMode",{enumerable:!0,get:function(){return A.ScrollMode}}),Object.defineProperty(F,"SimpleLinkService",{enumerable:!0,get:function(){return S.SimpleLinkService}}),Object.defineProperty(F,"SpreadMode",{enumerable:!0,get:function(){return A.SpreadMode}}),Object.defineProperty(F,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return v.StructTreeLayerBuilder}}),Object.defineProperty(F,"TextLayerBuilder",{enumerable:!0,get:function(){return e.TextLayerBuilder}}),Object.defineProperty(F,"XfaLayerBuilder",{enumerable:!0,get:function(){return r.XfaLayerBuilder}}),Object.defineProperty(F,"parseQueryString",{enumerable:!0,get:function(){return A.parseQueryString}});var S=M(1),A=M(2),h=M(3),t=M(6),m=M(7),f=M(8),i=M(5),a=M(10),p=M(12),o=M(13),d=M(21),E=M(23),C=M(24),v=M(16),e=M(19),r=M(20);class w{constructor(){throw new Error("The `DefaultAnnotationLayerFactory` has been removed, please use the `annotationMode` option when initializing the `PDFPageView`-instance to control AnnotationLayer rendering.")}}F.DefaultAnnotationLayerFactory=w;class D{constructor(){throw new Error("The `DefaultStructTreeLayerFactory` has been removed, this functionality is automatically enabled when the TextLayer is used.")}}F.DefaultStructTreeLayerFactory=D;class T{constructor(){throw new Error("The `DefaultTextLayerFactory` has been removed, please use the `textLayerMode` option when initializing the `PDFPageView`-instance to control TextLayer rendering.")}}F.DefaultTextLayerFactory=T;class I{constructor(){throw new Error("The `DefaultXfaLayerFactory` has been removed, please use the `enableXfa` option when calling the `getDocument`-function to control XfaLayer rendering.")}}F.DefaultXfaLayerFactory=I})(),U})())})(pdf_viewer)),pdf_viewer.exports}var pdf_viewerExports=requirePdf_viewer();pdfExports.GlobalWorkerOptions.workerSrc="/static/pdfjs/pdf.worker.min.js";const _sfc_main=vue.defineComponent({name:"DocumentEditor",components:{ToolbarPagination:_sfc_main$1,ToolbarRotation:_sfc_main$2,ToolbarZoom:_sfc_main$3,ToolbarAnnotation:_sfc_main$4},setup:(N,l)=>{i18n.global.t},props:{value:{type:String,required:!0},baseUrl:{type:String,required:!0},pagination:{type:Boolean,default:!0},zoom:{type:Boolean,default:!0},comment:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0},rotation:{type:Boolean,default:!0}},data(){return{token:this.value,rotations:{},highlightingColor:"",commentingColor:"",loading:!0,error:"",currentPage:1,currentZoom:"",hasAnnotations:!1,savingInProgress:!1,interval:null,pages:1,pdfDocument:void 0,viewer:void 0}},computed:{hasBeenRotated(){return this.rotations&&Object.keys(this.rotations).length!==0},needsToBeSaved(){return this.hasBeenRotated||this.hasAnnotations}},mounted(){this.pdfDocument=void 0,this.getFile();const N=["changeCurrentPage","rotate","zoomIn","zoomOut","setScale","setHighlight","setCommenting","save"];for(const l of N)this.$el.addEventListener(l,(k=>{this[l](k.detail)}))},unmounted(){this.stopWatchingAnnotations()},methods:{getFile:async function(){if(this.token==="FileInfectedException")this.error=this.t("view_entry.file_infected");else try{const N=await doRequest(`${this.baseUrl}metadata/${this.token}`),l=await pdfExports.getDocument(N.url).promise,k=new pdf_viewerExports.PDFViewer({container:this.$refs.viewerContainer,eventBus:new pdf_viewerExports.EventBus,viewer:this.$refs.pdfViewer});k.setDocument(l),k.eventBus.on("pagechanging",M=>{this.currentPage=M.pageNumber;const U=new CustomEvent("pageChange",{detail:{pageNumber:M.pageNumber}});this.$el.dispatchEvent(U)}),k.eventBus.on("pagesinit",()=>{this.currentZoom=k.currentScaleValue="auto"}),this.pages=l.numPages;const g=new CustomEvent("numPages",{detail:{numPages:l.numPages}});this.$el.dispatchEvent(g),this.pdfDocument=vue.markRaw(l),this.viewer=vue.markRaw(k)}catch(N){this.error=N.message}this.loading=!1},rotate(N){(this.viewer?.getPageView(this.currentPage-1)).update({rotation:N}),this.viewer?.update(),N!==0?this.rotations[this.currentPage-1]=N:delete this.rotations[this.currentPage-1]},changeCurrentPage(N){this.viewer.currentPageNumber=N},zoomIn(){const N=this.viewer;N.increaseScale({scaleFactor:1.1}),this.currentZoom=N.currentScale.toString()},zoomOut(){const N=this.viewer;N.decreaseScale({scaleFactor:1.1}),this.currentZoom=N.currentScale.toString()},setScale(N){this.viewer.currentScaleValue=N,this.currentZoom=N},startWatchingAnnotations:function(){this.interval||(this.interval=window.setInterval(()=>this.updateNeedsToBeSaved(),500))},stopWatchingAnnotations:function(){this.interval&&window.clearInterval(this.interval),this.interval=null},setHighlight(N){const l=this.viewer;this.commentingColor="",this.highlightingColor=N,N?(this.startWatchingAnnotations(),l.annotationEditorMode=pdfExports.AnnotationEditorType.INK,l.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_THICKNESS,value:10},l.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_OPACITY,value:50},l.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.INK_COLOR,value:N}):(this.stopWatchingAnnotations(),l.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},setCommenting(N){const l=this.viewer;this.highlightingColor="",this.commentingColor=N,N?(this.startWatchingAnnotations(),l.annotationEditorMode=pdfExports.AnnotationEditorType.FREETEXT,l.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_SIZE,value:10},l.annotationEditorParams={type:pdfExports.AnnotationEditorParamsType.FREETEXT_COLOR,value:N}):(this.stopWatchingAnnotations(),l.annotationEditorMode=pdfExports.AnnotationEditorType.NONE)},updateNeedsToBeSaved(){this.hasAnnotations=!!this.pdfDocument&&this.pdfDocument.annotationStorage.size>0},async save(){if(!this.needsToBeSaved)return!1;this.savingInProgress=!0,this.setCommenting("");const N=await this.pdfDocument.saveDocument(),l=new Blob([N],{type:"application/pdf"}),k=new FormData;k.append("file",l),k.append("rotations",JSON.stringify(vue.toRaw(this.rotations)));try{const g=await doRequest(`${this.baseUrl}save-editor/${this.token}`,{method:"POST",headers:void 0,body:k});this.rotations={},this.hasAnnotations=!1,this.token=g.token,this.getFile()}catch(g){this.error=g.message}this.savingInProgress=!1}}}),_export_sfc=(N,l)=>{const k=N.__vccOpts||N;for(const[g,M]of l)k[g]=M;return k},_hoisted_1={class:"editor-container"},_hoisted_2={class:"wrapper"},_hoisted_3={ref:"viewerContainer",class:"viewerContainer",tabindex:"0"},_hoisted_4={class:"pdfViewer",ref:"pdfViewer"},_hoisted_5={class:"btn-toolbar",role:"toolbar"},_hoisted_6={key:0,class:"text-danger"};function _sfc_render(N,l,k,g,M,U){const F=vue.resolveComponent("ToolbarPagination"),S=vue.resolveComponent("ToolbarRotation"),A=vue.resolveComponent("ToolbarZoom"),h=vue.resolveComponent("ToolbarAnnotation");return vue.openBlock(),vue.createElementBlock("div",_hoisted_1,[vue.createElementVNode("div",_hoisted_2,[vue.createElementVNode("div",_hoisted_3,[vue.createElementVNode("div",_hoisted_4,null,512)],512)]),vue.createElementVNode("div",_hoisted_5,[N.pages&&N.pagination?(vue.openBlock(),vue.createBlock(F,{key:0,"current-page":N.currentPage,pages:N.pages,onOnChangeCurrentPage:N.changeCurrentPage},null,8,["current-page","pages","onOnChangeCurrentPage"])):vue.createCommentVNode("",!0),N.rotation?(vue.openBlock(),vue.createBlock(S,{key:1,"current-rotation":N.rotations[N.currentPage-1]||0,onOnRotate:N.rotate},null,8,["current-rotation","onOnRotate"])):vue.createCommentVNode("",!0),N.zoom&&N.currentZoom?(vue.openBlock(),vue.createBlock(A,{key:2,"current-zoom":N.currentZoom,onOnZoomIn:N.zoomIn,onOnZoomOut:N.zoomOut,onOnSetScale:N.setScale},null,8,["current-zoom","onOnZoomIn","onOnZoomOut","onOnSetScale"])):vue.createCommentVNode("",!0),N.highlight?(vue.openBlock(),vue.createBlock(h,{key:3,icon:"fa-highlighter","is-activated":N.highlightingColor!="",color:N.highlightingColor,"class-prefix":"bg",colors:{warning:"#ffff00",danger:"#ff0000",info:"#0000ff",success:"#00ff00"},onOnChange:N.setHighlight},null,8,["is-activated","color","onOnChange"])):vue.createCommentVNode("",!0),N.comment?(vue.openBlock(),vue.createBlock(h,{key:4,icon:"fa-message","is-activated":N.commentingColor!="",color:N.commentingColor,"class-prefix":"text",colors:{danger:"#a94442",warning:"#ffff00",info:"#31708f",success:"#3c763d",muted:"#ffffff"},onOnChange:N.setCommenting},null,8,["is-activated","color","onOnChange"])):vue.createCommentVNode("",!0),vue.createElementVNode("button",{type:"button",class:vue.normalizeClass(["btn",N.needsToBeSaved?"btn-primary":"btn-default disabled"]),onClick:l[0]||(l[0]=(...t)=>N.save&&N.save(...t))},[vue.createElementVNode("span",{class:vue.normalizeClass(["fas",N.savingInProgress?"fa-spinner fa-spin-pulse":`fa-save ${N.needsToBeSaved&&"fa-beat-fade"}`])},null,2)],2)]),N.error?(vue.openBlock(),vue.createElementBlock("p",_hoisted_6,vue.toDisplayString(N.error),1)):vue.createCommentVNode("",!0)])}const Editor=_export_sfc(_sfc_main,[["render",_sfc_render]]);function initEditors(){document.querySelectorAll(".osis-document-editor:not([data-v-app])").forEach(N=>{const l={baseUrl:"",value:"",...N.dataset};for(const k of["pagination","zoom","comment","highlight","rotation"])typeof N.dataset[k]<"u"&&(l[k]=N.dataset[k]==="true");runtimeDom.createApp(Editor,l).use(i18n).mount(N)})}initEditors();const observer=new MutationObserver(initEditors);observer.observe(document,{childList:!0,subtree:!0})}));
//# sourceMappingURL=osis-document-editor.umd.min.js.map
